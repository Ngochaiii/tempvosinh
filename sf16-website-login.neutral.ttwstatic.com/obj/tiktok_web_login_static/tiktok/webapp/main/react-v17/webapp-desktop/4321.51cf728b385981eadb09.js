"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4321],{6726:(e,t,o)=>{o.d(t,{cF:()=>j,Nl:()=>T,Gd:()=>U,_0:()=>k});var i=o(46833),n=o(64388),s=o(1183),r=o(46249),a=o(78695),l=o(22113),u=o.n(l),c=o(16356),d=o(40746),m=o(25961),p=o(35762),v=o(17384),g=function(e,t,o,i){return new(o||(o=Promise))(function(n,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})};const f=(0,d.M)({csr:function(e,t){return g(this,void 0,void 0,function*(){let o=28,n=i.pf.WEBSCENE_RECOMMEND_USER_TRENDING;return(0,m.gq)(e)?o=50:(0,m.cj)(e)?(o=30,n=i.pf.WEBSCENE_RECOMMEND_USER_PROFILE):o=30,(yield p.h.get("/node/share/discover",{query:{noUser:"0",count:o,scene:n,pageId:t,userId:t}})).body[0].exploreList})}}),h={list:[],hasMore:!0,loading:!0,maxCursor:0,minCursor:0,total:0,statusCode:0};function y(e,t,o){const{list:i,maxCursor:n,minCursor:s,total:r,statusCode:a,hasMore:l}=o;e(t,e=>Object.assign(Object.assign({},e),{list:u()(e.list.concat(i)),maxCursor:n,minCursor:s,total:null!=r?r:e.total,statusCode:null!=a?a:e.statusCode,hasMore:null!=l?l:-1!==n,loading:!1}))}function w(e,t,o,i,n){var s,r,a,l,u;return r=this,a=void 0,u=function*(){try{const{count:r,scene:a,isNonPersonalized:l,secUid:u}=i,{list:d,maxCursor:m=0,minCursor:f=0}=e(o);t(o,e=>Object.assign(Object.assign({},e),{loading:!0}));const h=yield function(e){return g(this,void 0,void 0,function*(){return p.h.get("/api/user/list/",{query:e,baseUrlType:v.Z4.FixedWww})})}({scene:a,maxCursor:m,minCursor:f,count:r,isNonPersonalized:l,secUid:u});!function({set:e,atom:t,response:o,idList:i,useSorting:n=!1}){const{maxCursor:s,minCursor:r,userList:a=[],total:l,statusCode:u,hasMore:d}=o,m=(0,c.Gp)();m.multiSetUser(a.map(({user:e})=>e)),m.multiSetUserStats(a.map(({user:e,stats:t,statsV2:o})=>({uniqueId:e.uniqueId,stats:t,statsV2:o}))),y(e,t,{list:n?a.sort((e,t)=>{var o,i,n,s;return(null!==(o=null==(n=t.user.roomId)?void 0:n.length)&&void 0!==o?o:0)-(null!==(i=null==(s=e.user.roomId)?void 0:s.length)&&void 0!==i?i:0)}).map(({user:{uniqueId:e}})=>e).filter(e=>i.indexOf(e)<0):a.map(({user:{uniqueId:e}})=>e).filter(e=>i.indexOf(e)<0),maxCursor:s,minCursor:r,total:l,statusCode:u,hasMore:d})}({set:t,atom:o,response:h,idList:d,useSorting:null!==(s=null==n?void 0:n.useSorting)&&void 0!==s&&s})}catch(e){}},new((l=void 0)||(l=Promise))(function(e,t){function o(e){try{n(u.next(e))}catch(e){t(e)}}function i(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):(n=t.value,n instanceof l?n:new l(function(e){e(n)})).then(o,i)}n((u=u.apply(r,a||[])).next())})}function L(e){const t=e.toLowerCase().replace(/([-_][a-z])/g,e=>e.toUpperCase().replace("-","").replace("_",""));return(0,a._)((0,s.p)(`accountListAtom_${t}@tiktok/webapp-atoms`,h),{rehydrationKey:`webapp.accountList.${t}`})}var S=o(18499),I=function(e,t,o,i){return new(o||(o=Promise))(function(n,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})};const O=L(r.p.Following),_=L(r.p.Follower),C=L(r.p.Recommend),F=L(r.p.Friend),P=L(r.p.OthersFollowing),A=L(r.p.OthersFollower),E=L(r.p.SuggestedFollow),x=(0,s.p)("accountListAtomMapAtom@tiktok/webapp-atoms",{[r.p.Following]:O,[r.p.Follower]:_,[r.p.Recommend]:C,[r.p.Friend]:F,[r.p.OthersFollowing]:P,[r.p.OthersFollower]:A,[r.p.SuggestedFollow]:E}),b=(0,s.p)("accountListAtom@tiktok/webapp-atoms",e=>({[r.p.Following]:e(O),[r.p.Follower]:e(_),[r.p.Recommend]:e(C),[r.p.Friend]:e(F),[r.p.OthersFollowing]:e(P),[r.p.OthersFollower]:e(A),[r.p.SuggestedFollow]:e(E)}),(e,t,o)=>{t(e(x)[o.key],o.data)}),{useAtomService:U,useServiceState:k,useServiceDispatchers:T,getStaticApi:j}=(0,n.i)(b,(e,t)=>({resetList(e){t(b,{key:e.key,data:h})},resetUserFollowInfo(){(0,S.unstable_batchedUpdates)(()=>{t(A,h),t(P,h)})},getRecommendList(e){return I(this,void 0,void 0,function*(){try{const{pathname:o,userId:i=""}=e,n=yield f(o,i);t(C,h);const s=n.map(({cardItem:e})=>({avatarLarger:e.cover,avatarMedium:e.cover,avatarThumb:e.cover,id:e.id,nickname:e.title,relation:e.extraInfo.relation,signature:e.description,uniqueId:e.subTitle.replace(/^@/,""),verified:e.extraInfo.verified,secUid:e.extraInfo.secUid,roomId:e.extraInfo.roomId})).sort((e,t)=>{var o,i;return(null!==(o=null==e?void 0:e.relation)&&void 0!==o?o:0)-(null!==(i=null==t?void 0:t.relation)&&void 0!==i?i:0)}).sort((e,t)=>{var o,i,n,s;return(null!==(o=null==t||null==(n=t.roomId)?void 0:n.length)&&void 0!==o?o:0)-(null!==(i=null==e||null==(s=e.roomId)?void 0:s.length)&&void 0!==i?i:0)});(0,c.Gp)().multiSetUser(s),y(t,C,{list:s.map(({uniqueId:e})=>e),hasMore:!1})}catch(e){}})},getFollowingList(o){return I(this,void 0,void 0,function*(){yield w(e,t,O,{count:o.count,scene:i.pf.WEBSCENE_FOLLOWINGLIST_ALL},{useSorting:!0})})},getFollowerList(o){return I(this,void 0,void 0,function*(){yield w(e,t,_,{count:o.count,scene:i.pf.WEBAPP_USER_LIST_FOLLOWER})})},getFriendsList(o){var n;return I(this,void 0,void 0,function*(){yield w(e,t,F,{count:null!==(n=o.count)&&void 0!==n?n:30,scene:i.pf.WEBAPP_USER_LIST_MATCH_FRIEND})})},getSuggestedList(o){var n;return I(this,void 0,void 0,function*(){yield w(e,t,E,{count:null!==(n=o.count)&&void 0!==n?n:30,isNonPersonalized:o.isNonPersonalized,scene:i.pf.WEBAPP_USER_LIST_MATCH_SUGGESTED})})},getTargetFollowerList(o){var n;return I(this,void 0,void 0,function*(){yield w(e,t,A,{count:null!==(n=o.count)&&void 0!==n?n:30,secUid:o.secUid,scene:i.pf.WEBAPP_USER_LIST_FOLLOWER})})},getTargetFollowingList(o){var n;return I(this,void 0,void 0,function*(){yield w(e,t,P,{count:null!==(n=o.count)&&void 0!==n?n:30,secUid:o.secUid,scene:i.pf.WEBSCENE_FOLLOWINGLIST_ALL})})}}))},37123:(e,t,o)=>{o.d(t,{UO:()=>c,kq:()=>u});var i=o(78695),n=o(64388),s=o(1183);const r=(0,i._)((0,s.p)("recommendUserListAtom@tiktok/webapp-atoms",{uniqueId:void 0}),{rehydrationKey:"webapp.recommendUserList"}),{useAtomService:a,useServiceDispatchers:l,useServiceState:u,getStaticApi:c}=(0,n.i)(r,(e,t)=>({setUniqueId(e){t(r,t=>Object.assign(Object.assign({},t),{uniqueId:e}))}}))},42186:(e,t,o)=>{o.d(t,{kh:()=>L,vZ:()=>y,Z9:()=>w});var i=o(8094),n=o(63131),s=o(19664),r=o(1183),a=o(64388),l=o(43650),u=o(17164),c=o(72546),d=o(84198),m=o(37783);const p=(e,t)=>{const o=t(m.Pu);return e.flatMap(e=>{const t=o[e];return t?t.showNotPass||6===t.takeDown?[]:e:[]})},v=(0,r.p)("immersivePlayerItemListConfigAtom@tiktok/webapp-atoms",null),g=(0,r.p)("immersivePlayerItemListAtom@tiktok/webapp-atoms",e=>{const t=e(v);if(!t)return[];if("single"===t.mode){const o=(0,c.D)(t.itemListKey);return o?p(e(o).list,e):[]}return"id"===t.mode&&"user-playlist"===t.source?p(e(d.DB)[t.id].list,e):[]},(e,t,o)=>{t(v,o)}),f=(0,r.p)("immersivePlayerStateAtom@tiktok/webapp-atoms",{index:-1,isOpen:!1,isCommentsOpen:!1}),h=(0,r.p)("immersivePlayerAtom@tiktok/webapp-atoms",e=>{const t=e(f),o=e(g),i=e(v);return Object.assign({itemList:o,itemListSourceConfig:i},t)},(e,t,o)=>{console.warn("Tried to set immersivePlayerAtom with:",o)}),{useAtomService:y,useServiceState:w,useServiceDispatchers:L,getStaticApi:S}=(0,a.i)(h,(e,t)=>({syncStateToPlayerAtom({id:t}={}){const o=e(v),{index:r}=e(h),a=null!=t?t:e(g)[r],c=e(u.jD)[a],d="video"===(null==c?void 0:c.contentType)?c.currentTime:void 0,m={currentVideo:{index:r,id:a,mode:n.ey.ImmersivePlayer},playProgress:null!=d?d:0,pageType:"single"===(null==o?void 0:o.mode)?l.FB[o.itemListKey]:i.g.Unknown};(0,s.LM)().updateVideo(m),"video"===(null==c?void 0:c.contentType)?(0,u.Q3)().setVideoInfo({itemId:a,currentTime:d}):"photo"===(null==c?void 0:c.contentType)&&(0,u.Q3)().setPhotoInfo({itemId:a})},openImmersivePlayer({id:e,index:o,itemListSourceConfig:i,teaParams:n,isCommentsOpen:s}){t(v,i),t(f,{index:o,isOpen:!0,isCommentsOpen:s,teaParams:n}),this.syncStateToPlayerAtom({id:e})},closeImmersivePlayer(){this.syncStateToPlayerAtom(),t(f,{index:-1,isOpen:!1,isCommentsOpen:!1,teaParams:void 0}),t(v,null)},setIndex(e,o){t(f,t=>Object.assign(Object.assign({},t),{index:e})),this.syncStateToPlayerAtom({id:o})},setIsCommentsOpen(e){t(f,t=>Object.assign(Object.assign({},t),{isCommentsOpen:e}))}}))},46249:(e,t,o)=>{o.d(t,{p:()=>i});var i=function(e){return e.Recommend="suggest",e.Following="following",e.Follower="follower",e.Friend="friend",e.OthersFollowing="others_following",e.OthersFollower="others_follower",e.SuggestedFollow="suggested_follow",e}({})},84198:(e,t,o)=>{o.d(t,{DB:()=>f,V6:()=>y});var i=o(94658),n=o(89768),s=o(40746),r=o(35762),a=o(17384),l=o(1183),u=o(78695),c=o(64388),d=o(25094),m=o(18433),p=function(e,t,o,i){return new(o||(o=Promise))(function(n,s){function r(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(r,a)}l((i=i.apply(e,t||[])).next())})};const v=(0,s.M)({csr:e=>p(void 0,void 0,void 0,function*(){const t=yield(0,i.e)();return r.h.get("/api/mix/item_list/",{query:Object.assign(Object.assign({},e),{clientABVersions:t.join(",")}),baseUrlType:a.Z4.FixedWww})})}),g=(0,l.p)("activePlaylistItemListAtom@tiktok/webapp-atoms",d.hA),f=(0,u._)((0,l.p)("playlistItemListAtom@tiktok/webapp-atoms",{}),{rehydrationKey:"desktop.playlistPage.playlistItemList"}),{useAtomService:h,useServiceDispatchers:y,useServiceState:w}=(0,c.i)(f,(e,t)=>({fetchPlaylistItemList(o){var i;return p(this,void 0,void 0,function*(){const s=e(f),{mixId:r,itemListKey:a}=o,l=a||r;if(!(l in s)||s[l].hasMore)try{const o=s[l],u=null!==(i=null==o?void 0:o.cursor)&&void 0!==i?i:"0",{language:c}=(0,n.x)(),p=yield v({mixId:r,language:c,cursor:u,aid:d.xE,count:d.vu});t(g,e=>{var t;return null!==(t=s[l])&&void 0!==t?t:e}),(0,m.Tj)(e,t,g,l,p,{isPlayList:!0}),t(f,t=>Object.assign(Object.assign(Object.assign({},t),{[r]:e(g)}),a&&{[a]:e(g)}))}catch(e){(0,m.e_)(t,g)}else t(g,s[l])})}}))}}]);