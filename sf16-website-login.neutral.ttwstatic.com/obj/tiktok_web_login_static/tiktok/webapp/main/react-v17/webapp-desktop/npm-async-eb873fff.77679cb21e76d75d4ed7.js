/*! For license information please see npm-async-eb873fff.77679cb21e76d75d4ed7.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4563],{64:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5366 1.02886C10.2252 0.768225 9.77282 0.768225 9.46141 1.02886L0.729156 8.48328C0.555867 8.63122 0.533536 8.89091 0.679026 9.06625L1.20206 9.6966C1.35794 9.88447 1.64122 9.89868 1.81513 9.72736L2.51273 9.04012L3.24979 17.1829C3.30877 17.8345 3.85276 18.3334 4.50423 18.3334H15.1103C15.979 18.3334 16.7043 17.6682 16.7829 16.7993L17.4853 9.04012L18.1849 9.72798C18.3588 9.89903 18.6419 9.88469 18.7977 9.69694L19.3209 9.06628C19.4664 8.89093 19.4441 8.63121 19.2708 8.48329L10.5366 1.02886ZM4.88767 16.6466L4.08038 7.72809L9.99899 2.77458L15.9176 7.72809L15.1103 16.6466H4.88767ZM9.37502 14.0809L13.125 11.9158C13.9584 11.4347 13.9584 10.2319 13.125 9.75078L9.37502 7.58571C8.54169 7.10459 7.50002 7.706 7.50002 8.66825V12.9984C7.50002 13.9606 8.54169 14.562 9.37502 14.0809ZM9.16669 9.38993L11.6667 10.8333L9.16669 12.2767V9.38993Z"}))}},466:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0002 2.49992C5.85803 2.49992 2.50016 5.85778 2.50016 9.99992C2.50016 14.1421 5.85803 17.4999 10.0002 17.4999C14.1423 17.4999 17.5002 14.1421 17.5002 9.99992C17.5002 5.85778 14.1423 2.49992 10.0002 2.49992ZM0.833496 9.99992C0.833496 4.93731 4.93755 0.833252 10.0002 0.833252C15.0628 0.833252 19.1668 4.93731 19.1668 9.99992C19.1668 15.0625 15.0628 19.1666 10.0002 19.1666C4.93755 19.1666 0.833496 15.0625 0.833496 9.99992Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.141 4.99992C12.141 6.27424 13.2115 7.3484 14.5835 7.3484V9.01507C13.6736 9.01507 12.8267 8.72389 12.141 8.22854V11.4961C12.141 13.2238 10.7059 14.5833 8.98723 14.5833C7.26852 14.5833 5.8335 13.2238 5.8335 11.4961C5.8335 9.76845 7.26852 8.40901 8.98723 8.40901V10.0757C8.1429 10.0757 7.50016 10.7343 7.50016 11.4961C7.50016 12.2579 8.1429 12.9166 8.98723 12.9166C9.83156 12.9166 10.4743 12.2579 10.4743 11.4961V4.99992H12.141Z"}))}},924:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.5857 9.58571C27.6805 5.49096 34.3194 5.49096 38.4141 9.58571C42.5089 13.6805 42.5089 20.3194 38.4141 24.4141L37.1212 25.707C36.7307 26.0975 36.0975 26.0975 35.707 25.707L34.2928 24.2928C33.9023 23.9023 33.9023 23.2691 34.2928 22.8786L35.5857 21.5857C38.1184 19.0531 38.1184 14.9468 35.5857 12.4141C33.053 9.88149 28.9468 9.88148 26.4141 12.4141L22.4141 16.4141C20.121 18.7072 19.9041 22.2903 21.7634 24.8275C22.0899 25.2729 22.0976 25.9023 21.707 26.2928L20.2928 27.707C19.9023 28.0975 19.2646 28.1001 18.9126 27.6745C15.5048 23.5554 15.7292 17.4422 19.5857 13.5857L23.5857 9.58571ZM27.707 20.2928C28.0976 19.9023 28.7352 19.8997 29.0873 20.3253C32.495 24.4444 32.2706 30.5576 28.4141 34.4141L24.4141 38.4141C20.3194 42.5089 13.6805 42.5089 9.58571 38.4141C5.49096 34.3193 5.49096 27.6804 9.58573 23.5857L10.8786 22.2928C11.2691 21.9023 11.9023 21.9023 12.2928 22.2928L13.707 23.707C14.0976 24.0975 14.0975 24.7307 13.707 25.1212L12.4141 26.4141C9.88148 28.9468 9.88148 33.053 12.4141 35.5857C14.9468 38.1183 19.053 38.1183 21.5857 35.5857L25.5857 31.5857C27.8788 29.2926 28.0957 25.7095 26.2364 23.1724C25.9099 22.7269 25.9023 22.0975 26.2928 21.707L27.707 20.2928Z"}))}},1257:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M26.5858 5.08579C27.3479 4.32371 28.5767 4.30253 29.3646 5.03789L36.8646 12.0379C37.2612 12.408 37.4904 12.9232 37.4997 13.4655C37.5091 14.0078 37.2977 14.5307 36.9142 14.9142L16.9142 34.9142C16.5391 35.2893 16.0304 35.5 15.5 35.5H8.5C7.39543 35.5 6.5 34.6046 6.5 33.5V26C6.5 25.4696 6.71071 24.9609 7.08579 24.5858L26.5858 5.08579ZM28.0479 9.2805L10.5 26.8284V31.5H14.6716L32.622 13.5496L28.0479 9.2805Z"}),n.createElement("path",{d:"M7 41C7 40.4477 7.44772 40 8 40H41C41.5523 40 42 40.4477 42 41V43C42 43.5523 41.5523 44 41 44H8C7.44772 44 7 43.5523 7 43V41Z"}))}},1983:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"24",cy:"24",r:"24",fill:"#0A66C2"}),n.createElement("path",{d:"M25.2775 21.8588C25.5235 21.4456 25.8234 21.067 26.1692 20.7329C26.6685 20.2507 27.2585 19.8724 27.9051 19.6199C28.5518 19.3675 29.2421 19.246 29.936 19.2625C31.0487 19.2625 32.1351 19.3862 33.1478 19.8886C34.6419 20.6251 35.3363 21.9324 35.6888 23.4765C35.9239 24.6175 36.0298 25.7813 36.0044 26.946C36.0044 29.7685 36.0044 32.5909 36.0044 35.416C36.0044 35.6633 35.9387 35.7317 35.6914 35.729C34.242 35.729 32.7979 35.7159 31.3433 35.729C31.0803 35.729 31.0119 35.6659 31.0145 35.4029C31.025 32.7251 31.025 30.0482 31.0145 27.3722C31.0217 26.806 30.9679 26.2407 30.854 25.686C30.5252 24.1867 29.5835 23.5002 28.0553 23.6527C26.527 23.8053 25.6879 24.6891 25.4827 26.3384C25.4319 26.7652 25.4073 27.1948 25.409 27.6247C25.409 30.2183 25.409 32.8093 25.409 35.4029C25.409 35.6659 25.3354 35.7317 25.0776 35.729C23.6177 35.7159 22.1578 35.729 20.6979 35.729C20.4586 35.729 20.4033 35.6607 20.4033 35.4292C20.4033 30.2735 20.4033 25.1196 20.4033 19.9675C20.4033 19.7044 20.4849 19.6571 20.7242 19.6571C22.1105 19.6571 23.4967 19.6702 24.883 19.6571C25.146 19.6571 25.1986 19.7386 25.1933 19.978C25.1802 20.5935 25.1933 21.209 25.1933 21.8193L25.2775 21.8588Z",fill:"#FDFEFE"}),n.createElement("path",{d:"M17.2574 27.6825C17.2574 30.2525 17.2574 32.825 17.2574 35.395C17.2574 35.658 17.2022 35.7316 16.9312 35.729C15.474 35.7159 14.0141 35.729 12.5542 35.729C12.3254 35.729 12.2517 35.6817 12.2517 35.437C12.2517 30.2744 12.2517 25.1108 12.2517 19.9464C12.2517 19.736 12.2938 19.6544 12.5148 19.6571C13.9948 19.6676 15.4749 19.6676 16.9549 19.6571C17.218 19.6571 17.2443 19.7491 17.2443 19.9675C17.2548 22.54 17.2574 25.1126 17.2574 27.6825Z",fill:"#FDFDFE"}),n.createElement("path",{d:"M11.8755 14.5541C11.8755 13.9811 12.0456 13.4211 12.3642 12.9449C12.6829 12.4688 13.1357 12.0979 13.6654 11.8794C14.195 11.6608 14.7776 11.6045 15.3393 11.7174C15.901 11.8303 16.4165 12.1075 16.8206 12.5137C17.2246 12.92 17.4989 13.437 17.6088 13.9993C17.7186 14.5616 17.659 15.1439 17.4376 15.6723C17.2162 16.2008 16.8429 16.6516 16.365 16.9676C15.8871 17.2836 15.3261 17.4507 14.7532 17.4476C13.9896 17.44 13.2597 17.1322 12.7212 16.5907C12.1827 16.0493 11.8789 15.3177 11.8755 14.5541Z",fill:"#FDFDFE"}))}},2913:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C28.0553 42 31.7921 40.6614 34.8006 38.401L35.6001 37.8003C36.0416 37.4686 36.6685 37.5576 37.0003 37.9992L38.2016 39.5981C38.5334 40.0397 38.4443 40.6666 38.0028 40.9983L37.2033 41.599C33.5258 44.3619 28.9513 46 24 46C11.8497 46 2 36.1503 2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24V26C46 30.4843 42.1949 34 37.8438 34C35.1966 34 32.8496 32.7142 31.3935 30.733C29.5649 32.7403 26.9303 34 24 34C18.4772 34 14 29.5228 14 24C14 18.4772 18.4772 14 24 14C29.5228 14 34 18.4772 34 24C34 24.5814 33.9502 25.1528 33.8541 25.7096C33.8473 25.8052 33.8438 25.902 33.8438 26C33.8438 28.2091 35.6347 30 37.8438 30C40.1201 30 42 28.1431 42 26V24C42 14.0589 33.9411 6 24 6ZM24 18C20.6863 18 18 20.6863 18 24C18 27.3137 20.6863 30 24 30C26.9395 30 29.3891 27.8841 29.9013 25.0918C29.9659 24.7392 30 24.3744 30 24C30 20.6863 27.3137 18 24 18Z"}))}},3089:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.5858 32.4142L8.29289 18.1213C7.90237 17.7308 7.90237 17.0976 8.29289 16.7071L9.70711 15.2929C10.0976 14.9024 10.7308 14.9024 11.1213 15.2929L24 28.1716L36.8787 15.2929C37.2692 14.9024 37.9024 14.9024 38.2929 15.2929L39.7071 16.7071C40.0976 17.0976 40.0976 17.7308 39.7071 18.1213L25.4142 32.4142C24.6332 33.1953 23.3668 33.1953 22.5858 32.4142Z"}))}},3229:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M35.0001 10.7587C35.0001 10.1169 34.4041 9.64129 33.7784 9.78359L17.7902 13.4192C17.335 13.5227 17.0119 13.9275 17.0119 14.3943V37.9972H17.0109C17.0374 40.1644 14.8022 42.4189 11.612 43.2737C8.05093 44.2279 4.64847 43.0769 4.01236 40.7028C3.37624 38.3288 5.74735 35.6308 9.30838 34.6766C10.606 34.3289 11.8826 34.2608 13.0119 34.4294V14.3943C13.0119 12.0601 14.6271 10.0364 16.9033 9.5188L32.8914 5.88317C36.0204 5.17165 39.0001 7.54986 39.0001 10.7587V33.1191C39.084 35.3108 36.8331 37.6109 33.6032 38.4763C30.0421 39.4305 26.6397 38.2795 26.0036 35.9055C25.3675 33.5315 27.7386 30.8334 31.2996 29.8792C32.5961 29.5319 33.8715 29.4635 35.0001 29.6316V10.7587Z"}))}},3732:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M24 48C37.2548 48 48 37.2548 48 24C48 10.7452 37.2548 0 24 0C10.7452 0 0 10.7452 0 24C0 37.2548 10.7452 48 24 48Z",fill:"#37AEE2"}),n.createElement("path",{d:"M15.0708 25.1038L18.2549 33.5766C18.2549 33.5766 18.6529 34.3681 19.0782 34.3681C19.5035 34.3681 25.8443 28.0272 25.8443 28.0272L32.8947 14.9343L15.1822 22.9151L15.0708 25.1038Z",fill:"#C8DAEA"}),n.createElement("path",{d:"M19.2945 27.2772L18.6827 33.5219C18.6827 33.5219 18.428 35.4351 20.4158 33.5219C22.4035 31.6087 24.3117 30.1328 24.3117 30.1328",fill:"#A9C6D8"}),n.createElement("path",{d:"M15.1297 25.4063L8.5796 23.3553C8.5796 23.3553 7.79723 23.0492 8.04968 22.3583C8.10199 22.2161 8.20661 22.0937 8.51819 21.8838C9.96922 20.9108 35.378 12.1319 35.378 12.1319C35.378 12.1319 36.0967 11.9001 36.5198 12.0532C36.7131 12.1232 36.8382 12.2041 36.9405 12.4949C36.9792 12.5998 36.9996 12.8272 36.9974 13.0502C36.9951 13.212 36.9746 13.3607 36.9587 13.5969C36.8041 15.9977 32.1735 33.914 32.1735 33.914C32.1735 33.914 31.896 34.9614 30.9044 34.9985C30.5428 35.0116 30.1039 34.9417 29.5785 34.5066C27.6294 32.8951 20.8974 28.5439 19.41 27.5884C19.3258 27.5337 19.3031 27.4638 19.2872 27.396C19.2667 27.2954 19.3804 27.1708 19.3804 27.1708C19.3804 27.1708 31.1046 17.1522 31.4162 16.1004C31.4412 16.0195 31.3502 15.978 31.2274 16.013C30.4496 16.2885 16.9491 24.4836 15.4595 25.3888C15.373 25.4412 15.1297 25.4063 15.1297 25.4063Z",fill:"white"}))}},4972:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>Ge});var n=r(6978);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function a(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function d(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}var h="video",p="hevc";function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t.filter(Boolean);var n=new Uint8Array(t.reduce(function(e,t){return e+t.byteLength},0)),i=0;return t.forEach(function(e){n.set(e,i),i+=e.byteLength}),n}function _(e){if(!Array.isArray(e)){for(var t=[],r="",n=0;n<e.length;n++)n%2&&(r=e[n-1]+e[n],t.push(parseInt(r,16)),r="");return t}return e.map(function(e){return parseInt(e,16)})}Math.pow(2,32);var y,g=function(){return a(function e(){o(this,e),this.buffer=new Uint8Array(0)},[{key:"write",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){t?e.buffer=function(e){for(var t=0,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];n.forEach(function(e){t+=e.length});var o=new e(t),s=0;return n.forEach(function(e){o.set(e,s),s+=e.length}),o}(Uint8Array,e.buffer,t):window.console.warn(t)})}}],[{key:"writeUint16",value:function(e){return new Uint8Array([e>>8&255,255&e])}},{key:"writeUint32",value:function(e){return new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e])}}])}(),m=Math.pow(2,32)-1,v=function(){function e(){o(this,e)}return a(e,null,[{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=8+(r=r.filter(Boolean)).reduce(function(e,t){return e+t.byteLength},0),o=new Uint8Array(i);o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=255&i,o.set(e,4);var s=8;return r.forEach(function(e){o.set(e,s),s+=e.byteLength}),o}},{key:"FullBox",value:function(t,r,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return e.box.apply(e,[t,new Uint8Array([r,n>>16&255,n>>8&255,255&n])].concat(o))}},{key:"ftyp",value:function(t){return t.find(function(e){return e.type===h&&e.codecType===p})?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){return f(e.ftyp(t),e.moov(t))}},{key:"pssh",value:function(t){var r=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],_(t.kid),[0,0,0,0]));return e.box(e.types.pssh,r)}},{key:"moov",value:function(t){if(t[0].useEME&&(t[0].encv||t[0].enca)){t[0].pssh||(t[0].pssh={kid:t[0].kid});var r=this.pssh(t[0].pssh);return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),e.mvex(t)].concat(c(t.map(function(t){return e.trak(t)})),[r]))}return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat(c(t.map(function(t){return e.trak(t)})),[e.mvex(t)]))}},{key:"mvhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}},{key:"edts",value:function(t){return e.box(e.types.edts,e.elst(t))}},{key:"elst",value:function(t){t.entries;var r=t.entriesData,n=t.version;return e.FullBox(e.types.elst,n,0,r)}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]))}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===h?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){return t&&t.ext,e.box(e.types.stbl,e.stsd(t),e.STTS,[][0],e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){var r;return r="audio"===t.type?t.useEME&&t.enca?e.enca(t):e.mp4a(t):t.useEME&&t.encv?e.encv(t):t.av1C?e.av01(t):e.avc1hev1vvc1(t),e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),r)}},{key:"enca",value:function(t){var r=t.enca.channelCount,n=t.enca.sampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>8&255,255&n,0,0]),o=e.esds(t.config),s=e.sinf(t.enca);return e.box(e.types.enca,i,o,s)}},{key:"encv",value:function(t){var r,n,i=t.sps.length>0?t.sps[0]:[],o=t.pps.length>0?t.pps[0]:[],s=t.width,a=t.height,l=t.sarRatio[0],u=t.sarRatio[1],d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,a>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h=new Uint8Array((r=(n=[1,i[1],i[2],i[3],255,225,i.length>>>8&255,255&i.length]).concat.apply(n,c(i)).concat([1,o.length>>>8&255,255&o.length])).concat.apply(r,c(o))),p=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),f=e.sinf(t.encv),_=new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,u>>24,u>>16&255,u>>8&255,255&u]);return e.box(e.types.encv,d,e.box(e.types.avcC,h),e.box(e.types.btrt,p),f,e.box(e.types.pasp,_))}},{key:"schi",value:function(t){var r=new Uint8Array([]),n=e.tenc(t);return e.box(e.types.schi,r,n)}},{key:"tenc",value:function(t){var r=new Uint8Array([0,0,0,0,0,0,255&t.default_IsEncrypted,255&t.default_IV_size].concat(_(t.default_KID)));return e.box(e.types.tenc,r)}},{key:"sinf",value:function(t){var r=new Uint8Array([]),n=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),o=e.schi(t);return e.box(e.types.sinf,r,e.box(e.types.frma,n),e.box(e.types.schm,i),o)}},{key:"av01",value:function(t){return e.box(e.types.av01,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t.av1C,t.colr)}},{key:"avc1hev1vvc1",value:function(t){var r,n;t.codecType===p?(r=e.hvcC(t),n=e.types.hvc1):"vvcC"===t.codecType?(r=e.vvcC(t),n=e.types.bvc2):(r=e.avcC(t),n=e.types.avc1);var i=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r];return t.codecType===p?i.push(e.box(e.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&i.push(e.pasp(t.sarRatio)),e.box.apply(e,[n].concat(i))}},{key:"avcC",value:function(t){var r,n,i,o=[],s=[];return t.sps.forEach(function(e){i=e.byteLength,o.push(i>>>8&255),o.push(255&i),o.push.apply(o,c(e))}),t.pps.forEach(function(e){i=e.byteLength,s.push(i>>>8&255),s.push(255&i),s.push.apply(s,c(e))}),e.box(e.types.avcC,new Uint8Array((r=(n=[1,o[3],o[4],o[5],255,224|t.sps.length]).concat.apply(n,o).concat([t.pps.length])).concat.apply(r,s)))}},{key:"vvcC",value:function(t){var r=t.vvcC;return e.box(e.types.bv2C,new Uint8Array(r))}},{key:"hvcC",value:function(t){var r=t.hvcC;if(r instanceof ArrayBuffer||r instanceof Uint8Array)return r;var n,i=t.vps,o=t.sps,s=t.pps;if(r){var a=r.generalProfileCompatibilityFlags,l=r.generalConstraintIndicatorFlags,u=(i.length&&1)+(o.length&&1)+(s.length&&1);n=[1,r.generalProfileSpace<<6|r.generalTierFlag<<5|r.generalProfileIdc,a>>>24,a>>>16,a>>>8,a,l[0],l[1],l[2],l[3],l[4],l[5],r.generalLevelIdc,240,0,252,252|r.chromaFormatIdc,248|r.bitDepthLumaMinus8,248|r.bitDepthChromaMinus8,0,0,r.numTemporalLayers<<3|r.temporalIdNested<<2|3,u];var d=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,c(e))};i.length&&(n.push(160,0,i.length),i.forEach(d)),o.length&&(n.push(161,0,o.length),o.forEach(d)),s.length&&(n.push(162,0,s.length),s.forEach(d))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var r,n,i=(n=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(r,n)||d(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],s=i[1];return e.box(e.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var r=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+r,0,0,0,4,15+r,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([r]).concat(t).concat([6,1,2])))}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat(c(t.map(function(t){return e.trex(t.id)}))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trex1",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]))}},{key:"trex2",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]))}},{key:"moof",value:function(t){return e.box.apply(e,[e.types.moof,e.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat(c(t.map(function(t){return e.traf(t)}))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){var r=e.tfhd(t.id),n=e.tfdt(t.baseMediaDecodeTime),i=0;if(t.isVideo&&t.videoSenc&&t.videoSenc.forEach(function(e){i+=8,e.subsamples&&e.subsamples.length&&(i+=2,i+=6*e.subsamples.length)}),t.videoSencLength=i,t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)){if(t.isVideoEncryption){if(t.isVideo){var o=e.saiz(t),s=e.saio(t),a=e.trun1(t),l=e.senc(t);return e.box(e.types.traf,r,n,o,s,a,l)}if(t.isAudioEncryption){var c=e.sbgp(),u=e.saiz(t),d=e.saio(t),h=e.senc(t),p=e.trun1(t);return e.box(e.types.traf,r,n,c,u,d,h,p)}var f=e.sbgp(),_=e.trun1(t);return e.box(e.types.traf,r,n,f,_)}if(t.isVideo){var y=e.trun1(t);return e.box(e.types.traf,r,n,y)}var g=e.sbgp(),m=e.saiz(t),v=e.saio(t),b=e.senc(t),w=e.trun1(t);return e.box(e.types.traf,r,n,g,m,v,b,w)}var C=e.sdtp(t);return e.box(e.types.traf,r,n,C,e.trun(t.samples,C.byteLength+76))}},{key:"sdtp",value:function(t){var r=new g;return t.samples.forEach(function(e){r.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))}),e.box(e.types.sdtp,this.extension(0,0),r.buffer)}},{key:"trun1",value:function(t){var r=new g,n=g.writeUint32(t.samples.length),i=null;if(t.isVideo){var o=t.videoSencLength;i=g.writeUint32(76+16*t.samples.length+o+77),!t.isVideoEncryption&&t.isAudioEncryption&&(i=g.writeUint32(76+16*t.samples.length+20))}else{var s=76+12*t.samples.length+52;t.isAudioEncryption&&(s=76+12*t.samples.length+8*t.audioSenc.length+105),i=g.writeUint32(s)}return t.samples.forEach(function(e){r.write(g.writeUint32(e.duration)),r.write(g.writeUint32(e.size)),r.write(g.writeUint32(e.keyframe?33554432:65536)),t.isVideo&&r.write(g.writeUint32(e.cts?e.cts:0))}),e.box(e.types.trun,this.extension(0,t.flags),n,i,r.buffer)}},{key:"senc",value:function(t){var r=new g,n=t.samples.length,i=t.isVideo?16:8,o=t.isVideo?2:0,s=[],a=0;return t.isVideo?(s=t.videoSenc,a=t.videoSencLength):s=t.audioSenc,a=a||i*n,r.write(g.writeUint32(16+a),e.types.senc,this.extension(0,o)),r.write(g.writeUint32(n)),s.forEach(function(e){for(var t=0;t<e.InitializationVector.length;t++)r.write(new Uint8Array([e.InitializationVector[t]]));e.subsamples&&e.subsamples.length&&(r.write(g.writeUint16(e.subsamples.length)),e.subsamples.forEach(function(e){r.write(g.writeUint16(e.BytesOfClearData)),r.write(g.writeUint32(e.BytesOfProtectedData))}))}),r.buffer}},{key:"saio",value:function(t){var r=12*t.samples.length+141;!t.isVideo&&t.isAudioEncryption&&(r=149);var n=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r]);return e.box(e.types.saio,n)}},{key:"saiz",value:function(t){var r=t.samples.length,n=new Uint8Array([0,0,0,0,16,r>>24&255,r>>16&255,r>>8&255,255&r]);return e.box(e.types.saiz,n)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return e.box(e.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t){var r=Math.floor(t/(m+1)),n=Math.floor(t%(m+1));return e.box(e.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"trun",value:function(t,r){var n=t.length,i=12+16*n;r+=8+i;var o=new Uint8Array(i);o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var s=0;s<n;s++){var a=t[s],l=a.duration,c=a.size,u=a.flag,d=void 0===u?{}:u,h=a.cts,p=void 0===h?0:h;o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|(null===d.dependsOn||void 0===d.dependsOn?1:d.dependsOn),d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|(null===d.isNonSyncSample||void 0===d.isNonSyncSample?1:d.isNonSyncSample),61440&d.degradationPriority,15&d.degradationPriority,p>>>24&255,p>>>16&255,p>>>8&255,255&p],12+16*s)}return e.box(e.types.trun,o)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(c(t.map(function(t){return e.trackMP4(t)}))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===h?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var r=t.ext,n=[e.stsd(t),e.stts(r.stts),e.stsc(r.stsc),e.stsz(r.stsz),e.stco(r.stco)];return r.stss.length&&n.push(e.stss(r.stss)),r.ctts.length&&n.push(e.ctts(r.ctts)),e.box.apply(e,[e.types.stbl].concat(n))}},{key:"stts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach(function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8}),e.box(e.types.stts,f(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsc",value:function(t){var r=t.length,n=new Uint8Array(12*r),i=0;return t.forEach(function(e){var t=e.firstChunk,r=e.samplesPerChunk,o=e.sampleDescIndex;n.set([t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,o>>24,o>>16&255,o>>8&255,255&o],i),i+=12}),e.box(e.types.stsc,f(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsz",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stsz,f(new Uint8Array([0,0,0,0,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stco",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stco,f(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stss",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stss,f(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"ctts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach(function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8}),e.box(e.types.ctts,f(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"styp",value:function(){return e.box(e.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var r=t.timescale,n=t.samples[0].duration,i=n*t.samples.length,o=t.samples[0].sampleOffset*n,s=8;t.samples.forEach(function(e){s+=e.size});var a=0;if(t.isVideo){var l,c=0;t.videoSenc&&(l=t.videoSenc),t.isVideo&&l.forEach(function(e){c+=8,e.subsamples&&e.subsamples.length&&(c+=2,c+=6*e.subsamples.length)}),t.videoSencLength=c,a=s+141+16*t.samples.length+c,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(a=s+16*t.samples.length+84)}else a=s+116+12*t.samples.length,t.useEME&&t.isAudioEncryption&&(a=s+169+12*t.samples.length+8*t.audioSenc.length);var u=new Uint8Array([0,0,0,0,0,0,0,255&t.id,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,1,0,a>>16&255,a>>8&255,255&a,i>>24&255,i>>16&255,i>>8&255,255&i,144,0,0,0]);return e.box(e.types.sidx,u)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}}])}();y=v,l(v,"types",["av01","av1C","avc1","avcC","hvc1","hvcC","dinf","dref","edts","elst","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp","bvc2","bv2C"].reduce(function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e},Object.create(null))),l(v,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),l(v,"FTYPAVC1",y.box(y.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),l(v,"FTYPHEV1",y.box(y.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),l(v,"DINF",y.box(y.types.dinf,y.box(y.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),l(v,"VMHD",y.box(y.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),l(v,"SMHD",y.box(y.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),l(v,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),l(v,"STTS",y.box(y.types.stts,y.StblTable)),l(v,"STSC",y.box(y.types.stsc,y.StblTable)),l(v,"STSZ",y.box(y.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),l(v,"STCO",y.box(y.types.stco,y.StblTable));var b=function(){function e(t,r){o(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),e.disabled=r}return a(e,[{key:"debug",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).debug.apply(t,[this._prefix].concat(n))}}},{key:"log",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).log.apply(t,[this._prefix].concat(n))}}},{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}},{key:"error",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).error.apply(t,[this._prefix].concat(n))}}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}])}();l(b,"disabled",!0);var w=function(){return a(function e(t,r,n){o(this,e),this.videoTrack=t,this.audioTrack=r;var i=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=i&&Number(i[1])<50,this.log=new b("FMP4Remuxer",!n||!n.openLog||!n.openLog)},[{key:"remux",value:function(){var e,t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.videoTrack,l=this.audioTrack,c=a.exist(),u=l.exist(),d=[];return o&&(s&&s.initMerge?(c&&d.push(this.videoTrack),u&&d.push(this.audioTrack),r=v.initSegment(d)):(c&&(e=v.initSegment([this.videoTrack])),u&&(t=v.initSegment([this.audioTrack])))),c&&a.hasSample()&&(n=this._remuxVideo()),u&&l.hasSample()&&(i=this._remuxAudio()),a.samples=[],l.samples=[],{initSegment:r,videoInitSegment:e,audioInitSegment:t,videoSegment:n,audioSegment:i}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack;this.forceFirstIDR&&(e.samples[0].flag={dependsOn:2,isNonSyncSample:0});var t=e.samples,r=/av01/.test(e.codec),n=0;r?t.forEach(function(e){n+=e.data.byteLength}):t.forEach(function(e){n+=e.units.reduce(function(e,t){return e+t.byteLength},0),n+=4*e.units.length});var i=new Uint8Array(n);if(r)for(var o,s=0,a=t.length,l=0;s<a;s++)o=t[s],i.set(o.data,l),o.size=o.data.byteLength,l+=o.size;else for(var c,u=new DataView(i.buffer),d=function(e,r){r=t[h];var n=0;r.units.forEach(function(t){u.setUint32(e,t.byteLength),e+=4,i.set(t,e),e+=t.byteLength,n+=4+t.byteLength}),r.size=n,_=e,c=r},h=0,p=t.length,_=0;h<p;h++)d(_,c);var y=v.mdat(i);return f(v.moof([e]),y)}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=new Uint8Array(e.samples.reduce(function(e,t){return e+t.size},0));e.samples.reduce(function(e,r){return t.set(r.data,e),e+r.size},0);var r=v.mdat(t);return f(v.moof([e]),r)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}])}();function C(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function E(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){C(o,n,i,s,a,"next",e)}function a(e){C(o,n,i,s,a,"throw",e)}s(void 0)})}}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function S(e,t,r){return t&&T(e.prototype,t),r&&T(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e,t,r){return(t=L(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return($=function(){return!!e})()}function P(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return R(c,"_invoke",function(r,n,i){var o,a,l,c=0,u=i||[],d=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,a=0,l=e,h.n=r,s}};function p(r,n){for(a=r,l=n,t=0;!d&&c&&!i&&t<u.length;t++){var i,o=u[t],p=h.p,f=o[2];r>3?(i=f===n)&&(l=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=r<2&&p<o[1])?(a=0,h.v=n,h.n=o[1]):p<f&&(i=r<3||o[0]>n||n>f)&&(o[4]=r,o[5]=n,h.n=f,a=0))}if(i||r>1)return s;throw d=!0,n}return function(i,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,f),a=u,l=f;(t=a<2?e:l)||!d;){o||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(d=h.n<0)?l:r.call(n,h))!==s)break}catch(t){o=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,i,o),!0),c}var s={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(R(t={},n,function(){return this}),t),d=c.prototype=a.prototype=Object.create(u);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,R(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,R(d,"constructor",c),R(c,"constructor",l),l.displayName="GeneratorFunction",R(c,i,"GeneratorFunction"),R(d),R(d,i,"Generator"),R(d,n,function(){return this}),R(d,"toString",function(){return"[object Generator]"}),(P=function(){return{w:o,m:h}})()}function R(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}R=function(e,t,r,n){if(t)i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{let t=function(t,r){R(e,t,function(e){return this._invoke(t,r,e)})};t("next",0),t("throw",1),t("return",2)}},R(e,t,r,n)}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e){var t="function"==typeof Map?new Map:void 0;return M=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if($())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&x(i,r.prototype),i}(e,arguments,A(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),x(r,e)},M(e)}var D,B=function(){function e(){k(this,e)}return S(e,null,[{key:"start",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&e.start(0)<0?0:e.start(0):0}},{key:"end",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1):0}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(e){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var o=r.length;if(o&&t){var s=r[o-1],a=s[1];if(e.start(n)-a<=t){var l=e.end(n);l>a&&(s[1]=l)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"totalLength",value:function(e){return e&&e.length?e.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,o=0,s=0,a=0,l=0,c=0,u=0,d=e.buffers(t,n),h=0,p=d.length;h<p;h++){var f=d[h];if(r+n>=f[0]&&r<=f[1])i=f[0],o=f[1],s=h;else{if(r+n<f[0]){a=f[0],l=f[1];break}r+n>f[1]&&(c=f[0],u=f[1])}}return{start:i,end:o,index:s,buffers:d,nextStart:a,nextEnd:l,prevStart:c,prevEnd:u,currentTime:r,behind:r-i,remaining:o?o-r:0,length:e.totalLength&&e.totalLength(d)}}},{key:"isBuffered",value:function(t,r){if(t){var n=e.get(t);if(null!=n&&n.length)for(var i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return!0}return!1}}])}(),N="network",j="network_timeout",U="media",V="other",F="MSE_ADD_SB",H="MSE_APPEND_BUFFER",G="MSE_OTHER",W="MSE_FULL",q="MSE_CHANGE_TYPE",K=(O(O(O(O(O(O(O(O(O(O(D={},"manifest",{HLS:1100,DASH:1200}),N,2100),j,2101),"network_forbidden",2103),"network_notfound",2104),"network_range_not_satisfiable",2116),"demux",{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),"remux",{FMP4:4100,MP4:4200}),U,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),"drm",{LICENSE:7100,CUSTOM_LICENSE:7200}),O(O(D,V,8e3),"runtime",{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003})),z=function(e){function t(e,r,n,i,o){var s;return k(this,t),(s=function(e,t,r){return t=A(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$()?Reflect.construct(t,r||[],A(e).constructor):t.apply(e,r))}(this,t,[o||(null==n?void 0:n.message)])).errorType=e===j?N:e,s.originError=n,s.ext=i,s.errorCode=K[e][r]||K[e],s.errorMessage=s.message,s.errorCode||(s.errorType=V,s.errorCode=K[s.errorType]),s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x(e,t)}(t,e),S(t,null,[{key:"create",value:function(e,r,n,i,o){return e instanceof t?e:(e instanceof Error&&(n=e,e=""),e||(e=V),new t(e,r,n,i,o))}},{key:"network",value:function(e){var r;return new t(null!=e&&e.isTimeout?j:N,null,e instanceof Error?e:null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e||null===(r=e.response)||void 0===r?void 0:r.status})}}])}(M(Error)),Z={DEBUG:1,LOG:2,WARN:3,ERROR:4},Y=["Boolean","Number","String","Undefined","Null","Date","Object"],X=function(){function e(t,r){k(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(null==r?void 0:r.logCacheLevel)||3,this.logMaxSize=(null==r?void 0:r.logMaxSize)||204800,this.logSize=0,this.logTextArray=[]}return S(e,[{key:"debug",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Z.DEBUG].concat(n)),e.disabled||(t=console).debug.apply(t,[this._prefix,Q()].concat(n))}},{key:"log",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Z.LOG].concat(n)),e.disabled||(t=console).log.apply(t,[this._prefix,Q()].concat(n))}},{key:"warn",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Z.WARN].concat(n)),e.disabled||(t=console).warn.apply(t,[this._prefix,Q()].concat(n))}},{key:"error",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Z.ERROR].concat(n)),e.disabled||(t=console).error.apply(t,[this._prefix,Q()].concat(n))}},{key:"logCache",value:function(e){if(!(e<this.logCacheLevel)){var t="";try{for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=n.map(function(e){return ee(e)});t=this._prefix+Q()+JSON.stringify(o)}catch(e){return}if(e>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var s=this.logTextArray.shift();this.logSize-=s.length}}}},{key:"getLogCache",value:function(){var e=this.logTextArray.join("\n");return this.reset(),e}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(e){this.logCacheLevel=e}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}])}();function Q(){return(new Date).toLocaleString()}function J(e){if("object"!==I(e))return e;var t=Object.prototype.toString.call(e).slice(8,-1);switch(t){case"Array":case"Uint8Array":case"ArrayBuffer":return t+"["+e.length+"]";case"Object":return"{}";default:return t}}function ee(e,t,r){r||(r=1),t||(t=2);var n={};if(!e||"object"!==I(e))return e;var i=Object.prototype.toString.call(e).slice(8,-1);if(!Y.includes(i))return i;if(!(r>t)){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r===t?n[o]=J(e[o]):"object"===I(e[o])?n[o]=ee(e[o],t,r+1):n[o]=e[o]);return n}}function te(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.used=!1,r.resolve=function(){return r.used=!0,e.apply(void 0,arguments)},r.reject=function(){return r.used=!0,t.apply(void 0,arguments)},r}function re(){try{return parseInt(performance.now(),10)}catch(e){return(new Date).getTime()}}O(X,"disabled",!0);function ne(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{if(e&&"undefined"!=typeof ManagedMediaSource)return ManagedMediaSource;if("undefined"!=typeof MediaSource)return MediaSource;throw new Error("MediaSource no defined")}catch(e){}}function ie(e){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(e))}var oe="updateDuration",se=function(){function e(t,r){var n=this;k(this,e),O(this,"media",null),O(this,"mediaSource",null),O(this,"_openPromise",te()),O(this,"_queue",Object.create(null)),O(this,"_sourceBuffer",Object.create(null)),O(this,"_mseFullFlag",{}),O(this,"_st",0),O(this,"_opst",0),O(this,"_logger",null),O(this,"_config",null),O(this,"_url",null),O(this,"_onStartStreaming",function(){n._logger.debug("startstreaming")}),O(this,"_onEndStreaming",function(){n._logger.debug("endstreaming")}),O(this,"_onSBUpdateEnd",function(e){var t=n._queue[e];if(t){var r=t[0];if((null==r?void 0:r.opName)!==oe&&t.shift(),r){var i,o,s=re()-n._opst;n.media&&n._logger.debug("UpdateEnd(".concat(e,"/").concat(r.opName,")"),function(e){try{return JSON.stringify(e)}catch(e){return""}}(function(e){var t=[];if(e instanceof TimeRanges)for(var r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}(null===(o=n._sourceBuffer[e])||void 0===o?void 0:o.buffered)),s,r.context),r.promise.resolve({name:r.opName,context:r.context,costtime:s});var a=null===(i=r.context)||void 0===i?void 0:i.callback;a&&"function"==typeof a&&a(r.context),n._startQueue(e)}}}),O(this,"_onSBUpdateError",function(e,t){var r=n._queue[e];if(r){var i=r[0];i&&(n._logger.error("UpdateError",e,i.opName,i.context),i.promise.reject(new z(U,H,t)))}}),this._config=Object.assign(e.getDefaultConfig(),r),t&&this.bindMedia(t),this._logger=new X("MSE"),this._config.openLog&&X.enable()}return S(e,[{key:"version",get:function(){return"3.0.30"}},{key:"isOpened",get:function(){var e;return"open"===(null===(e=this.mediaSource)||void 0===e?void 0:e.readyState)}},{key:"hasOpTasks",get:function(){var e=this,t=!1;return Object.keys(this._queue).forEach(function(r){var n=e._queue[r];Array.isArray(n)&&(t||(t=n.length>0))}),t}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var e;return(null===(e=this.mediaSource)||void 0===e?void 0:e.duration)||-1}},{key:"isEnded",get:function(){return!!this.mediaSource&&"ended"===this.mediaSource.readyState}},{key:"streaming",get:function(){return!ie(this.mediaSource)||this.mediaSource.streaming}},{key:"handle",get:function(){var e;return null===(e=this.mediaSource)||void 0===e?void 0:e.handle}},{key:"liveEdge",get:function(){var e=this.bufferEnd("video"),t=this.bufferEnd("audio");return e&&t?Math.min(e,t):0}},{key:"videoMimeType",get:function(){var e;return null===(e=this._sourceBuffer.video)||void 0===e?void 0:e.mimeType}},{key:"isFull",value:function(t){return t?this._mseFullFlag[t]:this._mseFullFlag[e.VIDEO]}},{key:"getBlobUrl",value:function(){return this._url||(this._url=URL.createObjectURL(this.mediaSource)),this._url}},{key:"updateDuration",value:function(e){var t=this,r=this.mediaSource&&this.mediaSource.duration>e;if(this.mediaSource&&this.mediaSource.duration>e){var n=0;if(Object.keys(this._sourceBuffer).forEach(function(e){try{n=Math.max(t.bufferEnd(e)||0,n)}catch(e){}}),e<n)return Promise.resolve()}return this._enqueueBlockingOp(function(){t.isEnded?t._logger.debug("setDuration but ended"):t.mediaSource&&(t.mediaSource.duration=e,t._logger.debug("setDuration",e))},oe,{isReduceDuration:r})}},{key:"init",value:function(){var e=this,t=ne(this._config.preferMMS),r=this.mediaSource=new t;this._st=re();var n=function(){var t=re()-e._st;e._logger.debug("sourceopen"),r.removeEventListener("sourceopen",n),e._openPromise.resolve({costtime:t})};return r.addEventListener("sourceopen",n),ie(r)&&(r.addEventListener("startstreaming",this._onStartStreaming),r.addEventListener("endstreaming",this._onEndStreaming)),this._openPromise}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource,r=function(){var n=re()-e._st;e._logger.debug("sourceopen",n),t.removeEventListener("sourceopen",r),e._openPromise.resolve({costtime:n})};t.addEventListener("sourceopen",r),this._openPromise=te()}return this._openPromise}},{key:"bindMedia",value:(i=E(P().m(function e(t){var r,n,i,o,s=this;return P().w(function(e){for(;;)switch(e.n){case 0:if(!this.mediaSource&&!this.media){e.n=1;break}return e.n=1,this.unbindMedia();case 1:if(r=ne(this._config.preferMMS),t&&r){e.n=2;break}throw new Error("Param media or MediaSource does not exist");case 2:return this.media=t,n=this.mediaSource=new r,i=ie(n),this._st=re(),o=function(){var e=re()-s._st;s._logger.debug("sourceopen"),n.removeEventListener("sourceopen",o),URL.revokeObjectURL(t.src),s._openPromise.resolve({costtime:e})},n.addEventListener("sourceopen",o),i&&(n.addEventListener("startstreaming",this._onStartStreaming),n.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(n),t.src=this._url,t.disableRemotePlayback=i,e.a(2,this._openPromise)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"unbindMedia",value:(n=E(P().m(function e(){var t,r,n,i=this;return P().w(function(e){for(;;)switch(e.n){case 0:if(this._openPromise.used||this._openPromise.resolve(),t=this.mediaSource){if(Object.keys(this._queue).forEach(function(e){var t=i._queue[e];t&&t.forEach(function(e){var t,r;return null===(t=e.promise)||void 0===t||null===(r=t.resolve)||void 0===r?void 0:r.call(t)})}),r=!!this.media&&this.media.readyState>=1,n="open"===t.readyState,r&&n)try{t.endOfStream()}catch(e){}Object.keys(this._sourceBuffer).forEach(function(e){try{t.removeSourceBuffer(i._sourceBuffer[e])}catch(e){}}),ie(t)&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch(e){}this.media=null}this.mediaSource=null,this._openPromise=te(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"unbind",value:(r=E(P().m(function e(t){var r,n=this;return P().w(function(e){for(;;)switch(e.n){case 0:if(this._openPromise.used||this._openPromise.resolve(),r=this.mediaSource){if(Object.keys(this._queue).forEach(function(e){var t=n._queue[e];t&&t.forEach(function(e){var t,r;return null===(t=e.promise)||void 0===t||null===(r=t.resolve)||void 0===r?void 0:r.call(t)})}),t&&this.isOpened)try{r.endOfStream()}catch(e){}Object.keys(this._sourceBuffer).forEach(function(e){try{r.removeSourceBuffer(n._sourceBuffer[e])}catch(e){}})}ie(r)&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this._url&&(URL.revokeObjectURL(this._url),this._url=""),this.mediaSource=null,this._openPromise=te(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 1:return e.a(2)}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"createSource",value:function(e,t){if(!this._sourceBuffer[e]&&this.mediaSource){var r;try{r=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(e){throw new z(U,F,e)}r.mimeType=t,r.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),r.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var r=this,n=this._sourceBuffer[e];return this.mediaSource&&n&&n.mimeType!==t?"function"!=typeof n.changeType?Promise.reject(new z(U,q,new Error("changeType is not a function"))):this._enqueueOp(e,function(){try{n.changeType(t)}catch(e){throw new z(U,q,e)}n.mimeType=t,r._onSBUpdateEnd(e)},"changeType",{mimeType:t}):Promise.resolve()}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t,r){var n=this;return t&&t.byteLength&&this._sourceBuffer[e]?this._enqueueOp(e,function(){var i,o,s;!n.mediaSource||null!==(i=n.media)&&void 0!==i&&i.error||(n._logger.debug("MSE APPEND START",r),n._opst=re(),(!n.mediaSource.sourceBuffers||null!==(o=n.mediaSource.sourceBuffers)&&void 0!==o&&o.length)&&(null===(s=n._sourceBuffer[e])||void 0===s||s.appendBuffer(t)))},"appendBuffer",r):Promise.resolve()}},{key:"remove",value:function(e,t,r,n){var i=this,o=!1;return this._mseFullFlag[e]&&(o=!0),this._enqueueOp(e,function(){var o;if(i.mediaSource&&(null===(o=i.media)||void 0===o||!o.error)){var s=i._sourceBuffer[e];t>=r||!s?i._onSBUpdateEnd(e):(i._opst=re(),i._logger.debug("MSE REMOVE START",e,t,r,n),s.remove(t,r))}},"removeBuffer",n,o)}},{key:"clearBuffer",value:function(e,t){var r,n=this;return Object.keys(this._sourceBuffer).forEach(function(i){r=n.remove(i,e,t)}),r||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var e,t=this;return Object.keys(this._sourceBuffer).forEach(function(r){var n=t._sourceBuffer[r];e=t.remove(r,0,B.end(B.get(n)))}),e}},{key:"clearOpQueues",value:function(e,t){var r;this._logger.debug("MSE clearOpQueue START");var n=this._queue[e];if(t&&n)this._queue[e]=[];else if(n&&n[e]&&!(n.length<5)){var i=[];n.forEach(function(e){e.context&&e.context.isinit&&i.push(e)}),this._queue[e]=n.slice(0,2),i.length>0&&(r=this._queue[e]).push.apply(r,i)}}},{key:"endOfStream",value:function(e){var t=this;return this.mediaSource&&"open"===this.mediaSource.readyState?this._enqueueBlockingOp(function(){var r=t.mediaSource;r&&"open"===r.readyState&&(t._logger.debug("MSE endOfStream START"),e?r.endOfStream(e):r.endOfStream())},"endOfStream"):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(e,t){var r=this.mediaSource;e<0||t<e||null==r||!r.setLiveSeekableRange||"open"!==r.readyState||r.setLiveSeekableRange(e,t)}},{key:"getSourceBuffer",value:function(e){return this._sourceBuffer[e]}},{key:"buffered",value:function(e){return B.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return B.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return B.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t,r,n,i){var o=this;if(!this.mediaSource)return Promise.resolve();var s=this._queue[e]=this._queue[e]||[],a={exec:t,promise:te(),opName:r,context:n};return i?(s.splice(0,0,a),this._mseFullFlag[e]=!1,this._startQueue(e)):s.push(a),this.isOpened||this.isEnded?1===s.length&&this._startQueue(e):this._openPromise.then(function(){1===s.length&&o._startQueue(e)}),a.promise}},{key:"_enqueueBlockingOp",value:(t=E(P().m(function e(t,r,n){var i,o,s=this;return P().w(function(e){for(;;)switch(e.n){case 0:if(this.mediaSource){e.n=1;break}return e.a(2,Promise.resolve());case 1:if((i=Object.keys(this._sourceBuffer)).length){e.n=2;break}return e.a(2,t());case 2:return o=[],i.forEach(function(e){var t=s._queue[e],i=te();o.push(i),t.push({exec:function(){i.resolve()},promise:i,opName:r,context:n}),1===t.length&&s._startQueue(e)}),e.a(2,Promise.all(o).then(function(){try{return t()}finally{i.forEach(function(e){var t=s._queue[e],r=s._sourceBuffer[e];null==t||t.shift(),r&&r.updating||s._startQueue(e)})}}))}},e,this)})),function(e,r,n){return t.apply(this,arguments)})},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var r=t[0];if(r&&!this._mseFullFlag[e])try{r.exec()}catch(n){n&&n.message&&n.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[e]=!0,r.context&&"object"===I(r.context)&&(r.context.isFull=!0),this._logger.error("[MSE error],  context,",r.context," ,name,",r.opName,",err,SourceBuffer is full"),r.promise.reject(new z(U,W,n))):(this._logger.error(n),r.promise.reject(n.constructor===z?n:new z(U,G,n)),t.shift(),this._startQueue(e))}}}},{key:"setTimeoffset",value:function(e,t,r){var n=this;return this._enqueueOp(e,function(){t<0&&(t+=.001),n._sourceBuffer[e].timestampOffset=t,n._onSBUpdateEnd(e)},"setTimeoffset",r)}},{key:"abort",value:function(e,t){var r=this;return this.isOpened?this._enqueueOp(e,function(){r._sourceBuffer[e].abort(),r._onSBUpdateEnd(e)},"abort",t):Promise.resolve()}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',t=ne();if(!t)return!1;try{return t.isTypeSupported(e)}catch(t){return this._logger.error(e,t),!1}}},{key:"isMMSOnly",value:function(){return"undefined"!=typeof ManagedMediaSource&&"undefined"==typeof MediaSource}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]);var t,r,n,i}();O(se,"VIDEO","video"),O(se,"AUDIO","audio");var ae=Object.defineProperty,le=(e,t,r)=>((e,t,r)=>t in e?ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const ce=class e{constructor(t){le(this,"_open",!1),le(this,"_level",1),le(this,"_clsName",""),le(this,"log"),le(this,"info"),le(this,"warn"),le(this,"error"),le(this,"debug"),le(this,"table"),le(this,"trace"),le(this,"group"),le(this,"groupEnd");try{const e=localStorage.getItem("xgd");this._open=!!e,this._level=parseInt(e||"0")}catch{this._open=!1}this._clsName=t,["group","groupEnd","log","warn","error"].forEach(t=>{this[t]=(r,n,i,o,s,a,l,c,u,d)=>{if(this._open||e.enabled){const e=[r,n,i,o,s,a,l,c,u,d].filter(e=>void 0!==e);console[t](`[${this._clsName}]`,...e)}}})}static setEnable(){e.enabled=!0}get enable(){return this._open}get long(){return 2===this._level}};le(ce,"enabled",!1);let ue=ce;function de(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var he={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!i||a.once)&&(!n||a.context===n)&&s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(he);const pe=de(he.exports);var fe=(e=>(e.LOADSTART="loadstart",e.WAITING="waiting",e.CANPLAY="canplay",e.PLAY="play",e.PLAYING="playing",e.PAUSE="pause",e.SEEKING="seeking",e.SEEKED="seeked",e.LOADEDDATA="loadeddata",e.LOADEDMETADATA="loadedmetadata",e.TIMEUPDATE="timeupdate",e.DURATION_CHANGE="durationchange",e.VOLUME_CHANGE="volumechange",e.PROGRESS="progress",e.ERROR="error",e.ENDED="ended",e.RESIZE="resize",e.WARING="warning",e))(fe||{}),_e=(e=>(e.PLAY_EVENT="playevent",e.APPEND_CHUNKS="appendchunks",e.START_RENDER="startrender",e.DO_SEEK="doseek",e.DO_ENDOFSTREAM="doendofstream",e.DESTROY="destroy",e.READY="ready",e.AUDIO_READY="audioready",e.VIDEO_READY="videoready",e.AUDIO_WAITING="audiowaiting",e.AUDIO_PLAYING="audioplaying",e.AUDIO_PLAY="audioplay",e.UPDATE_VIDEO_FILLTYPE="updatevideofilltype",e.SET_PLAYBACKRATE="setplaybackrate",e.UPDATE_VOLUME="updatevolume",e.SET_AUTOPLAY="setautoplay",e.SET_LOOP="setloop",e))(_e||{}),ye=(e=>(e.PLAYCONTROL_PLAY="playcontrol.play",e.PLAYCONTROL_PAUSE="playcontrol.pause",e.PLAYCONTROL_SEEK="playcontrol.seek",e.WORKER_CONFIG="worker.config",e.PLAYCONTROL_UPDATETIME="playcontrol.updatetime",e.RENDER_INIT="render.init",e.RENDER_FRAME="render.frame",e.VIDEO_METADATA="video.metadata",e.VIDEO_SAMPLES="video.samples",e.DECODER_CONFIGURE="decoder.configure",e.DECODER_DODECODE="decoder.dodecode",e.RESET_WORKER="reset.worker",e))(ye||{}),ge=(e=>(e.FRAME_RESIZE_EVENT="event.resize",e.RENDER_ERROR="render.error",e.DECODER_FIRSTFRAME_READY="decoder.firstframeready",e.DECODER_DECODED="decoder.decoded",e.DECODER_READY="decoder.ready",e.TTVIDEO_ERROR="ttvideo.error",e.EFFICIENCY_INFO="efficiency.info",e))(ge||{});class me extends pe{constructor(e){super(),le(this,"_parent"),le(this,"_ready",!1),this._parent=e}_bindEvents(){this._parent.on(_e.APPEND_CHUNKS,this._appendChunk.bind(this)),this._parent.on(_e.DO_SEEK,this._doSeek.bind(this)),this._parent.on(_e.DESTROY,this._destroy.bind(this))}emitPlayEvent(e,t){var r;null==(r=this._parent)||r.emit(_e.PLAY_EVENT,e,t)}_appendChunk(e,t){}_doSeek(e){}_destroy(e){}}const ve=function(e,t,r){const n=[];let i,o;return i=2===r||5===r?r:5,o=e,e>=6?o=e-3:1===t&&(i=2,o=e),n[0]=i<<3,n[0]|=(14&e)>>1,n[1]=(1&e)<<7,n[1]|=t<<3,5===i&&(n[1]|=(14&o)>>1,n[2]=(1&o)<<7,n[2]|=8,n[3]=0),n},be=new ue("TTVideo.WakeLock"),we=new class{constructor(){if(le(this,"_running",!1),le(this,"_bgMedia",null),typeof document<"u"){this._bgMedia=document.createElement("video"),this._bgMedia.setAttribute("playsinline",""),this._bgMedia.setAttribute("loop","");const e=document.createElement("source");e.src="data:video/mp4;base64,AAAAHGZ0eXBNNFYgAAACAGlzb21pc28yYXZjMQAAAAhmcmVlAAAGF21kYXTeBAAAbGliZmFhYyAxLjI4AABCAJMgBDIARwAAArEGBf//rdxF6b3m2Ui3lizYINkj7u94MjY0IC0gY29yZSAxNDIgcjIgOTU2YzhkOCAtIEguMjY0L01QRUctNCBBVkMgY29kZWMgLSBDb3B5bGVmdCAyMDAzLTIwMTQgLSBodHRwOi8vd3d3LnZpZGVvbGFuLm9yZy94MjY0Lmh0bWwgLSBvcHRpb25zOiBjYWJhYz0wIHJlZj0zIGRlYmxvY2s9MTowOjAgYW5hbHlzZT0weDE6MHgxMTEgbWU9aGV4IHN1Ym1lPTcgcHN5PTEgcHN5X3JkPTEuMDA6MC4wMCBtaXhlZF9yZWY9MSBtZV9yYW5nZT0xNiBjaHJvbWFfbWU9MSB0cmVsbGlzPTEgOHg4ZGN0PTAgY3FtPTAgZGVhZHpvbmU9MjEsMTEgZmFzdF9wc2tpcD0xIGNocm9tYV9xcF9vZmZzZXQ9LTIgdGhyZWFkcz02IGxvb2thaGVhZF90aHJlYWRzPTEgc2xpY2VkX3RocmVhZHM9MCBucj0wIGRlY2ltYXRlPTEgaW50ZXJsYWNlZD0wIGJsdXJheV9jb21wYXQ9MCBjb25zdHJhaW5lZF9pbnRyYT0wIGJmcmFtZXM9MCB3ZWlnaHRwPTAga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCB2YnZfbWF4cmF0ZT03NjggdmJ2X2J1ZnNpemU9MzAwMCBjcmZfbWF4PTAuMCBuYWxfaHJkPW5vbmUgZmlsbGVyPTAgaXBfcmF0aW89MS40MCBhcT0xOjEuMDAAgAAAAFZliIQL8mKAAKvMnJycnJycnJycnXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXiEASZACGQAjgCEASZACGQAjgAAAAAdBmjgX4GSAIQBJkAIZACOAAAAAB0GaVAX4GSAhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGagC/AySEASZACGQAjgAAAAAZBmqAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZrAL8DJIQBJkAIZACOAAAAABkGa4C/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmwAvwMkhAEmQAhkAI4AAAAAGQZsgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGbQC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm2AvwMkhAEmQAhkAI4AAAAAGQZuAL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGboC/AySEASZACGQAjgAAAAAZBm8AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZvgL8DJIQBJkAIZACOAAAAABkGaAC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmiAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZpAL8DJIQBJkAIZACOAAAAABkGaYC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBmoAvwMkhAEmQAhkAI4AAAAAGQZqgL8DJIQBJkAIZACOAIQBJkAIZACOAAAAABkGawC/AySEASZACGQAjgAAAAAZBmuAvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZsAL8DJIQBJkAIZACOAAAAABkGbIC/AySEASZACGQAjgCEASZACGQAjgAAAAAZBm0AvwMkhAEmQAhkAI4AhAEmQAhkAI4AAAAAGQZtgL8DJIQBJkAIZACOAAAAABkGbgCvAySEASZACGQAjgCEASZACGQAjgAAAAAZBm6AnwMkhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AhAEmQAhkAI4AAAAhubW9vdgAAAGxtdmhkAAAAAAAAAAAAAAAAAAAD6AAABDcAAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAzB0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAABAAAAAAAAA+kAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAALAAAACQAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAPpAAAAAAABAAAAAAKobWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAB1MAAAdU5VxAAAAAAALWhkbHIAAAAAAAAAAHZpZGUAAAAAAAAAAAAAAABWaWRlb0hhbmRsZXIAAAACU21pbmYAAAAUdm1oZAAAAAEAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAhNzdGJsAAAAr3N0c2QAAAAAAAAAAQAAAJ9hdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAALAAkABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAALWF2Y0MBQsAN/+EAFWdCwA3ZAsTsBEAAAPpAADqYA8UKkgEABWjLg8sgAAAAHHV1aWRraEDyXyRPxbo5pRvPAyPzAAAAAAAAABhzdHRzAAAAAAAAAAEAAAAeAAAD6QAAABRzdHNzAAAAAAAAAAEAAAABAAAAHHN0c2MAAAAAAAAAAQAAAAEAAAABAAAAAQAAAIxzdHN6AAAAAAAAAAAAAAAeAAADDwAAAAsAAAALAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAACgAAAAoAAAAKAAAAiHN0Y28AAAAAAAAAHgAAAEYAAANnAAADewAAA5gAAAO0AAADxwAAA+MAAAP2AAAEEgAABCUAAARBAAAEXQAABHAAAASMAAAEnwAABLsAAATOAAAE6gAABQYAAAUZAAAFNQAABUgAAAVkAAAFdwAABZMAAAWmAAAFwgAABd4AAAXxAAAGDQAABGh0cmFrAAAAXHRraGQAAAADAAAAAAAAAAAAAAACAAAAAAAABDcAAAAAAAAAAAAAAAEBAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAkZWR0cwAAABxlbHN0AAAAAAAAAAEAAAQkAAADcAABAAAAAAPgbWRpYQAAACBtZGhkAAAAAAAAAAAAAAAAAAC7gAAAykBVxAAAAAAALWhkbHIAAAAAAAAAAHNvdW4AAAAAAAAAAAAAAABTb3VuZEhhbmRsZXIAAAADi21pbmYAAAAQc21oZAAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAADT3N0YmwAAABnc3RzZAAAAAAAAAABAAAAV21wNGEAAAAAAAAAAQAAAAAAAAAAAAIAEAAAAAC7gAAAAAAAM2VzZHMAAAAAA4CAgCIAAgAEgICAFEAVBbjYAAu4AAAADcoFgICAAhGQBoCAgAECAAAAIHN0dHMAAAAAAAAAAgAAADIAAAQAAAAAAQAAAkAAAAFUc3RzYwAAAAAAAAAbAAAAAQAAAAEAAAABAAAAAgAAAAIAAAABAAAAAwAAAAEAAAABAAAABAAAAAIAAAABAAAABgAAAAEAAAABAAAABwAAAAIAAAABAAAACAAAAAEAAAABAAAACQAAAAIAAAABAAAACgAAAAEAAAABAAAACwAAAAIAAAABAAAADQAAAAEAAAABAAAADgAAAAIAAAABAAAADwAAAAEAAAABAAAAEAAAAAIAAAABAAAAEQAAAAEAAAABAAAAEgAAAAIAAAABAAAAFAAAAAEAAAABAAAAFQAAAAIAAAABAAAAFgAAAAEAAAABAAAAFwAAAAIAAAABAAAAGAAAAAEAAAABAAAAGQAAAAIAAAABAAAAGgAAAAEAAAABAAAAGwAAAAIAAAABAAAAHQAAAAEAAAABAAAAHgAAAAIAAAABAAAAHwAAAAQAAAABAAAA4HN0c3oAAAAAAAAAAAAAADMAAAAaAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAAAJAAAACQAAAAkAAACMc3RjbwAAAAAAAAAfAAAALAAAA1UAAANyAAADhgAAA6IAAAO+AAAD0QAAA+0AAAQAAAAEHAAABC8AAARLAAAEZwAABHoAAASWAAAEqQAABMUAAATYAAAE9AAABRAAAAUjAAAFPwAABVIAAAVuAAAFgQAABZ0AAAWwAAAFzAAABegAAAX7AAAGFwAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTUuMzMuMTAw",e.type="video/mp4",this._bgMedia.appendChild(e),this._bgMedia.addEventListener("timeupdate",()=>{this._bgMedia&&this._bgMedia.currentTime>.5&&(this._bgMedia.currentTime=Math.random())})}}get running(){return this._running}enable(){var e;const t=null==(e=this._bgMedia)?void 0:e.play();if(t&&t.then)return t.then(e=>(this._running=!0,be.warn("background video running"),e)).catch(e=>{this._running=!1})}disable(){var e;null==(e=this._bgMedia)||e.pause(),this._running=!1,be.warn("background video paused")}};var Ce=(e=>(e[e.WORKER_INIT_ERROR=10001]="WORKER_INIT_ERROR",e[e.WORKER_RUNTIME_ERROR=10002]="WORKER_RUNTIME_ERROR",e[e.RENDER_INIT_ERROR=10003]="RENDER_INIT_ERROR",e[e.RENDER_RUNTIME_ERROR=10004]="RENDER_RUNTIME_ERROR",e[e.DECODER_INIT_ERROR=10005]="DECODER_INIT_ERROR",e[e.DECODER_DECODE_ERROR=10006]="DECODER_DECODE_ERROR",e[e.DECODER_RUNTIME_ERROR=10007]="DECODER_RUNTIME_ERROR",e[e.AUDIO_ERROR=10008]="AUDIO_ERROR",e[e.ELEMENT_USE_ERROR=10009]="ELEMENT_USE_ERROR",e[e.ONLY_SUPPORT_AVEXIST=10010]="ONLY_SUPPORT_AVEXIST",e[e.ONLY_SUPPORT_HEVC=10011]="ONLY_SUPPORT_HEVC",e[e.MOCK_ERROR=10012]="MOCK_ERROR",e))(Ce||{}),Ee=(e=>(e[e.DECODE_FRAME_SLOWLY=20001]="DECODE_FRAME_SLOWLY",e[e.RENDER_FRAME_SLOWLY=20002]="RENDER_FRAME_SLOWLY",e[e.FIRST_FRAME_SHOW_SLOWLY=20003]="FIRST_FRAME_SHOW_SLOWLY",e[e.MOCK_WARNING=20004]="MOCK_WARNING",e))(Ee||{});class ke extends Error{constructor(e,t){super(t),le(this,"code"),this.code=e}}class Te extends Error{constructor(e,t){super(t),le(this,"code"),this.code=e}}const Se=new ue("TTVideo.AudioRender");class Oe{constructor(e,t){le(this,"_rafId",0),le(this,"_destroyed",0),le(this,"_media"),le(this,"_updateTime"),le(this,"_raf",()=>{this._destroyed||this._media&&(this._media.ended||((this._media.currentTime<.5||!this._media.paused&&!this._media.seeking)&&this._updateTime(1e3*this._media.currentTime),this._rafId=requestAnimationFrame(this._raf)))}),this._media=e,this._updateTime=t}get backGroundMedia(){return we._bgMedia}init(){this._rafId&&cancelAnimationFrame(this._rafId),Se.log("[VideoDeriver]: init rvf driver for video decoder、render"),this._rafId=requestAnimationFrame(this._raf),we.running||we.enable()}destroy(){this._destroyed=1,this._media=null,we.disable(),cancelAnimationFrame(this._rafId),Se.log("[VideoDeriver]: cancelAnimationFrame")}}class Ae extends me{constructor(e){super(e),le(this,"_media",null),le(this,"_videoDeriver",null),le(this,"_mse",null),le(this,"_remuxer",null),le(this,"_meta",null),le(this,"_sampleQueue",[]),le(this,"_codec",""),le(this,"_sourceCreated",!1),le(this,"_needInitSegment",!0),le(this,"_inProcessing",!1),le(this,"_ended",!1),le(this,"_waiting",!1),le(this,"_onVisibilitychange",()=>{var e,t;if("hidden"===document.visibilityState)return Se.log("后台中!"),void(null==(e=this._media)||e.pause());Se.log("前台中!"),null==(t=this._media)||t.play()}),le(this,"_updatePlayTime",e=>{this._parent.updatePlayTime(e)}),le(this,"_onCanplay",()=>{Se.log("audio ON canplay!!!"),this._media&&(this._ready||(this._ended=!1,this._waiting||(Se.warn("pause audio play once canplay"),this._media.pause()),this._waiting=!1,this._ready=!0,this.emit(_e.AUDIO_READY),this._videoDeriver||(this._videoDeriver=new Oe(this._media,this._updatePlayTime)),this._videoDeriver.init()))}),le(this,"_onPlaying",()=>{this._media&&(this._ended=!1,Se.log("audio ON playing!!"),this._videoDeriver||(this._videoDeriver=new Oe(this._media,this._updatePlayTime)),this._videoDeriver.init(),this.emit(_e.AUDIO_PLAYING))}),le(this,"_onPlay",()=>{Se.log("audio ON play!!"),this.emit(_e.AUDIO_PLAY)}),le(this,"_onPause",()=>{Se.log("audio ON pause!!"),this.emitPlayEvent(fe.PAUSE)}),le(this,"_onWaiting",()=>{if(this._media){try{const e=this._media.buffered,t=this._media.currentTime;let r=0;for(let n=0,i=e.length;n<i;n++)e.start(n)<t&&e.end(n)>t&&(r=e.end(n)-t);if(Math.abs(r)>.5||this._checkEndOfStreamOrLoop())return}catch{}this._ready=!1,this._waiting=!0,this.emit(_e.AUDIO_WAITING)}}),le(this,"_onSeeking",()=>{Se.log("audio ON seeking")}),le(this,"_onSeeked",()=>{var e;Se.log("seeked","_ready:",this._ready),this._ready||(Se.warn("pause audio play once seeked!"),null==(e=this._media)||e.pause(),this._ready=!0,this.emit(_e.AUDIO_READY,!0))}),le(this,"_onEnded",()=>{Se.log("play ON ended!!"),this.emitPlayEvent(fe.ENDED),this._ended=!0}),le(this,"_onProgress",()=>{if(this._media){if(this._media.readyState<=1){const e=this._getBufferGap();e>0&&e<1&&(this._media.currentTime+=e+.05,Se.warn("progress, gap=",e))}this.emitPlayEvent(fe.PROGRESS)}}),le(this,"_onOnceProgress",()=>{if(this._media&&this._media.buffered.length){const e=this._media.buffered.start(0);e&&(this._media.currentTime=e+.05,Se.log("start gap:",e)),this._media.removeEventListener("progress",this._onOnceProgress)}}),le(this,"_onTimeupdate",()=>{this.emitPlayEvent(fe.TIMEUPDATE),this._checkEndOfStreamOrLoop()}),le(this,"_onDurationchange",()=>{this.emitPlayEvent(fe.DURATION_CHANGE)}),le(this,"_onError",e=>{var t,r;const n=(null==(r=null==(t=this._media)?void 0:t.error)?void 0:r.message)||(null==e?void 0:e.message)||"audio error",i=new ke(Ce.AUDIO_ERROR,n);this.emitPlayEvent(fe.ERROR,i)}),le(this,"_appendChunk",async(e,t)=>{if(t.samples.length){if(this._codec||(2!==t.objectType&&5!==t.objectType?this._codec="mp4a.40.5":this._codec=t.codec),t.samples.forEach(e=>{e.baseMediaDecodeTime=t.baseMediaDecodeTime,this._sampleQueue.push(e)}),t.samples=[],!this._meta){this._meta={...t,exist:()=>!0,hasSample:()=>!0,samples:[]},Se.warn("audio set metadata",this._meta),t.config.length||(this._meta.config=t.config=ve(t.sampleRateIndex,t.channelCount,t.objectType));try{await this._doAppendWrapper()}catch(e){this._onError(e)}return}if(!this._inProcessing&&this._sampleQueue.length)try{await this._doAppendWrapper()}catch(e){this._onError(e)}}}),le(this,"_doAppend",async e=>{var t,r,n;this._remuxer||(this._remuxer=new w({samples:[],exist:()=>!1},e,null)),this._sourceCreated||(await(null==(t=this._mse)?void 0:t.open()),this._sourceCreated=!0,Se.log(`video/mp4;codecs=${this._codec}`),null==(r=this._mse)||r.createSource(e.type,`video/mp4;codecs=${this._codec}`),Se.log("sourcebuffer created!"));const i=null==(n=this._remuxer)?void 0:n.remux(this._needInitSegment);if(this._needInitSegment&&!i.audioInitSegment||!this._mse)return;this._needInitSegment=!1;const o=[];return i.audioInitSegment&&o.push(this._mse.append(e.type,i.audioInitSegment,null)),i.audioSegment&&o.push(this._mse.append(e.type,i.audioSegment,null)),Promise.all(o)}),le(this,"_doSeek",e=>{this._media&&(Se.log("doSeek, t=",e),this._ready=!1,this._media.currentTime=e)}),this._initMedia()}static isSupported(){return!!window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="mp4a.40.5"')}get media(){return this._media}get currentTime(){var e;return(null==(e=this._media)?void 0:e.currentTime)||0}get buffered(){var e;return null==(e=this._media)?void 0:e.buffered}get ended(){var e;return null==(e=this._media)?void 0:e.ended}get played(){var e;return null==(e=this._media)?void 0:e.played}get duration(){var e;return null!=(e=this._media)&&e.duration?this._media.duration:this._meta?this._meta.duration/this._meta.formatTimescale:0}set duration(e){this._updateDuration(e)}get readyState(){var e;return(null==(e=this._media)?void 0:e.readyState)||0}_initMedia(){this._media=document.createElement("video"),this._mse=new se(void 0,null),this._bindEvents(),this._bindMediaEvents(),this._mse.bindMedia(this._media)}_getBufferGap(){const e=this.buffered;if(!e)return 0;for(let t=0,r=e.length;t<r;t++)if(!(e.end(t)<this.currentTime))return e.start(t)-this.currentTime;return 0}resume(){var e,t;return Se.log("call audio play() outside!!"),(null!=(e=this._media)&&e.ended||this._ended)&&this._parent.seek(.005),we.running||we.enable(),null==(t=this._media)?void 0:t.play()}pause(){var e;return Se.log("call audio pause() outside!!"),we.disable(),null==(e=this._media)?void 0:e.pause()}_bindEvents(){super._bindEvents(),this._parent.on(_e.UPDATE_VOLUME,e=>{this._media&&(this._media.volume=e,this.emitPlayEvent(fe.VOLUME_CHANGE),we.running||we.enable())}),this._parent.on(_e.DO_ENDOFSTREAM,()=>{var e;null==(e=this._mse)||e.endOfStream()}),this._parent.on(_e.SET_PLAYBACKRATE,e=>{this._media&&(Se.log("set playbackrate",e),this._media.playbackRate=e)}),this._parent.on(_e.SET_AUTOPLAY,e=>{this._media&&(Se.log("set autoplay",e),this._media.autoplay=e)}),this._parent.on(_e.SET_LOOP,e=>{this._media&&(Se.log("set loop",e),this._media.loop=e)}),document.addEventListener("visibilitychange",this._onVisibilitychange)}_bindMediaEvents(){this._media&&(this._media.addEventListener("canplay",this._onCanplay),this._media.addEventListener("play",this._onPlay),this._media.addEventListener("playing",this._onPlaying),this._media.addEventListener("pause",this._onPause),this._media.addEventListener("waiting",this._onWaiting),this._media.addEventListener("seeking",this._onSeeking),this._media.addEventListener("seeked",this._onSeeked),this._media.addEventListener("progress",this._onProgress),this._media.addEventListener("ended",this._onEnded),this._media.addEventListener("progress",this._onOnceProgress),this._media.addEventListener("timeupdate",this._onTimeupdate),this._media.addEventListener("durationchange",this._onDurationchange),this._media.addEventListener("error",this._onError))}_checkEndOfStreamOrLoop(){var e;if(this._media)return Math.abs(this._media.duration-this._media.currentTime)<.3&&(this._media.loop?(Se.log(`currentTime:${this.currentTime}, duration: ${this.duration}, loop play!`),this._parent.seek(.005),!0):(Se.log("mse do endOfStream()!"),null==(e=this._mse)||e.endOfStream(),this.emitPlayEvent(fe.ENDED),this._ended=!0,!0))}async _updateDuration(e){if(this._mse){if(this._mse.isOpened||await this._mse.open(),!this._mse)return;await this._mse.updateDuration(e),Se.log("update duration",e)}}async _doAppendWrapper(){var e;this._meta&&(this._meta.samples=this._sampleQueue.slice(),this._meta.baseMediaDecodeTime=(null==(e=this._meta.samples[0])?void 0:e.baseMediaDecodeTime)||0,this._sampleQueue=[],this._inProcessing=!0,await this._doAppend(this._meta),this._inProcessing=!1,this._sampleQueue.length&&await this._doAppendWrapper())}async _destroy(){var e,t,r;Se.log("destroy audio render"),this._media&&(this.removeAllListeners(),this._remuxer=null,null==(e=this._videoDeriver)||e.destroy(),document.removeEventListener("visibilitychange",this._onVisibilitychange),this._media.removeEventListener("canplay",this._onCanplay),this._media.removeEventListener("playing",this._onPlaying),this._media.removeEventListener("play",this._onPlay),this._media.removeEventListener("waiting",this._onWaiting),this._media.removeEventListener("seeking",this._onSeeking),this._media.removeEventListener("seeked",this._onSeeked),this._media.removeEventListener("progress",this._onProgress),this._media.removeEventListener("ended",this._onEnded),this._media.removeEventListener("progress",this._onOnceProgress),this._media.removeEventListener("error",this._onError),null==(t=this._mse)||t.endOfStream(),await(null==(r=this._mse)?void 0:r.unbindMedia()),this._mse=null,this._meta=null)}}const $e=new ue("TTVideo.WorkerInit"),Pe=new ue("TTVideo.WorkerPool"),Re=class e{static preloadWorker(){if(Pe.log("preload worker!"),e.Pools.length)return;const t=e._initWorker();if(!t)return;const r=e=>{t.worker.removeEventListener("message",r),e.data.type===ge.DECODER_READY&&(t.workerInfo.ready=!0)};t.worker.addEventListener("message",r),e.Pools.push(t)}static _initWorker(){const e=function(){let e;const t=(0,n.g)().workerUrl;if(!t)throw $e.log("new Worker by Inline"),new Error("no worker url found!");return $e.log("new Worker by URL!",t),e=new Worker(t),e}();if(!e)return;const t=document.createElement("canvas"),r=t.transferControlToOffscreen();return t.style.margin="auto",t.style.position="absolute",t.style.pointerEvents="none",e.postMessage({type:ye.RENDER_INIT,canvas:r},[r]),Pe.log("init new worker pairs"),{id:Date.now(),worker:e,cvs:t,offscreenCvs:r,workerInfo:{worker:e,ready:!1}}}static catchWorker(t){Pe.log("cache worker pairs"),e.Pools.push(t)}static getWorker(){const t=e.Pools.pop();return t?(Pe.log("use cached worker pairs, ready?",t.workerInfo.ready),t):(e.preloadWorker(),e.Pools.pop()||null)}};le(Re,"Pools",[]);let xe=Re;const Le=new ue("TTVideo.Degrade");class Ie{constructor(){le(this,"_videoFps",0),le(this,"_decodeFpsQueue",[]),le(this,"_totalFps",0),le(this,"_totalDecodeFps",0),le(this,"_totalRenderFrames",0)}get renderRate(){return this._totalFps?Number((this._totalRenderFrames/this._totalFps).toFixed(2)):0}get decodeRate(){return this._totalDecodeFps?Number((this._totalDecodeFps/this._totalFps).toFixed(2)):0}addEfficiInfo(e){this._videoFps=e.fps;const{powerfulDecodeFps:t,powerfulFFCost:r,powerfulRenderRate:i,minDecodeFps:o,continuousLowDecodeTime:s}=(0,n.g)();if(this._totalFps+=e.fps,this._totalDecodeFps+=e.decodeFps,this._totalRenderFrames+=e.renderFps,e.ffCost>r)throw Le.warn("slow firstframe decode, cost=",e.ffCost),new Te(Ee.FIRST_FRAME_SHOW_SLOWLY,`${e.ffCost}`);if(this._totalRenderFrames&&this._totalRenderFrames/this._totalFps<i)throw Le.warn("slow render"),new Te(Ee.RENDER_FRAME_SLOWLY,""+this._totalRenderFrames/this._totalFps);if(e.decodeFps>e.fps+t?this._decodeFpsQueue.pop():this._decodeFpsQueue.push(e.decodeFps),this._decodeFpsQueue.length>=s/1e3){Le.warn("slow decode!");const e=this._decodeFpsQueue[0];throw e<o&&(Le.warn("decode perf really slow, forbidden soft use!"),(0,n.f)()),this._decodeFpsQueue=[],new Te(Ee.DECODE_FRAME_SLOWLY,`${e}`)}}}const Me=new ue("TTVideo.MainSink");class De extends pe{constructor(e){super(),le(this,"_workerPairs",null),le(this,"_parent"),le(this,"_nextSample"),le(this,"_preSample"),le(this,"_inDecoding",!1),le(this,"_id",(new Date).getMilliseconds()),le(this,"_meta",null),le(this,"_efficiInfo",null),le(this,"_degrade",new Ie),le(this,"_firstFrame",!1),le(this,"_onWorkerMessage",e=>{this.emit(e.data.type,e.data)}),le(this,"_onWorkerError",e=>{null!=e&&e.message?this._parent.onError(new ke(Ce.WORKER_RUNTIME_ERROR,(null==e?void 0:e.message)||"worker eror")):this._parent.onError(new ke(Ce.WORKER_INIT_ERROR,(null==e?void 0:e.message)||"worker init error"))}),this._parent=e;try{this._workerPairs=xe.getWorker()}catch(e){setTimeout(()=>{this._parent.onError(new ke(Ce.WORKER_INIT_ERROR,null==e?void 0:e.message))})}this._bindWorkerEvent(),Me.log("workerPairs",this._workerPairs)}get canvas(){var e;return null==(e=this._workerPairs)?void 0:e.cvs}get worker(){var e,t;return null==(t=null==(e=this._workerPairs)?void 0:e.workerInfo)?void 0:t.worker}get decoderReady(){var e,t;return null==(t=null==(e=this._workerPairs)?void 0:e.workerInfo)?void 0:t.ready}get efficInfo(){return this._efficiInfo}_bindWorkerEvent(){const e=this.worker;e&&(e.addEventListener("message",this._onWorkerMessage),e.addEventListener("error",this._onWorkerError),this._transEventUp(ye.PLAYCONTROL_UPDATETIME),this._transEventUp(ye.PLAYCONTROL_SEEK),this._transEventUp(ye.RESET_WORKER),this._transEventUp(ye.VIDEO_METADATA),this._transEventUp(ye.WORKER_CONFIG),this._transSamplesUp(),this.on(ge.RENDER_ERROR,this._onWorkerError),this.on(ge.FRAME_RESIZE_EVENT,this.onFrameResize),this.on(ge.DECODER_READY,this.onDecoderReady),this.on(ge.EFFICIENCY_INFO,this.onEfficiInfo),this.on(ge.DECODER_FIRSTFRAME_READY,this.onDecoderFirstFrameReady),this.on(ge.TTVIDEO_ERROR,this.onTTVIDEOError),this.emit(ye.WORKER_CONFIG,{logger:Me.enable,init:Date.now(),...(0,n.g)()}))}_transEventUp(e){this.on(e,t=>{var r,n,i;null==(i=null==(n=null==(r=this._workerPairs)?void 0:r.workerInfo)?void 0:n.worker)||i.postMessage({type:e,...t})})}_transSamplesUp(){this.on(ye.VIDEO_SAMPLES,e=>{var t,r,n;null==(n=null==(r=null==(t=this._workerPairs)?void 0:t.workerInfo)?void 0:r.worker)||n.postMessage({type:ye.VIDEO_SAMPLES,buffer:e.buffer,list:e.list},[e.buffer.buffer])})}addMetadata(e){var t,r;Me.warn("add metadata, decoder ready? ",!(null==(r=null==(t=this._workerPairs)?void 0:t.workerInfo)||!r.ready)),this._meta=e,this.emit(ye.VIDEO_METADATA,{formatTimescale:e.formatTimescale,duration:e.duration,width:e.width,height:e.height,fpsNum:e.fpsNum,fpsDen:e.fpsDen,vps:e.vps,pps:e.pps,sps:e.sps,codec:e.codec})}appendBuffer(e){this.emit(ye.VIDEO_SAMPLES,function(e){const t=e.map(e=>function(e){const t=e.reduce((e,t)=>e+(t.byteLength+4),0),r=new Uint8Array(t);let n=0;return e.forEach(e=>{r.set([0,0,0,1],n),n+=4,r.set(e,n),n+=e.byteLength}),r}(e.units)),r=t.reduce((e,t)=>e+(t.byteLength||0),0),n=new Uint8Array(r);let i=0;t.forEach(e=>{n.set(e,i),i+=e.length});const o=e.map(e=>({dts:e.dts,pts:e.pts,size:e.data.length,key:e.keyframe?1:0}));return{buffer:n,list:o}}(e))}updatePlayTime(e){this.emit(ye.PLAYCONTROL_UPDATETIME,{time:e})}preciseSeek(e){this.emit(ye.PLAYCONTROL_SEEK,{time:1e3*e})}destroy(){var e,t;Me.log(" do destory!");const r=this.worker;r&&(this.emit(ye.RESET_WORKER),r.removeEventListener("message",this._onWorkerMessage),r.removeEventListener("error",this._onWorkerError),null!=(t=null==(e=this._workerPairs)?void 0:e.workerInfo)&&t.ready&&xe.catchWorker(this._workerPairs),this._workerPairs=null)}onDecoderReady(){this._workerPairs&&(Me.log("worker decoder init ready"),this._workerPairs.workerInfo.ready=!0)}onDecoderFirstFrameReady(){this._parent.emit(_e.VIDEO_READY),this._firstFrame||(this._firstFrame=!0,this._parent.emitPlayEvent(fe.LOADEDDATA))}onFrameResize(){this._parent.emitPlayEvent(fe.RESIZE)}onTTVIDEOError(e){var t,r;this._workerPairs&&(this._workerPairs.workerInfo.ready=!1,null==(t=this._workerPairs.workerInfo.worker)||t.terminate(),Me.warn("worker terminate!")),null==(r=this._parent)||r.onError(new ke(e.code,e.message))}onEfficiInfo(e){Me.log("EfficInfo:",e);try{this._degrade.addEfficiInfo(e)}catch(e){this._parent.emitPlayEvent(fe.WARING,e)}this._efficiInfo={...e,renderRate:this._degrade.renderRate,decodeRate:this._degrade.decodeRate}}}const Be=new ue("TTVideo.VideoRender");class Ne extends me{constructor(e){super(e),le(this,"_mainSink"),le(this,"_canvas"),le(this,"_worker"),le(this,"_meta",null),le(this,"_recentMeta",null),le(this,"_firstFrame",!1),this._bindEvents(),this._mainSink=new De(this),this._canvas=this._mainSink.canvas,this._worker=this._mainSink.worker}get canvas(){return this._canvas}get efficInfo(){return this._mainSink.efficInfo}_bindEvents(){super._bindEvents();const e=({width:e,height:t},r=0,n=0)=>{const{width:i,height:o}=this._meta||this._canvas,s=t*i/o,a=e*o/i,l=e-s,c=t-a,u=l*r+"px",d=c*n+"px";this._canvas.style.left=u,this._canvas.style.top=d,Be.warn(`cvsWidth=${i}, cvsHeight=${o}, scaleCvsWidth=${s}, scaleCvsHeight=${a}`),Be.warn(`cover position: deltaX=${l}, deltaY=${c}, width=${e}, height=${t}, pX=${u}, pY=${d}`)};this._parent.on(_e.UPDATE_VIDEO_FILLTYPE,(t,{width:r,height:n})=>{const{width:i,height:o}=this._meta||this._canvas,s=!r||r/n>i/o;return Be.warn(`UPDATE_VIDEO_FILLTYPE isGapX = ${s}, objectFit=${t}, cvsWidth:${i}, cvsHeight:${o}, container width:${r}, container height:${n}`),this._canvas.style.maxWidth="initial",this._canvas.style.maxHeight="initial","cover"===t?s?(this._canvas.style.left="0px",this._canvas.style.top="0px",this._canvas.style.height="auto",this._canvas.style.width="100%",void e({width:r,height:n},0,.5)):(this._canvas.style.left="0px",this._canvas.style.top="0px",this._canvas.style.width="auto",this._canvas.style.height="100%",void e({width:r,height:n},.5,0)):"fill"===t?(this._canvas.style.width="100%",void(this._canvas.style.height="100%")):(this._canvas.style.top="0px",this._canvas.style.bottom="0px",this._canvas.style.left="0px",this._canvas.style.right="0px",this._canvas.style.maxWidth="100%",this._canvas.style.maxHeight="100%",this._canvas.style.width="initial",this._canvas.style.height="initial",void(i<r&&o<n&&(i/r>o/n?this._canvas.style.width="100%":this._canvas.style.height="100%")))})}_appendChunk(e){var t,r,n,i,o;if(this._meta){if((null==(n=this._recentMeta)?void 0:n.width)!==e.width||this._recentMeta.height!==e.height){Be.warn(`metadata changed! width: ${null==(i=this._recentMeta)?void 0:i.width} -> ${e.width}, height: ${null==(o=this._recentMeta)?void 0:o.height} -> ${e.height}`);const t=e.samples[0];t&&(this._recentMeta=t.meta=Object.assign({},e,{samples:null}))}}else this.emitPlayEvent(fe.LOADEDMETADATA),Be.log("emit loadedmetadata event!"),this._recentMeta=this._meta=Object.assign({},e,{samples:null}),Be.warn("video set metadata",this._meta),null==(r=null==(t=this._mainSink)?void 0:t.addMetadata)||r.call(t,this._meta);const s=e.samples;e.samples=[],this._mainSink.appendBuffer(s)}_destroy(){var e;Be.log("destroy video render"),this.removeAllListeners(),null==(e=this._mainSink)||e.destroy()}updatePlayTime(e){var t;null==(t=this._mainSink)||t.updatePlayTime(e)}ajustSeekTime(e){var t;null==(t=this._mainSink)||t.preciseSeek(e)}onError(e){this.emitPlayEvent(fe.ERROR,e)}}const je=new ue("TTVideo.TimeLine");class Ue extends pe{constructor(){super(),le(this,"audioRender"),le(this,"videoRender"),le(this,"_readyStatus",{audio:!1,video:!1,seeking:!1}),le(this,"_loadeddata",!1),le(this,"_appendData",!1),le(this,"_initTime",0),le(this,"updatePlayTime",e=>{this.seeking||this.videoRender.updatePlayTime(e)}),this.audioRender=new Ae(this),this.videoRender=new Ne(this),this._bindEvent(),this._initTime=performance.now(),je.log("init TIMELINE")}get ready(){return this._readyStatus.video&&this._readyStatus.audio}get played(){return this.audioRender.played}get currentTime(){return this.audioRender.currentTime}get readyState(){return this.audioRender.readyState}get buffered(){return this.audioRender.buffered}get duration(){return this.audioRender.duration}get canvas(){return this.videoRender.canvas}get efficInfo(){return this.videoRender.efficInfo}get seeking(){return this._readyStatus.seeking}_resetReadyStatus(){this._readyStatus.audio=!1,this._readyStatus.video=!1,this._readyStatus.seeking=!0}_bindEvent(){this.audioRender.on(_e.AUDIO_READY,e=>{je.log("audio ready!!! seeking=",this._readyStatus.seeking,"seeked:",!!e),this._readyStatus.audio=!0,this._readyStatus.seeking?this.videoRender.ajustSeekTime(this.currentTime):this._playCtrol()}),this.audioRender.on(_e.AUDIO_PLAYING,()=>{this._readyStatus.seeking||this._loadeddata&&(this.emit(_e.PLAY_EVENT,fe.PLAYING),je.log("emit playing event!"))}),this.audioRender.on(_e.AUDIO_PLAY,()=>{this._loadeddata&&(this.emit(_e.PLAY_EVENT,fe.PLAY),je.log("emit play event!"))}),this.audioRender.on(_e.AUDIO_WAITING,()=>{this.currentTime&&(je.log("audio waiting!!! currentTime=",this.currentTime),this.emit(_e.PLAY_EVENT,fe.WAITING),je.log("emit waiting event!"),this._readyStatus.audio=!1)}),this.videoRender.on(_e.VIDEO_READY,()=>{je.log("video ready!!!"),this._loadeddata=!0,this._readyStatus.video=!0,this._playCtrol()}),this.on(_e.DESTROY,()=>{this.removeAllListeners()})}_playCtrol(){var e,t,r;je.log(`status: audio=${this._readyStatus.audio}, video=${this._readyStatus.video}, seeking:${this._readyStatus.seeking}`);const{audio:n,video:i,seeking:o}=this._readyStatus;if(n&&i){if(o)return this._readyStatus.seeking=!1,this.emit(_e.PLAY_EVENT,fe.SEEKED),je.log("emit seeked event!"),this.emit(_e.PLAY_EVENT,fe.CANPLAY),je.log("emit canplay event!"),void(null==(e=this.audioRender.resume())||e.catch(e=>{}));this.emit(_e.PLAY_EVENT,fe.CANPLAY),je.log("emit canplay event!"),null!=(t=this.audioRender.media)&&t.autoplay&&(null==(r=this.audioRender.resume())||r.catch(e=>{}))}}appendBuffer(e,t){this._appendData||(this._appendData=!0,je.log("fist time appendBuffer, cost=",Math.round(performance.now()-this._initTime))),this.emit(_e.APPEND_CHUNKS,e,t)}play(){return this.audioRender.resume()}pause(){return this.audioRender.pause()}seek(e){this._loadeddata&&(e>=this.duration&&(e=this.duration-1),e<0&&(e=0),je.log(`start seek to:${e}, set seeking status=true`),this._resetReadyStatus(),this.emit(_e.DO_SEEK,e),this.emit(_e.PLAY_EVENT,fe.SEEKING),je.log("emit seeking event!"))}}const Ve=new ue("TTVideo.TTVideo"),Fe=typeof HTMLElement>"u"?Object:HTMLElement,He=class e extends Fe{constructor(){super(),le(this,"_timeline",null),le(this,"_resizeObserver",null),le(this,"_domConnected",!1),le(this,"_err",null),le(this,"_warning",null),le(this,"_seekTimer",0),le(this,"_tempEfficCache",null),this._proxyProps()}_proxyProps(){Object.getOwnPropertyNames(e.prototype).forEach(e=>{if(!/^__/.test(e))return;const t=e.replace("__","");Object.defineProperty(this,t,{get:function(){try{return this[e]}catch{}return 0},set:function(t){try{this[e]=t}catch{}}})})}static get version(){return"0.1.5"}static setEleName(t){(0,n.s)(t),typeof customElements>"u"||customElements.get((0,n.a)())||customElements.define((0,n.a)(),class extends e{})}static updateTTVideoConfig(e){(0,n.u)(e)}static preloadWorker(){try{return xe.preloadWorker()}catch{}}addEventListener(e,t,r){super.addEventListener(e,t,r)}removeEventListener(e,t,r){super.removeEventListener(e,t,r)}setAttribute(e,t){super.setAttribute(e,t)}_init(){this._timeline=new Ue,Ve.log("timeline init"),this._bindEvents(),this._timeline&&(this._timeline.emit(_e.SET_PLAYBACKRATE,this.playbackRate),this._timeline.emit(_e.SET_AUTOPLAY,this.autoplay),this._timeline.emit(_e.SET_LOOP,this.loop),this.__muted=this.__muted)}_bindEvents(){var e;null==(e=this._timeline)||e.on(_e.PLAY_EVENT,(e,t)=>{e===fe.LOADEDDATA&&(this.querySelector("canvas")||(Ve.log("ttvideo appendChild canvas"),this.appendChild(this.__canvas)),this.__canvas&&(this.__canvas.style.display="block")),e===fe.RESIZE&&this._updateVideoPostion(),e===fe.ERROR&&(Ve.warn("detect error:",t),this.pause(),this._err=t),e===fe.WARING&&(this._warning=t),e===fe.ENDED&&this.pause(),this._innerDispatchEvent(e,t)})}disconnectedCallback(){this._domConnected=!1,Ve.log("video disconnectedCallback");const e=this.querySelector("canvas");if(e)try{this.removeChild(e),Ve.log("remove canvas child")}catch{}this._tempEfficCache=this.getStats(),this.destroy(),this._resizeObserver&&this._resizeObserver.disconnect()}connectedCallback(){var e,t;const r=null==(e=this.childNodes[0])?void 0:e.tagName;if("source"===(null==(t=null==r?void 0:r.toLocaleLowerCase)?void 0:t.call(r)))return this._err=new ke(Ce.ELEMENT_USE_ERROR,"not supported source node"),void this._innerDispatchEvent("error",this._err);if(Ve.log("video connected to document"),this._timeline||this._init(),this.style.width="100%",this.style.height="100%",this.style.position="absolute",this.style.left="0px",this.style.top="0px",ResizeObserver){let e=0;this._resizeObserver=new ResizeObserver(()=>{var t;null!=(t=this._timeline)&&t.ready&&(clearTimeout(e),e=setTimeout(()=>{this._updateVideoPostion()},100))}),this._resizeObserver.observe(this)}this._domConnected=!0}play(){var e;return(null==(e=this._timeline)?void 0:e.play())||new Promise(e=>e())}pause(){var e;null==(e=this._timeline)||e.pause()}load(){}endOfStream(){var e;this.__currentTime&&(Ve.log("endofstream called!"),null==(e=this._timeline)||e.emit(_e.DO_ENDOFSTREAM))}_updateVideoPostion(){var e;this.containerLayout&&(null==(e=this._timeline)||e.emit(_e.UPDATE_VIDEO_FILLTYPE,this.objectFit,this.containerLayout))}appendBuffer(e,t){if(this._timeline&&!this._err){if("hevc"!==e.codecType)return this._err=new ke(Ce.ONLY_SUPPORT_HEVC,"not hevc codec type"),void this._innerDispatchEvent("error",this._err);if(!e.duration||!t.duration)return this._err=new ke(Ce.ONLY_SUPPORT_AVEXIST,"video or audio not exist"),void this._innerDispatchEvent("error",this._err);e.formatTimescale&&e.samples.forEach(t=>{t.dts=Math.floor(t.dts/e.formatTimescale*1e3),t.pts=Math.floor(t.pts/e.formatTimescale*1e3)}),t.formatTimescale&&t.samples.forEach(e=>{e.dts=Math.floor(e.dts/t.formatTimescale*1e3),e.pts=Math.floor(e.pts/t.formatTimescale*1e3)}),this._timeline.appendBuffer(e,t)}}_innerDispatchEvent(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))}destroy(){this._timeline&&(Ve.log("call destroy"),this._timeline.emit(_e.DESTROY),this._timeline=null,this._err=null)}mockError(){var e;null==(e=this._timeline)||e.emit(_e.PLAY_EVENT,fe.ERROR,new ke(Ce.MOCK_ERROR,"mock error"))}mockWarning(){var e;null==(e=this._timeline)||e.emit(_e.PLAY_EVENT,fe.WARING,new Te(Ee.MOCK_WARNING,"mock warning"))}get autoplay(){return"true"===this.getAttribute("autoplay")}set autoplay(e){this.setAttribute("autoplay",e)}get loop(){return"loop"===this.getAttribute("loop")}set loop(e){var t;null==(t=this._timeline)||t.emit(_e.SET_LOOP,e),e?this.setAttribute("loop","loop"):this.removeAttribute("loop")}get __canvas(){var e;return null==(e=this._timeline)?void 0:e.canvas}get __ended(){var e;return null==(e=this.audioMedia)?void 0:e.ended}get __videoWidth(){var e;return(null==(e=this.__canvas)?void 0:e.width)||0}get __videoHeight(){var e;return(null==(e=this.__canvas)?void 0:e.height)||0}get __volume(){return Number(this.getAttribute("volume"))}set __volume(e){var t;e<=0&&(e=0),e>=1&&(e=1),this.setAttribute("volume",e),!this.__muted&&(null==(t=this._timeline)||t.emit(_e.UPDATE_VOLUME,e))}get __muted(){return"true"===this.getAttribute("muted")}set __muted(e){var t;this.setAttribute("muted",e),null==(t=this._timeline)||t.emit(_e.UPDATE_VOLUME,e?0:this.__volume)}get __currentTime(){if(!this._timeline)return 0;const e=this._timeline.currentTime,t=this._timeline.duration;return Math.min(e,t)}set __currentTime(e){this._seek(e)}_seek(e){this._seekTimer&&clearTimeout(this._seekTimer),this._seekTimer=setTimeout(()=>{var t;Ve.warn("seek to:",e),null==(t=this._timeline)||t.seek(Number(e))},100)}get __duration(){var e;return(null==(e=this.audioMedia)?void 0:e.duration)||0}get __seeking(){var e;return(null==(e=this.audioMedia)?void 0:e.seeking)||!1}get __paused(){var e;return null==(e=this.audioMedia)?void 0:e.paused}get __readyState(){var e;return(null==(e=this.audioMedia)?void 0:e.readyState)||0}get __buffered(){var e;return(null==(e=this.audioMedia)?void 0:e.buffered)||{length:0}}get __played(){var e;return null==(e=this.audioMedia)?void 0:e.played}get objectFit(){return this.getAttribute("object-fit")}set objectFit(e){this.setAttribute("object-fit",e),this._updateVideoPostion()}get src(){return this.getAttribute("src")||""}get currentSrc(){return this.getAttribute("src")||""}set src(e){var t;Ve.log("set src ",e),this.setAttribute("src",e),(!this._domConnected||null!=(t=this.__buffered)&&t.length)&&(this.destroy(),this._timeline||this._init()),this._innerDispatchEvent("loadstart")}set playbackRate(e){var t;this.setAttribute("playbackrate",e),null==(t=this._timeline)||t.emit(_e.SET_PLAYBACKRATE,e)}get playbackRate(){return parseFloat(this.getAttribute("playbackrate")||"1")}get networkState(){return 1}get preloadTime(){const e=this.getAttribute("preloadtime");if(e){const t=Number.parseFloat(e);if(t>0&&!Number.isNaN(t))return t}return 1/0}set preloadTime(e){e&&Number(e)>0&&this.setAttribute("preloadtime",e)}get __error(){return this._err}get containerLayout(){const e=this.parentNode;if(!e)return null;const t=e.parentNode;return t?null!=e&&e.clientWidth&&null!=e&&e.clientHeight?{width:null==e?void 0:e.clientWidth,height:null==e?void 0:e.clientHeight}:{width:null==t?void 0:t.clientWidth,height:(null==t?void 0:t.clientHeight)||0}:null}get audioMedia(){var e,t;return null==(t=null==(e=this._timeline)?void 0:e.audioRender)?void 0:t.media}getStats(){var e;if(this._tempEfficCache)return{...this._tempEfficCache};const t=null==(e=this._timeline)?void 0:e.efficInfo;return this._err?{...t,code:this._err.code,message:this._err.message}:this._warning?{...t,code:this._warning.code,message:this._warning.message}:t}};le(He,"workerUrl","");let Ge=He;try{typeof customElements<"u"&&(customElements.get((0,n.a)())||customElements.define((0,n.a)(),Ge))}catch{}},5227:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.5 7.50006V9.50006H28.5V7.50006H19.5ZM32.5 9.50006V6.00006C32.5 4.61935 31.3807 3.50006 30 3.50006H18C16.6193 3.50006 15.5 4.61935 15.5 6.00006V9.50006H7C6.44772 9.50006 6 9.94778 6 10.5001V12.5001C6 13.0523 6.44772 13.5001 7 13.5001H9.5V39.5001C9.5 41.7092 11.2909 43.5001 13.5 43.5001H34.5C36.7091 43.5001 38.5 41.7092 38.5 39.5001V13.5001H41C41.5523 13.5001 42 13.0523 42 12.5001V10.5001C42 9.94778 41.5523 9.50006 41 9.50006H32.5ZM34.5 13.5001H13.5V39.5001H34.5V13.5001ZM18.5 34.0001C17.9477 34.0001 17.5 33.5523 17.5 33.0001V20.0001C17.5 19.4478 17.9477 19.0001 18.5 19.0001H20.5C21.0523 19.0001 21.5 19.4478 21.5 20.0001V33.0001C21.5 33.5523 21.0523 34.0001 20.5 34.0001H18.5ZM27.5 34.0001C26.9477 34.0001 26.5 33.5523 26.5 33.0001V20.0001C26.5 19.4478 26.9477 19.0001 27.5 19.0001H29.5C30.0523 19.0001 30.5 19.4478 30.5 20.0001V33.0001C30.5 33.5523 30.0523 34.0001 29.5 34.0001H27.5Z"}))}},5406:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{clipPath:"url(#BubbleEllipsisRightFill_clip0)"},n.createElement("g",{opacity:"1",filter:"url(#BubbleEllipsisRightFill_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.0393 14.7137C17.75 13 18.75 11.215 18.75 9.13662C18.75 4.91897 14.8887 1.49997 10.125 1.49997C5.36129 1.49997 1.5 4.91897 1.5 9.13675C1.5 13.3545 5.48622 16.25 10.25 16.25V17.6487C10.25 18.0919 10.7095 18.3771 11.0992 18.1659C12.3166 17.5062 14.5725 16.183 16.0393 14.7137ZM5.93527 8.10679C6.61608 8.10679 7.16797 8.65471 7.16797 9.32962C7.16797 10.0059 6.61608 10.5538 5.93527 10.5538C5.2556 10.5538 4.70368 10.0059 4.70368 9.32962C4.70368 8.65471 5.2556 8.10679 5.93527 8.10679ZM11.3572 9.32962C11.3572 8.65471 10.8055 8.10679 10.125 8.10679C9.44459 8.10679 8.89289 8.65471 8.89289 9.32962C8.89292 10.0059 9.44462 10.5538 10.125 10.5538C10.8055 10.5538 11.3572 10.0059 11.3572 9.32962ZM14.3146 8.10679C14.9953 8.10679 15.5464 8.65471 15.5464 9.32962C15.5464 10.0059 14.9953 10.5538 14.3146 10.5538C13.6339 10.5538 13.082 10.0059 13.0821 9.32962C13.0821 8.65471 13.6339 8.10679 14.3146 8.10679Z"})),n.createElement("path",{opacity:"0.1",fillRule:"evenodd",clipRule:"evenodd",d:"M10.25 16.2499C10.25 16.2499 15.0278 15.8807 17.025 13.3234C15.0278 16.1364 13.0307 17.6708 11.2831 18.1822C9.53561 18.6937 10.25 16.2499 10.25 16.2499Z",fill:"url(#BubbleEllipsisRightFill_paint0_linear)"})),n.createElement("defs",null,n.createElement("filter",{id:"BubbleEllipsisRightFill_filter0_d",x:"0.5",y:"1.49997",width:"19.25",height:"18.737",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",{dy:"1"}),n.createElement("feGaussianBlur",{stdDeviation:"0.5"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})),n.createElement("linearGradient",{id:"BubbleEllipsisRightFill_paint0_linear",x1:"8.50426",y1:"15.6957",x2:"9.29499",y2:"18.1805",gradientUnits:"userSpaceOnUse"},n.createElement("stop",null),n.createElement("stop",{offset:"1",stopOpacity:"0.01"})),n.createElement("clipPath",{id:"BubbleEllipsisRightFill_clip0"},n.createElement("rect",{width:"20",height:"20",fill:"white"}))))}},5739:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C20.134 6 17 9.13401 17 13V17H31V13C31 9.13401 27.866 6 24 6ZM35 17V13C35 6.92487 30.0751 2 24 2C17.9249 2 13 6.92487 13 13V17H12C8.68629 17 6 19.6863 6 23V39C6 42.3137 8.68629 45 12 45H36C39.3137 45 42 42.3137 42 39V23C42 19.6863 39.3137 17 36 17H35ZM12 21C10.8954 21 10 21.8954 10 23V39C10 40.1046 10.8954 41 12 41H36C37.1046 41 38 40.1046 38 39V23C38 21.8954 37.1046 21 36 21H12ZM26 32.4649C27.1956 31.7733 28 30.4806 28 29C28 26.7909 26.2091 25 24 25C21.7909 25 20 26.7909 20 29C20 30.4806 20.8044 31.7733 22 32.4649V37C22 37.5523 22.4477 38 23 38H25C25.5523 38 26 37.5523 26 37V32.4649Z"}))}},6978:(e,t,r)=>{"use strict";r.d(t,{a:()=>i,f:()=>d,g:()=>l,i:()=>p,p:()=>f,s:()=>o,u:()=>a});let n="tt-video";function i(){return n}function o(e){n=e}let s={workerUrl:"",maxDecodeSize:200,sampleDtsLargetGap:100,powerfulDecodeFps:60,minDecodeFps:40,forbiddenDuration:6048e5,powerfulFFCost:800,powerfulRenderRate:.6,continuousLowDecodeTime:3e3};function a(e){s=Object.assign({},s,e)}function l(){return s}const c="s_forbi_v",u="s_forbi_t";function d(){try{localStorage.setItem(c,"1"),localStorage.setItem(u,Date.now()+"")}catch{}}let h=!1;try{h=WebAssembly&&WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))}catch{}function p(){return typeof CustomElementRegistry>"u"||typeof MediaSource>"u"?-1:h?!0===function(){let e=!1;try{if(e=!!localStorage.getItem(c),e){const t=Number(localStorage.getItem(u));Date.now()-t>l().forbiddenDuration&&(e=!1,localStorage.removeItem(c),localStorage.removeItem(u))}}catch{}return e}()?-3:1:-2}function f(e){return e?fetch(e).then(e=>e.ok).catch(()=>!1):Promise.resolve(!1)}},7713:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.5 9C13.0453 9 10.2347 11.8104 10.2347 15.2895C10.2347 18.7686 13.0453 21.5789 16.5 21.5789C19.9548 21.5789 22.7654 18.7686 22.7654 15.2895C22.7654 11.8104 19.9548 9 16.5 9ZM6.23468 15.2895C6.23468 9.61226 10.8251 5 16.5 5C22.1749 5 26.7654 9.61226 26.7654 15.2895C26.7654 20.9667 22.1749 25.5789 16.5 25.5789C10.8251 25.5789 6.23468 20.9667 6.23468 15.2895ZM35.5 16C33.4258 16 31.6837 17.7217 31.6837 19.9211C31.6837 22.1204 33.4258 23.8421 35.5 23.8421C37.5742 23.8421 39.3164 22.1204 39.3164 19.9211C39.3164 17.7217 37.5742 16 35.5 16ZM27.6837 19.9211C27.6837 15.5802 31.1497 12 35.5 12C39.8504 12 43.3164 15.5802 43.3164 19.9211C43.3164 24.2619 39.8504 27.8421 35.5 27.8421C31.1497 27.8421 27.6837 24.2619 27.6837 19.9211ZM16.5 32.9474C11.1565 32.9474 6.63553 36.522 5.20008 41.4261C5.04493 41.9561 4.52145 42.3079 3.98014 42.1984L2.01989 41.8016C1.47858 41.6921 1.12554 41.1628 1.26924 40.6295C3.08188 33.903 9.20882 28.9474 16.5 28.9474C23.7912 28.9474 29.9182 33.903 31.7308 40.6295C31.8745 41.1628 31.5215 41.6921 30.9801 41.8016L29.0199 42.1984C28.4786 42.3079 27.9551 41.9561 27.8 41.4261C26.3645 36.522 21.8436 32.9474 16.5 32.9474ZM34.5 35.1053C33.4444 35.1053 32.5679 35.2479 31.8346 35.4841C31.3089 35.6534 30.7069 35.4655 30.4554 34.9738L29.5446 33.1932C29.2931 32.7016 29.4865 32.0943 30.0008 31.893C31.3208 31.3762 32.8181 31.1053 34.5 31.1053C38.1911 31.1053 40.9031 32.4146 42.7838 34.5371C44.3511 36.3059 45.2273 38.5107 45.7455 40.6327C45.8765 41.1692 45.5223 41.6964 44.9807 41.8044L43.0193 42.1955C42.4777 42.3036 41.9545 41.951 41.8182 41.4158C41.3885 39.7287 40.7439 38.2663 39.79 37.1899C38.7278 35.9911 37.1389 35.1053 34.5 35.1053Z"}))}},7751:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.9999 7C15.6862 7 12.9999 9.68629 12.9999 13C12.9999 16.3137 15.6862 19 18.9999 19C22.3136 19 24.9999 16.3137 24.9999 13C24.9999 9.68629 22.3136 7 18.9999 7ZM8.9999 13C8.9999 7.47715 13.4771 3 18.9999 3C24.5228 3 28.9999 7.47715 28.9999 13C28.9999 18.5228 24.5228 23 18.9999 23C13.4771 23 8.9999 18.5228 8.9999 13ZM13.9159 30.738C10.0883 32.2352 6.70127 35.5144 5.19411 40.9681C5.047 41.5004 4.51432 41.8408 3.97551 41.7195L2.0243 41.2805C1.48549 41.1592 1.14514 40.6222 1.28805 40.0887C3.09315 33.3505 7.37401 29.0018 12.4589 27.0129C17.4031 25.0789 23.0153 25.4139 27.6381 27.7937C28.1292 28.0465 28.287 28.662 28.0069 29.1381L26.9929 30.8619C26.7129 31.338 26.1013 31.4934 25.6062 31.2486C22.0356 29.4832 17.7123 29.2531 13.9159 30.738ZM39.832 28.4453C40.2915 28.1389 40.9124 28.2631 41.2187 28.7227L44.664 33.8906C45.0731 34.5043 45.1113 35.2934 44.7633 35.9437C44.4152 36.594 43.7375 37 42.9999 37H27.9999C27.4476 37 26.9999 36.5523 26.9999 36V34C26.9999 33.4477 27.4476 33 27.9999 33H39.2629L37.8905 30.9415C37.5842 30.4819 37.7083 29.8611 38.1679 29.5547L39.832 28.4453ZM27.2366 40.0563C27.5846 39.406 28.2623 39 28.9999 39H43.9999C44.5522 39 44.9999 39.4477 44.9999 40V42C44.9999 42.5523 44.5522 43 43.9999 43H32.7369L34.1093 45.0585C34.4157 45.5181 34.2915 46.1389 33.832 46.4453L32.1679 47.5547C31.7083 47.8611 31.0875 47.7369 30.7811 47.2774L27.3358 42.1094C26.9267 41.4957 26.8885 40.7066 27.2366 40.0563Z"}))}},10594:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24Z",fill:"#FE2C55"}),n.createElement("path",{d:"M11.3028 15.2151C10.4934 16.0245 9.30444 16.016 8.6442 15.3557C7.98397 14.6955 7.97544 13.5065 8.78485 12.6971C9.06049 12.4215 9.06049 11.9745 8.78485 11.6989C8.5092 11.4232 8.06229 11.4232 7.78665 11.6989C6.49952 12.9861 6.36369 15.0716 7.646 16.354C8.92832 17.6363 11.0138 17.5005 12.301 16.2133L13.3248 15.1895C14.4068 14.1075 14.6713 12.4803 13.9787 11.2183C13.7911 10.8765 13.3621 10.7515 13.0203 10.9391C12.6786 11.1267 12.5536 11.5557 12.7412 11.8975C13.1094 12.5685 12.9986 13.5192 12.3266 14.1913L11.3028 15.2151ZM12.6972 8.7849C13.5066 7.97548 14.6956 7.984 15.3558 8.64425C16.016 9.30451 16.0246 10.4935 15.2152 11.3029C14.9395 11.5785 14.9395 12.0255 15.2152 12.3011C15.4908 12.5768 15.9377 12.5768 16.2134 12.3011C17.5005 11.0139 17.6363 8.92838 16.354 7.64603C15.0717 6.36368 12.9862 6.49951 11.699 7.78668L10.6752 8.8105C9.59325 9.89253 9.3287 11.5197 10.0213 12.7817C10.2089 13.1235 10.6379 13.2485 10.9797 13.0609C11.3214 12.8733 11.4464 12.4442 11.2588 12.1025C10.8906 11.4315 11.0014 10.4808 11.6734 9.80873L12.6972 8.7849ZM13.0336 12.6277C13.0186 12.3531 12.9459 12.0887 12.8178 11.8554C12.7737 11.7749 12.7493 11.6889 12.743 11.6029C12.7493 11.6889 12.7736 11.7749 12.8178 11.8554C12.9459 12.0888 13.0186 12.3531 13.0336 12.6277ZM13.2629 15.1276L12.2391 16.1514C10.9813 17.4093 8.95136 17.5356 7.70785 16.2921C7.11888 15.7031 6.83721 14.9377 6.8375 14.1615C6.8372 14.9377 7.11887 15.7031 7.70785 16.2921C8.95136 17.5357 10.9813 17.4093 12.2391 16.1515L13.2629 15.1277C13.8201 14.5704 14.1544 13.8662 14.2473 13.1452C14.1544 13.8661 13.8201 14.5704 13.2629 15.1276ZM8.90341 12.2276C8.89633 12.3759 8.8362 12.522 8.723 12.6352C8.28443 13.0738 8.07511 13.623 8.07481 14.147C8.07512 13.623 8.28444 13.0739 8.723 12.6353C8.83621 12.5221 8.89635 12.3759 8.90341 12.2276ZM12.6354 8.72306C13.4748 7.88361 14.7193 7.88401 15.4176 8.58241C15.6813 8.84604 15.8454 9.18748 15.9025 9.55557C15.8454 9.18746 15.6813 8.846 15.4176 8.58236C14.7193 7.88396 13.4748 7.88356 12.6354 8.72301L11.6116 9.74684C11.1715 10.1869 10.9613 10.7444 10.9635 11.2737C10.9613 10.7445 11.1715 10.187 11.6116 9.74689L12.6354 8.72306ZM11.2573 12.4817C11.244 12.6856 11.13 12.8786 10.9376 12.9842C10.6382 13.1485 10.2623 13.039 10.098 12.7396C9.88489 12.3514 9.76492 11.927 9.73407 11.4947C9.76493 11.9269 9.8849 12.3513 10.098 12.7396C10.2623 13.039 10.6382 13.1485 10.9376 12.9842C11.13 12.8786 11.244 12.6856 11.2573 12.4817ZM15.1103 11.9351C15.1348 12.0466 15.1903 12.1526 15.277 12.2393C15.5185 12.4808 15.91 12.4808 16.1515 12.2393C16.7 11.6908 17.0333 10.9955 17.1317 10.2827C17.0333 10.9955 16.6999 11.6908 16.1515 12.2392C15.91 12.4807 15.5185 12.4807 15.277 12.2392C15.1903 12.1526 15.1348 12.0466 15.1103 11.9351Z",fill:"white"}))}},10819:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.0781 7.17931C27.8285 6.68664 28.0244 6.08056 28.5358 5.87203C32.9356 4.07795 37.8765 5.08837 41.327 8.56047C46.2243 13.4886 46.2243 21.4734 41.327 26.4016L25.4186 42.4098C25.0432 42.7875 24.5326 43 24 43C23.4674 43 22.9568 42.7875 22.5814 42.4098L6.67302 26.4016C1.77566 21.4734 1.77566 13.4886 6.67302 8.56047C10.9346 4.27215 17.4319 3.76529 22.3657 7.54239C22.9025 7.95332 23.1954 8.6076 23.1443 9.28168L22.7627 14.3135L26.4527 16.5237C27.308 17.036 27.6554 18.1 27.2671 19.0183L25.2232 23.853L26.7562 26.8747C27.0061 27.3673 26.8093 27.9691 26.3168 28.219L24.5332 29.1238C24.0407 29.3737 23.4388 29.1769 23.189 28.6844L21.2358 24.8344C20.9694 24.3092 20.948 23.6933 21.1773 23.1508L22.9059 19.062L19.6473 17.1102C18.9976 16.721 18.6235 15.9983 18.6807 15.2432L19.0683 10.1318C15.8928 8.24443 12.1181 8.75584 9.51028 11.38C6.16324 14.7481 6.16324 20.2139 9.51028 23.582L24 38.1627L38.4897 23.582C41.8368 20.2139 41.8368 14.7481 38.4897 11.38C36.2471 9.1233 33.1639 8.44509 30.3515 9.45892C29.832 9.64621 29.2316 9.45607 28.982 8.96341L28.0781 7.17931Z"}))}},12527:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.58579 22.5858L20.8787 6.29289C21.2692 5.90237 21.9024 5.90237 22.2929 6.29289L23.7071 7.70711C24.0976 8.09763 24.0976 8.7308 23.7071 9.12132L8.82843 24L23.7071 38.8787C24.0976 39.2692 24.0976 39.9024 23.7071 40.2929L22.2929 41.7071C21.9024 42.0976 21.2692 42.0976 20.8787 41.7071L4.58579 25.4142C3.80474 24.6332 3.80474 23.3668 4.58579 22.5858Z"}))}},12861:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ErrorType:()=>ErrorType,EventEmitter:()=>EventEmitter,InitResult:()=>InitResult,Long:()=>json_long__WEBPACK_IMPORTED_MODULE_1___default.a,SdkConsts:()=>SdkConsts,SyncEvent:()=>SyncEvent,SyncSdk:()=>SyncSdk,SyncSocket:()=>SyncSocket,applyDefault:()=>applyDefault,applyDefaultBoe:()=>applyDefaultBoe,getFrontierURL:()=>getFrontierURL,md5:()=>js_md5__WEBPACK_IMPORTED_MODULE_0___default.a,optionCheck:()=>optionCheck,queryStringify:()=>queryStringify,uint8array2string:()=>uint8array2string});var js_md5__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(87378),js_md5__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(js_md5__WEBPACK_IMPORTED_MODULE_0__),json_long__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(34531),json_long__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(json_long__WEBPACK_IMPORTED_MODULE_1__),long__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(71031),tslib__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(72516),axios__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(84650),axios__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_3__),lodash__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(36613),lodash__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_4__),dexie__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(63137),pako__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(94341);function _mergeNamespaces(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(r){if("default"!==r&&!(r in e)){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}})}),Object.freeze(e)}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fails$s=function(e){try{return!!e()}catch(e){return!0}},fails$r=fails$s,functionBindNative=!fails$r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),NATIVE_BIND$4=functionBindNative,FunctionPrototype$3=Function.prototype,bind$r=FunctionPrototype$3.bind,call$u=FunctionPrototype$3.call,uncurryThis$s=NATIVE_BIND$4&&bind$r.bind(call$u,call$u),functionUncurryThis=NATIVE_BIND$4?function(e){return e&&uncurryThis$s(e)}:function(e){return e&&function(){return call$u.apply(e,arguments)}},uncurryThis$r=functionUncurryThis,objectIsPrototypeOf=uncurryThis$r({}.isPrototypeOf),check=function(e){return e&&e.Math==Math&&e},global$p=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof commonjsGlobal&&commonjsGlobal)||function(){return this}()||Function("return this")(),NATIVE_BIND$3=functionBindNative,FunctionPrototype$2=Function.prototype,apply$6=FunctionPrototype$2.apply,call$t=FunctionPrototype$2.call,functionApply="object"==typeof Reflect&&Reflect.apply||(NATIVE_BIND$3?call$t.bind(apply$6):function(){return call$t.apply(apply$6,arguments)}),isCallable$m=function(e){return"function"==typeof e},objectGetOwnPropertyDescriptor={},fails$q=fails$s,descriptors=!fails$q(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),NATIVE_BIND$2=functionBindNative,call$s=Function.prototype.call,functionCall=NATIVE_BIND$2?call$s.bind(call$s):function(){return call$s.apply(call$s,arguments)},objectPropertyIsEnumerable={},$propertyIsEnumerable$2={}.propertyIsEnumerable,getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor$2&&!$propertyIsEnumerable$2.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(e){var t=getOwnPropertyDescriptor$2(this,e);return!!t&&t.enumerable}:$propertyIsEnumerable$2;var createPropertyDescriptor$7=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},uncurryThis$q=functionUncurryThis,toString$8=uncurryThis$q({}.toString),stringSlice$1=uncurryThis$q("".slice),classofRaw$1=function(e){return stringSlice$1(toString$8(e),8,-1)},uncurryThis$p=functionUncurryThis,fails$p=fails$s,classof$c=classofRaw$1,$Object$4=Object,split=uncurryThis$p("".split),indexedObject=fails$p(function(){return!$Object$4("z").propertyIsEnumerable(0)})?function(e){return"String"==classof$c(e)?split(e,""):$Object$4(e)}:$Object$4,$TypeError$g=TypeError,requireObjectCoercible$4=function(e){if(null==e)throw $TypeError$g("Can't call method on "+e);return e},IndexedObject$2=indexedObject,requireObjectCoercible$3=requireObjectCoercible$4,toIndexedObject$9=function(e){return IndexedObject$2(requireObjectCoercible$3(e))},isCallable$l=isCallable$m,isObject$i=function(e){return"object"==typeof e?null!==e:isCallable$l(e)},path$l={},path$k=path$l,global$o=global$p,isCallable$k=isCallable$m,aFunction=function(e){return isCallable$k(e)?e:void 0},getBuiltIn$h=function(e,t){return arguments.length<2?aFunction(path$k[e])||aFunction(global$o[e]):path$k[e]&&path$k[e][t]||global$o[e]&&global$o[e][t]},getBuiltIn$g=getBuiltIn$h,engineUserAgent=getBuiltIn$g("navigator","userAgent")||"",global$n=global$p,userAgent$4=engineUserAgent,process$3=global$n.process,Deno$1=global$n.Deno,versions=process$3&&process$3.versions||Deno$1&&Deno$1.version,v8=versions&&versions.v8,match,version;v8&&(match=v8.split("."),version=match[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version&&userAgent$4&&(match=userAgent$4.match(/Edge\/(\d+)/),(!match||match[1]>=74)&&(match=userAgent$4.match(/Chrome\/(\d+)/),match&&(version=+match[1])));var engineV8Version=version,V8_VERSION$3=engineV8Version,fails$o=fails$s,nativeSymbol=!!Object.getOwnPropertySymbols&&!fails$o(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&V8_VERSION$3&&V8_VERSION$3<41}),NATIVE_SYMBOL$5=nativeSymbol,useSymbolAsUid=NATIVE_SYMBOL$5&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,getBuiltIn$f=getBuiltIn$h,isCallable$j=isCallable$m,isPrototypeOf$e=objectIsPrototypeOf,USE_SYMBOL_AS_UID$1=useSymbolAsUid,$Object$3=Object,isSymbol$4=USE_SYMBOL_AS_UID$1?function(e){return"symbol"==typeof e}:function(e){var t=getBuiltIn$f("Symbol");return isCallable$j(t)&&isPrototypeOf$e(t.prototype,$Object$3(e))},$String$3=String,tryToString$5=function(e){try{return $String$3(e)}catch(e){return"Object"}},isCallable$i=isCallable$m,tryToString$4=tryToString$5,$TypeError$f=TypeError,aCallable$m=function(e){if(isCallable$i(e))return e;throw $TypeError$f(tryToString$4(e)+" is not a function")},aCallable$l=aCallable$m,getMethod$3=function(e,t){var r=e[t];return null==r?void 0:aCallable$l(r)},call$r=functionCall,isCallable$h=isCallable$m,isObject$h=isObject$i,$TypeError$e=TypeError,ordinaryToPrimitive$1=function(e,t){var r,n;if("string"===t&&isCallable$h(r=e.toString)&&!isObject$h(n=call$r(r,e)))return n;if(isCallable$h(r=e.valueOf)&&!isObject$h(n=call$r(r,e)))return n;if("string"!==t&&isCallable$h(r=e.toString)&&!isObject$h(n=call$r(r,e)))return n;throw $TypeError$e("Can't convert object to primitive value")},shared$6={exports:{}},isPure=!0,global$m=global$p,defineProperty$f=Object.defineProperty,defineGlobalProperty$1=function(e,t){try{defineProperty$f(global$m,e,{value:t,configurable:!0,writable:!0})}catch(r){global$m[e]=t}return t},global$l=global$p,defineGlobalProperty=defineGlobalProperty$1,SHARED="__core-js_shared__",store$3=global$l[SHARED]||defineGlobalProperty(SHARED,{}),sharedStore=store$3,store$2=sharedStore;(shared$6.exports=function(e,t){return store$2[e]||(store$2[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.24.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.0/LICENSE",source:"https://github.com/zloirock/core-js"});var requireObjectCoercible$2=requireObjectCoercible$4,$Object$2=Object,toObject$9=function(e){return $Object$2(requireObjectCoercible$2(e))},uncurryThis$o=functionUncurryThis,toObject$8=toObject$9,hasOwnProperty=uncurryThis$o({}.hasOwnProperty),hasOwnProperty_1=Object.hasOwn||function(e,t){return hasOwnProperty(toObject$8(e),t)},uncurryThis$n=functionUncurryThis,id$1=0,postfix=Math.random(),toString$7=uncurryThis$n(1..toString),uid$4=function(e){return"Symbol("+(void 0===e?"":e)+")_"+toString$7(++id$1+postfix,36)},global$k=global$p,shared$5=shared$6.exports,hasOwn$g=hasOwnProperty_1,uid$3=uid$4,NATIVE_SYMBOL$4=nativeSymbol,USE_SYMBOL_AS_UID=useSymbolAsUid,WellKnownSymbolsStore$1=shared$5("wks"),Symbol$1=global$k.Symbol,symbolFor=Symbol$1&&Symbol$1.for,createWellKnownSymbol=USE_SYMBOL_AS_UID?Symbol$1:Symbol$1&&Symbol$1.withoutSetter||uid$3,wellKnownSymbol$n=function(e){if(!hasOwn$g(WellKnownSymbolsStore$1,e)||!NATIVE_SYMBOL$4&&"string"!=typeof WellKnownSymbolsStore$1[e]){var t="Symbol."+e;NATIVE_SYMBOL$4&&hasOwn$g(Symbol$1,e)?WellKnownSymbolsStore$1[e]=Symbol$1[e]:WellKnownSymbolsStore$1[e]=USE_SYMBOL_AS_UID&&symbolFor?symbolFor(t):createWellKnownSymbol(t)}return WellKnownSymbolsStore$1[e]},call$q=functionCall,isObject$g=isObject$i,isSymbol$3=isSymbol$4,getMethod$2=getMethod$3,ordinaryToPrimitive=ordinaryToPrimitive$1,wellKnownSymbol$m=wellKnownSymbol$n,$TypeError$d=TypeError,TO_PRIMITIVE=wellKnownSymbol$m("toPrimitive"),toPrimitive$1=function(e,t){if(!isObject$g(e)||isSymbol$3(e))return e;var r,n=getMethod$2(e,TO_PRIMITIVE);if(n){if(void 0===t&&(t="default"),r=call$q(n,e,t),!isObject$g(r)||isSymbol$3(r))return r;throw $TypeError$d("Can't convert object to primitive value")}return void 0===t&&(t="number"),ordinaryToPrimitive(e,t)},toPrimitive=toPrimitive$1,isSymbol$2=isSymbol$4,toPropertyKey$4=function(e){var t=toPrimitive(e,"string");return isSymbol$2(t)?t:t+""},global$j=global$p,isObject$f=isObject$i,document$3=global$j.document,EXISTS$1=isObject$f(document$3)&&isObject$f(document$3.createElement),documentCreateElement$1=function(e){return EXISTS$1?document$3.createElement(e):{}},DESCRIPTORS$e=descriptors,fails$n=fails$s,createElement$1=documentCreateElement$1,ie8DomDefine=!DESCRIPTORS$e&&!fails$n(function(){return 7!=Object.defineProperty(createElement$1("div"),"a",{get:function(){return 7}}).a}),DESCRIPTORS$d=descriptors,call$p=functionCall,propertyIsEnumerableModule$2=objectPropertyIsEnumerable,createPropertyDescriptor$6=createPropertyDescriptor$7,toIndexedObject$8=toIndexedObject$9,toPropertyKey$3=toPropertyKey$4,hasOwn$f=hasOwnProperty_1,IE8_DOM_DEFINE$1=ie8DomDefine,$getOwnPropertyDescriptor$2=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$d?$getOwnPropertyDescriptor$2:function(e,t){if(e=toIndexedObject$8(e),t=toPropertyKey$3(t),IE8_DOM_DEFINE$1)try{return $getOwnPropertyDescriptor$2(e,t)}catch(e){}if(hasOwn$f(e,t))return createPropertyDescriptor$6(!call$p(propertyIsEnumerableModule$2.f,e,t),e[t])};var fails$m=fails$s,isCallable$g=isCallable$m,replacement=/#|\.prototype\./,isForced$2=function(e,t){var r=data[normalize(e)];return r==POLYFILL||r!=NATIVE&&(isCallable$g(t)?fails$m(t):!!t)},normalize=isForced$2.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced$2.data={},NATIVE=isForced$2.NATIVE="N",POLYFILL=isForced$2.POLYFILL="P",isForced_1=isForced$2,uncurryThis$m=functionUncurryThis,aCallable$k=aCallable$m,NATIVE_BIND$1=functionBindNative,bind$q=uncurryThis$m(uncurryThis$m.bind),functionBindContext=function(e,t){return aCallable$k(e),void 0===t?e:NATIVE_BIND$1?bind$q(e,t):function(){return e.apply(t,arguments)}},objectDefineProperty={},DESCRIPTORS$c=descriptors,fails$l=fails$s,v8PrototypeDefineBug=DESCRIPTORS$c&&fails$l(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),isObject$e=isObject$i,$String$2=String,$TypeError$c=TypeError,anObject$s=function(e){if(isObject$e(e))return e;throw $TypeError$c($String$2(e)+" is not an object")},DESCRIPTORS$b=descriptors,IE8_DOM_DEFINE=ie8DomDefine,V8_PROTOTYPE_DEFINE_BUG$1=v8PrototypeDefineBug,anObject$r=anObject$s,toPropertyKey$2=toPropertyKey$4,$TypeError$b=TypeError,$defineProperty$1=Object.defineProperty,$getOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,ENUMERABLE="enumerable",CONFIGURABLE$1="configurable",WRITABLE="writable";objectDefineProperty.f=DESCRIPTORS$b?V8_PROTOTYPE_DEFINE_BUG$1?function(e,t,r){if(anObject$r(e),t=toPropertyKey$2(t),anObject$r(r),"function"==typeof e&&"prototype"===t&&"value"in r&&WRITABLE in r&&!r[WRITABLE]){var n=$getOwnPropertyDescriptor$1(e,t);n&&n[WRITABLE]&&(e[t]=r.value,r={configurable:CONFIGURABLE$1 in r?r[CONFIGURABLE$1]:n[CONFIGURABLE$1],enumerable:ENUMERABLE in r?r[ENUMERABLE]:n[ENUMERABLE],writable:!1})}return $defineProperty$1(e,t,r)}:$defineProperty$1:function(e,t,r){if(anObject$r(e),t=toPropertyKey$2(t),anObject$r(r),IE8_DOM_DEFINE)try{return $defineProperty$1(e,t,r)}catch(e){}if("get"in r||"set"in r)throw $TypeError$b("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var DESCRIPTORS$a=descriptors,definePropertyModule$5=objectDefineProperty,createPropertyDescriptor$5=createPropertyDescriptor$7,createNonEnumerableProperty$8=DESCRIPTORS$a?function(e,t,r){return definePropertyModule$5.f(e,t,createPropertyDescriptor$5(1,r))}:function(e,t,r){return e[t]=r,e},global$i=global$p,apply$5=functionApply,uncurryThis$l=functionUncurryThis,isCallable$f=isCallable$m,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,isForced$1=isForced_1,path$j=path$l,bind$p=functionBindContext,createNonEnumerableProperty$7=createNonEnumerableProperty$8,hasOwn$e=hasOwnProperty_1,wrapConstructor=function(e){var t=function(r,n,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,i)}return apply$5(e,this,arguments)};return t.prototype=e.prototype,t},_export=function(e,t){var r,n,i,o,s,a,l,c,u=e.target,d=e.global,h=e.stat,p=e.proto,f=d?global$i:h?global$i[u]:(global$i[u]||{}).prototype,_=d?path$j:path$j[u]||createNonEnumerableProperty$7(path$j,u,{})[u],y=_.prototype;for(i in t)r=!isForced$1(d?i:u+(h?".":"#")+i,e.forced)&&f&&hasOwn$e(f,i),s=_[i],r&&(a=e.dontCallGetSet?(c=getOwnPropertyDescriptor$1(f,i))&&c.value:f[i]),o=r&&a?a:t[i],r&&typeof s==typeof o||(l=e.bind&&r?bind$p(o,global$i):e.wrap&&r?wrapConstructor(o):p&&isCallable$f(o)?uncurryThis$l(o):o,(e.sham||o&&o.sham||s&&s.sham)&&createNonEnumerableProperty$7(l,"sham",!0),createNonEnumerableProperty$7(_,i,l),p&&(hasOwn$e(path$j,n=u+"Prototype")||createNonEnumerableProperty$7(path$j,n,{}),createNonEnumerableProperty$7(path$j[n],i,o),e.real&&y&&!y[i]&&createNonEnumerableProperty$7(y,i,o)))},classof$b=classofRaw$1,isArray$d=Array.isArray||function(e){return"Array"==classof$b(e)},ceil=Math.ceil,floor=Math.floor,mathTrunc=Math.trunc||function(e){var t=+e;return(t>0?floor:ceil)(t)},trunc=mathTrunc,toIntegerOrInfinity$3=function(e){var t=+e;return t!=t||0===t?0:trunc(t)},toIntegerOrInfinity$2=toIntegerOrInfinity$3,min$1=Math.min,toLength$1=function(e){return e>0?min$1(toIntegerOrInfinity$2(e),9007199254740991):0},toLength=toLength$1,lengthOfArrayLike$7=function(e){return toLength(e.length)},$TypeError$a=TypeError,MAX_SAFE_INTEGER=9007199254740991,doesNotExceedSafeInteger$1=function(e){if(e>MAX_SAFE_INTEGER)throw $TypeError$a("Maximum allowed index exceeded");return e},toPropertyKey$1=toPropertyKey$4,definePropertyModule$4=objectDefineProperty,createPropertyDescriptor$4=createPropertyDescriptor$7,createProperty$4=function(e,t,r){var n=toPropertyKey$1(t);n in e?definePropertyModule$4.f(e,n,createPropertyDescriptor$4(0,r)):e[n]=r},wellKnownSymbol$l=wellKnownSymbol$n,TO_STRING_TAG$4=wellKnownSymbol$l("toStringTag"),test$1={};test$1[TO_STRING_TAG$4]="z";var toStringTagSupport="[object z]"===String(test$1),TO_STRING_TAG_SUPPORT$2=toStringTagSupport,isCallable$e=isCallable$m,classofRaw=classofRaw$1,wellKnownSymbol$k=wellKnownSymbol$n,TO_STRING_TAG$3=wellKnownSymbol$k("toStringTag"),$Object$1=Object,CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}()),tryGet=function(e,t){try{return e[t]}catch(e){}},classof$a=TO_STRING_TAG_SUPPORT$2?classofRaw:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=tryGet(t=$Object$1(e),TO_STRING_TAG$3))?r:CORRECT_ARGUMENTS?classofRaw(t):"Object"==(n=classofRaw(t))&&isCallable$e(t.callee)?"Arguments":n},uncurryThis$k=functionUncurryThis,isCallable$d=isCallable$m,store$1=sharedStore,functionToString=uncurryThis$k(Function.toString);isCallable$d(store$1.inspectSource)||(store$1.inspectSource=function(e){return functionToString(e)});var inspectSource$3=store$1.inspectSource,uncurryThis$j=functionUncurryThis,fails$k=fails$s,isCallable$c=isCallable$m,classof$9=classof$a,getBuiltIn$e=getBuiltIn$h,inspectSource$2=inspectSource$3,noop$1=function(){},empty=[],construct$7=getBuiltIn$e("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec$1=uncurryThis$j(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.exec(noop$1),isConstructorModern=function(e){if(!isCallable$c(e))return!1;try{return construct$7(noop$1,empty,e),!0}catch(e){return!1}},isConstructorLegacy=function(e){if(!isCallable$c(e))return!1;switch(classof$9(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec$1(constructorRegExp,inspectSource$2(e))}catch(e){return!0}};isConstructorLegacy.sham=!0;var isConstructor$4=!construct$7||fails$k(function(){var e;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern(function(){e=!0})||e})?isConstructorLegacy:isConstructorModern,isArray$c=isArray$d,isConstructor$3=isConstructor$4,isObject$d=isObject$i,wellKnownSymbol$j=wellKnownSymbol$n,SPECIES$5=wellKnownSymbol$j("species"),$Array$3=Array,arraySpeciesConstructor$1=function(e){var t;return isArray$c(e)&&(t=e.constructor,(isConstructor$3(t)&&(t===$Array$3||isArray$c(t.prototype))||isObject$d(t)&&null===(t=t[SPECIES$5]))&&(t=void 0)),void 0===t?$Array$3:t},arraySpeciesConstructor=arraySpeciesConstructor$1,arraySpeciesCreate$2=function(e,t){return new(arraySpeciesConstructor(e))(0===t?0:t)},fails$j=fails$s,wellKnownSymbol$i=wellKnownSymbol$n,V8_VERSION$2=engineV8Version,SPECIES$4=wellKnownSymbol$i("species"),arrayMethodHasSpeciesSupport$4=function(e){return V8_VERSION$2>=51||!fails$j(function(){var t=[];return(t.constructor={})[SPECIES$4]=function(){return{foo:1}},1!==t[e](Boolean).foo})},$$_=_export,fails$i=fails$s,isArray$b=isArray$d,isObject$c=isObject$i,toObject$7=toObject$9,lengthOfArrayLike$6=lengthOfArrayLike$7,doesNotExceedSafeInteger=doesNotExceedSafeInteger$1,createProperty$3=createProperty$4,arraySpeciesCreate$1=arraySpeciesCreate$2,arrayMethodHasSpeciesSupport$3=arrayMethodHasSpeciesSupport$4,wellKnownSymbol$h=wellKnownSymbol$n,V8_VERSION$1=engineV8Version,IS_CONCAT_SPREADABLE=wellKnownSymbol$h("isConcatSpreadable"),IS_CONCAT_SPREADABLE_SUPPORT=V8_VERSION$1>=51||!fails$i(function(){var e=[];return e[IS_CONCAT_SPREADABLE]=!1,e.concat()[0]!==e}),SPECIES_SUPPORT=arrayMethodHasSpeciesSupport$3("concat"),isConcatSpreadable=function(e){if(!isObject$c(e))return!1;var t=e[IS_CONCAT_SPREADABLE];return void 0!==t?!!t:isArray$b(e)},FORCED$2=!IS_CONCAT_SPREADABLE_SUPPORT||!SPECIES_SUPPORT;$$_({target:"Array",proto:!0,arity:1,forced:FORCED$2},{concat:function(e){var t,r,n,i,o,s=toObject$7(this),a=arraySpeciesCreate$1(s,0),l=0;for(t=-1,n=arguments.length;t<n;t++)if(isConcatSpreadable(o=-1===t?s:arguments[t]))for(i=lengthOfArrayLike$6(o),doesNotExceedSafeInteger(l+i),r=0;r<i;r++,l++)r in o&&createProperty$3(a,l,o[r]);else doesNotExceedSafeInteger(l+1),createProperty$3(a,l++,o);return a.length=l,a}});var path$i=path$l,entryVirtual$b=function(e){return path$i[e+"Prototype"]},entryVirtual$a=entryVirtual$b,concat$6=entryVirtual$a("Array").concat,isPrototypeOf$d=objectIsPrototypeOf,method$8=concat$6,ArrayPrototype$9=Array.prototype,concat$5=function(e){var t=e.concat;return e===ArrayPrototype$9||isPrototypeOf$d(ArrayPrototype$9,e)&&t===ArrayPrototype$9.concat?method$8:t},parent$T=concat$5,concat$4=parent$T,concat$3=concat$4,classof$8=classof$a,$String$1=String,toString$6=function(e){if("Symbol"===classof$8(e))throw TypeError("Cannot convert a Symbol value to a string");return $String$1(e)},objectDefineProperties={},toIntegerOrInfinity$1=toIntegerOrInfinity$3,max$2=Math.max,min=Math.min,toAbsoluteIndex$3=function(e,t){var r=toIntegerOrInfinity$1(e);return r<0?max$2(r+t,0):min(r,t)},toIndexedObject$7=toIndexedObject$9,toAbsoluteIndex$2=toAbsoluteIndex$3,lengthOfArrayLike$5=lengthOfArrayLike$7,createMethod$3=function(e){return function(t,r,n){var i,o=toIndexedObject$7(t),s=lengthOfArrayLike$5(o),a=toAbsoluteIndex$2(n,s);if(e&&r!=r){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===r)return e||a||0;return!e&&-1}},arrayIncludes={includes:createMethod$3(!0),indexOf:createMethod$3(!1)},hiddenKeys$6={},uncurryThis$i=functionUncurryThis,hasOwn$d=hasOwnProperty_1,toIndexedObject$6=toIndexedObject$9,indexOf$7=arrayIncludes.indexOf,hiddenKeys$5=hiddenKeys$6,push$7=uncurryThis$i([].push),objectKeysInternal=function(e,t){var r,n=toIndexedObject$6(e),i=0,o=[];for(r in n)!hasOwn$d(hiddenKeys$5,r)&&hasOwn$d(n,r)&&push$7(o,r);for(;t.length>i;)hasOwn$d(n,r=t[i++])&&(~indexOf$7(o,r)||push$7(o,r));return o},enumBugKeys$3=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,enumBugKeys$2=enumBugKeys$3,objectKeys$4=Object.keys||function(e){return internalObjectKeys$1(e,enumBugKeys$2)},DESCRIPTORS$9=descriptors,V8_PROTOTYPE_DEFINE_BUG=v8PrototypeDefineBug,definePropertyModule$3=objectDefineProperty,anObject$q=anObject$s,toIndexedObject$5=toIndexedObject$9,objectKeys$3=objectKeys$4;objectDefineProperties.f=DESCRIPTORS$9&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(e,t){anObject$q(e);for(var r,n=toIndexedObject$5(t),i=objectKeys$3(t),o=i.length,s=0;o>s;)definePropertyModule$3.f(e,r=i[s++],n[r]);return e};var getBuiltIn$d=getBuiltIn$h,html$2=getBuiltIn$d("document","documentElement"),shared$4=shared$6.exports,uid$2=uid$4,keys$3=shared$4("keys"),sharedKey$4=function(e){return keys$3[e]||(keys$3[e]=uid$2(e))},anObject$p=anObject$s,definePropertiesModule$1=objectDefineProperties,enumBugKeys$1=enumBugKeys$3,hiddenKeys$4=hiddenKeys$6,html$1=html$2,documentCreateElement=documentCreateElement$1,sharedKey$3=sharedKey$4,GT=">",LT="<",PROTOTYPE$1="prototype",SCRIPT="script",IE_PROTO$1=sharedKey$3("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(e){return LT+SCRIPT+GT+e+LT+"/"+SCRIPT+GT},NullProtoObjectViaActiveX=function(e){e.write(scriptTag("")),e.close();var t=e.parentWindow.Object;return e=null,t},NullProtoObjectViaIFrame=function(){var e,t=documentCreateElement("iframe"),r="java"+SCRIPT+":";return t.style.display="none",html$1.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(scriptTag("document.F=Object")),e.close(),e.F},activeXDocument,NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch(e){}NullProtoObject="undefined"!=typeof document?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(activeXDocument);for(var e=enumBugKeys$1.length;e--;)delete NullProtoObject[PROTOTYPE$1][enumBugKeys$1[e]];return NullProtoObject()};hiddenKeys$4[IE_PROTO$1]=!0;var objectCreate=Object.create||function(e,t){var r;return null!==e?(EmptyConstructor[PROTOTYPE$1]=anObject$p(e),r=new EmptyConstructor,EmptyConstructor[PROTOTYPE$1]=null,r[IE_PROTO$1]=e):r=NullProtoObject(),void 0===t?r:definePropertiesModule$1.f(r,t)},objectGetOwnPropertyNames={},internalObjectKeys=objectKeysInternal,enumBugKeys=enumBugKeys$3,hiddenKeys$3=enumBugKeys.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(e){return internalObjectKeys(e,hiddenKeys$3)};var objectGetOwnPropertyNamesExternal={},toAbsoluteIndex$1=toAbsoluteIndex$3,lengthOfArrayLike$4=lengthOfArrayLike$7,createProperty$2=createProperty$4,$Array$2=Array,max$1=Math.max,arraySliceSimple=function(e,t,r){for(var n=lengthOfArrayLike$4(e),i=toAbsoluteIndex$1(t,n),o=toAbsoluteIndex$1(void 0===r?n:r,n),s=$Array$2(max$1(o-i,0)),a=0;i<o;i++,a++)createProperty$2(s,a,e[i]);return s.length=a,s},classof$7=classofRaw$1,toIndexedObject$4=toIndexedObject$9,$getOwnPropertyNames$1=objectGetOwnPropertyNames.f,arraySlice$6=arraySliceSimple,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(e){try{return $getOwnPropertyNames$1(e)}catch(e){return arraySlice$6(windowNames)}};objectGetOwnPropertyNamesExternal.f=function(e){return windowNames&&"Window"==classof$7(e)?getWindowNames(e):$getOwnPropertyNames$1(toIndexedObject$4(e))};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var createNonEnumerableProperty$6=createNonEnumerableProperty$8,defineBuiltIn$6=function(e,t,r,n){return n&&n.enumerable?e[t]=r:createNonEnumerableProperty$6(e,t,r),e},wellKnownSymbolWrapped={},wellKnownSymbol$g=wellKnownSymbol$n;wellKnownSymbolWrapped.f=wellKnownSymbol$g;var path$h=path$l,hasOwn$c=hasOwnProperty_1,wrappedWellKnownSymbolModule$1=wellKnownSymbolWrapped,defineProperty$e=objectDefineProperty.f,defineWellKnownSymbol$m=function(e){var t=path$h.Symbol||(path$h.Symbol={});hasOwn$c(t,e)||defineProperty$e(t,e,{value:wrappedWellKnownSymbolModule$1.f(e)})},call$o=functionCall,getBuiltIn$c=getBuiltIn$h,wellKnownSymbol$f=wellKnownSymbol$n,defineBuiltIn$5=defineBuiltIn$6,symbolDefineToPrimitive=function(){var e=getBuiltIn$c("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=wellKnownSymbol$f("toPrimitive");t&&!t[n]&&defineBuiltIn$5(t,n,function(e){return call$o(r,this)},{arity:1})},TO_STRING_TAG_SUPPORT$1=toStringTagSupport,classof$6=classof$a,objectToString=TO_STRING_TAG_SUPPORT$1?{}.toString:function(){return"[object "+classof$6(this)+"]"},TO_STRING_TAG_SUPPORT=toStringTagSupport,defineProperty$d=objectDefineProperty.f,createNonEnumerableProperty$5=createNonEnumerableProperty$8,hasOwn$b=hasOwnProperty_1,toString$5=objectToString,wellKnownSymbol$e=wellKnownSymbol$n,TO_STRING_TAG$2=wellKnownSymbol$e("toStringTag"),setToStringTag$7=function(e,t,r,n){if(e){var i=r?e:e.prototype;hasOwn$b(i,TO_STRING_TAG$2)||defineProperty$d(i,TO_STRING_TAG$2,{configurable:!0,value:t}),n&&!TO_STRING_TAG_SUPPORT&&createNonEnumerableProperty$5(i,"toString",toString$5)}},global$h=global$p,isCallable$b=isCallable$m,inspectSource$1=inspectSource$3,WeakMap$1=global$h.WeakMap,nativeWeakMap=isCallable$b(WeakMap$1)&&/native code/.test(inspectSource$1(WeakMap$1)),NATIVE_WEAK_MAP=nativeWeakMap,global$g=global$p,uncurryThis$h=functionUncurryThis,isObject$b=isObject$i,createNonEnumerableProperty$4=createNonEnumerableProperty$8,hasOwn$a=hasOwnProperty_1,shared$3=sharedStore,sharedKey$2=sharedKey$4,hiddenKeys$2=hiddenKeys$6,OBJECT_ALREADY_INITIALIZED="Object already initialized",TypeError$3=global$g.TypeError,WeakMap=global$g.WeakMap,set$1,get,has,enforce=function(e){return has(e)?get(e):set$1(e,{})},getterFor=function(e){return function(t){var r;if(!isObject$b(t)||(r=get(t)).type!==e)throw TypeError$3("Incompatible receiver, "+e+" required");return r}};if(NATIVE_WEAK_MAP||shared$3.state){var store=shared$3.state||(shared$3.state=new WeakMap),wmget=uncurryThis$h(store.get),wmhas=uncurryThis$h(store.has),wmset=uncurryThis$h(store.set);set$1=function(e,t){if(wmhas(store,e))throw new TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,wmset(store,e,t),t},get=function(e){return wmget(store,e)||{}},has=function(e){return wmhas(store,e)}}else{var STATE=sharedKey$2("state");hiddenKeys$2[STATE]=!0,set$1=function(e,t){if(hasOwn$a(e,STATE))throw new TypeError$3(OBJECT_ALREADY_INITIALIZED);return t.facade=e,createNonEnumerableProperty$4(e,STATE,t),t},get=function(e){return hasOwn$a(e,STATE)?e[STATE]:{}},has=function(e){return hasOwn$a(e,STATE)}}var internalState={set:set$1,get,has,enforce,getterFor},bind$o=functionBindContext,uncurryThis$g=functionUncurryThis,IndexedObject$1=indexedObject,toObject$6=toObject$9,lengthOfArrayLike$3=lengthOfArrayLike$7,arraySpeciesCreate=arraySpeciesCreate$2,push$6=uncurryThis$g([].push),createMethod$2=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,s=7==e,a=5==e||o;return function(l,c,u,d){for(var h,p,f=toObject$6(l),_=IndexedObject$1(f),y=bind$o(c,u),g=lengthOfArrayLike$3(_),m=0,v=d||arraySpeciesCreate,b=t?v(l,g):r||s?v(l,0):void 0;g>m;m++)if((a||m in _)&&(p=y(h=_[m],m,f),e))if(t)b[m]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return m;case 2:push$6(b,h)}else switch(e){case 4:return!1;case 7:push$6(b,h)}return o?-1:n||i?i:b}},arrayIteration={forEach:createMethod$2(0),map:createMethod$2(1),filter:createMethod$2(2),some:createMethod$2(3),every:createMethod$2(4),find:createMethod$2(5),findIndex:createMethod$2(6),filterReject:createMethod$2(7)},$$Z=_export,global$f=global$p,call$n=functionCall,uncurryThis$f=functionUncurryThis,DESCRIPTORS$8=descriptors,NATIVE_SYMBOL$3=nativeSymbol,fails$h=fails$s,hasOwn$9=hasOwnProperty_1,isPrototypeOf$c=objectIsPrototypeOf,anObject$o=anObject$s,toIndexedObject$3=toIndexedObject$9,toPropertyKey=toPropertyKey$4,$toString=toString$6,createPropertyDescriptor$3=createPropertyDescriptor$7,nativeObjectCreate=objectCreate,objectKeys$2=objectKeys$4,getOwnPropertyNamesModule$2=objectGetOwnPropertyNames,getOwnPropertyNamesExternal=objectGetOwnPropertyNamesExternal,getOwnPropertySymbolsModule$3=objectGetOwnPropertySymbols,getOwnPropertyDescriptorModule$1=objectGetOwnPropertyDescriptor,definePropertyModule$2=objectDefineProperty,definePropertiesModule=objectDefineProperties,propertyIsEnumerableModule$1=objectPropertyIsEnumerable,defineBuiltIn$4=defineBuiltIn$6,shared$2=shared$6.exports,sharedKey$1=sharedKey$4,hiddenKeys$1=hiddenKeys$6,uid$1=uid$4,wellKnownSymbol$d=wellKnownSymbol$n,wrappedWellKnownSymbolModule=wellKnownSymbolWrapped,defineWellKnownSymbol$l=defineWellKnownSymbol$m,defineSymbolToPrimitive$1=symbolDefineToPrimitive,setToStringTag$6=setToStringTag$7,InternalStateModule$5=internalState,$forEach$1=arrayIteration.forEach,HIDDEN=sharedKey$1("hidden"),SYMBOL="Symbol",PROTOTYPE="prototype",setInternalState$5=InternalStateModule$5.set,getInternalState$2=InternalStateModule$5.getterFor(SYMBOL),ObjectPrototype$2=Object[PROTOTYPE],$Symbol=global$f.Symbol,SymbolPrototype=$Symbol&&$Symbol[PROTOTYPE],TypeError$2=global$f.TypeError,QObject=global$f.QObject,nativeGetOwnPropertyDescriptor=getOwnPropertyDescriptorModule$1.f,nativeDefineProperty=definePropertyModule$2.f,nativeGetOwnPropertyNames=getOwnPropertyNamesExternal.f,nativePropertyIsEnumerable=propertyIsEnumerableModule$1.f,push$5=uncurryThis$f([].push),AllSymbols=shared$2("symbols"),ObjectPrototypeSymbols=shared$2("op-symbols"),WellKnownSymbolsStore=shared$2("wks"),USE_SETTER=!QObject||!QObject[PROTOTYPE]||!QObject[PROTOTYPE].findChild,setSymbolDescriptor=DESCRIPTORS$8&&fails$h(function(){return 7!=nativeObjectCreate(nativeDefineProperty({},"a",{get:function(){return nativeDefineProperty(this,"a",{value:7}).a}})).a})?function(e,t,r){var n=nativeGetOwnPropertyDescriptor(ObjectPrototype$2,t);n&&delete ObjectPrototype$2[t],nativeDefineProperty(e,t,r),n&&e!==ObjectPrototype$2&&nativeDefineProperty(ObjectPrototype$2,t,n)}:nativeDefineProperty,wrap$1=function(e,t){var r=AllSymbols[e]=nativeObjectCreate(SymbolPrototype);return setInternalState$5(r,{type:SYMBOL,tag:e,description:t}),DESCRIPTORS$8||(r.description=t),r},$defineProperty=function(e,t,r){e===ObjectPrototype$2&&$defineProperty(ObjectPrototypeSymbols,t,r),anObject$o(e);var n=toPropertyKey(t);return anObject$o(r),hasOwn$9(AllSymbols,n)?(r.enumerable?(hasOwn$9(e,HIDDEN)&&e[HIDDEN][n]&&(e[HIDDEN][n]=!1),r=nativeObjectCreate(r,{enumerable:createPropertyDescriptor$3(0,!1)})):(hasOwn$9(e,HIDDEN)||nativeDefineProperty(e,HIDDEN,createPropertyDescriptor$3(1,{})),e[HIDDEN][n]=!0),setSymbolDescriptor(e,n,r)):nativeDefineProperty(e,n,r)},$defineProperties=function(e,t){anObject$o(e);var r=toIndexedObject$3(t),n=objectKeys$2(r).concat($getOwnPropertySymbols(r));return $forEach$1(n,function(t){DESCRIPTORS$8&&!call$n($propertyIsEnumerable$1,r,t)||$defineProperty(e,t,r[t])}),e},$create=function(e,t){return void 0===t?nativeObjectCreate(e):$defineProperties(nativeObjectCreate(e),t)},$propertyIsEnumerable$1=function(e){var t=toPropertyKey(e),r=call$n(nativePropertyIsEnumerable,this,t);return!(this===ObjectPrototype$2&&hasOwn$9(AllSymbols,t)&&!hasOwn$9(ObjectPrototypeSymbols,t))&&(!(r||!hasOwn$9(this,t)||!hasOwn$9(AllSymbols,t)||hasOwn$9(this,HIDDEN)&&this[HIDDEN][t])||r)},$getOwnPropertyDescriptor=function(e,t){var r=toIndexedObject$3(e),n=toPropertyKey(t);if(r!==ObjectPrototype$2||!hasOwn$9(AllSymbols,n)||hasOwn$9(ObjectPrototypeSymbols,n)){var i=nativeGetOwnPropertyDescriptor(r,n);return!i||!hasOwn$9(AllSymbols,n)||hasOwn$9(r,HIDDEN)&&r[HIDDEN][n]||(i.enumerable=!0),i}},$getOwnPropertyNames=function(e){var t=nativeGetOwnPropertyNames(toIndexedObject$3(e)),r=[];return $forEach$1(t,function(e){hasOwn$9(AllSymbols,e)||hasOwn$9(hiddenKeys$1,e)||push$5(r,e)}),r},$getOwnPropertySymbols=function(e){var t=e===ObjectPrototype$2,r=nativeGetOwnPropertyNames(t?ObjectPrototypeSymbols:toIndexedObject$3(e)),n=[];return $forEach$1(r,function(e){!hasOwn$9(AllSymbols,e)||t&&!hasOwn$9(ObjectPrototype$2,e)||push$5(n,AllSymbols[e])}),n};NATIVE_SYMBOL$3||($Symbol=function(){if(isPrototypeOf$c(SymbolPrototype,this))throw TypeError$2("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?$toString(arguments[0]):void 0,t=uid$1(e),r=function(e){this===ObjectPrototype$2&&call$n(r,ObjectPrototypeSymbols,e),hasOwn$9(this,HIDDEN)&&hasOwn$9(this[HIDDEN],t)&&(this[HIDDEN][t]=!1),setSymbolDescriptor(this,t,createPropertyDescriptor$3(1,e))};return DESCRIPTORS$8&&USE_SETTER&&setSymbolDescriptor(ObjectPrototype$2,t,{configurable:!0,set:r}),wrap$1(t,e)},SymbolPrototype=$Symbol[PROTOTYPE],defineBuiltIn$4(SymbolPrototype,"toString",function(){return getInternalState$2(this).tag}),defineBuiltIn$4($Symbol,"withoutSetter",function(e){return wrap$1(uid$1(e),e)}),propertyIsEnumerableModule$1.f=$propertyIsEnumerable$1,definePropertyModule$2.f=$defineProperty,definePropertiesModule.f=$defineProperties,getOwnPropertyDescriptorModule$1.f=$getOwnPropertyDescriptor,getOwnPropertyNamesModule$2.f=getOwnPropertyNamesExternal.f=$getOwnPropertyNames,getOwnPropertySymbolsModule$3.f=$getOwnPropertySymbols,wrappedWellKnownSymbolModule.f=function(e){return wrap$1(wellKnownSymbol$d(e),e)},DESCRIPTORS$8&&nativeDefineProperty(SymbolPrototype,"description",{configurable:!0,get:function(){return getInternalState$2(this).description}})),$$Z({global:!0,constructor:!0,wrap:!0,forced:!NATIVE_SYMBOL$3,sham:!NATIVE_SYMBOL$3},{Symbol:$Symbol}),$forEach$1(objectKeys$2(WellKnownSymbolsStore),function(e){defineWellKnownSymbol$l(e)}),$$Z({target:SYMBOL,stat:!0,forced:!NATIVE_SYMBOL$3},{useSetter:function(){USE_SETTER=!0},useSimple:function(){USE_SETTER=!1}}),$$Z({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$3,sham:!DESCRIPTORS$8},{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor}),$$Z({target:"Object",stat:!0,forced:!NATIVE_SYMBOL$3},{getOwnPropertyNames:$getOwnPropertyNames}),defineSymbolToPrimitive$1(),setToStringTag$6($Symbol,SYMBOL),hiddenKeys$1[HIDDEN]=!0;var NATIVE_SYMBOL$2=nativeSymbol,nativeSymbolRegistry=NATIVE_SYMBOL$2&&!!Symbol.for&&!!Symbol.keyFor,$$Y=_export,getBuiltIn$b=getBuiltIn$h,hasOwn$8=hasOwnProperty_1,toString$4=toString$6,shared$1=shared$6.exports,NATIVE_SYMBOL_REGISTRY$1=nativeSymbolRegistry,StringToSymbolRegistry=shared$1("string-to-symbol-registry"),SymbolToStringRegistry$1=shared$1("symbol-to-string-registry");$$Y({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY$1},{for:function(e){var t=toString$4(e);if(hasOwn$8(StringToSymbolRegistry,t))return StringToSymbolRegistry[t];var r=getBuiltIn$b("Symbol")(t);return StringToSymbolRegistry[t]=r,SymbolToStringRegistry$1[r]=t,r}});var $$X=_export,hasOwn$7=hasOwnProperty_1,isSymbol$1=isSymbol$4,tryToString$3=tryToString$5,shared=shared$6.exports,NATIVE_SYMBOL_REGISTRY=nativeSymbolRegistry,SymbolToStringRegistry=shared("symbol-to-string-registry");$$X({target:"Symbol",stat:!0,forced:!NATIVE_SYMBOL_REGISTRY},{keyFor:function(e){if(!isSymbol$1(e))throw TypeError(tryToString$3(e)+" is not a symbol");if(hasOwn$7(SymbolToStringRegistry,e))return SymbolToStringRegistry[e]}});var uncurryThis$e=functionUncurryThis,arraySlice$5=uncurryThis$e([].slice),$$W=_export,getBuiltIn$a=getBuiltIn$h,apply$4=functionApply,call$m=functionCall,uncurryThis$d=functionUncurryThis,fails$g=fails$s,isArray$a=isArray$d,isCallable$a=isCallable$m,isObject$a=isObject$i,isSymbol=isSymbol$4,arraySlice$4=arraySlice$5,NATIVE_SYMBOL$1=nativeSymbol,$stringify=getBuiltIn$a("JSON","stringify"),exec=uncurryThis$d(/./.exec),charAt$2=uncurryThis$d("".charAt),charCodeAt$2=uncurryThis$d("".charCodeAt),replace$1=uncurryThis$d("".replace),numberToString=uncurryThis$d(1..toString),tester=/[\uD800-\uDFFF]/g,low=/^[\uD800-\uDBFF]$/,hi=/^[\uDC00-\uDFFF]$/,WRONG_SYMBOLS_CONVERSION=!NATIVE_SYMBOL$1||fails$g(function(){var e=getBuiltIn$a("Symbol")();return"[null]"!=$stringify([e])||"{}"!=$stringify({a:e})||"{}"!=$stringify(Object(e))}),ILL_FORMED_UNICODE=fails$g(function(){return'"\\udf06\\ud834"'!==$stringify("\udf06\ud834")||'"\\udead"'!==$stringify("\udead")}),stringifyWithSymbolsFix=function(e,t){var r=arraySlice$4(arguments),n=t;if((isObject$a(t)||void 0!==e)&&!isSymbol(e))return isArray$a(t)||(t=function(e,t){if(isCallable$a(n)&&(t=call$m(n,this,e,t)),!isSymbol(t))return t}),r[1]=t,apply$4($stringify,null,r)},fixIllFormed=function(e,t,r){var n=charAt$2(r,t-1),i=charAt$2(r,t+1);return exec(low,e)&&!exec(hi,i)||exec(hi,e)&&!exec(low,n)?"\\u"+numberToString(charCodeAt$2(e,0),16):e};$stringify&&$$W({target:"JSON",stat:!0,arity:3,forced:WRONG_SYMBOLS_CONVERSION||ILL_FORMED_UNICODE},{stringify:function(e,t,r){var n=arraySlice$4(arguments),i=apply$4(WRONG_SYMBOLS_CONVERSION?stringifyWithSymbolsFix:$stringify,null,n);return ILL_FORMED_UNICODE&&"string"==typeof i?replace$1(i,tester,fixIllFormed):i}});var $$V=_export,NATIVE_SYMBOL=nativeSymbol,fails$f=fails$s,getOwnPropertySymbolsModule$2=objectGetOwnPropertySymbols,toObject$5=toObject$9,FORCED$1=!NATIVE_SYMBOL||fails$f(function(){getOwnPropertySymbolsModule$2.f(1)});$$V({target:"Object",stat:!0,forced:FORCED$1},{getOwnPropertySymbols:function(e){var t=getOwnPropertySymbolsModule$2.f;return t?t(toObject$5(e)):[]}});var defineWellKnownSymbol$k=defineWellKnownSymbol$m;defineWellKnownSymbol$k("asyncIterator");var defineWellKnownSymbol$j=defineWellKnownSymbol$m;defineWellKnownSymbol$j("hasInstance");var defineWellKnownSymbol$i=defineWellKnownSymbol$m;defineWellKnownSymbol$i("isConcatSpreadable");var defineWellKnownSymbol$h=defineWellKnownSymbol$m;defineWellKnownSymbol$h("iterator");var defineWellKnownSymbol$g=defineWellKnownSymbol$m;defineWellKnownSymbol$g("match");var defineWellKnownSymbol$f=defineWellKnownSymbol$m;defineWellKnownSymbol$f("matchAll");var defineWellKnownSymbol$e=defineWellKnownSymbol$m;defineWellKnownSymbol$e("replace");var defineWellKnownSymbol$d=defineWellKnownSymbol$m;defineWellKnownSymbol$d("search");var defineWellKnownSymbol$c=defineWellKnownSymbol$m;defineWellKnownSymbol$c("species");var defineWellKnownSymbol$b=defineWellKnownSymbol$m;defineWellKnownSymbol$b("split");var defineWellKnownSymbol$a=defineWellKnownSymbol$m,defineSymbolToPrimitive=symbolDefineToPrimitive;defineWellKnownSymbol$a("toPrimitive"),defineSymbolToPrimitive();var getBuiltIn$9=getBuiltIn$h,defineWellKnownSymbol$9=defineWellKnownSymbol$m,setToStringTag$5=setToStringTag$7;defineWellKnownSymbol$9("toStringTag"),setToStringTag$5(getBuiltIn$9("Symbol"),"Symbol");var defineWellKnownSymbol$8=defineWellKnownSymbol$m;defineWellKnownSymbol$8("unscopables");var global$e=global$p,setToStringTag$4=setToStringTag$7;setToStringTag$4(global$e.JSON,"JSON",!0);var path$g=path$l,symbol$6=path$g.Symbol,iterators={},DESCRIPTORS$7=descriptors,hasOwn$6=hasOwnProperty_1,FunctionPrototype$1=Function.prototype,getDescriptor=DESCRIPTORS$7&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn$6(FunctionPrototype$1,"name"),PROPER=EXISTS&&"something"===function(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS$7||DESCRIPTORS$7&&getDescriptor(FunctionPrototype$1,"name").configurable),functionName={EXISTS,PROPER,CONFIGURABLE},fails$e=fails$s,correctPrototypeGetter=!fails$e(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),hasOwn$5=hasOwnProperty_1,isCallable$9=isCallable$m,toObject$4=toObject$9,sharedKey=sharedKey$4,CORRECT_PROTOTYPE_GETTER$1=correctPrototypeGetter,IE_PROTO=sharedKey("IE_PROTO"),$Object=Object,ObjectPrototype$1=$Object.prototype,objectGetPrototypeOf=CORRECT_PROTOTYPE_GETTER$1?$Object.getPrototypeOf:function(e){var t=toObject$4(e);if(hasOwn$5(t,IE_PROTO))return t[IE_PROTO];var r=t.constructor;return isCallable$9(r)&&t instanceof r?r.prototype:t instanceof $Object?ObjectPrototype$1:null},fails$d=fails$s,isCallable$8=isCallable$m,create$e=objectCreate,getPrototypeOf$9=objectGetPrototypeOf,defineBuiltIn$3=defineBuiltIn$6,wellKnownSymbol$c=wellKnownSymbol$n,ITERATOR$4=wellKnownSymbol$c("iterator"),BUGGY_SAFARI_ITERATORS$1=!1,IteratorPrototype$1,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=getPrototypeOf$9(getPrototypeOf$9(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype$1=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS$1=!0);var NEW_ITERATOR_PROTOTYPE=null==IteratorPrototype$1||fails$d(function(){var e={};return IteratorPrototype$1[ITERATOR$4].call(e)!==e});IteratorPrototype$1=NEW_ITERATOR_PROTOTYPE?{}:create$e(IteratorPrototype$1),isCallable$8(IteratorPrototype$1[ITERATOR$4])||defineBuiltIn$3(IteratorPrototype$1,ITERATOR$4,function(){return this});var iteratorsCore={IteratorPrototype:IteratorPrototype$1,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS$1},IteratorPrototype=iteratorsCore.IteratorPrototype,create$d=objectCreate,createPropertyDescriptor$2=createPropertyDescriptor$7,setToStringTag$3=setToStringTag$7,Iterators$5=iterators,returnThis$1=function(){return this},createIteratorConstructor$1=function(e,t,r,n){var i=t+" Iterator";return e.prototype=create$d(IteratorPrototype,{next:createPropertyDescriptor$2(+!n,r)}),setToStringTag$3(e,i,!1,!0),Iterators$5[i]=returnThis$1,e},isCallable$7=isCallable$m,$String=String,$TypeError$9=TypeError,aPossiblePrototype$1=function(e){if("object"==typeof e||isCallable$7(e))return e;throw $TypeError$9("Can't set "+$String(e)+" as a prototype")},uncurryThis$c=functionUncurryThis,anObject$n=anObject$s,aPossiblePrototype=aPossiblePrototype$1,objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=uncurryThis$c(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return anObject$n(r),aPossiblePrototype(n),t?e(r,n):r.__proto__=n,r}}():void 0),$$U=_export,call$l=functionCall,FunctionName=functionName,createIteratorConstructor=createIteratorConstructor$1,getPrototypeOf$8=objectGetPrototypeOf,setToStringTag$2=setToStringTag$7,defineBuiltIn$2=defineBuiltIn$6,wellKnownSymbol$b=wellKnownSymbol$n,Iterators$4=iterators,IteratorsCore=iteratorsCore,PROPER_FUNCTION_NAME=FunctionName.PROPER,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR$3=wellKnownSymbol$b("iterator"),KEYS="keys",VALUES="values",ENTRIES="entries",returnThis=function(){return this},defineIterator$3=function(e,t,r,n,i,o,s){createIteratorConstructor(r,t,n);var a,l,c,u=function(e){if(e===i&&_)return _;if(!BUGGY_SAFARI_ITERATORS&&e in p)return p[e];switch(e){case KEYS:case VALUES:case ENTRIES:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",h=!1,p=e.prototype,f=p[ITERATOR$3]||p["@@iterator"]||i&&p[i],_=!BUGGY_SAFARI_ITERATORS&&f||u(i),y="Array"==t&&p.entries||f;if(y&&(a=getPrototypeOf$8(y.call(new e)))!==Object.prototype&&a.next&&(setToStringTag$2(a,d,!0,!0),Iterators$4[d]=returnThis),PROPER_FUNCTION_NAME&&i==VALUES&&f&&f.name!==VALUES&&(h=!0,_=function(){return call$l(f,this)}),i)if(l={values:u(VALUES),keys:o?_:u(KEYS),entries:u(ENTRIES)},s)for(c in l)(BUGGY_SAFARI_ITERATORS||h||!(c in p))&&defineBuiltIn$2(p,c,l[c]);else $$U({target:t,proto:!0,forced:BUGGY_SAFARI_ITERATORS||h},l);return s&&p[ITERATOR$3]!==_&&defineBuiltIn$2(p,ITERATOR$3,_,{name:i}),Iterators$4[t]=_,l},toIndexedObject$2=toIndexedObject$9,Iterators$3=iterators,InternalStateModule$4=internalState;objectDefineProperty.f;var defineIterator$2=defineIterator$3,ARRAY_ITERATOR="Array Iterator",setInternalState$4=InternalStateModule$4.set,getInternalState$1=InternalStateModule$4.getterFor(ARRAY_ITERATOR);defineIterator$2(Array,"Array",function(e,t){setInternalState$4(this,{type:ARRAY_ITERATOR,target:toIndexedObject$2(e),index:0,kind:t})},function(){var e=getInternalState$1(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}},"values"),Iterators$3.Arguments=Iterators$3.Array;var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},DOMIterables$1=domIterables,global$d=global$p,classof$5=classof$a,createNonEnumerableProperty$3=createNonEnumerableProperty$8,Iterators$2=iterators,wellKnownSymbol$a=wellKnownSymbol$n,TO_STRING_TAG$1=wellKnownSymbol$a("toStringTag");for(var COLLECTION_NAME in DOMIterables$1){var Collection=global$d[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;CollectionPrototype&&classof$5(CollectionPrototype)!==TO_STRING_TAG$1&&createNonEnumerableProperty$3(CollectionPrototype,TO_STRING_TAG$1,COLLECTION_NAME),Iterators$2[COLLECTION_NAME]=Iterators$2.Array}var parent$S=symbol$6,symbol$5=parent$S,parent$R=symbol$5,symbol$4=parent$R,defineWellKnownSymbol$7=defineWellKnownSymbol$m;defineWellKnownSymbol$7("asyncDispose");var defineWellKnownSymbol$6=defineWellKnownSymbol$m;defineWellKnownSymbol$6("dispose");var defineWellKnownSymbol$5=defineWellKnownSymbol$m;defineWellKnownSymbol$5("matcher");var defineWellKnownSymbol$4=defineWellKnownSymbol$m;defineWellKnownSymbol$4("metadataKey");var defineWellKnownSymbol$3=defineWellKnownSymbol$m;defineWellKnownSymbol$3("observable");var defineWellKnownSymbol$2=defineWellKnownSymbol$m;defineWellKnownSymbol$2("metadata");var defineWellKnownSymbol$1=defineWellKnownSymbol$m;defineWellKnownSymbol$1("patternMatch");var defineWellKnownSymbol=defineWellKnownSymbol$m;defineWellKnownSymbol("replaceAll");var parent$Q=symbol$4,symbol$3=parent$Q,symbol$2=symbol$3,symbol$1=symbol$2,uncurryThis$b=functionUncurryThis,toIntegerOrInfinity=toIntegerOrInfinity$3,toString$3=toString$6,requireObjectCoercible$1=requireObjectCoercible$4,charAt$1=uncurryThis$b("".charAt),charCodeAt$1=uncurryThis$b("".charCodeAt),stringSlice=uncurryThis$b("".slice),createMethod$1=function(e){return function(t,r){var n,i,o=toString$3(requireObjectCoercible$1(t)),s=toIntegerOrInfinity(r),a=o.length;return s<0||s>=a?e?"":void 0:(n=charCodeAt$1(o,s))<55296||n>56319||s+1===a||(i=charCodeAt$1(o,s+1))<56320||i>57343?e?charAt$1(o,s):n:e?stringSlice(o,s,s+2):i-56320+(n-55296<<10)+65536}},stringMultibyte={codeAt:createMethod$1(!1),charAt:createMethod$1(!0)},charAt=stringMultibyte.charAt,toString$2=toString$6,InternalStateModule$3=internalState,defineIterator$1=defineIterator$3,STRING_ITERATOR="String Iterator",setInternalState$3=InternalStateModule$3.set,getInternalState=InternalStateModule$3.getterFor(STRING_ITERATOR);defineIterator$1(String,"String",function(e){setInternalState$3(this,{type:STRING_ITERATOR,string:toString$2(e),index:0})},function(){var e,t=getInternalState(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=charAt(r,n),t.index+=e.length,{value:e,done:!1})});var WrappedWellKnownSymbolModule=wellKnownSymbolWrapped,iterator$5=WrappedWellKnownSymbolModule.f("iterator"),parent$P=iterator$5,iterator$4=parent$P,parent$O=iterator$4,iterator$3=parent$O,parent$N=iterator$3,iterator$2=parent$N,iterator$1=iterator$2,iterator=iterator$1;function _typeof(e){return _typeof="function"==typeof symbol$1&&"symbol"==typeof iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof symbol$1&&e.constructor===symbol$1&&e!==symbol$1.prototype?"symbol":typeof e},_typeof(e)}var $$T=_export,toObject$3=toObject$9,nativeKeys=objectKeys$4,fails$c=fails$s,FAILS_ON_PRIMITIVES$2=fails$c(function(){nativeKeys(1)});$$T({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$2},{keys:function(e){return nativeKeys(toObject$3(e))}});var path$f=path$l,keys$2=path$f.Object.keys,parent$M=keys$2,keys$1=parent$M,keys=keys$1,$$S=_export,DESCRIPTORS$6=descriptors,create$c=objectCreate;$$S({target:"Object",stat:!0,sham:!DESCRIPTORS$6},{create:create$c});var path$e=path$l,Object$2=path$e.Object,create$b=function(e,t){return Object$2.create(e,t)},parent$L=create$b,create$a=parent$L,create$9=create$a,$$R=_export,uncurryThis$a=functionUncurryThis,isArray$9=isArray$d,un$Reverse=uncurryThis$a([].reverse),test=[1,2];$$R({target:"Array",proto:!0,forced:String(test)===String(test.reverse())},{reverse:function(){return isArray$9(this)&&(this.length=this.length),un$Reverse(this)}});var entryVirtual$9=entryVirtual$b,reverse$3=entryVirtual$9("Array").reverse,isPrototypeOf$b=objectIsPrototypeOf,method$7=reverse$3,ArrayPrototype$8=Array.prototype,reverse$2=function(e){var t=e.reverse;return e===ArrayPrototype$8||isPrototypeOf$b(ArrayPrototype$8,e)&&t===ArrayPrototype$8.reverse?method$7:t},parent$K=reverse$2,reverse$1=parent$K,reverse=reverse$1,indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}})}var base64$2={};!function(e){var t=base64$2;t.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var r=new Array(64),n=new Array(123),i=0;i<64;)n[r[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(e,t,n){for(var i,o=null,s=[],a=0,l=0;t<n;){var c=e[t++];switch(l){case 0:s[a++]=r[c>>2],i=(3&c)<<4,l=1;break;case 1:s[a++]=r[i|c>>4],i=(15&c)<<2,l=2;break;case 2:s[a++]=r[i|c>>6],s[a++]=r[63&c],l=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return l&&(s[a++]=r[i],s[a++]=61,1===l&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var o="invalid encoding";t.decode=function(e,t,r){for(var i,s=r,a=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&a>1)break;if(void 0===(c=n[c]))throw Error(o);switch(a){case 0:i=c,a=1;break;case 1:t[r++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[r++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[r++]=(3&i)<<6|c,a=0}}if(1===a)throw Error(o);return r-s},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}();var eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},EventEmitter$1.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},EventEmitter$1.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this};var float=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>17976931348623157e292)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var l=Math.floor(Math.log(n)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(a=n*Math.pow(2,-l))>>>0,i,o+t),e((s<<31|l+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,l=s>>>20&2047,c=4294967296*(1048575&s)+o;return 2047===l?c?NaN:a*(1/0):0===l?5e-324*a*c:a*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={},t;t=utf8$2,t.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},t.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},t.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o};var pool_1=pool;function pool(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}var longbits=LongBits$2,util$5=minimal$1;function LongBits$2(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits$2.zero=new LongBits$2(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits$2.zeroHash="\0\0\0\0\0\0\0\0";LongBits$2.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new LongBits$2(r,n)},LongBits$2.from=function(e){if("number"==typeof e)return LongBits$2.fromNumber(e);if(util$5.isString(e)){if(!util$5.Long)return LongBits$2.fromNumber(parseInt(e,10));e=util$5.Long.fromString(e)}return e.low||e.high?new LongBits$2(e.low>>>0,e.high>>>0):zero},LongBits$2.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},LongBits$2.prototype.toLong=function(e){return util$5.Long?new util$5.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits$2.fromHash=function(e){return e===zeroHash?zero:new LongBits$2((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits$2.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits$2.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits$2.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits$2.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10},function(e){var t=minimal$1;function r(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function n(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}t.asPromise=aspromise,t.base64=base64$2,t.EventEmitter=eventemitter,t.float=float,t.inquire=inquire_1,t.utf8=utf8$2,t.pool=pool_1,t.LongBits=longbits,t.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"==typeof e},t.isset=t.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,r){var n=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))},t.merge=r,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},t.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}();var writer=Writer$1,util$4=minimal$1,BufferWriter$1,LongBits$1=util$4.LongBits,base64$1=util$4.base64,utf8$1=util$4.utf8;function Op(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$8=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte(e,t,r){t[r]=255&e}function writeVarint32(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer$1.create=create$8(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Op(e,t,r),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer$1.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes=util$4.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer$1.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(util$4.isString(e)){var r=Writer$1.alloc(t=base64$1.length(e));base64$1.decode(e,r,0),e=r}return this.uint32(t)._push(writeBytes,t,e)},Writer$1.prototype.string=function(e){var t=utf8$1.length(e);return t?this.uint32(t)._push(utf8$1.write,t,e):this._push(writeByte,1,0)},Writer$1.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$8(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=minimal$1;function BufferWriter(){Writer.call(this)}function writeStringBuffer(e,t,r){e.length<40?util$3.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&"set"===util$3.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter.writeBytesBuffer,t,e),this},BufferWriter.prototype.string=function(e){var t=util$3.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter._configure();var reader=Reader$1,util$2=minimal$1,BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create$7=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(e){return util$2.Buffer.isBuffer(e)?new BufferReader$1(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create$7(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},Reader$1.prototype.bool=function(){return 0!==this.uint32()},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create$7(),BufferReader$1._configure();var t=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=minimal$1;function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=minimal$1,exports;function Service(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,r,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return util.asPromise(e,s,t,r,n,i);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,r){if(e)return s.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",r,t),o(null,r)}s.end(!0)})}catch(e){return s.emit("error",e,t),void setTimeout(function(){o(e)},0)}else setTimeout(function(){o(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},exports=rpc,exports.Service=service;var roots={};!function(e){var t=indexMinimal;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=writer,t.BufferWriter=writer_buffer,t.Reader=reader,t.BufferReader=reader_buffer,t.util=minimal$1,t.rpc=rpc,t.roots=roots,t.configure=r,r()}();var minimal=indexMinimal,$Reader=minimal.Reader,$Writer=minimal.Writer,$util=minimal.util;minimal.util.Long=long__WEBPACK_IMPORTED_MODULE_2__.A,minimal.configure();var $root=minimal.roots.default||(minimal.roots.default={}),im_proto=$root.im_proto=(e={},e.Frame=function(){function e(e){if(this.headers=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seqid=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.logid=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.service=0,e.prototype.method=0,e.prototype.headers=$util.emptyArray,e.prototype.payload_encoding="",e.prototype.payload_type="",e.prototype.payload=$util.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).uint64(e.seqid),t.uint32(16).uint64(e.logid),t.uint32(24).int32(e.service),t.uint32(32).int32(e.method),null!=e.headers&&e.headers.length)for(var r=0;r<e.headers.length;++r)$root.im_proto.Frame.ExtendedEntry.encode(e.headers[r],t.uint32(42).fork()).ldelim();return null!=e.payload_encoding&&Object.hasOwnProperty.call(e,"payload_encoding")&&t.uint32(50).string(e.payload_encoding),null!=e.payload_type&&Object.hasOwnProperty.call(e,"payload_type")&&t.uint32(58).string(e.payload_type),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(66).bytes(e.payload),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.Frame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.seqid=e.uint64();break;case 2:n.logid=e.uint64();break;case 3:n.service=e.int32();break;case 4:n.method=e.int32();break;case 5:n.headers&&n.headers.length||(n.headers=[]),n.headers.push($root.im_proto.Frame.ExtendedEntry.decode(e,e.uint32()));break;case 6:n.payload_encoding=e.string();break;case 7:n.payload_type=e.string();break;case 8:n.payload=e.bytes();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("seqid"))throw $util.ProtocolError("missing required 'seqid'",{instance:n});if(!n.hasOwnProperty("logid"))throw $util.ProtocolError("missing required 'logid'",{instance:n});if(!n.hasOwnProperty("service"))throw $util.ProtocolError("missing required 'service'",{instance:n});if(!n.hasOwnProperty("method"))throw $util.ProtocolError("missing required 'method'",{instance:n});return n},e.ExtendedEntry=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(10).string(e.key),t.uint32(18).string(e.value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.Frame.ExtendedEntry;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("key"))throw $util.ProtocolError("missing required 'key'",{instance:n});if(!n.hasOwnProperty("value"))throw $util.ProtocolError("missing required 'value'",{instance:n});return n},e}(),e}(),e.IMCMD=function(){var e={},t=create$9(e);return t[e[100]="SEND_MESSAGE"]=100,t[e[200]="GET_MESSAGES_BY_USER"]=200,t[e[203]="GET_MESSAGES_BY_USER_INIT_V2"]=203,t[e[211]="GET_MESSAGE_INFO_BY_SERVER_ID"]=211,t[e[301]="GET_MESSAGES_BY_CONVERSATION"]=301,t[e[302]="GET_MESSAGES_CHECKINFO_IN_CONVERSATION"]=302,t[e[410]="SEND_USER_ACTION"]=410,t[e[411]="SEND_INPUT_STATUS"]=411,t[e[500]="NEW_MSG_NOTIFY"]=500,t[e[505]="NEW_BROADCAST_MSG_NOTIFY"]=505,t[e[603]="MARK_CONVERSATION_DELETE"]=603,t[e[609]="CREATE_CONVERSATION_V2"]=609,t[e[610]="GET_CONVERSATION_INFO_LIST_V2"]=610,t[e[611]="GET_CONVERSATION_INFO_LIST_BY_FAVORITE_V2"]=611,t[e[612]="GET_CONVERSATION_INFO_LIST_BY_TOP_V2"]=612,t[e[614]="DISSOLVE_CONVERSATION"]=614,t[e[615]="GET_CONVERSATIONS_CHECKINFO"]=615,t[e[605]="CONVERSATION_PARTICIPANTS_LIST"]=605,t[e[650]="ADD_CONVERSATION_PARTICIPANTS"]=650,t[e[651]="REMOVE_CONVERSATION_PARTICIPANTS"]=651,t[e[652]="LEAVE_CONVERSATION"]=652,t[e[655]="UPDATE_CONVERSATION_PARTICIPANT"]=655,t[e[701]="DELETE_MESSAGE"]=701,t[e[702]="RECALL_MESSAGE"]=702,t[e[705]="SET_MESSAGE_PROPERTY"]=705,t[e[901]="GET_CONVERSATION_CORE_INFO"]=901,t[e[902]="SET_CONVERSATION_CORE_INFO"]=902,t[e[904]="UPSERT_CONVERSATION_CORE_EXT_INFO"]=904,t[e[921]="SET_CONVERSATION_SETTING_INFO"]=921,t[e[922]="UPSERT_CONVERSATION_SETTING_EXT_INFO"]=922,t[e[1001]="GET_STRANGER_CONVERSATION_LIST"]=1001,t[e[1002]="GET_STRANGER_MESSAGES_IN_CONVERSATION"]=1002,t[e[1003]="DELETE_STRANGER_MESSAGE"]=1003,t[e[1004]="DELETE_STRANGER_CONVERSATION"]=1004,t[e[1005]="DELETE_ALL_STRANGER_CONVERSATIONS"]=1005,t[e[1006]="MARK_STRANGER_CONVERSATION_READ"]=1006,t[e[1007]="MARK_ALL_STRANGER_CONVERSATIONS_READ"]=1007,t[e[1099]="STRANGER_NEW_MSG_NOTIFY"]=1099,t[e[2e3]="GET_CONVERSATION_PARTICIPANTS_READ_INDEX_V3"]=2e3,t[e[2001]="GET_CONVERSATION_PARTICIPANTS_MIN_INDEX_V3"]=2001,t[e[2002]="MARK_CONVERSATION_READ_V3"]=2002,t[e[2003]="GET_MEDIA_UPLOAD_TOKEN"]=2003,t[e[2004]="GET_MEDIA_URLS"]=2004,t[e[2005]="GET_TICKET"]=2005,t[e[2006]="GET_USER_CONVERSATION_LIST"]=2006,t[e[2007]="BROADCAST_SEND_MESSAGE"]=2007,t[e[2008]="BROADCAST_RECV_MESSAGE"]=2008,t[e[2009]="BROADCAST_USER_COUNTER"]=2009,t[e[2010]="CLIENT_ACK"]=2010,t[e[2011]="CREATE_VOIP"]=2011,t[e[2012]="CALL_VOIP"]=2012,t[e[2013]="UPDATE_VOIP"]=2013,t[e[2014]="HEARTBEAT_CHANNEL"]=2014,t[e[2015]="PROFILE_GET_INFO"]=2015,t[e[2016]="REPORT_CLIENT_METRICS"]=2016,t[e[2017]="GET_CONFIGS"]=2017,t[e[2021]="MODIFY_MESSAGE_EXT"]=2021,t[e[2018]="UNREAD_COUNT_REPORT"]=2018,t[e[2019]="BLOCK_MEMBERS"]=2019,t[e[2020]="BLOCK_CONVERSATION"]=2020,t[e[2030]="GET_UNREAD_COUNT"]=2030,t[e[2031]="SEND_MESSAGE_P2P"]=2031,t[e[2032]="GET_BLOCKLIST"]=2032,t[e[2033]="SET_BLOCKLIST"]=2033,t[e[2034]="CHECK_IN_BLOCKLIST"]=2034,t[e[2036]="MARK_MESSAGE"]=2036,t[e[2037]="PULL_MARK_MESSAGE"]=2037,t[e[2054]="MARK_MSG_UNREAD_COUNT_REPORT"]=2054,t[e[2055]="MARK_MSG_GET_UNREAD_COUNT"]=2055,t[e[2056]="BATCH_UNMARK_MESSAGE"]=2056,t}(),e.StatusCode=function(){var e={},t=create$9(e);return t[e[0]="OK"]=0,t[e[1]="INVALID_TOKEN"]=1,t[e[100]="EXPIRED_TOKEN"]=100,t[e[2]="INVALID_TICKET"]=2,t[e[4]="INVALID_REQUEST"]=4,t[e[5]="INVALID_CMD"]=5,t[e[6]="SERVER_ERR"]=6,t[e[11]="USER_FORBIDDEN"]=11,t[e[500]="INTERNAL_ERROR"]=500,t[e[15]="MESSAGE_TARGET_CONVERSATION_NOT_EXIST"]=15,t[e[16]="DEGRADATION_ERROR"]=16,t[e[17]="RECALL_TIMEOUT"]=17,t[e[19]="CALLBACK_DENY"]=19,t}(),e.SendMessageStatus=function(){var e={},t=create$9(e);return t[e[0]="SEND_SUCCEED"]=0,t[e[1]="USER_NOT_IN_CONVERSATION"]=1,t[e[2]="CHECK_CONV_NOT_PASS"]=2,t[e[3]="CHECK_MSG_NOT_PASS"]=3,t[e[4]="CHECK_MSG_NOT_PASS_BUT_SELF_VISIBLE"]=4,t}(),e.Refer=function(){var e={},t=create$9(e);return t[e[1]="ANDROID"]=1,t[e[2]="IOS"]=2,t[e[3]="PC"]=3,t[e[4]="SERVER"]=4,t}(),e.ConversationType=function(){var e={},t=create$9(e);return t[e[1]="ONE_TO_ONE_CHAT"]=1,t[e[2]="GROUP_CHAT"]=2,t[e[3]="LIVE_CHAT"]=3,t[e[4]="BROADCAST_CHAT"]=4,t}(),e.MessageType=function(){var e={},t=create$9(e);return t[e[1]="LEGACY_MESSAGE_TYPE_SYSTEM"]=1,t[e[2]="LEGACY_MESSAGE_TYPE_IMAGE"]=2,t[e[3]="LEGACY_MESSAGE_TYPE_AUDIO"]=3,t[e[4]="LEGACY_MESSAGE_TYPE_VIDEO"]=4,t[e[5]="LEGACY_MESSAGE_TYPE_EMOJI"]=5,t[e[6]="LEGACY_MESSAGE_TYPE_FILE"]=6,t[e[7]="LEGACY_MESSAGE_TYPE_TEXT"]=7,t[e[8]="LEGACY_MESSAGE_TYPE_USER_CARD"]=8,t[e[9]="LEGACY_MESSAGE_TYPE_TOAST"]=9,t[e[10]="LEGACY_MESSAGE_TYPE_GROUP_CARD"]=10,t[e[10001]="MESSAGE_TYPE_TEXT"]=10001,t[e[10002]="MESSAGE_TYPE_STICKER"]=10002,t[e[10003]="MESSAGE_TYPE_IMAGE"]=10003,t[e[10004]="MESSAGE_TYPE_VIDEO"]=10004,t[e[10005]="MESSAGE_TYPE_FILE"]=10005,t[e[10006]="MESSAGE_TYPE_AUDIO"]=10006,t[e[10007]="MESSAGE_TYPE_LOCATION"]=10007,t[e[10008]="MESSAGE_TYPE_SYSTEM"]=10008,t[e[10009]="MESSAGE_TYPE_LINK"]=10009,t[e[50001]="MESSAGE_TYPE_COMMAND"]=50001,t[e[50002]="MESSAGE_TYPE_UPDATE_MESSAGE_EXT"]=50002,t[e[50010]="MESSAGE_TYPE_MODE_CHANGE"]=50010,t[e[50003]="MESSAGE_TYPE_UPDATE_MIN_INDEX"]=50003,t[e[50004]="MESSAGE_TYPE_USER_ACTION"]=50004,t[e[50005]="MESSAGE_TYPE_CONVERSATION_DESTROY"]=50005,t[e[50011]="MESSAGE_TYPE_BLOCK_COMMAND"]=50011,t[e[50012]="MESSAGE_TYPE_MARK_COMMAND"]=50012,t[e[50016]="MESSAGE_TYPE_BATCH_UNMARK_COMMAND"]=50016,t[e[60001]="MESSAGE_TYPE_NOTIFY_COMMAND"]=60001,t[e[70001]="MESSAGE_TYPE_MESSAGE_PROPERTY"]=70001,t[e[70002]="MESSAGE_TYPE_UPDATE_MESSAGE_PROPERTY"]=70002,t[e[80001]="MESSAGE_TYPE_VOIP_COMMAND"]=80001,t[e[80002]="MESSAGE_TYPE_VOIP_CARD_COMMAND"]=80002,t[e[80003]="MESSAGE_TYPE_VOIP_SINGLE_CHAT_STATUS_COMMAND"]=80003,t[e[80004]="MESSAGE_TYPE_VOIP_CALLEE_LIST_UPDATE_NOTIFY"]=80004,t}(),e.GroupRole=function(){var e={},t=create$9(e);return t[e[0]="ORDINARY"]=0,t[e[1]="OWNER"]=1,t[e[2]="MANAGER"]=2,t[e[3]="VISITOR"]=3,t}(),e.TicketType=function(){var e={},t=create$9(e);return t[e[1]="TICKET_TYPE_APP"]=1,t[e[2]="TICKET_TYPE_PC"]=2,t[e[3]="TICKET_TYPE_WEB"]=3,t}(),e.PropertyItem=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.uid=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.create_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.idempotent_id="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(8).int64(e.uid),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(24).int64(e.create_time),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(42).string(e.value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.PropertyItem;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.uid=e.int64();break;case 2:n.sec_uid=e.string();break;case 3:n.create_time=e.int64();break;case 4:n.idempotent_id=e.string();break;case 5:n.value=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.PropertyItemList=function(){function e(e){if(this.Items=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Items=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.Items&&e.Items.length)for(var r=0;r<e.Items.length;++r)$root.im_proto.PropertyItem.encode(e.Items[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.PropertyItemList;e.pos<r;){var i=e.uint32();i>>>3==1?(n.Items&&n.Items.length||(n.Items=[]),n.Items.push($root.im_proto.PropertyItem.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.MessageBody=function(){function e(e){if(this.ext={},this.property_list={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.index_in_conversation=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.message_type=0,e.prototype.sender=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=$util.emptyObject,e.prototype.create_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.version=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.status=0,e.prototype.order_in_conversation=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_sender="",e.prototype.property_list=$util.emptyObject,e.prototype.reference_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(24).int64(e.server_message_id),null!=e.index_in_conversation&&Object.hasOwnProperty.call(e,"index_in_conversation")&&t.uint32(32).int64(e.index_in_conversation),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.sender&&Object.hasOwnProperty.call(e,"sender")&&t.uint32(56).int64(e.sender),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(74).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();if(null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(80).int64(e.create_time),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(88).int64(e.version),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(96).int32(e.status),null!=e.order_in_conversation&&Object.hasOwnProperty.call(e,"order_in_conversation")&&t.uint32(104).int64(e.order_in_conversation),null!=e.sec_sender&&Object.hasOwnProperty.call(e,"sec_sender")&&t.uint32(114).string(e.sec_sender),null!=e.property_list&&Object.hasOwnProperty.call(e,"property_list"))for(r=keys(e.property_list),n=0;n<r.length;++n)t.uint32(122).fork().uint32(10).string(r[n]),$root.im_proto.PropertyItemList.encode(e.property_list[r[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.reference_info&&Object.hasOwnProperty.call(e,"reference_info")&&$root.im_proto.ReferenceInfo.encode(e.reference_info,t.uint32(146).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.MessageBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.server_message_id=e.int64();break;case 4:o.index_in_conversation=e.int64();break;case 5:o.conversation_short_id=e.int64();break;case 6:o.message_type=e.int32();break;case 7:o.sender=e.int64();break;case 8:o.content=e.string();break;case 9:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;)switch((l=e.uint32())>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}o.ext[r]=n;break;case 10:o.create_time=e.int64();break;case 11:o.version=e.int64();break;case 12:o.status=e.int32();break;case 13:o.order_in_conversation=e.int64();break;case 14:o.sec_sender=e.string();break;case 15:for(o.property_list===$util.emptyObject&&(o.property_list={}),a=e.uint32()+e.pos,r="",n=null;e.pos<a;){var l;switch((l=e.uint32())>>>3){case 1:r=e.string();break;case 2:n=$root.im_proto.PropertyItemList.decode(e,e.uint32());break;default:e.skipType(7&l)}}o.property_list[r]=n;break;case 18:o.reference_info=$root.im_proto.ReferenceInfo.decode(e,e.uint32());break;default:e.skipType(7&s)}}return o},e}(),e.ReferenceInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.referenced_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.hint="",e.prototype.ref_message_type=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.referenced_message_status=0,e.prototype.root_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.root_message_conv_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.referenced_message_id),t.uint32(18).string(e.hint),t.uint32(24).int64(e.ref_message_type),t.uint32(32).int32(e.referenced_message_status),null!=e.root_message_id&&Object.hasOwnProperty.call(e,"root_message_id")&&t.uint32(40).int64(e.root_message_id),null!=e.root_message_conv_index&&Object.hasOwnProperty.call(e,"root_message_conv_index")&&t.uint32(48).int64(e.root_message_conv_index),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ReferenceInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.referenced_message_id=e.int64();break;case 2:n.hint=e.string();break;case 3:n.ref_message_type=e.int64();break;case 4:n.referenced_message_status=e.int32();break;case 5:n.root_message_id=e.int64();break;case 6:n.root_message_conv_index=e.int64();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("referenced_message_id"))throw $util.ProtocolError("missing required 'referenced_message_id'",{instance:n});if(!n.hasOwnProperty("hint"))throw $util.ProtocolError("missing required 'hint'",{instance:n});if(!n.hasOwnProperty("ref_message_type"))throw $util.ProtocolError("missing required 'ref_message_type'",{instance:n});if(!n.hasOwnProperty("referenced_message_status"))throw $util.ProtocolError("missing required 'referenced_message_status'",{instance:n});return n},e}(),e.ParticipantRole=function(){var e={},t=create$9(e);return t[e[0]="PARTICIPANT_ROLE_NORMAL"]=0,t[e[1]="PARTICIPANT_ROLE_OWNER"]=1,t[e[2]="PARTICIPANT_ROLE_ADMIN"]=2,t[e[3]="PARTICIPANT_ROLE_VISITOR"]=3,t}(),e.Participant=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sort_order=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.role=0,e.prototype.alias="",e.prototype.sec_uid="",e.prototype.blocked=0,e.prototype.left_block_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sort_order&&Object.hasOwnProperty.call(e,"sort_order")&&t.uint32(16).int64(e.sort_order),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(24).int32(e.role),null!=e.alias&&Object.hasOwnProperty.call(e,"alias")&&t.uint32(34).string(e.alias),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(42).string(e.sec_uid),null!=e.blocked&&Object.hasOwnProperty.call(e,"blocked")&&t.uint32(48).int32(e.blocked),null!=e.left_block_time&&Object.hasOwnProperty.call(e,"left_block_time")&&t.uint32(56).int64(e.left_block_time),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.Participant;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_id=e.int64();break;case 2:n.sort_order=e.int64();break;case 3:n.role=e.int32();break;case 4:n.alias=e.string();break;case 5:n.sec_uid=e.string();break;case 6:n.blocked=e.int32();break;case 7:n.left_block_time=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ParticipantsPage=function(){function e(e){if(this.participants=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.participants=$util.emptyArray,e.prototype.has_more=!1,e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.participants&&e.participants.length)for(var r=0;r<e.participants.length;++r)$root.im_proto.Participant.encode(e.participants[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(24).int64(e.cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ParticipantsPage;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.participants&&n.participants.length||(n.participants=[]),n.participants.push($root.im_proto.Participant.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationInfoV2=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ticket="",e.prototype.first_page_participants=null,e.prototype.participants_count=0,e.prototype.is_participant=!1,e.prototype.inbox_type=0,e.prototype.user_info=null,e.prototype.conversation_core_info=null,e.prototype.conversation_setting_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(34).string(e.ticket),null!=e.first_page_participants&&Object.hasOwnProperty.call(e,"first_page_participants")&&$root.im_proto.ParticipantsPage.encode(e.first_page_participants,t.uint32(50).fork()).ldelim(),null!=e.participants_count&&Object.hasOwnProperty.call(e,"participants_count")&&t.uint32(56).int32(e.participants_count),null!=e.is_participant&&Object.hasOwnProperty.call(e,"is_participant")&&t.uint32(64).bool(e.is_participant),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(72).int32(e.inbox_type),null!=e.user_info&&Object.hasOwnProperty.call(e,"user_info")&&$root.im_proto.Participant.encode(e.user_info,t.uint32(162).fork()).ldelim(),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&$root.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(402).fork()).ldelim(),null!=e.conversation_setting_info&&Object.hasOwnProperty.call(e,"conversation_setting_info")&&$root.im_proto.ConversationSettingInfo.encode(e.conversation_setting_info,t.uint32(410).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationInfoV2;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.ticket=e.string();break;case 6:n.first_page_participants=$root.im_proto.ParticipantsPage.decode(e,e.uint32());break;case 7:n.participants_count=e.int32();break;case 8:n.is_participant=e.bool();break;case 9:n.inbox_type=e.int32();break;case 20:n.user_info=$root.im_proto.Participant.decode(e,e.uint32());break;case 50:n.conversation_core_info=$root.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 51:n.conversation_setting_info=$root.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),e.ConversationCoreInfo=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.info_version=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.name="",e.prototype.desc="",e.prototype.icon="",e.prototype.inbox_type=0,e.prototype.notice="",e.prototype.ext=$util.emptyObject,e.prototype.owner=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_owner="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.info_version&&Object.hasOwnProperty.call(e,"info_version")&&t.uint32(32).int64(e.info_version),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(42).string(e.name),null!=e.desc&&Object.hasOwnProperty.call(e,"desc")&&t.uint32(50).string(e.desc),null!=e.icon&&Object.hasOwnProperty.call(e,"icon")&&t.uint32(58).string(e.icon),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(64).int32(e.inbox_type),null!=e.notice&&Object.hasOwnProperty.call(e,"notice")&&t.uint32(74).string(e.notice),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(90).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return null!=e.owner&&Object.hasOwnProperty.call(e,"owner")&&t.uint32(96).int64(e.owner),null!=e.sec_owner&&Object.hasOwnProperty.call(e,"sec_owner")&&t.uint32(106).string(e.sec_owner),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ConversationCoreInfo;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.info_version=e.int64();break;case 5:o.name=e.string();break;case 6:o.desc=e.string();break;case 7:o.icon=e.string();break;case 8:o.inbox_type=e.int32();break;case 9:o.notice=e.string();break;case 11:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 12:o.owner=e.int64();break;case 13:o.sec_owner=e.string();break;default:e.skipType(7&s)}}return o},e}(),e.ConversationSettingInfo=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.min_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.read_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.mute=0,e.prototype.stick_on_top=0,e.prototype.inbox_type=0,e.prototype.ext=$util.emptyObject,e.prototype.setting_version=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.favorite=0,e.prototype.set_top_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.set_favorite_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.min_index&&Object.hasOwnProperty.call(e,"min_index")&&t.uint32(32).int64(e.min_index),null!=e.read_index&&Object.hasOwnProperty.call(e,"read_index")&&t.uint32(40).int64(e.read_index),null!=e.mute&&Object.hasOwnProperty.call(e,"mute")&&t.uint32(48).int32(e.mute),null!=e.stick_on_top&&Object.hasOwnProperty.call(e,"stick_on_top")&&t.uint32(56).int32(e.stick_on_top),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(64).int32(e.inbox_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(74).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return null!=e.setting_version&&Object.hasOwnProperty.call(e,"setting_version")&&t.uint32(80).int64(e.setting_version),null!=e.favorite&&Object.hasOwnProperty.call(e,"favorite")&&t.uint32(88).int32(e.favorite),null!=e.set_top_time&&Object.hasOwnProperty.call(e,"set_top_time")&&t.uint32(96).int64(e.set_top_time),null!=e.set_favorite_time&&Object.hasOwnProperty.call(e,"set_favorite_time")&&t.uint32(104).int64(e.set_favorite_time),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ConversationSettingInfo;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.min_index=e.int64();break;case 5:o.read_index=e.int64();break;case 6:o.mute=e.int32();break;case 7:o.stick_on_top=e.int32();break;case 8:o.inbox_type=e.int32();break;case 9:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 10:o.setting_version=e.int64();break;case 11:o.favorite=e.int32();break;case 12:o.set_top_time=e.int64();break;case 13:o.set_favorite_time=e.int64();break;default:e.skipType(7&s)}}return o},e}(),e.MessagesPerUserRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=50,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesPerUserRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.MessagesPerUserResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(10).fork()).ldelim();return null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(16).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(24).bool(e.has_more),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesPerUserResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:n.next_cursor=e.int64();break;case 3:n.has_more=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.MessagesPerUserInitV2RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.new_user=0,e.prototype.init_sub_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.new_user&&Object.hasOwnProperty.call(e,"new_user")&&t.uint32(16).int32(e.new_user),null!=e.init_sub_type&&Object.hasOwnProperty.call(e,"init_sub_type")&&t.uint32(24).int32(e.init_sub_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesPerUserInitV2RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.new_user=e.int32();break;case 3:n.init_sub_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.MessagesPerUserInitV2ResponseBody=function(){function e(e){if(this.messages=[],this.conversations=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.prototype.conversations=$util.emptyArray,e.prototype.per_user_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(10).fork()).ldelim();if(null!=e.conversations&&e.conversations.length)for(r=0;r<e.conversations.length;++r)$root.im_proto.ConversationInfoV2.encode(e.conversations[r],t.uint32(18).fork()).ldelim();return null!=e.per_user_cursor&&Object.hasOwnProperty.call(e,"per_user_cursor")&&t.uint32(24).int64(e.per_user_cursor),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(32).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(40).bool(e.has_more),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesPerUserInitV2ResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:n.conversations&&n.conversations.length||(n.conversations=[]),n.conversations.push($root.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 3:n.per_user_cursor=e.int64();break;case 4:n.next_cursor=e.int64();break;case 5:n.has_more=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.MessageDirection=function(){var e={},t=create$9(e);return t[e[1]="OLDER"]=1,t[e[2]="NEWER"]=2,t[e[3]="FROM_LATEST"]=3,t}(),e.MessagesInConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.direction=1,e.prototype.anchor_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=50,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.direction&&Object.hasOwnProperty.call(e,"direction")&&t.uint32(32).int32(e.direction),null!=e.anchor_index&&Object.hasOwnProperty.call(e,"anchor_index")&&t.uint32(40).int64(e.anchor_index),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(48).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesInConversationRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.direction=e.int32();break;case 5:n.anchor_index=e.int64();break;case 6:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.MessagesInConversationResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(10).fork()).ldelim();return null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(16).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(24).bool(e.has_more),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesInConversationResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:n.next_cursor=e.int64();break;case 3:n.has_more=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.CreateConversationV2RequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_type=0,e.prototype.participants=$util.emptyArray,e.prototype.persistent=!1,e.prototype.idempotent_id="",e.prototype.name="",e.prototype.avatar_url="",e.prototype.description="",e.prototype.biz_ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(8).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var r=0;r<e.participants.length;++r)t.uint32(16).int64(e.participants[r]);if(null!=e.persistent&&Object.hasOwnProperty.call(e,"persistent")&&t.uint32(24).bool(e.persistent),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(50).string(e.name),null!=e.avatar_url&&Object.hasOwnProperty.call(e,"avatar_url")&&t.uint32(58).string(e.avatar_url),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(66).string(e.description),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var n=keys(e.biz_ext);for(r=0;r<n.length;++r)t.uint32(90).fork().uint32(10).string(n[r]).uint32(18).string(e.biz_ext[n[r]]).ldelim()}return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.CreateConversationV2RequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_type=e.int32();break;case 2:if(o.participants&&o.participants.length||(o.participants=[]),2==(7&s))for(var a=e.uint32()+e.pos;e.pos<a;)o.participants.push(e.int64());else o.participants.push(e.int64());break;case 3:o.persistent=e.bool();break;case 4:o.idempotent_id=e.string();break;case 6:o.name=e.string();break;case 7:o.avatar_url=e.string();break;case 8:o.description=e.string();break;case 11:for(o.biz_ext===$util.emptyObject&&(o.biz_ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.biz_ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.CreateConversationV2ResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation=null,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation&&Object.hasOwnProperty.call(e,"conversation")&&$root.im_proto.ConversationInfoV2.encode(e.conversation,t.uint32(10).fork()).ldelim(),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(40).int32(e.status),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CreateConversationV2ResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation=$root.im_proto.ConversationInfoV2.decode(e,e.uint32());break;case 2:n.check_code=e.int64();break;case 3:n.check_message=e.string();break;case 4:n.extra_info=e.string();break;case 5:n.status=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.UserActionType=function(){var e={},t=create$9(e);return t[e[1]="ENTER_CONVERSATION"]=1,t[e[2]="EXIT_CONVERSATION"]=2,t}(),e.SendUserActionRequestBody=function(){function e(e){if(this.extra={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.action_type=1,e.prototype.extra=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(32).int32(e.action_type),null!=e.extra&&Object.hasOwnProperty.call(e,"extra"))for(var r=keys(e.extra),n=0;n<r.length;++n)t.uint32(42).fork().uint32(10).string(r[n]).uint32(18).string(e.extra[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.SendUserActionRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.action_type=e.int32();break;case 5:o.extra===$util.emptyObject&&(o.extra={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.extra[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.InputStatus=function(){var e={},t=create$9(e);return t[e[3]="TYPING"]=3,t[e[4]="CLEAR_INPUT"]=4,t}(),e.SendInputStatusRequestBody=function(){function e(e){if(this.extra={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.status=3,e.prototype.extra=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),null!=e.extra&&Object.hasOwnProperty.call(e,"extra"))for(var r=keys(e.extra),n=0;n<r.length;++n)t.uint32(42).fork().uint32(10).string(r[n]).uint32(18).string(e.extra[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.SendInputStatusRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.status=e.int32();break;case 5:o.extra===$util.emptyObject&&(o.extra={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.extra[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.DeleteConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.last_message_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.last_message_index&&Object.hasOwnProperty.call(e,"last_message_index")&&t.uint32(32).int64(e.last_message_index),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DeleteConversationRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.last_message_index=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.DissolveConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DissolveConversationRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.DeleteMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.message_id&&Object.hasOwnProperty.call(e,"message_id")&&t.uint32(32).int64(e.message_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DeleteMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.message_id=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.MarkConversationReadRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.read_message_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.total_unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.read_message_index&&Object.hasOwnProperty.call(e,"read_message_index")&&t.uint32(32).int64(e.read_message_index),null!=e.conv_unread_count&&Object.hasOwnProperty.call(e,"conv_unread_count")&&t.uint32(40).int64(e.conv_unread_count),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(48).int64(e.total_unread_count),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkConversationReadRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.read_message_index=e.int64();break;case 5:n.conv_unread_count=e.int64();break;case 6:n.total_unread_count=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationParticipantsReadIndexV3RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(26).string(e.conversation_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationParticipantsReadIndexV3RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_id=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationParticipantsReadIndexV3ResponseBody=function(){function e(e){if(this.indexes=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.indexes=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.indexes&&e.indexes.length)for(var r=0;r<e.indexes.length;++r)$root.im_proto.ParticipantReadIndex.encode(e.indexes[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationParticipantsReadIndexV3ResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.indexes&&n.indexes.length||(n.indexes=[]),n.indexes.push($root.im_proto.ParticipantReadIndex.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.ParticipantReadIndex=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&t.uint32(24).int64(e.index),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ParticipantReadIndex;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_id=e.int64();break;case 2:n.sec_uid=e.string();break;case 3:n.index=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationParticipantsMinIndexV3RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(26).string(e.conversation_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationParticipantsMinIndexV3RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_id=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationParticipantsMinIndexV3ResponseBody=function(){function e(e){if(this.indexes=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.indexes=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.indexes&&e.indexes.length)for(var r=0;r<e.indexes.length;++r)$root.im_proto.ParticipantMinIndex.encode(e.indexes[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationParticipantsMinIndexV3ResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.indexes&&n.indexes.length||(n.indexes=[]),n.indexes.push($root.im_proto.ParticipantMinIndex.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.ParticipantMinIndex=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.prototype.index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&t.uint32(24).int64(e.index),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ParticipantMinIndex;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_id=e.int64();break;case 2:n.sec_uid=e.string();break;case 3:n.index=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.SendMessageRequestBody=function(){function e(e){if(this.ext={},this.mentioned_users=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=$util.emptyObject,e.prototype.message_type=0,e.prototype.ticket="",e.prototype.client_message_id="",e.prototype.mentioned_users=$util.emptyArray,e.prototype.ref_msg_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(34).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(42).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(58).string(e.ticket),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(66).string(e.client_message_id),null!=e.mentioned_users&&e.mentioned_users.length)for(n=0;n<e.mentioned_users.length;++n)t.uint32(72).int64(e.mentioned_users[n]);return null!=e.ref_msg_info&&Object.hasOwnProperty.call(e,"ref_msg_info")&&$root.im_proto.ReferencedMessageInfo.encode(e.ref_msg_info,t.uint32(90).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.SendMessageRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.content=e.string();break;case 5:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 6:o.message_type=e.int32();break;case 7:o.ticket=e.string();break;case 8:o.client_message_id=e.string();break;case 9:if(o.mentioned_users&&o.mentioned_users.length||(o.mentioned_users=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.mentioned_users.push(e.int64());else o.mentioned_users.push(e.int64());break;case 11:o.ref_msg_info=$root.im_proto.ReferencedMessageInfo.decode(e,e.uint32());break;default:e.skipType(7&s)}}return o},e}(),e.ReferencedMessageInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.referenced_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.hint="",e.prototype.root_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.root_message_conv_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.referenced_message_id),t.uint32(18).string(e.hint),null!=e.root_message_id&&Object.hasOwnProperty.call(e,"root_message_id")&&t.uint32(24).int64(e.root_message_id),null!=e.root_message_conv_index&&Object.hasOwnProperty.call(e,"root_message_conv_index")&&t.uint32(32).int64(e.root_message_conv_index),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ReferencedMessageInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.referenced_message_id=e.int64();break;case 2:n.hint=e.string();break;case 3:n.root_message_id=e.int64();break;case 4:n.root_message_conv_index=e.int64();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("referenced_message_id"))throw $util.ProtocolError("missing required 'referenced_message_id'",{instance:n});if(!n.hasOwnProperty("hint"))throw $util.ProtocolError("missing required 'hint'",{instance:n});return n},e}(),e.SendMessageResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.extra_info="",e.prototype.status=0,e.prototype.client_message_id="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(18).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(34).string(e.client_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SendMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.server_message_id=e.int64();break;case 2:n.extra_info=e.string();break;case 3:n.status=e.int32();break;case 4:n.client_message_id=e.string();break;case 5:n.check_code=e.int64();break;case 6:n.check_message=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.NewMessageNotifyType=function(){var e={},t=create$9(e);return t[e[1]="PER_USER"]=1,t[e[2]="PER_CONVERSATION"]=2,t}(),e.NewMessageNotify=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.notify_type=1,e.prototype.message=null,e.prototype.previous_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.index_in_conversation=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ref_msg_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.notify_type&&Object.hasOwnProperty.call(e,"notify_type")&&t.uint32(32).int32(e.notify_type),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&$root.im_proto.MessageBody.encode(e.message,t.uint32(42).fork()).ldelim(),null!=e.previous_cursor&&Object.hasOwnProperty.call(e,"previous_cursor")&&t.uint32(48).int64(e.previous_cursor),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(56).int64(e.next_cursor),null!=e.index_in_conversation&&Object.hasOwnProperty.call(e,"index_in_conversation")&&t.uint32(64).int64(e.index_in_conversation),null!=e.ref_msg_info&&Object.hasOwnProperty.call(e,"ref_msg_info")&&$root.im_proto.ReferenceInfo.encode(e.ref_msg_info,t.uint32(122).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.NewMessageNotify;e.pos<r;){var i=e.uint32();switch(i>>>3){case 2:n.conversation_id=e.string();break;case 3:n.conversation_type=e.int32();break;case 4:n.notify_type=e.int32();break;case 5:n.message=$root.im_proto.MessageBody.decode(e,e.uint32());break;case 6:n.previous_cursor=e.int64();break;case 7:n.next_cursor=e.int64();break;case 8:n.index_in_conversation=e.int64();break;case 15:n.ref_msg_info=$root.im_proto.ReferenceInfo.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),e.ConversationsPerUserByFavoriteV2RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=500,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationsPerUserByFavoriteV2RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationsPerUserByTopV2RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=500,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationsPerUserByTopV2RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationInfoV2RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationInfoV2RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationInfoListV2RequestBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_info_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var r=0;r<e.conversation_info_list.length;++r)$root.im_proto.GetConversationInfoV2RequestBody.encode(e.conversation_info_list[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationInfoListV2RequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.conversation_info_list&&n.conversation_info_list.length||(n.conversation_info_list=[]),n.conversation_info_list.push($root.im_proto.GetConversationInfoV2RequestBody.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.GetConversationInfoListV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_info_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var r=0;r<e.conversation_info_list.length;++r)$root.im_proto.ConversationInfoV2.encode(e.conversation_info_list[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationInfoListV2ResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.conversation_info_list&&n.conversation_info_list.length||(n.conversation_info_list=[]),n.conversation_info_list.push($root.im_proto.ConversationInfoV2.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.GetConversationInfoListByFavoriteV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_info_list=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var r=0;r<e.conversation_info_list.length;++r)$root.im_proto.ConversationInfoV2.encode(e.conversation_info_list[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationInfoListByFavoriteV2ResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_info_list&&n.conversation_info_list.length||(n.conversation_info_list=[]),n.conversation_info_list.push($root.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationInfoListByTopV2ResponseBody=function(){function e(e){if(this.conversation_info_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_info_list=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_info_list&&e.conversation_info_list.length)for(var r=0;r<e.conversation_info_list.length;++r)$root.im_proto.ConversationInfoV2.encode(e.conversation_info_list[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationInfoListByTopV2ResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_info_list&&n.conversation_info_list.length||(n.conversation_info_list=[]),n.conversation_info_list.push($root.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.RecallMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.RecallMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.server_message_id=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationAddParticipantsRequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.participants=$util.emptyArray,e.prototype.biz_ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var r=0;r<e.participants.length;++r)t.uint32(32).int64(e.participants[r]);if(null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var n=keys(e.biz_ext);for(r=0;r<n.length;++r)t.uint32(42).fork().uint32(10).string(n[r]).uint32(18).string(e.biz_ext[n[r]]).ldelim()}return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ConversationAddParticipantsRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:if(o.participants&&o.participants.length||(o.participants=[]),2==(7&s))for(var a=e.uint32()+e.pos;e.pos<a;)o.participants.push(e.int64());else o.participants.push(e.int64());break;case 5:for(o.biz_ext===$util.emptyObject&&(o.biz_ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.biz_ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.SecUidPair=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.uid=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_uid="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(8).int64(e.uid),null!=e.sec_uid&&Object.hasOwnProperty.call(e,"sec_uid")&&t.uint32(18).string(e.sec_uid),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SecUidPair;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.uid=e.int64();break;case 2:n.sec_uid=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationAddParticipantsResponseBody=function(){function e(e){if(this.success_participants=[],this.failed_participants=[],this.sec_success_participants=[],this.sec_failed_participants=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.success_participants=$util.emptyArray,e.prototype.failed_participants=$util.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.sec_success_participants=$util.emptyArray,e.prototype.sec_failed_participants=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.success_participants&&e.success_participants.length)for(var r=0;r<e.success_participants.length;++r)t.uint32(8).int64(e.success_participants[r]);if(null!=e.failed_participants&&e.failed_participants.length)for(r=0;r<e.failed_participants.length;++r)t.uint32(16).int64(e.failed_participants[r]);if(null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),null!=e.sec_success_participants&&e.sec_success_participants.length)for(r=0;r<e.sec_success_participants.length;++r)$root.im_proto.SecUidPair.encode(e.sec_success_participants[r],t.uint32(58).fork()).ldelim();if(null!=e.sec_failed_participants&&e.sec_failed_participants.length)for(r=0;r<e.sec_failed_participants.length;++r)$root.im_proto.SecUidPair.encode(e.sec_failed_participants[r],t.uint32(66).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationAddParticipantsResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:if(n.success_participants&&n.success_participants.length||(n.success_participants=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.success_participants.push(e.int64());else n.success_participants.push(e.int64());break;case 2:if(n.failed_participants&&n.failed_participants.length||(n.failed_participants=[]),2==(7&i))for(o=e.uint32()+e.pos;e.pos<o;)n.failed_participants.push(e.int64());else n.failed_participants.push(e.int64());break;case 3:n.status=e.int32();break;case 4:n.extra_info=e.string();break;case 5:n.check_code=e.int64();break;case 6:n.check_message=e.string();break;case 7:n.sec_success_participants&&n.sec_success_participants.length||(n.sec_success_participants=[]),n.sec_success_participants.push($root.im_proto.SecUidPair.decode(e,e.uint32()));break;case 8:n.sec_failed_participants&&n.sec_failed_participants.length||(n.sec_failed_participants=[]),n.sec_failed_participants.push($root.im_proto.SecUidPair.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.ConversationRemoveParticipantsRequestBody=function(){function e(e){if(this.participants=[],this.biz_ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.participants=$util.emptyArray,e.prototype.biz_ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.participants&&e.participants.length)for(var r=0;r<e.participants.length;++r)t.uint32(32).int64(e.participants[r]);if(null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext")){var n=keys(e.biz_ext);for(r=0;r<n.length;++r)t.uint32(42).fork().uint32(10).string(n[r]).uint32(18).string(e.biz_ext[n[r]]).ldelim()}return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ConversationRemoveParticipantsRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:if(o.participants&&o.participants.length||(o.participants=[]),2==(7&s))for(var a=e.uint32()+e.pos;e.pos<a;)o.participants.push(e.int64());else o.participants.push(e.int64());break;case 5:for(o.biz_ext===$util.emptyObject&&(o.biz_ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.biz_ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.ConversationRemoveParticipantsResponseBody=function(){function e(e){if(this.failed_participants=[],this.failed_sec_participants=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.failed_participants=$util.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.failed_sec_participants=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.failed_participants&&e.failed_participants.length)for(var r=0;r<e.failed_participants.length;++r)t.uint32(8).int64(e.failed_participants[r]);if(null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),null!=e.failed_sec_participants&&e.failed_sec_participants.length)for(r=0;r<e.failed_sec_participants.length;++r)$root.im_proto.SecUidPair.encode(e.failed_sec_participants[r],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationRemoveParticipantsResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:if(n.failed_participants&&n.failed_participants.length||(n.failed_participants=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_participants.push(e.int64());else n.failed_participants.push(e.int64());break;case 2:n.status=e.int32();break;case 3:n.extra_info=e.string();break;case 4:n.check_code=e.int64();break;case 5:n.check_message=e.string();break;case 6:n.failed_sec_participants&&n.failed_sec_participants.length||(n.failed_sec_participants=[]),n.failed_sec_participants.push($root.im_proto.SecUidPair.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.ConversationLeaveRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationLeaveRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationParticipantsListRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=100,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationParticipantsListRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.cursor=e.int64();break;case 5:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationParticipantsListResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.participants_page=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.participants_page&&Object.hasOwnProperty.call(e,"participants_page")&&$root.im_proto.ParticipantsPage.encode(e.participants_page,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationParticipantsListResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.participants_page=$root.im_proto.ParticipantsPage.decode(e,e.uint32()):e.skipType(7&i)}return n},e}(),e.UpdateConversationParticipantRequestBody=function(){function e(e){if(this.biz_ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.role=0,e.prototype.alias="",e.prototype.is_alias_set=!1,e.prototype.biz_ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(32).int64(e.user_id),null!=e.role&&Object.hasOwnProperty.call(e,"role")&&t.uint32(40).int32(e.role),null!=e.alias&&Object.hasOwnProperty.call(e,"alias")&&t.uint32(50).string(e.alias),null!=e.is_alias_set&&Object.hasOwnProperty.call(e,"is_alias_set")&&t.uint32(56).bool(e.is_alias_set),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext"))for(var r=keys(e.biz_ext),n=0;n<r.length;++n)t.uint32(90).fork().uint32(10).string(r[n]).uint32(18).string(e.biz_ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.UpdateConversationParticipantRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.user_id=e.int64();break;case 5:o.role=e.int32();break;case 6:o.alias=e.string();break;case 7:o.is_alias_set=e.bool();break;case 11:o.biz_ext===$util.emptyObject&&(o.biz_ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.biz_ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.UpdateConversationParticipantResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.participant=null,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.participant&&Object.hasOwnProperty.call(e,"participant")&&$root.im_proto.Participant.encode(e.participant,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UpdateConversationParticipantResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.participant=$root.im_proto.Participant.decode(e,e.uint32());break;case 2:n.status=e.int32();break;case 3:n.extra_info=e.string();break;case 4:n.check_code=e.int64();break;case 5:n.check_message=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationCoreInfoRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationCoreInfoRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationCoreInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_core_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&$root.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationCoreInfoResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.conversation_core_info=$root.im_proto.ConversationCoreInfo.decode(e,e.uint32()):e.skipType(7&i)}return n},e}(),e.SetConversationCoreInfoRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.name="",e.prototype.desc="",e.prototype.icon="",e.prototype.notice="",e.prototype.is_name_set=!1,e.prototype.is_desc_set=!1,e.prototype.is_icon_set=!1,e.prototype.is_notice_set=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(34).string(e.name),null!=e.desc&&Object.hasOwnProperty.call(e,"desc")&&t.uint32(42).string(e.desc),null!=e.icon&&Object.hasOwnProperty.call(e,"icon")&&t.uint32(50).string(e.icon),null!=e.notice&&Object.hasOwnProperty.call(e,"notice")&&t.uint32(58).string(e.notice),null!=e.is_name_set&&Object.hasOwnProperty.call(e,"is_name_set")&&t.uint32(64).bool(e.is_name_set),null!=e.is_desc_set&&Object.hasOwnProperty.call(e,"is_desc_set")&&t.uint32(72).bool(e.is_desc_set),null!=e.is_icon_set&&Object.hasOwnProperty.call(e,"is_icon_set")&&t.uint32(80).bool(e.is_icon_set),null!=e.is_notice_set&&Object.hasOwnProperty.call(e,"is_notice_set")&&t.uint32(88).bool(e.is_notice_set),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetConversationCoreInfoRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.name=e.string();break;case 5:n.desc=e.string();break;case 6:n.icon=e.string();break;case 7:n.notice=e.string();break;case 8:n.is_name_set=e.bool();break;case 9:n.is_desc_set=e.bool();break;case 10:n.is_icon_set=e.bool();break;case 11:n.is_notice_set=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.SetConversationCoreInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_core_info=null,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_core_info&&Object.hasOwnProperty.call(e,"conversation_core_info")&&$root.im_proto.ConversationCoreInfo.encode(e.conversation_core_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(26).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(32).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(42).string(e.check_message),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetConversationCoreInfoResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_core_info=$root.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 2:n.status=e.int32();break;case 3:n.extra_info=e.string();break;case 4:n.check_code=e.int64();break;case 5:n.check_message=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.UpsertConversationCoreExtInfoRequestBody=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(34).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.UpsertConversationCoreExtInfoRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.UpsertConversationCoreExtInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.core_info=null,e.prototype.status=0,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.core_info&&Object.hasOwnProperty.call(e,"core_info")&&$root.im_proto.ConversationCoreInfo.encode(e.core_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UpsertConversationCoreExtInfoResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.core_info=$root.im_proto.ConversationCoreInfo.decode(e,e.uint32());break;case 2:n.status=e.int32();break;case 3:n.check_code=e.int64();break;case 4:n.check_message=e.string();break;case 5:n.extra_info=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.SetConversationSettingInfoRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.set_stick_on_top=!1,e.prototype.set_mute=!1,e.prototype.set_favorite=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.set_stick_on_top&&Object.hasOwnProperty.call(e,"set_stick_on_top")&&t.uint32(32).bool(e.set_stick_on_top),null!=e.set_mute&&Object.hasOwnProperty.call(e,"set_mute")&&t.uint32(40).bool(e.set_mute),null!=e.set_favorite&&Object.hasOwnProperty.call(e,"set_favorite")&&t.uint32(48).bool(e.set_favorite),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetConversationSettingInfoRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.set_stick_on_top=e.bool();break;case 5:n.set_mute=e.bool();break;case 6:n.set_favorite=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.SetConversationSettingInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.setting_info=null,e.prototype.status=0,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.setting_info&&Object.hasOwnProperty.call(e,"setting_info")&&$root.im_proto.ConversationSettingInfo.encode(e.setting_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetConversationSettingInfoResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.setting_info=$root.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;case 2:n.status=e.int32();break;case 3:n.check_code=e.int64();break;case 4:n.check_message=e.string();break;case 5:n.extra_info=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.UpsertConversationSettingExtInfoRequestBody=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(34).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.UpsertConversationSettingExtInfoRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_short_id=e.int64();break;case 3:o.conversation_type=e.int32();break;case 4:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.UpsertConversationSettingExtInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.setting_info=null,e.prototype.status=0,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.extra_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.setting_info&&Object.hasOwnProperty.call(e,"setting_info")&&$root.im_proto.ConversationSettingInfo.encode(e.setting_info,t.uint32(10).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(24).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(34).string(e.check_message),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(42).string(e.extra_info),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UpsertConversationSettingExtInfoResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.setting_info=$root.im_proto.ConversationSettingInfo.decode(e,e.uint32());break;case 2:n.status=e.int32();break;case 3:n.check_code=e.int64();break;case 4:n.check_message=e.string();break;case 5:n.extra_info=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.StrangerConversation=function(){function e(e){if(this.participants=[],this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.unread=0,e.prototype.last_message=null,e.prototype.conversation_id="",e.prototype.participants=$util.emptyArray,e.prototype.ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.unread&&Object.hasOwnProperty.call(e,"unread")&&t.uint32(16).int32(e.unread),null!=e.last_message&&Object.hasOwnProperty.call(e,"last_message")&&$root.im_proto.MessageBody.encode(e.last_message,t.uint32(26).fork()).ldelim(),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(34).string(e.conversation_id),null!=e.participants&&e.participants.length)for(var r=0;r<e.participants.length;++r)$root.im_proto.Participant.encode(e.participants[r],t.uint32(42).fork()).ldelim();if(null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var n=keys(e.ext);for(r=0;r<n.length;++r)t.uint32(58).fork().uint32(10).string(n[r]).uint32(18).string(e.ext[n[r]]).ldelim()}return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.StrangerConversation;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.unread=e.int32();break;case 3:o.last_message=$root.im_proto.MessageBody.decode(e,e.uint32());break;case 4:o.conversation_id=e.string();break;case 5:o.participants&&o.participants.length||(o.participants=[]),o.participants.push($root.im_proto.Participant.decode(e,e.uint32()));break;case 7:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.GetStrangerConversationListRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.count=$util.Long?$util.Long.fromBits(50,0,!1):50,e.prototype.show_total_unread=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.count&&Object.hasOwnProperty.call(e,"count")&&t.uint32(16).int64(e.count),null!=e.show_total_unread&&Object.hasOwnProperty.call(e,"show_total_unread")&&t.uint32(24).bool(e.show_total_unread),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetStrangerConversationListRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.count=e.int64();break;case 3:n.show_total_unread=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.GetStrangerConversationListResponseBody=function(){function e(e){if(this.conversation_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.has_more=!1,e.prototype.total_unread=0,e.prototype.conversation_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(8).int64(e.next_cursor),null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.total_unread&&Object.hasOwnProperty.call(e,"total_unread")&&t.uint32(24).int32(e.total_unread),null!=e.conversation_list&&e.conversation_list.length)for(var r=0;r<e.conversation_list.length;++r)$root.im_proto.StrangerConversation.encode(e.conversation_list[r],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetStrangerConversationListResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.next_cursor=e.int64();break;case 2:n.has_more=e.bool();break;case 3:n.total_unread=e.int32();break;case 4:n.conversation_list&&n.conversation_list.length||(n.conversation_list=[]),n.conversation_list.push($root.im_proto.StrangerConversation.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.GetStrangerMessagesRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.reset_unread_count=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.reset_unread_count&&Object.hasOwnProperty.call(e,"reset_unread_count")&&t.uint32(16).bool(e.reset_unread_count),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetStrangerMessagesRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.reset_unread_count=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.GetStrangerMessagesResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetStrangerMessagesResponseBody;e.pos<r;){var i=e.uint32();i>>>3==3?(n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.DeleteStrangerMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DeleteStrangerMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.server_message_id=e.int64();break;case 2:n.conversation_short_id=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.DeleteStrangerConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DeleteStrangerConversationRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.conversation_short_id=e.int64():e.skipType(7&i)}return n},e}(),e.DeleteStrangerAllConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.DeleteStrangerAllConversationRequestBody;e.pos<r;){var i=e.uint32();e.skipType(7&i)}return n},e}(),e.MarkStrangerConversationReadRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkStrangerConversationReadRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.conversation_short_id=e.int64():e.skipType(7&i)}return n},e}(),e.MarkStrangerAllConversationReadRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkStrangerAllConversationReadRequestBody;e.pos<r;){var i=e.uint32();e.skipType(7&i)}return n},e}(),e.OPERATION_TYPE=function(){var e={},t=create$9(e);return t[e[0]="ADD_PROPERTY_ITEM"]=0,t[e[1]="REMOVE_PROPERTY_ITEM"]=1,t[e[2]="SET_PROPERTY"]=2,t[e[3]="DEL_PROPERTY"]=3,t}(),e.ModifyPropertyContent=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.operation=0,e.prototype.key="",e.prototype.value="",e.prototype.idempotent_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.operation&&Object.hasOwnProperty.call(e,"operation")&&t.uint32(8).int32(e.operation),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(18).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(26).string(e.value),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(34).string(e.idempotent_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ModifyPropertyContent;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.operation=e.int32();break;case 2:n.key=e.string();break;case 3:n.value=e.string();break;case 4:n.idempotent_id=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.ModifyPropertyBody=function(){function e(e){if(this.modify_property_content=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.client_message_id="",e.prototype.modify_property_content=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(42).string(e.client_message_id),null!=e.modify_property_content&&e.modify_property_content.length)for(var r=0;r<e.modify_property_content.length;++r)$root.im_proto.ModifyPropertyContent.encode(e.modify_property_content[r],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ModifyPropertyBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.server_message_id=e.int64();break;case 5:n.client_message_id=e.string();break;case 6:n.modify_property_content&&n.modify_property_content.length||(n.modify_property_content=[]),n.modify_property_content.push($root.im_proto.ModifyPropertyContent.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.ModifyMessagePropertyRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.property_list=null,e.prototype.ticket="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.property_list&&Object.hasOwnProperty.call(e,"property_list")&&$root.im_proto.ModifyPropertyBody.encode(e.property_list,t.uint32(10).fork()).ldelim(),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(18).string(e.ticket),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ModifyMessagePropertyRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.property_list=$root.im_proto.ModifyPropertyBody.decode(e,e.uint32());break;case 2:n.ticket=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.ModifyMessagePropertyStatus=function(){var e={},t=create$9(e);return t[e[0]="MODIFY_PROPERTY_SUCCESS"]=0,t[e[1]="MODIFY_PROPERTY_REPEAT_REQUEST"]=1,t[e[2]="MODIFY_PROPERTY_INVALID_LENGTH"]=2,t[e[3]="MODIFY_PROPERTY_INVALID_REQUEST"]=3,t[e[4]="MODIFY_PROPERTY_CALLBACK_ERROR"]=4,t[e[500]="MODIFY_PROPERTY_INTERNAL_ERROR"]=500,t}(),e.ModifyMessagePropertyResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.status=0,e.prototype.version=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).int32(e.status),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(16).int64(e.version),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ModifyMessagePropertyResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.status=e.int32();break;case 2:n.version=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.MediaType=function(){var e={},t=create$9(e);return t[e[1]="IMG"]=1,t[e[2]="VIDEO"]=2,t[e[3]="AUDIO"]=3,t[e[4]="FILE"]=4,t[e[10]="OTHER"]=10,t}(),e.MediaTokenType=function(){var e={},t=create$9(e);return t[e[1]="VSDK"]=1,t[e[2]="IMAGEX"]=2,t}(),e.GetUploadTokenRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.vsdk_version="",e.prototype.token_type=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.vsdk_version&&Object.hasOwnProperty.call(e,"vsdk_version")&&t.uint32(10).string(e.vsdk_version),null!=e.token_type&&Object.hasOwnProperty.call(e,"token_type")&&t.uint32(16).int32(e.token_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetUploadTokenRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.vsdk_version=e.string();break;case 2:n.token_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetUploadTokenResponseBody=function(){function e(e){if(this.hosts=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.access_key="",e.prototype.hosts=$util.emptyArray,e.prototype.token="",e.prototype.token_type=1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.access_key&&Object.hasOwnProperty.call(e,"access_key")&&t.uint32(10).string(e.access_key),null!=e.hosts&&e.hosts.length)for(var r=0;r<e.hosts.length;++r)t.uint32(18).string(e.hosts[r]);return null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(26).string(e.token),null!=e.token_type&&Object.hasOwnProperty.call(e,"token_type")&&t.uint32(32).int32(e.token_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetUploadTokenResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.access_key=e.string();break;case 2:n.hosts&&n.hosts.length||(n.hosts=[]),n.hosts.push(e.string());break;case 3:n.token=e.string();break;case 4:n.token_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.ImgOption=function(){function e(e){if(this.params=[],this.urls=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.tplv="",e.prototype.params=$util.emptyArray,e.prototype.format="",e.prototype.urls=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.tplv&&Object.hasOwnProperty.call(e,"tplv")&&t.uint32(10).string(e.tplv),null!=e.params&&e.params.length)for(var r=0;r<e.params.length;++r)t.uint32(18).string(e.params[r]);if(null!=e.format&&Object.hasOwnProperty.call(e,"format")&&t.uint32(26).string(e.format),null!=e.urls&&e.urls.length)for(r=0;r<e.urls.length;++r)t.uint32(802).string(e.urls[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ImgOption;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.tplv=e.string();break;case 2:n.params&&n.params.length||(n.params=[]),n.params.push(e.string());break;case 3:n.format=e.string();break;case 100:n.urls&&n.urls.length||(n.urls=[]),n.urls.push(e.string());break;default:e.skipType(7&i)}}return n},e}(),e.VideoOption=function(){function e(e){if(this.urls=[],this.cover_urls=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.vid="",e.prototype.cover_uri="",e.prototype.urls=$util.emptyArray,e.prototype.cover_urls=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.vid&&Object.hasOwnProperty.call(e,"vid")&&t.uint32(10).string(e.vid),null!=e.cover_uri&&Object.hasOwnProperty.call(e,"cover_uri")&&t.uint32(18).string(e.cover_uri),null!=e.urls&&e.urls.length)for(var r=0;r<e.urls.length;++r)t.uint32(802).string(e.urls[r]);if(null!=e.cover_urls&&e.cover_urls.length)for(r=0;r<e.cover_urls.length;++r)t.uint32(810).string(e.cover_urls[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.VideoOption;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.vid=e.string();break;case 2:n.cover_uri=e.string();break;case 100:n.urls&&n.urls.length||(n.urls=[]),n.urls.push(e.string());break;case 101:n.cover_urls&&n.cover_urls.length||(n.cover_urls=[]),n.cover_urls.push(e.string());break;default:e.skipType(7&i)}}return n},e}(),e.AudioOption=function(){function e(e){if(this.urls=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.vid="",e.prototype.urls=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.vid&&Object.hasOwnProperty.call(e,"vid")&&t.uint32(10).string(e.vid),null!=e.urls&&e.urls.length)for(var r=0;r<e.urls.length;++r)t.uint32(802).string(e.urls[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.AudioOption;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.vid=e.string();break;case 100:n.urls&&n.urls.length||(n.urls=[]),n.urls.push(e.string());break;default:e.skipType(7&i)}}return n},e}(),e.FileOption=function(){function e(e){if(this.urls=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.urls=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.urls&&e.urls.length)for(var r=0;r<e.urls.length;++r)t.uint32(802).string(e.urls[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.FileOption;e.pos<r;){var i=e.uint32();i>>>3==100?(n.urls&&n.urls.length||(n.urls=[]),n.urls.push(e.string())):e.skipType(7&i)}return n},e}(),e.ReadURLFrom=function(){var e={},t=create$9(e);return t[e[1]="URL_VSDK"]=1,t[e[2]="URL_IMAGEX"]=2,t}(),e.GetMediaUrlsRequestBody=function(){function e(e){if(this.img_options=[],this.video_options=[],this.audio_options=[],this.file_options=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.source_appid=0,e.prototype.uri="",e.prototype.media_type=0,e.prototype.encrypted=!1,e.prototype.img_options=$util.emptyArray,e.prototype.video_options=$util.emptyArray,e.prototype.audio_options=$util.emptyArray,e.prototype.file_options=$util.emptyArray,e.prototype.encrypted_uri="",e.prototype.read_url_from=1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.source_appid&&Object.hasOwnProperty.call(e,"source_appid")&&t.uint32(8).int32(e.source_appid),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(18).string(e.uri),null!=e.media_type&&Object.hasOwnProperty.call(e,"media_type")&&t.uint32(24).int32(e.media_type),null!=e.encrypted&&Object.hasOwnProperty.call(e,"encrypted")&&t.uint32(32).bool(e.encrypted),null!=e.img_options&&e.img_options.length)for(var r=0;r<e.img_options.length;++r)$root.im_proto.ImgOption.encode(e.img_options[r],t.uint32(42).fork()).ldelim();if(null!=e.video_options&&e.video_options.length)for(r=0;r<e.video_options.length;++r)$root.im_proto.VideoOption.encode(e.video_options[r],t.uint32(50).fork()).ldelim();if(null!=e.audio_options&&e.audio_options.length)for(r=0;r<e.audio_options.length;++r)$root.im_proto.AudioOption.encode(e.audio_options[r],t.uint32(58).fork()).ldelim();if(null!=e.file_options&&e.file_options.length)for(r=0;r<e.file_options.length;++r)$root.im_proto.FileOption.encode(e.file_options[r],t.uint32(66).fork()).ldelim();return null!=e.encrypted_uri&&Object.hasOwnProperty.call(e,"encrypted_uri")&&t.uint32(74).string(e.encrypted_uri),null!=e.read_url_from&&Object.hasOwnProperty.call(e,"read_url_from")&&t.uint32(80).int32(e.read_url_from),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMediaUrlsRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.source_appid=e.int32();break;case 2:n.uri=e.string();break;case 3:n.media_type=e.int32();break;case 4:n.encrypted=e.bool();break;case 5:n.img_options&&n.img_options.length||(n.img_options=[]),n.img_options.push($root.im_proto.ImgOption.decode(e,e.uint32()));break;case 6:n.video_options&&n.video_options.length||(n.video_options=[]),n.video_options.push($root.im_proto.VideoOption.decode(e,e.uint32()));break;case 7:n.audio_options&&n.audio_options.length||(n.audio_options=[]),n.audio_options.push($root.im_proto.AudioOption.decode(e,e.uint32()));break;case 8:n.file_options&&n.file_options.length||(n.file_options=[]),n.file_options.push($root.im_proto.FileOption.decode(e,e.uint32()));break;case 9:n.encrypted_uri=e.string();break;case 10:n.read_url_from=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetMediaUrlsResponseBody=function(){function e(e){if(this.img_options=[],this.video_options=[],this.audio_options=[],this.file_options=[],this.encrypted_urls=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.uri="",e.prototype.media_type=0,e.prototype.img_options=$util.emptyArray,e.prototype.video_options=$util.emptyArray,e.prototype.audio_options=$util.emptyArray,e.prototype.file_options=$util.emptyArray,e.prototype.encrypted_urls=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(10).string(e.uri),null!=e.media_type&&Object.hasOwnProperty.call(e,"media_type")&&t.uint32(16).int32(e.media_type),null!=e.img_options&&e.img_options.length)for(var r=0;r<e.img_options.length;++r)$root.im_proto.ImgOption.encode(e.img_options[r],t.uint32(26).fork()).ldelim();if(null!=e.video_options&&e.video_options.length)for(r=0;r<e.video_options.length;++r)$root.im_proto.VideoOption.encode(e.video_options[r],t.uint32(34).fork()).ldelim();if(null!=e.audio_options&&e.audio_options.length)for(r=0;r<e.audio_options.length;++r)$root.im_proto.AudioOption.encode(e.audio_options[r],t.uint32(42).fork()).ldelim();if(null!=e.file_options&&e.file_options.length)for(r=0;r<e.file_options.length;++r)$root.im_proto.FileOption.encode(e.file_options[r],t.uint32(50).fork()).ldelim();if(null!=e.encrypted_urls&&e.encrypted_urls.length)for(r=0;r<e.encrypted_urls.length;++r)t.uint32(58).string(e.encrypted_urls[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMediaUrlsResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.uri=e.string();break;case 2:n.media_type=e.int32();break;case 3:n.img_options&&n.img_options.length||(n.img_options=[]),n.img_options.push($root.im_proto.ImgOption.decode(e,e.uint32()));break;case 4:n.video_options&&n.video_options.length||(n.video_options=[]),n.video_options.push($root.im_proto.VideoOption.decode(e,e.uint32()));break;case 5:n.audio_options&&n.audio_options.length||(n.audio_options=[]),n.audio_options.push($root.im_proto.AudioOption.decode(e,e.uint32()));break;case 6:n.file_options&&n.file_options.length||(n.file_options=[]),n.file_options.push($root.im_proto.FileOption.decode(e,e.uint32()));break;case 7:n.encrypted_urls&&n.encrypted_urls.length||(n.encrypted_urls=[]),n.encrypted_urls.push(e.string());break;default:e.skipType(7&i)}}return n},e}(),e.GetTicketRequestBody=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.ticket_type=1,e.prototype.conversation_type=1,e.prototype.to_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.ticket_type&&Object.hasOwnProperty.call(e,"ticket_type")&&t.uint32(8).int32(e.ticket_type),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.to_id&&Object.hasOwnProperty.call(e,"to_id")&&t.uint32(32).int64(e.to_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(82).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.GetTicketRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.ticket_type=e.int32();break;case 2:o.conversation_type=e.int32();break;case 4:o.to_id=e.int64();break;case 5:o.conversation_short_id=e.int64();break;case 10:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.GetTicketResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.ticket="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(10).string(e.ticket),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetTicketResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.ticket=e.string():e.skipType(7&i)}return n},e}(),e.SortType=function(){var e={},t=create$9(e);return t[e[1]="JOIN_TIME"]=1,t[e[2]="CREATED_TIME"]=2,t[e[3]="GROUP_NAME"]=3,t[e[4]="ACTIVE_TIME"]=4,t}(),e.GetUserConversationListRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sort_type=1,e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.con_type=1,e.prototype.limit=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.include_role=0,e.prototype.exclude_role=0,e.prototype.with_cold=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.sort_type&&Object.hasOwnProperty.call(e,"sort_type")&&t.uint32(8).int32(e.sort_type),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(16).int64(e.cursor),null!=e.con_type&&Object.hasOwnProperty.call(e,"con_type")&&t.uint32(24).int32(e.con_type),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(32).int64(e.limit),null!=e.include_role&&Object.hasOwnProperty.call(e,"include_role")&&t.uint32(40).int32(e.include_role),null!=e.exclude_role&&Object.hasOwnProperty.call(e,"exclude_role")&&t.uint32(48).int32(e.exclude_role),null!=e.with_cold&&Object.hasOwnProperty.call(e,"with_cold")&&t.uint32(64).bool(e.with_cold),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetUserConversationListRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sort_type=e.int32();break;case 2:n.cursor=e.int64();break;case 3:n.con_type=e.int32();break;case 4:n.limit=e.int64();break;case 5:n.include_role=e.int32();break;case 6:n.exclude_role=e.int32();break;case 8:n.with_cold=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.GetUserConversationListResponseBody=function(){function e(e){if(this.list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.list=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.list&&e.list.length)for(var r=0;r<e.list.length;++r)$root.im_proto.ConversationInfoV2.encode(e.list[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetUserConversationListResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.list&&n.list.length||(n.list=[]),n.list.push($root.im_proto.ConversationInfoV2.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ModifyMessageExtRequestBody=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ticket="",e.prototype.ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).int64(e.conversation_short_id),t.uint32(16).int64(e.message_id),t.uint32(26).string(e.ticket),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(34).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ModifyMessageExtRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_short_id=e.int64();break;case 2:o.message_id=e.int64();break;case 3:o.ticket=e.string();break;case 4:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;default:e.skipType(7&s)}}if(!o.hasOwnProperty("conversation_short_id"))throw $util.ProtocolError("missing required 'conversation_short_id'",{instance:o});if(!o.hasOwnProperty("message_id"))throw $util.ProtocolError("missing required 'message_id'",{instance:o});if(!o.hasOwnProperty("ticket"))throw $util.ProtocolError("missing required 'ticket'",{instance:o});return o},e}(),e.RequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.send_message_body=null,e.prototype.messages_per_user_body=null,e.prototype.messages_per_user_init_v2_body=null,e.prototype.get_message_by_id_body=null,e.prototype.messages_in_conversation_body=null,e.prototype.get_messages_checkinfo_in_conversation_body=null,e.prototype.send_user_action_body=null,e.prototype.send_input_status_body=null,e.prototype.delete_conversation_body=null,e.prototype.mark_conversation_read_body=null,e.prototype.conversation_participants_body=null,e.prototype.dissolve_conversation_body=null,e.prototype.create_conversation_v2_body=null,e.prototype.get_conversation_info_list_v2_body=null,e.prototype.get_conversation_info_list_by_favorite_v2_body=null,e.prototype.get_conversation_info_list_by_top_v2_body=null,e.prototype.conversation_add_participants_body=null,e.prototype.conversation_remove_participants_body=null,e.prototype.leave_conversation_body=null,e.prototype.update_conversation_participant_body=null,e.prototype.delete_message_body=null,e.prototype.recall_message_body=null,e.prototype.modify_message_property_body=null,e.prototype.get_conversation_core_info_body=null,e.prototype.set_conversation_core_info_body=null,e.prototype.upsert_conversation_core_ext_info_body=null,e.prototype.set_conversation_setting_info_body=null,e.prototype.upsert_conversation_setting_ext_info_body=null,e.prototype.get_stranger_conversation_body=null,e.prototype.get_stranger_messages_body=null,e.prototype.delete_stranger_message_body=null,e.prototype.delete_stranger_conversation_body=null,e.prototype.delete_stranger_all_conversation_body=null,e.prototype.mark_stranger_conversation_read_body=null,e.prototype.mark_stranger_all_conversation_read_body=null,e.prototype.participants_read_index_body=null,e.prototype.participants_min_index_body=null,e.prototype.get_upload_token_body=null,e.prototype.get_media_urls_body=null,e.prototype.get_ticket_body=null,e.prototype.get_conversation_list_body=null,e.prototype.broadcast_send_message_body=null,e.prototype.broadcast_recv_message_body=null,e.prototype.broadcast_user_counter_body=null,e.prototype.client_ack_body=null,e.prototype.create_voip_body=null,e.prototype.call_voip_body=null,e.prototype.update_voip_body=null,e.prototype.channel_heartbeat_body=null,e.prototype.profile_get_info=null,e.prototype.report_client_metrics_body=null,e.prototype.get_configs_body=null,e.prototype.modify_message_ext_body=null,e.prototype.unread_count_report_body=null,e.prototype.block_members_body=null,e.prototype.block_conversation_body=null,e.prototype.get_unread_count_body=null,e.prototype.send_message_p2p_body=null,e.prototype.get_blocklist_body=null,e.prototype.set_blocklist_body=null,e.prototype.check_in_blocklist_body=null,e.prototype.mark_message_body=null,e.prototype.pull_mark_message_body=null,e.prototype.mark_msg_unread_count_report=null,e.prototype.mark_msg_get_unread_count=null,e.prototype.batch_unmark_message=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.send_message_body&&Object.hasOwnProperty.call(e,"send_message_body")&&$root.im_proto.SendMessageRequestBody.encode(e.send_message_body,t.uint32(802).fork()).ldelim(),null!=e.messages_per_user_body&&Object.hasOwnProperty.call(e,"messages_per_user_body")&&$root.im_proto.MessagesPerUserRequestBody.encode(e.messages_per_user_body,t.uint32(1602).fork()).ldelim(),null!=e.messages_per_user_init_v2_body&&Object.hasOwnProperty.call(e,"messages_per_user_init_v2_body")&&$root.im_proto.MessagesPerUserInitV2RequestBody.encode(e.messages_per_user_init_v2_body,t.uint32(1626).fork()).ldelim(),null!=e.get_message_by_id_body&&Object.hasOwnProperty.call(e,"get_message_by_id_body")&&$root.im_proto.GetMessageByIdRequestBody.encode(e.get_message_by_id_body,t.uint32(1690).fork()).ldelim(),null!=e.messages_in_conversation_body&&Object.hasOwnProperty.call(e,"messages_in_conversation_body")&&$root.im_proto.MessagesInConversationRequestBody.encode(e.messages_in_conversation_body,t.uint32(2410).fork()).ldelim(),null!=e.get_messages_checkinfo_in_conversation_body&&Object.hasOwnProperty.call(e,"get_messages_checkinfo_in_conversation_body")&&$root.im_proto.GetMessagesCheckInfoInConversationRequestBody.encode(e.get_messages_checkinfo_in_conversation_body,t.uint32(2418).fork()).ldelim(),null!=e.send_user_action_body&&Object.hasOwnProperty.call(e,"send_user_action_body")&&$root.im_proto.SendUserActionRequestBody.encode(e.send_user_action_body,t.uint32(3282).fork()).ldelim(),null!=e.send_input_status_body&&Object.hasOwnProperty.call(e,"send_input_status_body")&&$root.im_proto.SendInputStatusRequestBody.encode(e.send_input_status_body,t.uint32(3290).fork()).ldelim(),null!=e.delete_conversation_body&&Object.hasOwnProperty.call(e,"delete_conversation_body")&&$root.im_proto.DeleteConversationRequestBody.encode(e.delete_conversation_body,t.uint32(4826).fork()).ldelim(),null!=e.mark_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_conversation_read_body")&&$root.im_proto.MarkConversationReadRequestBody.encode(e.mark_conversation_read_body,t.uint32(4834).fork()).ldelim(),null!=e.conversation_participants_body&&Object.hasOwnProperty.call(e,"conversation_participants_body")&&$root.im_proto.ConversationParticipantsListRequestBody.encode(e.conversation_participants_body,t.uint32(4842).fork()).ldelim(),null!=e.create_conversation_v2_body&&Object.hasOwnProperty.call(e,"create_conversation_v2_body")&&$root.im_proto.CreateConversationV2RequestBody.encode(e.create_conversation_v2_body,t.uint32(4874).fork()).ldelim(),null!=e.get_conversation_info_list_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_v2_body")&&$root.im_proto.GetConversationInfoListV2RequestBody.encode(e.get_conversation_info_list_v2_body,t.uint32(4882).fork()).ldelim(),null!=e.get_conversation_info_list_by_favorite_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_favorite_v2_body")&&$root.im_proto.ConversationsPerUserByFavoriteV2RequestBody.encode(e.get_conversation_info_list_by_favorite_v2_body,t.uint32(4890).fork()).ldelim(),null!=e.get_conversation_info_list_by_top_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_top_v2_body")&&$root.im_proto.ConversationsPerUserByTopV2RequestBody.encode(e.get_conversation_info_list_by_top_v2_body,t.uint32(4898).fork()).ldelim(),null!=e.dissolve_conversation_body&&Object.hasOwnProperty.call(e,"dissolve_conversation_body")&&$root.im_proto.DissolveConversationRequestBody.encode(e.dissolve_conversation_body,t.uint32(4914).fork()).ldelim(),null!=e.conversation_add_participants_body&&Object.hasOwnProperty.call(e,"conversation_add_participants_body")&&$root.im_proto.ConversationAddParticipantsRequestBody.encode(e.conversation_add_participants_body,t.uint32(5202).fork()).ldelim(),null!=e.conversation_remove_participants_body&&Object.hasOwnProperty.call(e,"conversation_remove_participants_body")&&$root.im_proto.ConversationRemoveParticipantsRequestBody.encode(e.conversation_remove_participants_body,t.uint32(5210).fork()).ldelim(),null!=e.leave_conversation_body&&Object.hasOwnProperty.call(e,"leave_conversation_body")&&$root.im_proto.ConversationLeaveRequestBody.encode(e.leave_conversation_body,t.uint32(5218).fork()).ldelim(),null!=e.update_conversation_participant_body&&Object.hasOwnProperty.call(e,"update_conversation_participant_body")&&$root.im_proto.UpdateConversationParticipantRequestBody.encode(e.update_conversation_participant_body,t.uint32(5242).fork()).ldelim(),null!=e.delete_message_body&&Object.hasOwnProperty.call(e,"delete_message_body")&&$root.im_proto.DeleteMessageRequestBody.encode(e.delete_message_body,t.uint32(5610).fork()).ldelim(),null!=e.recall_message_body&&Object.hasOwnProperty.call(e,"recall_message_body")&&$root.im_proto.RecallMessageRequestBody.encode(e.recall_message_body,t.uint32(5618).fork()).ldelim(),null!=e.modify_message_property_body&&Object.hasOwnProperty.call(e,"modify_message_property_body")&&$root.im_proto.ModifyMessagePropertyRequestBody.encode(e.modify_message_property_body,t.uint32(5642).fork()).ldelim(),null!=e.get_conversation_core_info_body&&Object.hasOwnProperty.call(e,"get_conversation_core_info_body")&&$root.im_proto.GetConversationCoreInfoRequestBody.encode(e.get_conversation_core_info_body,t.uint32(7210).fork()).ldelim(),null!=e.set_conversation_core_info_body&&Object.hasOwnProperty.call(e,"set_conversation_core_info_body")&&$root.im_proto.SetConversationCoreInfoRequestBody.encode(e.set_conversation_core_info_body,t.uint32(7218).fork()).ldelim(),null!=e.upsert_conversation_core_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_core_ext_info_body")&&$root.im_proto.UpsertConversationCoreExtInfoRequestBody.encode(e.upsert_conversation_core_ext_info_body,t.uint32(7234).fork()).ldelim(),null!=e.set_conversation_setting_info_body&&Object.hasOwnProperty.call(e,"set_conversation_setting_info_body")&&$root.im_proto.SetConversationSettingInfoRequestBody.encode(e.set_conversation_setting_info_body,t.uint32(7370).fork()).ldelim(),null!=e.upsert_conversation_setting_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_setting_ext_info_body")&&$root.im_proto.UpsertConversationSettingExtInfoRequestBody.encode(e.upsert_conversation_setting_ext_info_body,t.uint32(7378).fork()).ldelim(),null!=e.get_stranger_conversation_body&&Object.hasOwnProperty.call(e,"get_stranger_conversation_body")&&$root.im_proto.GetStrangerConversationListRequestBody.encode(e.get_stranger_conversation_body,t.uint32(8002).fork()).ldelim(),null!=e.get_stranger_messages_body&&Object.hasOwnProperty.call(e,"get_stranger_messages_body")&&$root.im_proto.GetStrangerMessagesRequestBody.encode(e.get_stranger_messages_body,t.uint32(8010).fork()).ldelim(),null!=e.delete_stranger_message_body&&Object.hasOwnProperty.call(e,"delete_stranger_message_body")&&$root.im_proto.DeleteStrangerMessageRequestBody.encode(e.delete_stranger_message_body,t.uint32(8018).fork()).ldelim(),null!=e.delete_stranger_conversation_body&&Object.hasOwnProperty.call(e,"delete_stranger_conversation_body")&&$root.im_proto.DeleteStrangerConversationRequestBody.encode(e.delete_stranger_conversation_body,t.uint32(8026).fork()).ldelim(),null!=e.delete_stranger_all_conversation_body&&Object.hasOwnProperty.call(e,"delete_stranger_all_conversation_body")&&$root.im_proto.DeleteStrangerAllConversationRequestBody.encode(e.delete_stranger_all_conversation_body,t.uint32(8034).fork()).ldelim(),null!=e.mark_stranger_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_stranger_conversation_read_body")&&$root.im_proto.MarkStrangerConversationReadRequestBody.encode(e.mark_stranger_conversation_read_body,t.uint32(8042).fork()).ldelim(),null!=e.mark_stranger_all_conversation_read_body&&Object.hasOwnProperty.call(e,"mark_stranger_all_conversation_read_body")&&$root.im_proto.MarkStrangerAllConversationReadRequestBody.encode(e.mark_stranger_all_conversation_read_body,t.uint32(8050).fork()).ldelim(),null!=e.participants_read_index_body&&Object.hasOwnProperty.call(e,"participants_read_index_body")&&$root.im_proto.GetConversationParticipantsReadIndexV3RequestBody.encode(e.participants_read_index_body,t.uint32(16002).fork()).ldelim(),null!=e.participants_min_index_body&&Object.hasOwnProperty.call(e,"participants_min_index_body")&&$root.im_proto.GetConversationParticipantsMinIndexV3RequestBody.encode(e.participants_min_index_body,t.uint32(16010).fork()).ldelim(),null!=e.get_upload_token_body&&Object.hasOwnProperty.call(e,"get_upload_token_body")&&$root.im_proto.GetUploadTokenRequestBody.encode(e.get_upload_token_body,t.uint32(16026).fork()).ldelim(),null!=e.get_media_urls_body&&Object.hasOwnProperty.call(e,"get_media_urls_body")&&$root.im_proto.GetMediaUrlsRequestBody.encode(e.get_media_urls_body,t.uint32(16034).fork()).ldelim(),null!=e.get_ticket_body&&Object.hasOwnProperty.call(e,"get_ticket_body")&&$root.im_proto.GetTicketRequestBody.encode(e.get_ticket_body,t.uint32(16042).fork()).ldelim(),null!=e.get_conversation_list_body&&Object.hasOwnProperty.call(e,"get_conversation_list_body")&&$root.im_proto.GetUserConversationListRequestBody.encode(e.get_conversation_list_body,t.uint32(16050).fork()).ldelim(),null!=e.broadcast_send_message_body&&Object.hasOwnProperty.call(e,"broadcast_send_message_body")&&$root.im_proto.BroadcastSendMessageRequestBody.encode(e.broadcast_send_message_body,t.uint32(16058).fork()).ldelim(),null!=e.broadcast_recv_message_body&&Object.hasOwnProperty.call(e,"broadcast_recv_message_body")&&$root.im_proto.BroadcastRecvMessageRequestBody.encode(e.broadcast_recv_message_body,t.uint32(16066).fork()).ldelim(),null!=e.broadcast_user_counter_body&&Object.hasOwnProperty.call(e,"broadcast_user_counter_body")&&$root.im_proto.BroadcastUserCounterRequestBody.encode(e.broadcast_user_counter_body,t.uint32(16074).fork()).ldelim(),null!=e.client_ack_body&&Object.hasOwnProperty.call(e,"client_ack_body")&&$root.im_proto.ClientACKRequestBody.encode(e.client_ack_body,t.uint32(16082).fork()).ldelim(),null!=e.create_voip_body&&Object.hasOwnProperty.call(e,"create_voip_body")&&$root.im_proto.CreateVoipRequestBody.encode(e.create_voip_body,t.uint32(16090).fork()).ldelim(),null!=e.call_voip_body&&Object.hasOwnProperty.call(e,"call_voip_body")&&$root.im_proto.CallVoipRequestBody.encode(e.call_voip_body,t.uint32(16098).fork()).ldelim(),null!=e.update_voip_body&&Object.hasOwnProperty.call(e,"update_voip_body")&&$root.im_proto.UpdateVoipRequestBody.encode(e.update_voip_body,t.uint32(16106).fork()).ldelim(),null!=e.channel_heartbeat_body&&Object.hasOwnProperty.call(e,"channel_heartbeat_body")&&$root.im_proto.ChannelHeartBeatRequestBody.encode(e.channel_heartbeat_body,t.uint32(16114).fork()).ldelim(),null!=e.profile_get_info&&Object.hasOwnProperty.call(e,"profile_get_info")&&$root.im_proto.ProfileGetInfoRequestBody.encode(e.profile_get_info,t.uint32(16122).fork()).ldelim(),null!=e.report_client_metrics_body&&Object.hasOwnProperty.call(e,"report_client_metrics_body")&&$root.im_proto.ReportClientMetricsRequestBody.encode(e.report_client_metrics_body,t.uint32(16130).fork()).ldelim(),null!=e.get_configs_body&&Object.hasOwnProperty.call(e,"get_configs_body")&&$root.im_proto.GetConfigsRequestBody.encode(e.get_configs_body,t.uint32(16138).fork()).ldelim(),null!=e.unread_count_report_body&&Object.hasOwnProperty.call(e,"unread_count_report_body")&&$root.im_proto.UnReadCountReportRequestBody.encode(e.unread_count_report_body,t.uint32(16146).fork()).ldelim(),null!=e.block_members_body&&Object.hasOwnProperty.call(e,"block_members_body")&&$root.im_proto.BlockMembersRequestBody.encode(e.block_members_body,t.uint32(16154).fork()).ldelim(),null!=e.block_conversation_body&&Object.hasOwnProperty.call(e,"block_conversation_body")&&$root.im_proto.BlockConversationRequestBody.encode(e.block_conversation_body,t.uint32(16162).fork()).ldelim(),null!=e.modify_message_ext_body&&Object.hasOwnProperty.call(e,"modify_message_ext_body")&&$root.im_proto.ModifyMessageExtRequestBody.encode(e.modify_message_ext_body,t.uint32(16170).fork()).ldelim(),null!=e.get_unread_count_body&&Object.hasOwnProperty.call(e,"get_unread_count_body")&&$root.im_proto.GetUnreadCountRequestBody.encode(e.get_unread_count_body,t.uint32(16242).fork()).ldelim(),null!=e.send_message_p2p_body&&Object.hasOwnProperty.call(e,"send_message_p2p_body")&&$root.im_proto.SendMessageP2PRequestBody.encode(e.send_message_p2p_body,t.uint32(16250).fork()).ldelim(),null!=e.get_blocklist_body&&Object.hasOwnProperty.call(e,"get_blocklist_body")&&$root.im_proto.GetBlockListRequestBody.encode(e.get_blocklist_body,t.uint32(16258).fork()).ldelim(),null!=e.set_blocklist_body&&Object.hasOwnProperty.call(e,"set_blocklist_body")&&$root.im_proto.SetBlocklistRequestBody.encode(e.set_blocklist_body,t.uint32(16266).fork()).ldelim(),null!=e.check_in_blocklist_body&&Object.hasOwnProperty.call(e,"check_in_blocklist_body")&&$root.im_proto.CheckInBlockListRequestBody.encode(e.check_in_blocklist_body,t.uint32(16274).fork()).ldelim(),null!=e.mark_message_body&&Object.hasOwnProperty.call(e,"mark_message_body")&&$root.im_proto.MarkMessageRequestBody.encode(e.mark_message_body,t.uint32(16290).fork()).ldelim(),null!=e.pull_mark_message_body&&Object.hasOwnProperty.call(e,"pull_mark_message_body")&&$root.im_proto.PullMarkMessageRequestBody.encode(e.pull_mark_message_body,t.uint32(16298).fork()).ldelim(),null!=e.mark_msg_unread_count_report&&Object.hasOwnProperty.call(e,"mark_msg_unread_count_report")&&$root.im_proto.MarkMsgUnreadCountReportRequestBody.encode(e.mark_msg_unread_count_report,t.uint32(16434).fork()).ldelim(),null!=e.mark_msg_get_unread_count&&Object.hasOwnProperty.call(e,"mark_msg_get_unread_count")&&$root.im_proto.MarkMsgGetUnreadCountRequestBody.encode(e.mark_msg_get_unread_count,t.uint32(16442).fork()).ldelim(),null!=e.batch_unmark_message&&Object.hasOwnProperty.call(e,"batch_unmark_message")&&$root.im_proto.BatchUnmarkMessageRequestBody.encode(e.batch_unmark_message,t.uint32(16450).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.RequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 100:n.send_message_body=$root.im_proto.SendMessageRequestBody.decode(e,e.uint32());break;case 200:n.messages_per_user_body=$root.im_proto.MessagesPerUserRequestBody.decode(e,e.uint32());break;case 203:n.messages_per_user_init_v2_body=$root.im_proto.MessagesPerUserInitV2RequestBody.decode(e,e.uint32());break;case 211:n.get_message_by_id_body=$root.im_proto.GetMessageByIdRequestBody.decode(e,e.uint32());break;case 301:n.messages_in_conversation_body=$root.im_proto.MessagesInConversationRequestBody.decode(e,e.uint32());break;case 302:n.get_messages_checkinfo_in_conversation_body=$root.im_proto.GetMessagesCheckInfoInConversationRequestBody.decode(e,e.uint32());break;case 410:n.send_user_action_body=$root.im_proto.SendUserActionRequestBody.decode(e,e.uint32());break;case 411:n.send_input_status_body=$root.im_proto.SendInputStatusRequestBody.decode(e,e.uint32());break;case 603:n.delete_conversation_body=$root.im_proto.DeleteConversationRequestBody.decode(e,e.uint32());break;case 604:n.mark_conversation_read_body=$root.im_proto.MarkConversationReadRequestBody.decode(e,e.uint32());break;case 605:n.conversation_participants_body=$root.im_proto.ConversationParticipantsListRequestBody.decode(e,e.uint32());break;case 614:n.dissolve_conversation_body=$root.im_proto.DissolveConversationRequestBody.decode(e,e.uint32());break;case 609:n.create_conversation_v2_body=$root.im_proto.CreateConversationV2RequestBody.decode(e,e.uint32());break;case 610:n.get_conversation_info_list_v2_body=$root.im_proto.GetConversationInfoListV2RequestBody.decode(e,e.uint32());break;case 611:n.get_conversation_info_list_by_favorite_v2_body=$root.im_proto.ConversationsPerUserByFavoriteV2RequestBody.decode(e,e.uint32());break;case 612:n.get_conversation_info_list_by_top_v2_body=$root.im_proto.ConversationsPerUserByTopV2RequestBody.decode(e,e.uint32());break;case 650:n.conversation_add_participants_body=$root.im_proto.ConversationAddParticipantsRequestBody.decode(e,e.uint32());break;case 651:n.conversation_remove_participants_body=$root.im_proto.ConversationRemoveParticipantsRequestBody.decode(e,e.uint32());break;case 652:n.leave_conversation_body=$root.im_proto.ConversationLeaveRequestBody.decode(e,e.uint32());break;case 655:n.update_conversation_participant_body=$root.im_proto.UpdateConversationParticipantRequestBody.decode(e,e.uint32());break;case 701:n.delete_message_body=$root.im_proto.DeleteMessageRequestBody.decode(e,e.uint32());break;case 702:n.recall_message_body=$root.im_proto.RecallMessageRequestBody.decode(e,e.uint32());break;case 705:n.modify_message_property_body=$root.im_proto.ModifyMessagePropertyRequestBody.decode(e,e.uint32());break;case 901:n.get_conversation_core_info_body=$root.im_proto.GetConversationCoreInfoRequestBody.decode(e,e.uint32());break;case 902:n.set_conversation_core_info_body=$root.im_proto.SetConversationCoreInfoRequestBody.decode(e,e.uint32());break;case 904:n.upsert_conversation_core_ext_info_body=$root.im_proto.UpsertConversationCoreExtInfoRequestBody.decode(e,e.uint32());break;case 921:n.set_conversation_setting_info_body=$root.im_proto.SetConversationSettingInfoRequestBody.decode(e,e.uint32());break;case 922:n.upsert_conversation_setting_ext_info_body=$root.im_proto.UpsertConversationSettingExtInfoRequestBody.decode(e,e.uint32());break;case 1e3:n.get_stranger_conversation_body=$root.im_proto.GetStrangerConversationListRequestBody.decode(e,e.uint32());break;case 1001:n.get_stranger_messages_body=$root.im_proto.GetStrangerMessagesRequestBody.decode(e,e.uint32());break;case 1002:n.delete_stranger_message_body=$root.im_proto.DeleteStrangerMessageRequestBody.decode(e,e.uint32());break;case 1003:n.delete_stranger_conversation_body=$root.im_proto.DeleteStrangerConversationRequestBody.decode(e,e.uint32());break;case 1004:n.delete_stranger_all_conversation_body=$root.im_proto.DeleteStrangerAllConversationRequestBody.decode(e,e.uint32());break;case 1005:n.mark_stranger_conversation_read_body=$root.im_proto.MarkStrangerConversationReadRequestBody.decode(e,e.uint32());break;case 1006:n.mark_stranger_all_conversation_read_body=$root.im_proto.MarkStrangerAllConversationReadRequestBody.decode(e,e.uint32());break;case 2e3:n.participants_read_index_body=$root.im_proto.GetConversationParticipantsReadIndexV3RequestBody.decode(e,e.uint32());break;case 2001:n.participants_min_index_body=$root.im_proto.GetConversationParticipantsMinIndexV3RequestBody.decode(e,e.uint32());break;case 2003:n.get_upload_token_body=$root.im_proto.GetUploadTokenRequestBody.decode(e,e.uint32());break;case 2004:n.get_media_urls_body=$root.im_proto.GetMediaUrlsRequestBody.decode(e,e.uint32());break;case 2005:n.get_ticket_body=$root.im_proto.GetTicketRequestBody.decode(e,e.uint32());break;case 2006:n.get_conversation_list_body=$root.im_proto.GetUserConversationListRequestBody.decode(e,e.uint32());break;case 2007:n.broadcast_send_message_body=$root.im_proto.BroadcastSendMessageRequestBody.decode(e,e.uint32());break;case 2008:n.broadcast_recv_message_body=$root.im_proto.BroadcastRecvMessageRequestBody.decode(e,e.uint32());break;case 2009:n.broadcast_user_counter_body=$root.im_proto.BroadcastUserCounterRequestBody.decode(e,e.uint32());break;case 2010:n.client_ack_body=$root.im_proto.ClientACKRequestBody.decode(e,e.uint32());break;case 2011:n.create_voip_body=$root.im_proto.CreateVoipRequestBody.decode(e,e.uint32());break;case 2012:n.call_voip_body=$root.im_proto.CallVoipRequestBody.decode(e,e.uint32());break;case 2013:n.update_voip_body=$root.im_proto.UpdateVoipRequestBody.decode(e,e.uint32());break;case 2014:n.channel_heartbeat_body=$root.im_proto.ChannelHeartBeatRequestBody.decode(e,e.uint32());break;case 2015:n.profile_get_info=$root.im_proto.ProfileGetInfoRequestBody.decode(e,e.uint32());break;case 2016:n.report_client_metrics_body=$root.im_proto.ReportClientMetricsRequestBody.decode(e,e.uint32());break;case 2017:n.get_configs_body=$root.im_proto.GetConfigsRequestBody.decode(e,e.uint32());break;case 2021:n.modify_message_ext_body=$root.im_proto.ModifyMessageExtRequestBody.decode(e,e.uint32());break;case 2018:n.unread_count_report_body=$root.im_proto.UnReadCountReportRequestBody.decode(e,e.uint32());break;case 2019:n.block_members_body=$root.im_proto.BlockMembersRequestBody.decode(e,e.uint32());break;case 2020:n.block_conversation_body=$root.im_proto.BlockConversationRequestBody.decode(e,e.uint32());break;case 2030:n.get_unread_count_body=$root.im_proto.GetUnreadCountRequestBody.decode(e,e.uint32());break;case 2031:n.send_message_p2p_body=$root.im_proto.SendMessageP2PRequestBody.decode(e,e.uint32());break;case 2032:n.get_blocklist_body=$root.im_proto.GetBlockListRequestBody.decode(e,e.uint32());break;case 2033:n.set_blocklist_body=$root.im_proto.SetBlocklistRequestBody.decode(e,e.uint32());break;case 2034:n.check_in_blocklist_body=$root.im_proto.CheckInBlockListRequestBody.decode(e,e.uint32());break;case 2036:n.mark_message_body=$root.im_proto.MarkMessageRequestBody.decode(e,e.uint32());break;case 2037:n.pull_mark_message_body=$root.im_proto.PullMarkMessageRequestBody.decode(e,e.uint32());break;case 2054:n.mark_msg_unread_count_report=$root.im_proto.MarkMsgUnreadCountReportRequestBody.decode(e,e.uint32());break;case 2055:n.mark_msg_get_unread_count=$root.im_proto.MarkMsgGetUnreadCountRequestBody.decode(e,e.uint32());break;case 2056:n.batch_unmark_message=$root.im_proto.BatchUnmarkMessageRequestBody.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),e.Request=function(){function e(e){if(this.headers={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cmd=0,e.prototype.sequence_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sdk_version="",e.prototype.token="",e.prototype.refer=1,e.prototype.inbox_type=0,e.prototype.build_number="",e.prototype.body=null,e.prototype.device_id="",e.prototype.channel="",e.prototype.device_platform="",e.prototype.device_type="",e.prototype.os_version="",e.prototype.version_code="",e.prototype.headers=$util.emptyObject,e.prototype.config_id=0,e.prototype.token_info=null,e.prototype.auth_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(8).int32(e.cmd),null!=e.sequence_id&&Object.hasOwnProperty.call(e,"sequence_id")&&t.uint32(16).int64(e.sequence_id),null!=e.sdk_version&&Object.hasOwnProperty.call(e,"sdk_version")&&t.uint32(26).string(e.sdk_version),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(34).string(e.token),null!=e.refer&&Object.hasOwnProperty.call(e,"refer")&&t.uint32(40).int32(e.refer),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(48).int32(e.inbox_type),null!=e.build_number&&Object.hasOwnProperty.call(e,"build_number")&&t.uint32(58).string(e.build_number),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&$root.im_proto.RequestBody.encode(e.body,t.uint32(66).fork()).ldelim(),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(74).string(e.device_id),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(82).string(e.channel),null!=e.device_platform&&Object.hasOwnProperty.call(e,"device_platform")&&t.uint32(90).string(e.device_platform),null!=e.device_type&&Object.hasOwnProperty.call(e,"device_type")&&t.uint32(98).string(e.device_type),null!=e.os_version&&Object.hasOwnProperty.call(e,"os_version")&&t.uint32(106).string(e.os_version),null!=e.version_code&&Object.hasOwnProperty.call(e,"version_code")&&t.uint32(114).string(e.version_code),null!=e.headers&&Object.hasOwnProperty.call(e,"headers"))for(var r=keys(e.headers),n=0;n<r.length;++n)t.uint32(122).fork().uint32(10).string(r[n]).uint32(18).string(e.headers[r[n]]).ldelim();return null!=e.config_id&&Object.hasOwnProperty.call(e,"config_id")&&t.uint32(128).int32(e.config_id),null!=e.token_info&&Object.hasOwnProperty.call(e,"token_info")&&$root.im_proto.TokenInfo.encode(e.token_info,t.uint32(138).fork()).ldelim(),null!=e.auth_type&&Object.hasOwnProperty.call(e,"auth_type")&&t.uint32(144).int32(e.auth_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.Request;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.cmd=e.int32();break;case 2:o.sequence_id=e.int64();break;case 3:o.sdk_version=e.string();break;case 4:o.token=e.string();break;case 5:o.refer=e.int32();break;case 6:o.inbox_type=e.int32();break;case 7:o.build_number=e.string();break;case 8:o.body=$root.im_proto.RequestBody.decode(e,e.uint32());break;case 9:o.device_id=e.string();break;case 10:o.channel=e.string();break;case 11:o.device_platform=e.string();break;case 12:o.device_type=e.string();break;case 13:o.os_version=e.string();break;case 14:o.version_code=e.string();break;case 15:o.headers===$util.emptyObject&&(o.headers={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.headers[r]=n;break;case 16:o.config_id=e.int32();break;case 17:o.token_info=$root.im_proto.TokenInfo.decode(e,e.uint32());break;case 18:o.auth_type=e.int32();break;default:e.skipType(7&s)}}return o},e}(),e.AuthType=function(){var e={},t=create$9(e);return t[e[0]="UNKNOWN_AUTH"]=0,t[e[1]="SESSION_AUTH"]=1,t[e[2]="TOKEN_AUTH"]=2,t}(),e.TokenType=function(){var e={},t=create$9(e);return t[e[0]="DEFAULT_TOKEN"]=0,t[e[1]="APP_TOKEN"]=1,t[e[2]="SERVER_TOKEN"]=2,t}(),e.TokenInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.mark_id=0,e.prototype.type=0,e.prototype.app_id=0,e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.mark_id&&Object.hasOwnProperty.call(e,"mark_id")&&t.uint32(8).int32(e.mark_id),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.app_id&&Object.hasOwnProperty.call(e,"app_id")&&t.uint32(24).int32(e.app_id),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(32).int64(e.user_id),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(40).int64(e.timestamp),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.TokenInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.mark_id=e.int32();break;case 2:n.type=e.int32();break;case 3:n.app_id=e.int32();break;case 4:n.user_id=e.int64();break;case 5:n.timestamp=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.SendType=function(){var e={},t=create$9(e);return t[e[0]="BY_CONVERSATION"]=0,t[e[1]="BY_USER"]=1,t}(),e.NewP2PMessageNotify=function(){function e(e){if(this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.send_type=0,e.prototype.sender=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sec_sender="",e.prototype.conversation_id="",e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.message_type=0,e.prototype.content="",e.prototype.ext=$util.emptyObject,e.prototype.create_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.send_type&&Object.hasOwnProperty.call(e,"send_type")&&t.uint32(8).int32(e.send_type),null!=e.sender&&Object.hasOwnProperty.call(e,"sender")&&t.uint32(16).int64(e.sender),null!=e.sec_sender&&Object.hasOwnProperty.call(e,"sec_sender")&&t.uint32(26).string(e.sec_sender),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(34).string(e.conversation_id),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(40).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(48).int32(e.conversation_type),null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(56).int32(e.message_type),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(74).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();return null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(80).int64(e.create_time),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.NewP2PMessageNotify;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.send_type=e.int32();break;case 2:o.sender=e.int64();break;case 3:o.sec_sender=e.string();break;case 4:o.conversation_id=e.string();break;case 5:o.conversation_short_id=e.int64();break;case 6:o.conversation_type=e.int32();break;case 7:o.message_type=e.int32();break;case 8:o.content=e.string();break;case 9:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 10:o.create_time=e.int64();break;default:e.skipType(7&s)}}return o},e}(),e.MessageInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.status=0,e.prototype.body=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(8).int32(e.status),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&$root.im_proto.MessageBody.encode(e.body,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessageInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.status=e.int32();break;case 2:n.body=$root.im_proto.MessageBody.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),e.GetMessageByIdRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMessageByIdRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.server_message_id=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.GetMessageByIdResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.msg_info=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.msg_info&&Object.hasOwnProperty.call(e,"msg_info")&&$root.im_proto.MessageInfo.encode(e.msg_info,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMessageByIdResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.msg_info=$root.im_proto.MessageInfo.decode(e,e.uint32()):e.skipType(7&i)}return n},e}(),e.ResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.send_message_body=null,e.prototype.messages_per_user_body=null,e.prototype.messages_per_user_init_v2_body=null,e.prototype.get_message_by_id_body=null,e.prototype.messages_in_conversation_body=null,e.prototype.get_messages_checkinfo_in_conversation_body=null,e.prototype.has_new_message_notify=null,e.prototype.has_new_p2p_message_notify=null,e.prototype.get_conversations_checkinfo_body=null,e.prototype.create_conversation_v2_body=null,e.prototype.get_conversation_info_list_v2_body=null,e.prototype.get_conversation_info_list_by_favorite_v2_body=null,e.prototype.get_conversation_info_list_by_top_v2_body=null,e.prototype.conversation_participants_body=null,e.prototype.conversation_add_participants_body=null,e.prototype.conversation_remove_participants_body=null,e.prototype.update_conversation_participant_body=null,e.prototype.modify_message_property_body=null,e.prototype.get_conversation_core_info_body=null,e.prototype.set_conversation_core_info_body=null,e.prototype.upsert_conversation_core_ext_info_body=null,e.prototype.set_conversation_setting_info_body=null,e.prototype.upsert_conversation_setting_ext_info_body=null,e.prototype.get_stranger_conversation_body=null,e.prototype.get_stranger_messages_body=null,e.prototype.participants_read_index_body=null,e.prototype.participants_min_index_body=null,e.prototype.get_upload_token_body=null,e.prototype.get_media_urls_body=null,e.prototype.get_ticket_body=null,e.prototype.get_conversation_list_body=null,e.prototype.broadcast_send_message_body=null,e.prototype.broadcast_recv_message_body=null,e.prototype.broadcast_user_counter_body=null,e.prototype.create_voip_body=null,e.prototype.call_voip_body=null,e.prototype.update_voip_body=null,e.prototype.profile_get_info=null,e.prototype.get_configs_body=null,e.prototype.unread_count_report_body=null,e.prototype.block_members_body=null,e.prototype.get_unread_count_body=null,e.prototype.send_message_p2p_body=null,e.prototype.get_blocklist_body=null,e.prototype.set_blocklist_body=null,e.prototype.check_in_blocklist_body=null,e.prototype.mark_message_body=null,e.prototype.pull_mark_message_body=null,e.prototype.mark_msg_unread_count_report=null,e.prototype.mark_msg_get_unread_count=null,e.prototype.batch_unmark_message=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.send_message_body&&Object.hasOwnProperty.call(e,"send_message_body")&&$root.im_proto.SendMessageResponseBody.encode(e.send_message_body,t.uint32(802).fork()).ldelim(),null!=e.messages_per_user_body&&Object.hasOwnProperty.call(e,"messages_per_user_body")&&$root.im_proto.MessagesPerUserResponseBody.encode(e.messages_per_user_body,t.uint32(1602).fork()).ldelim(),null!=e.messages_per_user_init_v2_body&&Object.hasOwnProperty.call(e,"messages_per_user_init_v2_body")&&$root.im_proto.MessagesPerUserInitV2ResponseBody.encode(e.messages_per_user_init_v2_body,t.uint32(1626).fork()).ldelim(),null!=e.get_message_by_id_body&&Object.hasOwnProperty.call(e,"get_message_by_id_body")&&$root.im_proto.GetMessageByIdResponseBody.encode(e.get_message_by_id_body,t.uint32(1690).fork()).ldelim(),null!=e.messages_in_conversation_body&&Object.hasOwnProperty.call(e,"messages_in_conversation_body")&&$root.im_proto.MessagesInConversationResponseBody.encode(e.messages_in_conversation_body,t.uint32(2410).fork()).ldelim(),null!=e.get_messages_checkinfo_in_conversation_body&&Object.hasOwnProperty.call(e,"get_messages_checkinfo_in_conversation_body")&&$root.im_proto.GetMessagesCheckInfoInConversationResponseBody.encode(e.get_messages_checkinfo_in_conversation_body,t.uint32(2418).fork()).ldelim(),null!=e.has_new_message_notify&&Object.hasOwnProperty.call(e,"has_new_message_notify")&&$root.im_proto.NewMessageNotify.encode(e.has_new_message_notify,t.uint32(4002).fork()).ldelim(),null!=e.has_new_p2p_message_notify&&Object.hasOwnProperty.call(e,"has_new_p2p_message_notify")&&$root.im_proto.NewP2PMessageNotify.encode(e.has_new_p2p_message_notify,t.uint32(4034).fork()).ldelim(),null!=e.conversation_participants_body&&Object.hasOwnProperty.call(e,"conversation_participants_body")&&$root.im_proto.ConversationParticipantsListResponseBody.encode(e.conversation_participants_body,t.uint32(4842).fork()).ldelim(),null!=e.create_conversation_v2_body&&Object.hasOwnProperty.call(e,"create_conversation_v2_body")&&$root.im_proto.CreateConversationV2ResponseBody.encode(e.create_conversation_v2_body,t.uint32(4874).fork()).ldelim(),null!=e.get_conversation_info_list_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_v2_body")&&$root.im_proto.GetConversationInfoListV2ResponseBody.encode(e.get_conversation_info_list_v2_body,t.uint32(4882).fork()).ldelim(),null!=e.get_conversation_info_list_by_favorite_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_favorite_v2_body")&&$root.im_proto.GetConversationInfoListByFavoriteV2ResponseBody.encode(e.get_conversation_info_list_by_favorite_v2_body,t.uint32(4890).fork()).ldelim(),null!=e.get_conversation_info_list_by_top_v2_body&&Object.hasOwnProperty.call(e,"get_conversation_info_list_by_top_v2_body")&&$root.im_proto.GetConversationInfoListByTopV2ResponseBody.encode(e.get_conversation_info_list_by_top_v2_body,t.uint32(4898).fork()).ldelim(),null!=e.get_conversations_checkinfo_body&&Object.hasOwnProperty.call(e,"get_conversations_checkinfo_body")&&$root.im_proto.GetConversationsCheckInfoResponseBody.encode(e.get_conversations_checkinfo_body,t.uint32(4922).fork()).ldelim(),null!=e.conversation_add_participants_body&&Object.hasOwnProperty.call(e,"conversation_add_participants_body")&&$root.im_proto.ConversationAddParticipantsResponseBody.encode(e.conversation_add_participants_body,t.uint32(5202).fork()).ldelim(),null!=e.conversation_remove_participants_body&&Object.hasOwnProperty.call(e,"conversation_remove_participants_body")&&$root.im_proto.ConversationRemoveParticipantsResponseBody.encode(e.conversation_remove_participants_body,t.uint32(5210).fork()).ldelim(),null!=e.update_conversation_participant_body&&Object.hasOwnProperty.call(e,"update_conversation_participant_body")&&$root.im_proto.UpdateConversationParticipantResponseBody.encode(e.update_conversation_participant_body,t.uint32(5242).fork()).ldelim(),null!=e.modify_message_property_body&&Object.hasOwnProperty.call(e,"modify_message_property_body")&&$root.im_proto.ModifyMessagePropertyResponseBody.encode(e.modify_message_property_body,t.uint32(5642).fork()).ldelim(),null!=e.get_conversation_core_info_body&&Object.hasOwnProperty.call(e,"get_conversation_core_info_body")&&$root.im_proto.GetConversationCoreInfoResponseBody.encode(e.get_conversation_core_info_body,t.uint32(7210).fork()).ldelim(),null!=e.set_conversation_core_info_body&&Object.hasOwnProperty.call(e,"set_conversation_core_info_body")&&$root.im_proto.SetConversationCoreInfoResponseBody.encode(e.set_conversation_core_info_body,t.uint32(7218).fork()).ldelim(),null!=e.upsert_conversation_core_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_core_ext_info_body")&&$root.im_proto.UpsertConversationCoreExtInfoResponseBody.encode(e.upsert_conversation_core_ext_info_body,t.uint32(7234).fork()).ldelim(),null!=e.set_conversation_setting_info_body&&Object.hasOwnProperty.call(e,"set_conversation_setting_info_body")&&$root.im_proto.SetConversationSettingInfoResponseBody.encode(e.set_conversation_setting_info_body,t.uint32(7370).fork()).ldelim(),null!=e.upsert_conversation_setting_ext_info_body&&Object.hasOwnProperty.call(e,"upsert_conversation_setting_ext_info_body")&&$root.im_proto.UpsertConversationSettingExtInfoResponseBody.encode(e.upsert_conversation_setting_ext_info_body,t.uint32(7378).fork()).ldelim(),null!=e.get_stranger_conversation_body&&Object.hasOwnProperty.call(e,"get_stranger_conversation_body")&&$root.im_proto.GetStrangerConversationListResponseBody.encode(e.get_stranger_conversation_body,t.uint32(8002).fork()).ldelim(),null!=e.get_stranger_messages_body&&Object.hasOwnProperty.call(e,"get_stranger_messages_body")&&$root.im_proto.GetStrangerMessagesResponseBody.encode(e.get_stranger_messages_body,t.uint32(8010).fork()).ldelim(),null!=e.participants_read_index_body&&Object.hasOwnProperty.call(e,"participants_read_index_body")&&$root.im_proto.GetConversationParticipantsReadIndexV3ResponseBody.encode(e.participants_read_index_body,t.uint32(16002).fork()).ldelim(),null!=e.participants_min_index_body&&Object.hasOwnProperty.call(e,"participants_min_index_body")&&$root.im_proto.GetConversationParticipantsMinIndexV3ResponseBody.encode(e.participants_min_index_body,t.uint32(16010).fork()).ldelim(),null!=e.get_upload_token_body&&Object.hasOwnProperty.call(e,"get_upload_token_body")&&$root.im_proto.GetUploadTokenResponseBody.encode(e.get_upload_token_body,t.uint32(16026).fork()).ldelim(),null!=e.get_media_urls_body&&Object.hasOwnProperty.call(e,"get_media_urls_body")&&$root.im_proto.GetMediaUrlsResponseBody.encode(e.get_media_urls_body,t.uint32(16034).fork()).ldelim(),null!=e.get_ticket_body&&Object.hasOwnProperty.call(e,"get_ticket_body")&&$root.im_proto.GetTicketResponseBody.encode(e.get_ticket_body,t.uint32(16042).fork()).ldelim(),null!=e.get_conversation_list_body&&Object.hasOwnProperty.call(e,"get_conversation_list_body")&&$root.im_proto.GetUserConversationListResponseBody.encode(e.get_conversation_list_body,t.uint32(16050).fork()).ldelim(),null!=e.broadcast_send_message_body&&Object.hasOwnProperty.call(e,"broadcast_send_message_body")&&$root.im_proto.BroadcastSendMessageResponseBody.encode(e.broadcast_send_message_body,t.uint32(16058).fork()).ldelim(),null!=e.broadcast_recv_message_body&&Object.hasOwnProperty.call(e,"broadcast_recv_message_body")&&$root.im_proto.BroadcastRecvMessageResponseBody.encode(e.broadcast_recv_message_body,t.uint32(16066).fork()).ldelim(),null!=e.broadcast_user_counter_body&&Object.hasOwnProperty.call(e,"broadcast_user_counter_body")&&$root.im_proto.BroadcastUserCounterResponseBody.encode(e.broadcast_user_counter_body,t.uint32(16074).fork()).ldelim(),null!=e.create_voip_body&&Object.hasOwnProperty.call(e,"create_voip_body")&&$root.im_proto.CreateVoipResponseBody.encode(e.create_voip_body,t.uint32(16090).fork()).ldelim(),null!=e.call_voip_body&&Object.hasOwnProperty.call(e,"call_voip_body")&&$root.im_proto.CallVoipResponseBody.encode(e.call_voip_body,t.uint32(16098).fork()).ldelim(),null!=e.update_voip_body&&Object.hasOwnProperty.call(e,"update_voip_body")&&$root.im_proto.UpdateVoipResponseBody.encode(e.update_voip_body,t.uint32(16106).fork()).ldelim(),null!=e.profile_get_info&&Object.hasOwnProperty.call(e,"profile_get_info")&&$root.im_proto.ProfileGetInfoResponseBody.encode(e.profile_get_info,t.uint32(16122).fork()).ldelim(),null!=e.get_configs_body&&Object.hasOwnProperty.call(e,"get_configs_body")&&$root.im_proto.GetConfigsResponseBody.encode(e.get_configs_body,t.uint32(16138).fork()).ldelim(),null!=e.unread_count_report_body&&Object.hasOwnProperty.call(e,"unread_count_report_body")&&$root.im_proto.UnReadCountReportResponseBody.encode(e.unread_count_report_body,t.uint32(16146).fork()).ldelim(),null!=e.block_members_body&&Object.hasOwnProperty.call(e,"block_members_body")&&$root.im_proto.BlockMembersResponseBody.encode(e.block_members_body,t.uint32(16154).fork()).ldelim(),null!=e.get_unread_count_body&&Object.hasOwnProperty.call(e,"get_unread_count_body")&&$root.im_proto.GetUnreadCountResponseBody.encode(e.get_unread_count_body,t.uint32(16242).fork()).ldelim(),null!=e.send_message_p2p_body&&Object.hasOwnProperty.call(e,"send_message_p2p_body")&&$root.im_proto.SendMessageP2PResponseBody.encode(e.send_message_p2p_body,t.uint32(16250).fork()).ldelim(),null!=e.get_blocklist_body&&Object.hasOwnProperty.call(e,"get_blocklist_body")&&$root.im_proto.GetBlockListResponseBody.encode(e.get_blocklist_body,t.uint32(16258).fork()).ldelim(),null!=e.set_blocklist_body&&Object.hasOwnProperty.call(e,"set_blocklist_body")&&$root.im_proto.SetBlocklistResponseBody.encode(e.set_blocklist_body,t.uint32(16266).fork()).ldelim(),null!=e.check_in_blocklist_body&&Object.hasOwnProperty.call(e,"check_in_blocklist_body")&&$root.im_proto.CheckInBlockListResponseBody.encode(e.check_in_blocklist_body,t.uint32(16274).fork()).ldelim(),null!=e.mark_message_body&&Object.hasOwnProperty.call(e,"mark_message_body")&&$root.im_proto.MarkMessageResponseBody.encode(e.mark_message_body,t.uint32(16290).fork()).ldelim(),null!=e.pull_mark_message_body&&Object.hasOwnProperty.call(e,"pull_mark_message_body")&&$root.im_proto.PullMarkMessageResponseBody.encode(e.pull_mark_message_body,t.uint32(16298).fork()).ldelim(),null!=e.mark_msg_unread_count_report&&Object.hasOwnProperty.call(e,"mark_msg_unread_count_report")&&$root.im_proto.MarkMsgUnreadCountReportResponseBody.encode(e.mark_msg_unread_count_report,t.uint32(16434).fork()).ldelim(),null!=e.mark_msg_get_unread_count&&Object.hasOwnProperty.call(e,"mark_msg_get_unread_count")&&$root.im_proto.MarkMsgGetUnreadCountResponseBody.encode(e.mark_msg_get_unread_count,t.uint32(16442).fork()).ldelim(),null!=e.batch_unmark_message&&Object.hasOwnProperty.call(e,"batch_unmark_message")&&$root.im_proto.BatchUnmarkMessageResponseBody.encode(e.batch_unmark_message,t.uint32(16450).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 100:n.send_message_body=$root.im_proto.SendMessageResponseBody.decode(e,e.uint32());break;case 200:n.messages_per_user_body=$root.im_proto.MessagesPerUserResponseBody.decode(e,e.uint32());break;case 203:n.messages_per_user_init_v2_body=$root.im_proto.MessagesPerUserInitV2ResponseBody.decode(e,e.uint32());break;case 211:n.get_message_by_id_body=$root.im_proto.GetMessageByIdResponseBody.decode(e,e.uint32());break;case 301:n.messages_in_conversation_body=$root.im_proto.MessagesInConversationResponseBody.decode(e,e.uint32());break;case 302:n.get_messages_checkinfo_in_conversation_body=$root.im_proto.GetMessagesCheckInfoInConversationResponseBody.decode(e,e.uint32());break;case 500:n.has_new_message_notify=$root.im_proto.NewMessageNotify.decode(e,e.uint32());break;case 504:n.has_new_p2p_message_notify=$root.im_proto.NewP2PMessageNotify.decode(e,e.uint32());break;case 615:n.get_conversations_checkinfo_body=$root.im_proto.GetConversationsCheckInfoResponseBody.decode(e,e.uint32());break;case 609:n.create_conversation_v2_body=$root.im_proto.CreateConversationV2ResponseBody.decode(e,e.uint32());break;case 610:n.get_conversation_info_list_v2_body=$root.im_proto.GetConversationInfoListV2ResponseBody.decode(e,e.uint32());break;case 611:n.get_conversation_info_list_by_favorite_v2_body=$root.im_proto.GetConversationInfoListByFavoriteV2ResponseBody.decode(e,e.uint32());break;case 612:n.get_conversation_info_list_by_top_v2_body=$root.im_proto.GetConversationInfoListByTopV2ResponseBody.decode(e,e.uint32());break;case 605:n.conversation_participants_body=$root.im_proto.ConversationParticipantsListResponseBody.decode(e,e.uint32());break;case 650:n.conversation_add_participants_body=$root.im_proto.ConversationAddParticipantsResponseBody.decode(e,e.uint32());break;case 651:n.conversation_remove_participants_body=$root.im_proto.ConversationRemoveParticipantsResponseBody.decode(e,e.uint32());break;case 655:n.update_conversation_participant_body=$root.im_proto.UpdateConversationParticipantResponseBody.decode(e,e.uint32());break;case 705:n.modify_message_property_body=$root.im_proto.ModifyMessagePropertyResponseBody.decode(e,e.uint32());break;case 901:n.get_conversation_core_info_body=$root.im_proto.GetConversationCoreInfoResponseBody.decode(e,e.uint32());break;case 902:n.set_conversation_core_info_body=$root.im_proto.SetConversationCoreInfoResponseBody.decode(e,e.uint32());break;case 904:n.upsert_conversation_core_ext_info_body=$root.im_proto.UpsertConversationCoreExtInfoResponseBody.decode(e,e.uint32());break;case 921:n.set_conversation_setting_info_body=$root.im_proto.SetConversationSettingInfoResponseBody.decode(e,e.uint32());break;case 922:n.upsert_conversation_setting_ext_info_body=$root.im_proto.UpsertConversationSettingExtInfoResponseBody.decode(e,e.uint32());break;case 1e3:n.get_stranger_conversation_body=$root.im_proto.GetStrangerConversationListResponseBody.decode(e,e.uint32());break;case 1001:n.get_stranger_messages_body=$root.im_proto.GetStrangerMessagesResponseBody.decode(e,e.uint32());break;case 2e3:n.participants_read_index_body=$root.im_proto.GetConversationParticipantsReadIndexV3ResponseBody.decode(e,e.uint32());break;case 2001:n.participants_min_index_body=$root.im_proto.GetConversationParticipantsMinIndexV3ResponseBody.decode(e,e.uint32());break;case 2003:n.get_upload_token_body=$root.im_proto.GetUploadTokenResponseBody.decode(e,e.uint32());break;case 2004:n.get_media_urls_body=$root.im_proto.GetMediaUrlsResponseBody.decode(e,e.uint32());break;case 2005:n.get_ticket_body=$root.im_proto.GetTicketResponseBody.decode(e,e.uint32());break;case 2006:n.get_conversation_list_body=$root.im_proto.GetUserConversationListResponseBody.decode(e,e.uint32());break;case 2007:n.broadcast_send_message_body=$root.im_proto.BroadcastSendMessageResponseBody.decode(e,e.uint32());break;case 2008:n.broadcast_recv_message_body=$root.im_proto.BroadcastRecvMessageResponseBody.decode(e,e.uint32());break;case 2009:n.broadcast_user_counter_body=$root.im_proto.BroadcastUserCounterResponseBody.decode(e,e.uint32());break;case 2011:n.create_voip_body=$root.im_proto.CreateVoipResponseBody.decode(e,e.uint32());break;case 2012:n.call_voip_body=$root.im_proto.CallVoipResponseBody.decode(e,e.uint32());break;case 2013:n.update_voip_body=$root.im_proto.UpdateVoipResponseBody.decode(e,e.uint32());break;case 2015:n.profile_get_info=$root.im_proto.ProfileGetInfoResponseBody.decode(e,e.uint32());break;case 2017:n.get_configs_body=$root.im_proto.GetConfigsResponseBody.decode(e,e.uint32());break;case 2018:n.unread_count_report_body=$root.im_proto.UnReadCountReportResponseBody.decode(e,e.uint32());break;case 2019:n.block_members_body=$root.im_proto.BlockMembersResponseBody.decode(e,e.uint32());break;case 2030:n.get_unread_count_body=$root.im_proto.GetUnreadCountResponseBody.decode(e,e.uint32());break;case 2031:n.send_message_p2p_body=$root.im_proto.SendMessageP2PResponseBody.decode(e,e.uint32());break;case 2032:n.get_blocklist_body=$root.im_proto.GetBlockListResponseBody.decode(e,e.uint32());break;case 2033:n.set_blocklist_body=$root.im_proto.SetBlocklistResponseBody.decode(e,e.uint32());break;case 2034:n.check_in_blocklist_body=$root.im_proto.CheckInBlockListResponseBody.decode(e,e.uint32());break;case 2036:n.mark_message_body=$root.im_proto.MarkMessageResponseBody.decode(e,e.uint32());break;case 2037:n.pull_mark_message_body=$root.im_proto.PullMarkMessageResponseBody.decode(e,e.uint32());break;case 2054:n.mark_msg_unread_count_report=$root.im_proto.MarkMsgUnreadCountReportResponseBody.decode(e,e.uint32());break;case 2055:n.mark_msg_get_unread_count=$root.im_proto.MarkMsgGetUnreadCountResponseBody.decode(e,e.uint32());break;case 2056:n.batch_unmark_message=$root.im_proto.BatchUnmarkMessageResponseBody.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e}(),e.Response=function(){function e(e){if(this.headers={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cmd=0,e.prototype.sequence_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.status_code=0,e.prototype.error_desc="",e.prototype.inbox_type=0,e.prototype.body=null,e.prototype.log_id="",e.prototype.headers=$util.emptyObject,e.prototype.start_time_stamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.request_arrived_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_execution_end_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.cmd&&Object.hasOwnProperty.call(e,"cmd")&&t.uint32(8).int32(e.cmd),null!=e.sequence_id&&Object.hasOwnProperty.call(e,"sequence_id")&&t.uint32(16).int64(e.sequence_id),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(24).int32(e.status_code),null!=e.error_desc&&Object.hasOwnProperty.call(e,"error_desc")&&t.uint32(34).string(e.error_desc),null!=e.inbox_type&&Object.hasOwnProperty.call(e,"inbox_type")&&t.uint32(40).int32(e.inbox_type),null!=e.body&&Object.hasOwnProperty.call(e,"body")&&$root.im_proto.ResponseBody.encode(e.body,t.uint32(50).fork()).ldelim(),null!=e.log_id&&Object.hasOwnProperty.call(e,"log_id")&&t.uint32(58).string(e.log_id),null!=e.headers&&Object.hasOwnProperty.call(e,"headers"))for(var r=keys(e.headers),n=0;n<r.length;++n)t.uint32(66).fork().uint32(10).string(r[n]).uint32(18).string(e.headers[r[n]]).ldelim();return null!=e.start_time_stamp&&Object.hasOwnProperty.call(e,"start_time_stamp")&&t.uint32(72).int64(e.start_time_stamp),null!=e.request_arrived_time&&Object.hasOwnProperty.call(e,"request_arrived_time")&&t.uint32(80).int64(e.request_arrived_time),null!=e.server_execution_end_time&&Object.hasOwnProperty.call(e,"server_execution_end_time")&&t.uint32(88).int64(e.server_execution_end_time),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.Response;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.cmd=e.int32();break;case 2:o.sequence_id=e.int64();break;case 3:o.status_code=e.int32();break;case 4:o.error_desc=e.string();break;case 5:o.inbox_type=e.int32();break;case 6:o.body=$root.im_proto.ResponseBody.decode(e,e.uint32());break;case 7:o.log_id=e.string();break;case 8:o.headers===$util.emptyObject&&(o.headers={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.headers[r]=n;break;case 9:o.start_time_stamp=e.int64();break;case 10:o.request_arrived_time=e.int64();break;case 11:o.server_execution_end_time=e.int64();break;default:e.skipType(7&s)}}return o},e}(),e.BroadcastSendMessageRequestBody=function(){function e(e){if(this.ext={},this.mentioned_users=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.content="",e.prototype.ext=$util.emptyObject,e.prototype.message_type=0,e.prototype.ticket="",e.prototype.client_message_id="",e.prototype.mentioned_users=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(34).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext"))for(var r=keys(e.ext),n=0;n<r.length;++n)t.uint32(42).fork().uint32(10).string(r[n]).uint32(18).string(e.ext[r[n]]).ldelim();if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(48).int32(e.message_type),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(58).string(e.ticket),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(66).string(e.client_message_id),null!=e.mentioned_users&&e.mentioned_users.length)for(n=0;n<e.mentioned_users.length;++n)t.uint32(72).int64(e.mentioned_users[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.BroadcastSendMessageRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.content=e.string();break;case 5:o.ext===$util.emptyObject&&(o.ext={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 6:o.message_type=e.int32();break;case 7:o.ticket=e.string();break;case 8:o.client_message_id=e.string();break;case 9:if(o.mentioned_users&&o.mentioned_users.length||(o.mentioned_users=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.mentioned_users.push(e.int64());else o.mentioned_users.push(e.int64());break;default:e.skipType(7&s)}}return o},e}(),e.BroadcastSendMessageResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.extra_info="",e.prototype.status=0,e.prototype.client_message_id="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(18).string(e.extra_info),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(34).string(e.client_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastSendMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.server_message_id=e.int64();break;case 2:n.extra_info=e.string();break;case 3:n.status=e.int32();break;case 4:n.client_message_id=e.string();break;case 5:n.check_code=e.int64();break;case 6:n.check_message=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.BroadcastRecvMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.reverse=!1,e.prototype.pull_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int64(e.limit),null!=reverse(e)&&Object.hasOwnProperty.call(e,"reverse")&&t.uint32(48).bool(reverse(e)),null!=e.pull_type&&Object.hasOwnProperty.call(e,"pull_type")&&t.uint32(56).int32(e.pull_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastRecvMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.cursor=e.int64();break;case 5:n.limit=e.int64();break;case 6:n.reverse=e.bool();break;case 7:n.pull_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.BroadcastRecvMessageResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastRecvMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationRequest=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationRequest;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.BroadcastUserCounterRequestBody=function(){function e(e){if(this.conversations=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversations=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversations&&e.conversations.length)for(var r=0;r<e.conversations.length;++r)$root.im_proto.ConversationRequest.encode(e.conversations[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastUserCounterRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.conversations&&n.conversations.length||(n.conversations=[]),n.conversations.push($root.im_proto.ConversationRequest.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.BroadcastUserInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.counter=0,e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.counter&&Object.hasOwnProperty.call(e,"counter")&&t.uint32(16).int32(e.counter),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastUserInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.counter=e.int32();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.BroadcastUserCounterResponseBody=function(){function e(e){if(this.infos=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.infos=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.infos&&e.infos.length)for(var r=0;r<e.infos.length;++r)$root.im_proto.BroadcastUserInfo.encode(e.infos[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BroadcastUserCounterResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.infos&&n.infos.length||(n.infos=[]),n.infos.push($root.im_proto.BroadcastUserInfo.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.NetworkType=function(){var e={},t=create$9(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="WIFI"]=1,t[e[2]="MOBILE_2G"]=2,t[e[3]="MOBILE_3G"]=3,t[e[4]="MOBILE_4G"]=4,t[e[5]="MOBILE_5G"]=5,t}(),e.ClientACKRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.start_time_stamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.cmd=0,e.prototype.network_type=0,e.prototype.logid="",e.prototype.client_time_stamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.start_time_stamp),t.uint32(16).int32(e.cmd),null!=e.network_type&&Object.hasOwnProperty.call(e,"network_type")&&t.uint32(24).int32(e.network_type),null!=e.logid&&Object.hasOwnProperty.call(e,"logid")&&t.uint32(34).string(e.logid),null!=e.client_time_stamp&&Object.hasOwnProperty.call(e,"client_time_stamp")&&t.uint32(40).int64(e.client_time_stamp),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(48).int64(e.server_message_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ClientACKRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.start_time_stamp=e.int64();break;case 2:n.cmd=e.int32();break;case 3:n.network_type=e.int32();break;case 4:n.logid=e.string();break;case 5:n.client_time_stamp=e.int64();break;case 6:n.server_message_id=e.int64();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("start_time_stamp"))throw $util.ProtocolError("missing required 'start_time_stamp'",{instance:n});if(!n.hasOwnProperty("cmd"))throw $util.ProtocolError("missing required 'cmd'",{instance:n});return n},e}(),e.VoipMode=function(){var e={},t=create$9(e);return t[e[0]="VOIP_MODE_DOUBLE"]=0,t[e[1]="VOIP_MODE_MULTIPLAYER"]=1,t}(),e.VoipStatusCode=function(){var e={},t=create$9(e);return t[e[0]="SUCCESS"]=0,t[e[4]="VOIP_PARAMS_ERROR"]=4,t[e[18]="VOIP_STATUS_ERROR"]=18,t[e[19]="VOIP_CANCEL_ERROR"]=19,t[e[20]="VOIP_OTHER_RESPONSE_ERROR"]=20,t[e[21]="VOIP_CALLBACK_ERROR"]=21,t}(),e.VoipStatus=function(){var e={},t=create$9(e);return t[e[0]="IDLE"]=0,t[e[1]="CALLING"]=1,t[e[2]="RINGING"]=2,t[e[3]="ACCEPTED"]=3,t[e[4]="ONTHECALL"]=4,t[e[101]="TERMINATED"]=101,t[e[102]="OCCUPIED"]=102,t[e[103]="REFUSED"]=103,t[e[104]="CANCELLED"]=104,t[e[105]="UNAVAILABLE"]=105,t[e[106]="RTCERROR"]=106,t[e[107]="RTC_ENGINE_MISMATCH"]=107,t}(),e.VoipType=function(){var e={},t=create$9(e);return t[e[0]="VOIP_TYPE_NOT_USED"]=0,t[e[1]="VOIP_TYPE_ALL"]=1,t[e[2]="VOIP_TYPE_VIDEOONLY"]=2,t[e[3]="VOIP_TYPE_AUDIOONLY"]=3,t}(),e.VoipInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.device_id="",e.prototype.channel_id="",e.prototype.token="",e.prototype.status=0,e.prototype.caller_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.created_time_ms=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.updated_time_ms=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.con_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.v_type=0,e.prototype.srv_msg_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.device_id&&Object.hasOwnProperty.call(e,"device_id")&&t.uint32(18).string(e.device_id),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(26).string(e.channel_id),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(34).string(e.token),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(40).int32(e.status),null!=e.caller_id&&Object.hasOwnProperty.call(e,"caller_id")&&t.uint32(48).int64(e.caller_id),null!=e.created_time_ms&&Object.hasOwnProperty.call(e,"created_time_ms")&&t.uint32(56).int64(e.created_time_ms),null!=e.updated_time_ms&&Object.hasOwnProperty.call(e,"updated_time_ms")&&t.uint32(64).int64(e.updated_time_ms),null!=e.con_short_id&&Object.hasOwnProperty.call(e,"con_short_id")&&t.uint32(72).int64(e.con_short_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(80).int32(e.v_type),null!=e.srv_msg_id&&Object.hasOwnProperty.call(e,"srv_msg_id")&&t.uint32(88).int64(e.srv_msg_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.VoipInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_id=e.int64();break;case 2:n.device_id=e.string();break;case 3:n.channel_id=e.string();break;case 4:n.token=e.string();break;case 5:n.status=e.int32();break;case 6:n.caller_id=e.int64();break;case 7:n.created_time_ms=e.int64();break;case 8:n.updated_time_ms=e.int64();break;case 9:n.con_short_id=e.int64();break;case 10:n.v_type=e.int32();break;case 11:n.srv_msg_id=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.CreateVoipRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.idempotent_id="",e.prototype.v_type=0,e.prototype.con_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.srv_msg_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ref_channel_id="",e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.idempotent_id&&Object.hasOwnProperty.call(e,"idempotent_id")&&t.uint32(10).string(e.idempotent_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(16).int32(e.v_type),null!=e.con_short_id&&Object.hasOwnProperty.call(e,"con_short_id")&&t.uint32(24).int64(e.con_short_id),null!=e.srv_msg_id&&Object.hasOwnProperty.call(e,"srv_msg_id")&&t.uint32(32).int64(e.srv_msg_id),null!=e.ref_channel_id&&Object.hasOwnProperty.call(e,"ref_channel_id")&&t.uint32(42).string(e.ref_channel_id),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(48).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CreateVoipRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.idempotent_id=e.string();break;case 2:n.v_type=e.int32();break;case 3:n.con_short_id=e.int64();break;case 4:n.srv_msg_id=e.int64();break;case 5:n.ref_channel_id=e.string();break;case 6:n.voip_mode=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.CreateVoipResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.info=null,e.prototype.status_code=0,e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&$root.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(16).int32(e.status_code),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(24).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CreateVoipResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.info=$root.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:n.status_code=e.int32();break;case 3:n.voip_mode=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.CallVoipRequestBody=function(){function e(e){if(this.callee_ids=[],this.ext={},this.ref_channel_users=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.callee_ids=$util.emptyArray,e.prototype.channel_id="",e.prototype.v_type=0,e.prototype.ext=$util.emptyObject,e.prototype.ref_channel_users=$util.emptyArray,e.prototype.con_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.callee_ids&&e.callee_ids.length)for(var r=0;r<e.callee_ids.length;++r)t.uint32(8).int64(e.callee_ids[r]);if(null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(18).string(e.channel_id),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(24).int32(e.v_type),null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var n=keys(e.ext);for(r=0;r<n.length;++r)t.uint32(34).fork().uint32(10).string(n[r]).uint32(18).string(e.ext[n[r]]).ldelim()}if(null!=e.ref_channel_users&&e.ref_channel_users.length)for(r=0;r<e.ref_channel_users.length;++r)t.uint32(40).int64(e.ref_channel_users[r]);return null!=e.con_id&&Object.hasOwnProperty.call(e,"con_id")&&t.uint32(50).string(e.con_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.CallVoipRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:if(o.callee_ids&&o.callee_ids.length||(o.callee_ids=[]),2==(7&s))for(var a=e.uint32()+e.pos;e.pos<a;)o.callee_ids.push(e.int64());else o.callee_ids.push(e.int64());break;case 2:o.channel_id=e.string();break;case 3:o.v_type=e.int32();break;case 4:for(o.ext===$util.emptyObject&&(o.ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 5:if(o.ref_channel_users&&o.ref_channel_users.length||(o.ref_channel_users=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.ref_channel_users.push(e.int64());else o.ref_channel_users.push(e.int64());break;case 6:o.con_id=e.string();break;default:e.skipType(7&s)}}return o},e}(),e.CallVoipResponseBody=function(){function e(e){if(this.callee_ids=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.info=null,e.prototype.callee_ids=$util.emptyArray,e.prototype.status=0,e.prototype.extra_info="",e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.ref_channel_id="",e.prototype.voip_mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&$root.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.callee_ids&&e.callee_ids.length)for(var r=0;r<e.callee_ids.length;++r)t.uint32(16).int64(e.callee_ids[r]);return null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.extra_info&&Object.hasOwnProperty.call(e,"extra_info")&&t.uint32(34).string(e.extra_info),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(40).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(50).string(e.check_message),null!=e.ref_channel_id&&Object.hasOwnProperty.call(e,"ref_channel_id")&&t.uint32(58).string(e.ref_channel_id),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(64).int32(e.voip_mode),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CallVoipResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.info=$root.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:if(n.callee_ids&&n.callee_ids.length||(n.callee_ids=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.callee_ids.push(e.int64());else n.callee_ids.push(e.int64());break;case 3:n.status=e.int32();break;case 4:n.extra_info=e.string();break;case 5:n.check_code=e.int64();break;case 6:n.check_message=e.string();break;case 7:n.ref_channel_id=e.string();break;case 8:n.voip_mode=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.UpdateVoipRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.channel_id="",e.prototype.status=0,e.prototype.v_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(10).string(e.channel_id),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(16).int32(e.status),null!=e.v_type&&Object.hasOwnProperty.call(e,"v_type")&&t.uint32(24).int32(e.v_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UpdateVoipRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.channel_id=e.string();break;case 2:n.status=e.int32();break;case 3:n.v_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.UpdateVoipResponseBody=function(){function e(e){if(this.callees=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.info=null,e.prototype.status_code=0,e.prototype.voip_mode=0,e.prototype.callees=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.info&&Object.hasOwnProperty.call(e,"info")&&$root.im_proto.VoipInfo.encode(e.info,t.uint32(10).fork()).ldelim(),null!=e.status_code&&Object.hasOwnProperty.call(e,"status_code")&&t.uint32(16).int32(e.status_code),null!=e.voip_mode&&Object.hasOwnProperty.call(e,"voip_mode")&&t.uint32(24).int32(e.voip_mode),null!=e.callees&&e.callees.length)for(var r=0;r<e.callees.length;++r)t.uint32(32).int64(e.callees[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UpdateVoipResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.info=$root.im_proto.VoipInfo.decode(e,e.uint32());break;case 2:n.status_code=e.int32();break;case 3:n.voip_mode=e.int32();break;case 4:if(n.callees&&n.callees.length||(n.callees=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.callees.push(e.int64());else n.callees.push(e.int64());break;default:e.skipType(7&i)}}return n},e}(),e.ChannelStatus=function(){var e={},t=create$9(e);return t[e[0]="CHANNEL_STATUS_NOT_USED"]=0,t[e[1]="ONLINE"]=1,t[e[2]="OFFLINE"]=2,t}(),e.ChannelHeartBeatRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.channel_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.channel_id&&Object.hasOwnProperty.call(e,"channel_id")&&t.uint32(10).string(e.channel_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ChannelHeartBeatRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.channel_id=e.string():e.skipType(7&i)}return n},e}(),e.Profile=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.nick_name="",e.prototype.protrait="",e.prototype.basic_ext_info="",e.prototype.detail_ext_info="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.nick_name&&Object.hasOwnProperty.call(e,"nick_name")&&t.uint32(10).string(e.nick_name),null!=e.protrait&&Object.hasOwnProperty.call(e,"protrait")&&t.uint32(18).string(e.protrait),null!=e.basic_ext_info&&Object.hasOwnProperty.call(e,"basic_ext_info")&&t.uint32(26).string(e.basic_ext_info),null!=e.detail_ext_info&&Object.hasOwnProperty.call(e,"detail_ext_info")&&t.uint32(34).string(e.detail_ext_info),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.Profile;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.nick_name=e.string();break;case 2:n.protrait=e.string();break;case 3:n.basic_ext_info=e.string();break;case 4:n.detail_ext_info=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.ProfileGetInfoRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.userid=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.userid),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ProfileGetInfoRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.userid=e.int64():e.skipType(7&i)}if(!n.hasOwnProperty("userid"))throw $util.ProtocolError("missing required 'userid'",{instance:n});return n},e}(),e.ProfileGetInfoResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.profile=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.profile&&Object.hasOwnProperty.call(e,"profile")&&$root.im_proto.Profile.encode(e.profile,t.uint32(10).fork()).ldelim(),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ProfileGetInfoResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.profile=$root.im_proto.Profile.decode(e,e.uint32()):e.skipType(7&i)}return n},e}(),e.ClientMetricType=function(){var e={},t=create$9(e);return t[e[0]="COUNTER"]=0,t[e[1]="TIMER"]=1,t}(),e.ClientMetric=function(){function e(e){if(this.tags={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.metric_type=0,e.prototype.k="",e.prototype.v=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.tags=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.metric_type&&Object.hasOwnProperty.call(e,"metric_type")&&t.uint32(8).int32(e.metric_type),null!=e.k&&Object.hasOwnProperty.call(e,"k")&&t.uint32(18).string(e.k),null!=e.v&&Object.hasOwnProperty.call(e,"v")&&t.uint32(24).int64(e.v),null!=e.tags&&Object.hasOwnProperty.call(e,"tags"))for(var r=keys(e.tags),n=0;n<r.length;++n)t.uint32(34).fork().uint32(10).string(r[n]).uint32(18).string(e.tags[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.ClientMetric;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.metric_type=e.int32();break;case 2:o.k=e.string();break;case 3:o.v=e.int64();break;case 4:o.tags===$util.emptyObject&&(o.tags={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.tags[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.ReportClientMetricsRequestBody=function(){function e(e){if(this.report_metrics_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.report_metrics_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.report_metrics_list&&e.report_metrics_list.length)for(var r=0;r<e.report_metrics_list.length;++r)$root.im_proto.ClientMetric.encode(e.report_metrics_list[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ReportClientMetricsRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.report_metrics_list&&n.report_metrics_list.length||(n.report_metrics_list=[]),n.report_metrics_list.push($root.im_proto.ClientMetric.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.GetConfigsRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConfigsRequestBody;e.pos<r;){var i=e.uint32();e.skipType(7&i)}return n},e}(),e.GetConfigsResponseBody=function(){function e(e){if(this.configs=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.configs=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).int32(e.version),null!=e.configs&&e.configs.length)for(var r=0;r<e.configs.length;++r)$root.im_proto.Config.encode(e.configs[r],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConfigsResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.version=e.int32();break;case 2:n.configs&&n.configs.length||(n.configs=[]),n.configs.push($root.im_proto.Config.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.Config=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conf_name="",e.prototype.conf_value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conf_name&&Object.hasOwnProperty.call(e,"conf_name")&&t.uint32(10).string(e.conf_name),null!=e.conf_value&&Object.hasOwnProperty.call(e,"conf_value")&&t.uint32(18).string(e.conf_value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.Config;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conf_name=e.string();break;case 2:n.conf_value=e.string();break;default:e.skipType(7&i)}}return n},e}(),e.SendMessageP2PRequestBody=function(){function e(e){if(this.visible_user=[],this.invisible_user=[],this.ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.send_type=0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.visible_user=$util.emptyArray,e.prototype.invisible_user=$util.emptyArray,e.prototype.message_type=0,e.prototype.content="",e.prototype.ext=$util.emptyObject,e.prototype.client_message_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.send_type&&Object.hasOwnProperty.call(e,"send_type")&&t.uint32(8).int32(e.send_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(32).int64(e.conversation_short_id),null!=e.visible_user&&e.visible_user.length)for(var r=0;r<e.visible_user.length;++r)t.uint32(40).int64(e.visible_user[r]);if(null!=e.invisible_user&&e.invisible_user.length)for(r=0;r<e.invisible_user.length;++r)t.uint32(48).int64(e.invisible_user[r]);if(null!=e.message_type&&Object.hasOwnProperty.call(e,"message_type")&&t.uint32(56).int32(e.message_type),null!=e.content&&Object.hasOwnProperty.call(e,"content")&&t.uint32(66).string(e.content),null!=e.ext&&Object.hasOwnProperty.call(e,"ext")){var n=keys(e.ext);for(r=0;r<n.length;++r)t.uint32(74).fork().uint32(10).string(n[r]).uint32(18).string(e.ext[n[r]]).ldelim()}return null!=e.client_message_id&&Object.hasOwnProperty.call(e,"client_message_id")&&t.uint32(82).string(e.client_message_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.SendMessageP2PRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.send_type=e.int32();break;case 2:o.conversation_id=e.string();break;case 3:o.conversation_type=e.int32();break;case 4:o.conversation_short_id=e.int64();break;case 5:if(o.visible_user&&o.visible_user.length||(o.visible_user=[]),2==(7&s))for(var a=e.uint32()+e.pos;e.pos<a;)o.visible_user.push(e.int64());else o.visible_user.push(e.int64());break;case 6:if(o.invisible_user&&o.invisible_user.length||(o.invisible_user=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.invisible_user.push(e.int64());else o.invisible_user.push(e.int64());break;case 7:o.message_type=e.int32();break;case 8:o.content=e.string();break;case 9:for(o.ext===$util.emptyObject&&(o.ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.ext[r]=n;break;case 10:o.client_message_id=e.string();break;default:e.skipType(7&s)}}return o},e}(),e.SendMessageP2PResponseBody=function(){function e(e){if(this.failed_user=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.failed_user=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.failed_user&&e.failed_user.length)for(var r=0;r<e.failed_user.length;++r)t.uint32(8).int64(e.failed_user[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SendMessageP2PResponseBody;e.pos<r;){var i=e.uint32();if(i>>>3==1)if(n.failed_user&&n.failed_user.length||(n.failed_user=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_user.push(e.int64());else n.failed_user.push(e.int64());else e.skipType(7&i)}return n},e}(),e.ConvCountReport=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conv_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(8).int64(e.conv_short_id),null!=e.unread_count&&Object.hasOwnProperty.call(e,"unread_count")&&t.uint32(16).int64(e.unread_count),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConvCountReport;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conv_short_id=e.int64();break;case 2:n.unread_count=e.int64();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.UnReadCountReportRequestBody=function(){function e(e){if(this.conv_unread_count=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.total_unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(8).int64(e.total_unread_count),null!=e.conv_unread_count&&e.conv_unread_count.length)for(var r=0;r<e.conv_unread_count.length;++r)$root.im_proto.ConvCountReport.encode(e.conv_unread_count[r],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UnReadCountReportRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.total_unread_count=e.int64();break;case 2:n.conv_unread_count&&n.conv_unread_count.length||(n.conv_unread_count=[]),n.conv_unread_count.push($root.im_proto.ConvCountReport.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e}(),e.UnReadCountReportResponseBody=function(){function e(e){if(this.failed_conv_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.set_total_status=!1,e.prototype.failed_conv_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).bool(e.set_total_status),null!=e.failed_conv_list&&e.failed_conv_list.length)for(var r=0;r<e.failed_conv_list.length;++r)t.uint32(16).int64(e.failed_conv_list[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.UnReadCountReportResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.set_total_status=e.bool();break;case 2:if(n.failed_conv_list&&n.failed_conv_list.length||(n.failed_conv_list=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_conv_list.push(e.int64());else n.failed_conv_list.push(e.int64());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("set_total_status"))throw $util.ProtocolError("missing required 'set_total_status'",{instance:n});return n},e}(),e.GetUnreadCountRequestBody=function(){function e(e){if(this.conv_short_id=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.get_total=!1,e.prototype.conv_short_id=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.get_total&&Object.hasOwnProperty.call(e,"get_total")&&t.uint32(8).bool(e.get_total),null!=e.conv_short_id&&e.conv_short_id.length)for(var r=0;r<e.conv_short_id.length;++r)t.uint32(16).int64(e.conv_short_id[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetUnreadCountRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.get_total=e.bool();break;case 2:if(n.conv_short_id&&n.conv_short_id.length||(n.conv_short_id=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.conv_short_id.push(e.int64());else n.conv_short_id.push(e.int64());break;default:e.skipType(7&i)}}return n},e}(),e.GetUnreadCountResponseBody=function(){function e(e){if(this.conv_unread_count={},this.failed_conv_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.total_unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conv_unread_count=$util.emptyObject,e.prototype.failed_conv_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(8).int64(e.total_unread_count),null!=e.conv_unread_count&&Object.hasOwnProperty.call(e,"conv_unread_count"))for(var r=keys(e.conv_unread_count),n=0;n<r.length;++n)t.uint32(18).fork().uint32(8).int64(r[n]).uint32(16).int64(e.conv_unread_count[r[n]]).ldelim();if(null!=e.failed_conv_list&&e.failed_conv_list.length)for(n=0;n<e.failed_conv_list.length;++n)t.uint32(24).int64(e.failed_conv_list[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.GetUnreadCountResponseBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.total_unread_count=e.int64();break;case 2:o.conv_unread_count===$util.emptyObject&&(o.conv_unread_count={});var a=e.uint32()+e.pos;for(r=0,n=0;e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.int64();break;case 2:n=e.int64();break;default:e.skipType(7&l)}}o.conv_unread_count["object"===_typeof(r)?$util.longToHash(r):r]=n;break;case 3:if(o.failed_conv_list&&o.failed_conv_list.length||(o.failed_conv_list=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.failed_conv_list.push(e.int64());else o.failed_conv_list.push(e.int64());break;default:e.skipType(7&s)}}return o},e}(),e.GetBlockListRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(8).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(16).int32(e.limit),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetBlockListRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.cursor=e.int64();break;case 2:n.limit=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.BlockUserInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.create_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_id&&Object.hasOwnProperty.call(e,"user_id")&&t.uint32(8).int64(e.user_id),null!=e.create_time&&Object.hasOwnProperty.call(e,"create_time")&&t.uint32(16).int64(e.create_time),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BlockUserInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_id=e.int64();break;case 2:n.create_time=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.GetBlockListResponseBody=function(){function e(e){if(this.user_info=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_info=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.user_info&&e.user_info.length)for(var r=0;r<e.user_info.length;++r)$root.im_proto.BlockUserInfo.encode(e.user_info[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetBlockListResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.user_info&&n.user_info.length||(n.user_info=[]),n.user_info.push($root.im_proto.BlockUserInfo.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.SetBlocklistRequestBody=function(){function e(e){if(this.blocklist=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.set_block_list=!1,e.prototype.blocklist=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.set_block_list&&Object.hasOwnProperty.call(e,"set_block_list")&&t.uint32(8).bool(e.set_block_list),null!=e.blocklist&&e.blocklist.length)for(var r=0;r<e.blocklist.length;++r)t.uint32(16).int64(e.blocklist[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetBlocklistRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.set_block_list=e.bool();break;case 2:if(n.blocklist&&n.blocklist.length||(n.blocklist=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.blocklist.push(e.int64());else n.blocklist.push(e.int64());break;default:e.skipType(7&i)}}return n},e}(),e.SetBlocklistResponseBody=function(){function e(e){if(this.failed_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.failed_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.failed_list&&e.failed_list.length)for(var r=0;r<e.failed_list.length;++r)t.uint32(8).int64(e.failed_list[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.SetBlocklistResponseBody;e.pos<r;){var i=e.uint32();if(i>>>3==1)if(n.failed_list&&n.failed_list.length||(n.failed_list=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_list.push(e.int64());else n.failed_list.push(e.int64());else e.skipType(7&i)}return n},e}(),e.CheckInBlockListRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.user_to_check=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.user_to_check&&Object.hasOwnProperty.call(e,"user_to_check")&&t.uint32(8).int64(e.user_to_check),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CheckInBlockListRequestBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.user_to_check=e.int64():e.skipType(7&i)}return n},e}(),e.CheckInBlockListResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.in_blocklist=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.in_blocklist&&Object.hasOwnProperty.call(e,"in_blocklist")&&t.uint32(8).bool(e.in_blocklist),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.CheckInBlockListResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?n.in_blocklist=e.bool():e.skipType(7&i)}return n},e}(),e.BlockStatus=function(){var e={},t=create$9(e);return t[e[0]="UNBLOCK"]=0,t[e[1]="BLOCK"]=1,t}(),e.BlockMembersRequestBody=function(){function e(e){if(this.block_time={},this.biz_ext={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.block_status=0,e.prototype.block_time=$util.emptyObject,e.prototype.conv_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.conversation_id="",e.prototype.biz_ext=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.block_status&&Object.hasOwnProperty.call(e,"block_status")&&t.uint32(8).int32(e.block_status),null!=e.block_time&&Object.hasOwnProperty.call(e,"block_time"))for(var r=keys(e.block_time),n=0;n<r.length;++n)t.uint32(18).fork().uint32(8).int64(r[n]).uint32(16).int64(e.block_time[r[n]]).ldelim();if(null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(24).int64(e.conv_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(32).int32(e.conversation_type),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(42).string(e.conversation_id),null!=e.biz_ext&&Object.hasOwnProperty.call(e,"biz_ext"))for(r=keys(e.biz_ext),n=0;n<r.length;++n)t.uint32(90).fork().uint32(10).string(r[n]).uint32(18).string(e.biz_ext[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.BlockMembersRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.block_status=e.int32();break;case 2:o.block_time===$util.emptyObject&&(o.block_time={});var a=e.uint32()+e.pos;for(r=0,n=0;e.pos<a;)switch((l=e.uint32())>>>3){case 1:r=e.int64();break;case 2:n=e.int64();break;default:e.skipType(7&l)}o.block_time["object"===_typeof(r)?$util.longToHash(r):r]=n;break;case 3:o.conv_short_id=e.int64();break;case 4:o.conversation_type=e.int32();break;case 5:o.conversation_id=e.string();break;case 11:for(o.biz_ext===$util.emptyObject&&(o.biz_ext={}),a=e.uint32()+e.pos,r="",n="";e.pos<a;){var l;switch((l=e.uint32())>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.biz_ext[r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.BlockMembersResponseBody=function(){function e(e){if(this.failed_members=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.failed_members=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.failed_members&&e.failed_members.length)for(var r=0;r<e.failed_members.length;++r)t.uint32(8).int64(e.failed_members[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BlockMembersResponseBody;e.pos<r;){var i=e.uint32();if(i>>>3==1)if(n.failed_members&&n.failed_members.length||(n.failed_members=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_members.push(e.int64());else n.failed_members.push(e.int64());else e.skipType(7&i)}return n},e}(),e.BlockConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conv_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_type=0,e.prototype.block_status=0,e.prototype.block_normal_only=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conv_short_id&&Object.hasOwnProperty.call(e,"conv_short_id")&&t.uint32(16).int64(e.conv_short_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),null!=e.block_status&&Object.hasOwnProperty.call(e,"block_status")&&t.uint32(32).int32(e.block_status),null!=e.block_normal_only&&Object.hasOwnProperty.call(e,"block_normal_only")&&t.uint32(40).bool(e.block_normal_only),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BlockConversationRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conv_short_id=e.int64();break;case 3:n.conversation_type=e.int32();break;case 4:n.block_status=e.int32();break;case 5:n.block_normal_only=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.GetMessagesCheckInfoInConversationRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.cursor_reverse_begin=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.cursor_reverse_end=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.expect_msg_total_count=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(16).int64(e.conversation_short_id),null!=e.cursor_reverse_begin&&Object.hasOwnProperty.call(e,"cursor_reverse_begin")&&t.uint32(24).int64(e.cursor_reverse_begin),null!=e.expect_msg_total_count&&Object.hasOwnProperty.call(e,"expect_msg_total_count")&&t.uint32(32).int32(e.expect_msg_total_count),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(42).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(48).int32(e.conversation_type),null!=e.cursor_reverse_end&&Object.hasOwnProperty.call(e,"cursor_reverse_end")&&t.uint32(56).int64(e.cursor_reverse_end),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMessagesCheckInfoInConversationRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 2:n.conversation_short_id=e.int64();break;case 5:n.conversation_id=e.string();break;case 6:n.conversation_type=e.int32();break;case 3:n.cursor_reverse_begin=e.int64();break;case 7:n.cursor_reverse_end=e.int64();break;case 4:n.expect_msg_total_count=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.MessagesCheckInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.head_msg_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.tail_msg_index=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.msg_count=0,e.prototype.indexes_checksum=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.head_msg_index&&Object.hasOwnProperty.call(e,"head_msg_index")&&t.uint32(8).int64(e.head_msg_index),null!=e.tail_msg_index&&Object.hasOwnProperty.call(e,"tail_msg_index")&&t.uint32(16).int64(e.tail_msg_index),null!=e.msg_count&&Object.hasOwnProperty.call(e,"msg_count")&&t.uint32(24).int32(e.msg_count),null!=e.indexes_checksum&&Object.hasOwnProperty.call(e,"indexes_checksum")&&t.uint32(32).uint32(e.indexes_checksum),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MessagesCheckInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.head_msg_index=e.int64();break;case 2:n.tail_msg_index=e.int64();break;case 3:n.msg_count=e.int32();break;case 4:n.indexes_checksum=e.uint32();break;default:e.skipType(7&i)}}return n},e}(),e.GetMessagesCheckInfoInConversationResponseBody=function(){function e(e){if(this.msgs_checkinfo_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.msgs_checkinfo_list=$util.emptyArray,e.prototype.real_msg_total_count=0,e.prototype.cursor_reverse_next=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.msgs_checkinfo_list&&e.msgs_checkinfo_list.length)for(var r=0;r<e.msgs_checkinfo_list.length;++r)$root.im_proto.MessagesCheckInfo.encode(e.msgs_checkinfo_list[r],t.uint32(10).fork()).ldelim();return null!=e.real_msg_total_count&&Object.hasOwnProperty.call(e,"real_msg_total_count")&&t.uint32(16).int32(e.real_msg_total_count),null!=e.cursor_reverse_next&&Object.hasOwnProperty.call(e,"cursor_reverse_next")&&t.uint32(32).int64(e.cursor_reverse_next),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetMessagesCheckInfoInConversationResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.msgs_checkinfo_list&&n.msgs_checkinfo_list.length||(n.msgs_checkinfo_list=[]),n.msgs_checkinfo_list.push($root.im_proto.MessagesCheckInfo.decode(e,e.uint32()));break;case 2:n.real_msg_total_count=e.int32();break;case 4:n.cursor_reverse_next=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.ConversationCheckInfo=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.conversation_id="",e.prototype.conversation_type=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(8).int64(e.conversation_short_id),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(18).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(24).int32(e.conversation_type),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.ConversationCheckInfo;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_short_id=e.int64();break;case 2:n.conversation_id=e.string();break;case 3:n.conversation_type=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.GetConversationsCheckInfoResponseBody=function(){function e(e){if(this.conversation_checkinfo_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_checkinfo_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_checkinfo_list&&e.conversation_checkinfo_list.length)for(var r=0;r<e.conversation_checkinfo_list.length;++r)$root.im_proto.ConversationCheckInfo.encode(e.conversation_checkinfo_list[r],t.uint32(10).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.GetConversationsCheckInfoResponseBody;e.pos<r;){var i=e.uint32();i>>>3==1?(n.conversation_checkinfo_list&&n.conversation_checkinfo_list.length||(n.conversation_checkinfo_list=[]),n.conversation_checkinfo_list.push($root.im_proto.ConversationCheckInfo.decode(e,e.uint32()))):e.skipType(7&i)}return n},e}(),e.ActionType=function(){var e={},t=create$9(e);return t[e[0]="UNKNOWN_ACTION"]=0,t[e[1]="FAVORITE"]=1,t[e[2]="PIN"]=2,t[e[3]="UNREAD"]=3,t}(),e.MarkMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.do_action=!1,e.prototype.action_type=0,e.prototype.sort_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.tag=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(32).int64(e.server_message_id),null!=e.do_action&&Object.hasOwnProperty.call(e,"do_action")&&t.uint32(40).bool(e.do_action),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(48).int32(e.action_type),null!=e.sort_time&&Object.hasOwnProperty.call(e,"sort_time")&&t.uint32(56).int64(e.sort_time),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(64).int64(e.tag),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.server_message_id=e.int64();break;case 5:n.do_action=e.bool();break;case 6:n.action_type=e.int32();break;case 7:n.sort_time=e.int64();break;case 8:n.tag=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.MarkMessageResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.server_message_id=e.int64();break;case 2:n.check_code=e.int64();break;case 3:n.check_message=e.string();break;case 4:n.status=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.PullMarkMessageRequestBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.limit=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.asc=!1,e.prototype.action_type=0,e.prototype.tag=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.clear_unread_count=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.cursor&&Object.hasOwnProperty.call(e,"cursor")&&t.uint32(32).int64(e.cursor),null!=e.limit&&Object.hasOwnProperty.call(e,"limit")&&t.uint32(40).int64(e.limit),null!=e.asc&&Object.hasOwnProperty.call(e,"asc")&&t.uint32(48).bool(e.asc),null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(56).int32(e.action_type),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(64).int64(e.tag),null!=e.clear_unread_count&&Object.hasOwnProperty.call(e,"clear_unread_count")&&t.uint32(72).bool(e.clear_unread_count),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.PullMarkMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.cursor=e.int64();break;case 5:n.limit=e.int64();break;case 6:n.asc=e.bool();break;case 7:n.action_type=e.int32();break;case 8:n.tag=e.int64();break;case 9:n.clear_unread_count=e.bool();break;default:e.skipType(7&i)}}return n},e}(),e.PullMarkMessageResponseBody=function(){function e(e){if(this.messages=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.messages=$util.emptyArray,e.prototype.has_more=!1,e.prototype.next_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.messages&&e.messages.length)for(var r=0;r<e.messages.length;++r)$root.im_proto.MessageBody.encode(e.messages[r],t.uint32(10).fork()).ldelim();return null!=e.has_more&&Object.hasOwnProperty.call(e,"has_more")&&t.uint32(16).bool(e.has_more),null!=e.next_cursor&&Object.hasOwnProperty.call(e,"next_cursor")&&t.uint32(24).int64(e.next_cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.PullMarkMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.messages&&n.messages.length||(n.messages=[]),n.messages.push($root.im_proto.MessageBody.decode(e,e.uint32()));break;case 2:n.has_more=e.bool();break;case 3:n.next_cursor=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.MessageStatus=function(){var e={},t=create$9(e);return t[e[0]="AVAILABLE"]=0,t[e[1]="NOT_EXIST"]=1,t[e[2]="INVISIBLE"]=2,t[e[3]="RECALLED"]=3,t[e[4]="DELETED"]=4,t}(),e.BatchUnmarkMessageRequestBody=function(){function e(e){if(this.server_message_ids=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.server_message_ids=$util.emptyArray,e.prototype.action_type=0,e.prototype.tag=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.server_message_ids&&e.server_message_ids.length)for(var r=0;r<e.server_message_ids.length;++r)t.uint32(32).int64(e.server_message_ids[r]);return null!=e.action_type&&Object.hasOwnProperty.call(e,"action_type")&&t.uint32(40).int32(e.action_type),null!=e.tag&&Object.hasOwnProperty.call(e,"tag")&&t.uint32(48).int64(e.tag),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BatchUnmarkMessageRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:if(n.server_message_ids&&n.server_message_ids.length||(n.server_message_ids=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.server_message_ids.push(e.int64());else n.server_message_ids.push(e.int64());break;case 5:n.action_type=e.int32();break;case 6:n.tag=e.int64();break;default:e.skipType(7&i)}}return n},e}(),e.BatchUnmarkMessageResponseBody=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.server_message_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_code=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.check_message="",e.prototype.status=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.server_message_id&&Object.hasOwnProperty.call(e,"server_message_id")&&t.uint32(8).int64(e.server_message_id),null!=e.check_code&&Object.hasOwnProperty.call(e,"check_code")&&t.uint32(16).int64(e.check_code),null!=e.check_message&&Object.hasOwnProperty.call(e,"check_message")&&t.uint32(26).string(e.check_message),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(32).int32(e.status),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.BatchUnmarkMessageResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.server_message_id=e.int64();break;case 2:n.check_code=e.int64();break;case 3:n.check_message=e.string();break;case 4:n.status=e.int32();break;default:e.skipType(7&i)}}return n},e}(),e.MarkMsgUnreadCountReportRequestBody=function(){function e(e){if(this.tag_unread_count={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.total_unread_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.tag_unread_count=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.total_unread_count&&Object.hasOwnProperty.call(e,"total_unread_count")&&t.uint32(32).int64(e.total_unread_count),null!=e.tag_unread_count&&Object.hasOwnProperty.call(e,"tag_unread_count"))for(var r=keys(e.tag_unread_count),n=0;n<r.length;++n)t.uint32(42).fork().uint32(8).int64(r[n]).uint32(16).int64(e.tag_unread_count[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.MarkMsgUnreadCountReportRequestBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.conversation_id=e.string();break;case 2:o.conversation_type=e.int32();break;case 3:o.conversation_short_id=e.int64();break;case 4:o.total_unread_count=e.int64();break;case 5:o.tag_unread_count===$util.emptyObject&&(o.tag_unread_count={});var a=e.uint32()+e.pos;for(r=0,n=0;e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.int64();break;case 2:n=e.int64();break;default:e.skipType(7&l)}}o.tag_unread_count["object"===_typeof(r)?$util.longToHash(r):r]=n;break;default:e.skipType(7&s)}}return o},e}(),e.MarkMsgUnreadCountReportResponseBody=function(){function e(e){if(this.failed_tag_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.set_total_status=!1,e.prototype.failed_tag_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.set_total_status&&Object.hasOwnProperty.call(e,"set_total_status")&&t.uint32(8).bool(e.set_total_status),null!=e.failed_tag_list&&e.failed_tag_list.length)for(var r=0;r<e.failed_tag_list.length;++r)t.uint32(16).int64(e.failed_tag_list[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkMsgUnreadCountReportResponseBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.set_total_status=e.bool();break;case 2:if(n.failed_tag_list&&n.failed_tag_list.length||(n.failed_tag_list=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.failed_tag_list.push(e.int64());else n.failed_tag_list.push(e.int64());break;default:e.skipType(7&i)}}return n},e}(),e.MarkMsgGetUnreadCountRequestBody=function(){function e(e){if(this.tags=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.conversation_id="",e.prototype.conversation_type=0,e.prototype.conversation_short_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.get_total=!1,e.prototype.tags=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.conversation_id&&Object.hasOwnProperty.call(e,"conversation_id")&&t.uint32(10).string(e.conversation_id),null!=e.conversation_type&&Object.hasOwnProperty.call(e,"conversation_type")&&t.uint32(16).int32(e.conversation_type),null!=e.conversation_short_id&&Object.hasOwnProperty.call(e,"conversation_short_id")&&t.uint32(24).int64(e.conversation_short_id),null!=e.get_total&&Object.hasOwnProperty.call(e,"get_total")&&t.uint32(32).bool(e.get_total),null!=e.tags&&e.tags.length)for(var r=0;r<e.tags.length;++r)t.uint32(40).int64(e.tags[r]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.im_proto.MarkMsgGetUnreadCountRequestBody;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.conversation_id=e.string();break;case 2:n.conversation_type=e.int32();break;case 3:n.conversation_short_id=e.int64();break;case 4:n.get_total=e.bool();break;case 5:if(n.tags&&n.tags.length||(n.tags=[]),2==(7&i))for(var o=e.uint32()+e.pos;e.pos<o;)n.tags.push(e.int64());else n.tags.push(e.int64());break;default:e.skipType(7&i)}}return n},e}(),e.MarkMsgGetUnreadCountResponseBody=function(){function e(e){if(this.tag_unread_count={},this.failed_tag_list=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.total_count=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.tag_unread_count=$util.emptyObject,e.prototype.failed_tag_list=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.total_count&&Object.hasOwnProperty.call(e,"total_count")&&t.uint32(8).int64(e.total_count),null!=e.tag_unread_count&&Object.hasOwnProperty.call(e,"tag_unread_count"))for(var r=keys(e.tag_unread_count),n=0;n<r.length;++n)t.uint32(18).fork().uint32(8).int64(r[n]).uint32(16).int64(e.tag_unread_count[r[n]]).ldelim();if(null!=e.failed_tag_list&&e.failed_tag_list.length)for(n=0;n<e.failed_tag_list.length;++n)t.uint32(24).int64(e.failed_tag_list[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.im_proto.MarkMsgGetUnreadCountResponseBody;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.total_count=e.int64();break;case 2:o.tag_unread_count===$util.emptyObject&&(o.tag_unread_count={});var a=e.uint32()+e.pos;for(r=0,n=0;e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.int64();break;case 2:n=e.int64();break;default:e.skipType(7&l)}}o.tag_unread_count["object"===_typeof(r)?$util.longToHash(r):r]=n;break;case 3:if(o.failed_tag_list&&o.failed_tag_list.length||(o.failed_tag_list=[]),2==(7&s))for(a=e.uint32()+e.pos;e.pos<a;)o.failed_tag_list.push(e.int64());else o.failed_tag_list.push(e.int64());break;default:e.skipType(7&s)}}return o},e}(),e),sync_proto=$root.sync_proto=function(){var e={};return e.Frame=function(){function e(e){if(this.headers=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.seqid=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.logid=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.service=0,e.prototype.method=0,e.prototype.headers=$util.emptyArray,e.prototype.payload_encoding="",e.prototype.payload_type="",e.prototype.payload=$util.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).uint64(e.seqid),t.uint32(16).uint64(e.logid),t.uint32(24).int32(e.service),t.uint32(32).int32(e.method),null!=e.headers&&e.headers.length)for(var r=0;r<e.headers.length;++r)$root.sync_proto.Frame.ExtendedEntry.encode(e.headers[r],t.uint32(42).fork()).ldelim();return null!=e.payload_encoding&&Object.hasOwnProperty.call(e,"payload_encoding")&&t.uint32(50).string(e.payload_encoding),null!=e.payload_type&&Object.hasOwnProperty.call(e,"payload_type")&&t.uint32(58).string(e.payload_type),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(66).bytes(e.payload),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.Frame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.seqid=e.uint64();break;case 2:n.logid=e.uint64();break;case 3:n.service=e.int32();break;case 4:n.method=e.int32();break;case 5:n.headers&&n.headers.length||(n.headers=[]),n.headers.push($root.sync_proto.Frame.ExtendedEntry.decode(e,e.uint32()));break;case 6:n.payload_encoding=e.string();break;case 7:n.payload_type=e.string();break;case 8:n.payload=e.bytes();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("seqid"))throw $util.ProtocolError("missing required 'seqid'",{instance:n});if(!n.hasOwnProperty("logid"))throw $util.ProtocolError("missing required 'logid'",{instance:n});if(!n.hasOwnProperty("service"))throw $util.ProtocolError("missing required 'service'",{instance:n});if(!n.hasOwnProperty("method"))throw $util.ProtocolError("missing required 'method'",{instance:n});return n},e.ExtendedEntry=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(10).string(e.key),t.uint32(18).string(e.value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.Frame.ExtendedEntry;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("key"))throw $util.ProtocolError("missing required 'key'",{instance:n});if(!n.hasOwnProperty("value"))throw $util.ProtocolError("missing required 'value'",{instance:n});return n},e}(),e}(),e.Version=function(){var e={},t=create$9(e);return t[e[0]="Unknown"]=0,t[e[1]="V1"]=1,t[e[2]="V2"]=2,t}(),e.ConsumeType=function(){var e={},t=create$9(e);return t[e[0]="OneByOne"]=0,t[e[1]="Increment"]=1,t}(),e.Flag=function(){var e={},t=create$9(e);return t[e[0]="None"]=0,t[e[1]="ACK"]=1,t[e[2]="Data"]=2,t[e[3]="Sync"]=3,t[e[4]="Poll"]=4,t[e[5]="FIN"]=5,t}(),e.InfoKey=function(){var e={},t=create$9(e);return t[e[0]="Params"]=0,t[e[1]="CustomParams"]=1,t[e[100]="ErrCode"]=100,t[e[101]="ErrMsg"]=101,t}(),e.Bucket=function(){var e={},t=create$9(e);return t[e[0]="Device"]=0,t[e[1]="User"]=1,t}(),e.TopicType=function(){var e={},t=create$9(e);return t[e[0]="SpecTopic"]=0,t[e[1]="GlobalTopic"]=1,t[e[2]="CustomTopic"]=2,t}(),e.TopicStatus=function(){var e={},t=create$9(e);return t[e[0]="NotExist"]=0,t[e[1]="Active"]=1,t[e[2]="Closed"]=2,t}(),e.Status=function(){var e={},t=create$9(e);return t[e[0]="InValid"]=0,t[e[1]="Valid"]=1,t}(),e.PacketStatus=function(){var e={},t=create$9(e);return t[e[0]="Full"]=0,t[e[1]="OnlySave"]=1,t}(),e.Ctrl=function(){var e={},t=create$9(e);return t[e[0]="Default"]=0,t[e[1]="HttpPoll"]=1,t[e[2]="HeartbeatPong"]=2,t}(),e.BsyncHeader=function(){function e(e){if(this.infos={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.version=0,e.prototype.uid="",e.prototype.did="",e.prototype.ts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ctrl=0,e.prototype.infos=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).int32(e.version),null!=e.uid&&Object.hasOwnProperty.call(e,"uid")&&t.uint32(18).string(e.uid),null!=e.did&&Object.hasOwnProperty.call(e,"did")&&t.uint32(26).string(e.did),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(32).int64(e.ts),null!=e.ctrl&&Object.hasOwnProperty.call(e,"ctrl")&&t.uint32(40).int32(e.ctrl),null!=e.infos&&Object.hasOwnProperty.call(e,"infos"))for(var r=keys(e.infos),n=0;n<r.length;++n)t.uint32(2042).fork().uint32(8).int32(r[n]).uint32(18).bytes(e.infos[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.sync_proto.BsyncHeader;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.version=e.int32();break;case 2:o.uid=e.string();break;case 3:o.did=e.string();break;case 4:o.ts=e.int64();break;case 5:o.ctrl=e.int32();break;case 255:o.infos===$util.emptyObject&&(o.infos={});var a=e.uint32()+e.pos;for(r=0,n=[];e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.int32();break;case 2:n=e.bytes();break;default:e.skipType(7&l)}}o.infos[r]=n;break;default:e.skipType(7&s)}}if(!o.hasOwnProperty("version"))throw $util.ProtocolError("missing required 'version'",{instance:o});return o},e}(),e.BsyncCursor=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int64(e.cursor),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.BsyncCursor;e.pos<r;){var i=e.uint32();i>>>3==1?n.cursor=e.int64():e.skipType(7&i)}if(!n.hasOwnProperty("cursor"))throw $util.ProtocolError("missing required 'cursor'",{instance:n});return n},e}(),e.BsyncPayload=function(){function e(e){if(e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.business=0,e.prototype.consume_type=0,e.prototype.md5="",e.prototype.data=$util.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),t.uint32(8).int32(e.business),null!=e.consume_type&&Object.hasOwnProperty.call(e,"consume_type")&&t.uint32(16).int32(e.consume_type),null!=e.md5&&Object.hasOwnProperty.call(e,"md5")&&t.uint32(26).string(e.md5),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).bytes(e.data),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.BsyncPayload;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.business=e.int32();break;case 2:n.consume_type=e.int32();break;case 3:n.md5=e.string();break;case 4:n.data=e.bytes();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("business"))throw $util.ProtocolError("missing required 'business'",{instance:n});return n},e}(),e.BsyncPacket=function(){function e(e){if(this.extra={},e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.cursor=null,e.prototype.payload=null,e.prototype.status=0,e.prototype.ts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.extra=$util.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),$root.sync_proto.BsyncCursor.encode(e.cursor,t.uint32(10).fork()).ldelim(),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&$root.sync_proto.BsyncPayload.encode(e.payload,t.uint32(18).fork()).ldelim(),null!=e.status&&Object.hasOwnProperty.call(e,"status")&&t.uint32(24).int32(e.status),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(2040).int64(e.ts),null!=e.extra&&Object.hasOwnProperty.call(e,"extra"))for(var r=keys(e.extra),n=0;n<r.length;++n)t.uint32(2050).fork().uint32(10).string(r[n]).uint32(18).string(e.extra[r[n]]).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r,n,i=void 0===t?e.len:e.pos+t,o=new $root.sync_proto.BsyncPacket;e.pos<i;){var s=e.uint32();switch(s>>>3){case 1:o.cursor=$root.sync_proto.BsyncCursor.decode(e,e.uint32());break;case 2:o.payload=$root.sync_proto.BsyncPayload.decode(e,e.uint32());break;case 3:o.status=e.int32();break;case 255:o.ts=e.int64();break;case 256:o.extra===$util.emptyObject&&(o.extra={});var a=e.uint32()+e.pos;for(r="",n="";e.pos<a;){var l=e.uint32();switch(l>>>3){case 1:r=e.string();break;case 2:n=e.string();break;default:e.skipType(7&l)}}o.extra[r]=n;break;default:e.skipType(7&s)}}if(!o.hasOwnProperty("cursor"))throw $util.ProtocolError("missing required 'cursor'",{instance:o});return o},e}(),e.BsyncTopic=function(){function e(e){if(this.packets=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.flag=0,e.prototype.bucket=0,e.prototype.topic_type=0,e.prototype.sync_id=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.ref_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.new_cursor=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.packets=$util.emptyArray,e.prototype.topic_status=0,e.prototype.expire_time=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.req_id="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),t.uint32(8).int32(e.flag),null!=e.bucket&&Object.hasOwnProperty.call(e,"bucket")&&t.uint32(16).int32(e.bucket),t.uint32(24).int32(e.topic_type),null!=e.sync_id&&Object.hasOwnProperty.call(e,"sync_id")&&t.uint32(32).int64(e.sync_id),null!=e.ref_cursor&&Object.hasOwnProperty.call(e,"ref_cursor")&&t.uint32(40).int64(e.ref_cursor),null!=e.new_cursor&&Object.hasOwnProperty.call(e,"new_cursor")&&t.uint32(48).int64(e.new_cursor),null!=e.packets&&e.packets.length)for(var r=0;r<e.packets.length;++r)$root.sync_proto.BsyncPacket.encode(e.packets[r],t.uint32(58).fork()).ldelim();return null!=e.topic_status&&Object.hasOwnProperty.call(e,"topic_status")&&t.uint32(64).int32(e.topic_status),null!=e.expire_time&&Object.hasOwnProperty.call(e,"expire_time")&&t.uint32(72).int64(e.expire_time),null!=e.req_id&&Object.hasOwnProperty.call(e,"req_id")&&t.uint32(2042).string(e.req_id),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.BsyncTopic;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.flag=e.int32();break;case 2:n.bucket=e.int32();break;case 3:n.topic_type=e.int32();break;case 4:n.sync_id=e.int64();break;case 5:n.ref_cursor=e.int64();break;case 6:n.new_cursor=e.int64();break;case 7:n.packets&&n.packets.length||(n.packets=[]),n.packets.push($root.sync_proto.BsyncPacket.decode(e,e.uint32()));break;case 8:n.topic_status=e.int32();break;case 9:n.expire_time=e.int64();break;case 255:n.req_id=e.string();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("flag"))throw $util.ProtocolError("missing required 'flag'",{instance:n});if(!n.hasOwnProperty("topic_type"))throw $util.ProtocolError("missing required 'topic_type'",{instance:n});return n},e}(),e.BsyncProtocol=function(){function e(e){if(this.topics=[],e)for(var t=keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.header=null,e.prototype.topics=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),$root.sync_proto.BsyncHeader.encode(e.header,t.uint32(10).fork()).ldelim(),null!=e.topics&&e.topics.length)for(var r=0;r<e.topics.length;++r)$root.sync_proto.BsyncTopic.encode(e.topics[r],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.sync_proto.BsyncProtocol;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.header=$root.sync_proto.BsyncHeader.decode(e,e.uint32());break;case 2:n.topics&&n.topics.length||(n.topics=[]),n.topics.push($root.sync_proto.BsyncTopic.decode(e,e.uint32()));break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("header"))throw $util.ProtocolError("missing required 'header'",{instance:n});return n},e}(),e}(),Version$1={},_context,SdkConsts={sdkVersion:Version$1.version,refer:im_proto.Refer.PC,buildNumber:concat$3(_context="".concat(Version$1.commit,":")).call(_context,Version$1.branch),wsProtocols:["binary","base64","pbbp2"],ticketType:im_proto.TicketType.TICKET_TYPE_WEB,envKey:"X-Tt-Env",boeHeaderKey:"X-Use-Boe",ppeHeaderKey:"X-Use-Ppe"},InitResult,SyncEvent,ErrorType,e;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){e[e.NotAvailable=0]="NotAvailable",e[e.Start=1]="Start",e[e.Error=2]="Error",e[e.Succeeded=3]="Succeeded"}(InitResult||(InitResult={})),function(e){e.Error="error",e.WebSocketConnected="websocket-connected",e.WebSocketDisconnected="websocket-disconnected",e.WebSocketReceiveUnexpectedFrame="websocket-receive-unexpected-frame",e.InitLoadPage="init-load-page",e.InitFinish="init-finish"}(SyncEvent||(SyncEvent={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Success=0]="Success",e[e.InvalidParam=400]="InvalidParam",e[e.InternalError=500]="InternalError",e[e.NetworkError=501]="NetworkError"}(ErrorType||(ErrorType={}));var defineProperty$c={exports:{}},$$Q=_export,DESCRIPTORS$5=descriptors,defineProperty$b=objectDefineProperty.f;$$Q({target:"Object",stat:!0,forced:Object.defineProperty!==defineProperty$b,sham:!DESCRIPTORS$5},{defineProperty:defineProperty$b});var path$d=path$l,Object$1=path$d.Object,defineProperty$a=defineProperty$c.exports=function(e,t,r){return Object$1.defineProperty(e,t,r)};Object$1.defineProperty.sham&&(defineProperty$a.sham=!0);var parent$J=defineProperty$c.exports,defineProperty$9=parent$J,parent$I=defineProperty$9,defineProperty$8=parent$I,parent$H=defineProperty$8,defineProperty$7=parent$H,defineProperty$6=defineProperty$7,defineProperty$5=defineProperty$6;function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),defineProperty$5(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),defineProperty$5(e,"prototype",{writable:!1}),e}var $$P=_export,$map=arrayIteration.map,arrayMethodHasSpeciesSupport$2=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT$2=arrayMethodHasSpeciesSupport$2("map");$$P({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$2},{map:function(e){return $map(this,e,arguments.length>1?arguments[1]:void 0)}});var entryVirtual$8=entryVirtual$b,map$9=entryVirtual$8("Array").map,isPrototypeOf$a=objectIsPrototypeOf,method$6=map$9,ArrayPrototype$7=Array.prototype,map$8=function(e){var t=e.map;return e===ArrayPrototype$7||isPrototypeOf$a(ArrayPrototype$7,e)&&t===ArrayPrototype$7.map?method$6:t},parent$G=map$8,map$7=parent$G,map$6=map$7,$$O=_export,$filter=arrayIteration.filter,arrayMethodHasSpeciesSupport$1=arrayMethodHasSpeciesSupport$4,HAS_SPECIES_SUPPORT$1=arrayMethodHasSpeciesSupport$1("filter");$$O({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT$1},{filter:function(e){return $filter(this,e,arguments.length>1?arguments[1]:void 0)}});var entryVirtual$7=entryVirtual$b,filter$3=entryVirtual$7("Array").filter,isPrototypeOf$9=objectIsPrototypeOf,method$5=filter$3,ArrayPrototype$6=Array.prototype,filter$2=function(e){var t=e.filter;return e===ArrayPrototype$6||isPrototypeOf$9(ArrayPrototype$6,e)&&t===ArrayPrototype$6.filter?method$5:t},parent$F=filter$2,filter$1=parent$F,filter=filter$1,fails$b=fails$s,arrayMethodIsStrict$3=function(e,t){var r=[][e];return!!r&&fails$b(function(){r.call(null,t||function(){return 1},1)})},$forEach=arrayIteration.forEach,arrayMethodIsStrict$2=arrayMethodIsStrict$3,STRICT_METHOD$2=arrayMethodIsStrict$2("forEach"),arrayForEach=STRICT_METHOD$2?[].forEach:function(e){return $forEach(this,e,arguments.length>1?arguments[1]:void 0)},$$N=_export,forEach$5=arrayForEach;$$N({target:"Array",proto:!0,forced:[].forEach!=forEach$5},{forEach:forEach$5});var entryVirtual$6=entryVirtual$b,forEach$4=entryVirtual$6("Array").forEach,parent$E=forEach$4,forEach$3=parent$E,classof$4=classof$a,hasOwn$4=hasOwnProperty_1,isPrototypeOf$8=objectIsPrototypeOf,method$4=forEach$3,ArrayPrototype$5=Array.prototype,DOMIterables={DOMTokenList:!0,NodeList:!0},forEach$2=function(e){var t=e.forEach;return e===ArrayPrototype$5||isPrototypeOf$8(ArrayPrototype$5,e)&&t===ArrayPrototype$5.forEach||hasOwn$4(DOMIterables,classof$4(e))?method$4:t},forEach$1=forEach$2,EventEmitter=function(){function e(){_classCallCheck(this,e),this.map={}}return _createClass(e,[{key:"off",value:function(e,t){var r=map$6(this)[e]||[];map$6(this)[e]=t?filter(r).call(r,function(e){return e!==t}):[]}},{key:"on",value:function(e,t){var r=map$6(this)[e]||[];return r.push(t),map$6(this)[e]=r,function(){this.off(e,t)}}},{key:"emit",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=map$6(this)[e]||[];forEach$1(i).call(i,function(e){e.apply(void 0,r)})}},{key:"clearAll",value:function(){this.map={}}}]),e}(),parent$D=create$a,create$6=parent$D,parent$C=create$6,create$5=parent$C,create$4=create$5,create$3=create$4,$$M=_export,setPrototypeOf$8=objectSetPrototypeOf;$$M({target:"Object",stat:!0},{setPrototypeOf:setPrototypeOf$8});var path$c=path$l,setPrototypeOf$7=path$c.Object.setPrototypeOf,parent$B=setPrototypeOf$7,setPrototypeOf$6=parent$B,parent$A=setPrototypeOf$6,setPrototypeOf$5=parent$A,parent$z=setPrototypeOf$5,setPrototypeOf$4=parent$z,setPrototypeOf$3=setPrototypeOf$4,setPrototypeOf$2=setPrototypeOf$3;function _setPrototypeOf(e,t){return _setPrototypeOf=setPrototypeOf$2||function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=create$3(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),defineProperty$5(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}var uncurryThis$9=functionUncurryThis,aCallable$j=aCallable$m,isObject$9=isObject$i,hasOwn$3=hasOwnProperty_1,arraySlice$3=arraySlice$5,NATIVE_BIND=functionBindNative,$Function=Function,concat$2=uncurryThis$9([].concat),join=uncurryThis$9([].join),factories={},construct$6=function(e,t,r){if(!hasOwn$3(factories,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";factories[t]=$Function("C,a","return new C("+join(n,",")+")")}return factories[t](e,r)},functionBind=NATIVE_BIND?$Function.bind:function(e){var t=aCallable$j(this),r=t.prototype,n=arraySlice$3(arguments,1),i=function(){var r=concat$2(n,arraySlice$3(arguments));return this instanceof i?construct$6(t,r.length,r):t.apply(e,r)};return isObject$9(r)&&(i.prototype=r),i},isConstructor$2=isConstructor$4,tryToString$2=tryToString$5,$TypeError$8=TypeError,aConstructor$3=function(e){if(isConstructor$2(e))return e;throw $TypeError$8(tryToString$2(e)+" is not a constructor")},$$L=_export,getBuiltIn$8=getBuiltIn$h,apply$3=functionApply,bind$n=functionBind,aConstructor$2=aConstructor$3,anObject$m=anObject$s,isObject$8=isObject$i,create$2=objectCreate,fails$a=fails$s,nativeConstruct=getBuiltIn$8("Reflect","construct"),ObjectPrototype=Object.prototype,push$4=[].push,NEW_TARGET_BUG=fails$a(function(){function e(){}return!(nativeConstruct(function(){},[],e)instanceof e)}),ARGS_BUG=!fails$a(function(){nativeConstruct(function(){})}),FORCED=NEW_TARGET_BUG||ARGS_BUG;$$L({target:"Reflect",stat:!0,forced:FORCED,sham:FORCED},{construct:function(e,t){aConstructor$2(e),anObject$m(t);var r=arguments.length<3?e:aConstructor$2(arguments[2]);if(ARGS_BUG&&!NEW_TARGET_BUG)return nativeConstruct(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return apply$3(push$4,n,t),new(apply$3(bind$n,e,n))}var i=r.prototype,o=create$2(isObject$8(i)?i:ObjectPrototype),s=apply$3(e,o,t);return isObject$8(s)?s:o}});var path$b=path$l,construct$5=path$b.Reflect.construct,parent$y=construct$5,construct$4=parent$y,parent$x=construct$4,construct$3=parent$x,parent$w=construct$3,construct$2=parent$w,construct$1=construct$2,construct=construct$1,$$K=_export,fails$9=fails$s,toObject$2=toObject$9,nativeGetPrototypeOf=objectGetPrototypeOf,CORRECT_PROTOTYPE_GETTER=correctPrototypeGetter,FAILS_ON_PRIMITIVES$1=fails$9(function(){nativeGetPrototypeOf(1)});$$K({target:"Object",stat:!0,forced:FAILS_ON_PRIMITIVES$1,sham:!CORRECT_PROTOTYPE_GETTER},{getPrototypeOf:function(e){return nativeGetPrototypeOf(toObject$2(e))}});var path$a=path$l,getPrototypeOf$7=path$a.Object.getPrototypeOf,parent$v=getPrototypeOf$7,getPrototypeOf$6=parent$v,parent$u=getPrototypeOf$6,getPrototypeOf$5=parent$u,parent$t=getPrototypeOf$5,getPrototypeOf$4=parent$t,getPrototypeOf$3=getPrototypeOf$4,getPrototypeOf$2=getPrototypeOf$3;function _getPrototypeOf(e){return _getPrototypeOf=setPrototypeOf$2?getPrototypeOf$2:function(e){return e.__proto__||getPrototypeOf$2(e)},_getPrototypeOf(e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!construct)return!1;if(construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}var DESCRIPTORS$4=descriptors,uncurryThis$8=functionUncurryThis,call$k=functionCall,fails$8=fails$s,objectKeys$1=objectKeys$4,getOwnPropertySymbolsModule$1=objectGetOwnPropertySymbols,propertyIsEnumerableModule=objectPropertyIsEnumerable,toObject$1=toObject$9,IndexedObject=indexedObject,$assign=Object.assign,defineProperty$4=Object.defineProperty,concat$1=uncurryThis$8([].concat),objectAssign=!$assign||fails$8(function(){if(DESCRIPTORS$4&&1!==$assign({b:1},$assign(defineProperty$4({},"a",{enumerable:!0,get:function(){defineProperty$4(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!=$assign({},e)[r]||objectKeys$1($assign({},t)).join("")!=n})?function(e,t){for(var r=toObject$1(e),n=arguments.length,i=1,o=getOwnPropertySymbolsModule$1.f,s=propertyIsEnumerableModule.f;n>i;)for(var a,l=IndexedObject(arguments[i++]),c=o?concat$1(objectKeys$1(l),o(l)):objectKeys$1(l),u=c.length,d=0;u>d;)a=c[d++],DESCRIPTORS$4&&!call$k(s,l,a)||(r[a]=l[a]);return r}:$assign,$$J=_export,assign$3=objectAssign;$$J({target:"Object",stat:!0,arity:2,forced:Object.assign!==assign$3},{assign:assign$3});var path$9=path$l,assign$2=path$9.Object.assign,parent$s=assign$2,assign$1=parent$s,assign=assign$1;function queryStringify(e){for(var t=[],r=0,n=keys(e);r<n.length;r++){var i,o=n[r];e[o]&&t.push(concat$3(i="".concat(o,"=")).call(i,e[o]))}return t.join("&")}function getFrontierURL(e){var t,r=e.frontier,n=e.aid,i=r,o=i.appKey,s=i.url,a=(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__rest)(i,["appKey","url"]),l=assign(assign({},a),{aid:n,device_id:e.did,access_key:js_md5__WEBPACK_IMPORTED_MODULE_0___default()("".concat(r.fpid+o+e.did,"f8a69f1719916z")),device_platform:e.devicePlatform});return concat$3(t="".concat(s,"?")).call(t,queryStringify(l))}function uint8array2string(e){return TextDecoder?(new TextDecoder).decode(e):String.fromCharCode.apply(null,e)}var SyncSocket=function(e){_inherits(r,EventEmitter);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).option=e,n}return _createClass(r,[{key:"frontierURL",get:function(){return getFrontierURL(this.option)}},{key:"open",value:function(){throw new Error("Method not implemented.")}},{key:"send",value:function(e){throw new Error("Method not implemented.")}},{key:"close",value:function(){throw new Error("Method not implemented.")}},{key:"isOpen",value:function(){throw new Error("Method not implemented.")}},{key:"dispose",value:function(){this.clearAll()}}]),r}(),context={option:{},network:{},db:{},monitor:{},initResult:InitResult.NotAvailable,logger:{},compensator:{},businessManager:{}},defaultOption={aid:0,did:"",uid:"",apiUrl:"",commonParams:{},frontier:{url:"",fpid:89,appKey:"e0f82475ab9dbf5717d18b4a9c0d7fd0",service:2,method:2},devicePlatform:"web",oversea:!1};function optionCheck(e){"string"!=typeof e.did&&context.logger.error("opt.deviceId is not a string! did you pass a number?"),"string"!=typeof e.uid&&context.logger.error("opt.userId is not a string! did you pass a number?"),"string"==typeof e.apiUrl&&0!==e.apiUrl.length||context.logger.error("opt.apiUrl invalid")}function applyDefault(e){return assign(assign({},defaultOption),e)}function applyDefaultBoe(e){return applyDefault(assign({debug:!0},e))}var classof$3=classof$a,getMethod$1=getMethod$3,Iterators$1=iterators,wellKnownSymbol$9=wellKnownSymbol$n,ITERATOR$2=wellKnownSymbol$9("iterator"),getIteratorMethod$9=function(e){if(null!=e)return getMethod$1(e,ITERATOR$2)||getMethod$1(e,"@@iterator")||Iterators$1[classof$3(e)]},getIteratorMethod$8=getIteratorMethod$9,getIteratorMethod_1=getIteratorMethod$8,parent$r=getIteratorMethod_1,getIteratorMethod$7=parent$r,parent$q=getIteratorMethod$7,getIteratorMethod$6=parent$q,parent$p=getIteratorMethod$6,getIteratorMethod$5=parent$p,getIteratorMethod$4=getIteratorMethod$5,getIteratorMethod$3=getIteratorMethod$4,$$I=_export,isArray$8=isArray$d;$$I({target:"Array",stat:!0},{isArray:isArray$8});var path$8=path$l,isArray$7=path$8.Array.isArray,parent$o=isArray$7,isArray$6=parent$o,parent$n=isArray$6,isArray$5=parent$n,parent$m=isArray$5,isArray$4=parent$m,isArray$3=isArray$4,isArray$2=isArray$3,$$H=_export,isArray$1=isArray$d,isConstructor$1=isConstructor$4,isObject$7=isObject$i,toAbsoluteIndex=toAbsoluteIndex$3,lengthOfArrayLike$2=lengthOfArrayLike$7,toIndexedObject$1=toIndexedObject$9,createProperty$1=createProperty$4,wellKnownSymbol$8=wellKnownSymbol$n,arrayMethodHasSpeciesSupport=arrayMethodHasSpeciesSupport$4,un$Slice=arraySlice$5,HAS_SPECIES_SUPPORT=arrayMethodHasSpeciesSupport("slice"),SPECIES$3=wellKnownSymbol$8("species"),$Array$1=Array,max=Math.max;$$H({target:"Array",proto:!0,forced:!HAS_SPECIES_SUPPORT},{slice:function(e,t){var r,n,i,o=toIndexedObject$1(this),s=lengthOfArrayLike$2(o),a=toAbsoluteIndex(e,s),l=toAbsoluteIndex(void 0===t?s:t,s);if(isArray$1(o)&&(r=o.constructor,(isConstructor$1(r)&&(r===$Array$1||isArray$1(r.prototype))||isObject$7(r)&&null===(r=r[SPECIES$3]))&&(r=void 0),r===$Array$1||void 0===r))return un$Slice(o,a,l);for(n=new(void 0===r?$Array$1:r)(max(l-a,0)),i=0;a<l;a++,i++)a in o&&createProperty$1(n,i,o[a]);return n.length=i,n}});var entryVirtual$5=entryVirtual$b,slice$7=entryVirtual$5("Array").slice,isPrototypeOf$7=objectIsPrototypeOf,method$3=slice$7,ArrayPrototype$4=Array.prototype,slice$6=function(e){var t=e.slice;return e===ArrayPrototype$4||isPrototypeOf$7(ArrayPrototype$4,e)&&t===ArrayPrototype$4.slice?method$3:t},parent$l=slice$6,slice$5=parent$l,parent$k=slice$5,slice$4=parent$k,parent$j=slice$4,slice$3=parent$j,slice$2=slice$3,slice$1=slice$2,call$j=functionCall,anObject$l=anObject$s,getMethod=getMethod$3,iteratorClose$2=function(e,t,r){var n,i;anObject$l(e);try{if(!(n=getMethod(e,"return"))){if("throw"===t)throw r;return r}n=call$j(n,e)}catch(e){i=!0,n=e}if("throw"===t)throw r;if(i)throw n;return anObject$l(n),r},anObject$k=anObject$s,iteratorClose$1=iteratorClose$2,callWithSafeIterationClosing$1=function(e,t,r,n){try{return n?t(anObject$k(r)[0],r[1]):t(r)}catch(t){iteratorClose$1(e,"throw",t)}},wellKnownSymbol$7=wellKnownSymbol$n,Iterators=iterators,ITERATOR$1=wellKnownSymbol$7("iterator"),ArrayPrototype$3=Array.prototype,isArrayIteratorMethod$2=function(e){return void 0!==e&&(Iterators.Array===e||ArrayPrototype$3[ITERATOR$1]===e)},call$i=functionCall,aCallable$i=aCallable$m,anObject$j=anObject$s,tryToString$1=tryToString$5,getIteratorMethod$2=getIteratorMethod$9,$TypeError$7=TypeError,getIterator$4=function(e,t){var r=arguments.length<2?getIteratorMethod$2(e):t;if(aCallable$i(r))return anObject$j(call$i(r,e));throw $TypeError$7(tryToString$1(e)+" is not iterable")},bind$m=functionBindContext,call$h=functionCall,toObject=toObject$9,callWithSafeIterationClosing=callWithSafeIterationClosing$1,isArrayIteratorMethod$1=isArrayIteratorMethod$2,isConstructor=isConstructor$4,lengthOfArrayLike$1=lengthOfArrayLike$7,createProperty=createProperty$4,getIterator$3=getIterator$4,getIteratorMethod$1=getIteratorMethod$9,$Array=Array,arrayFrom=function(e){var t=toObject(e),r=isConstructor(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=bind$m(i,n>2?arguments[2]:void 0));var s,a,l,c,u,d,h=getIteratorMethod$1(t),p=0;if(!h||this===$Array&&isArrayIteratorMethod$1(h))for(s=lengthOfArrayLike$1(t),a=r?new this(s):$Array(s);s>p;p++)d=o?i(t[p],p):t[p],createProperty(a,p,d);else for(u=(c=getIterator$3(t,h)).next,a=r?new this:[];!(l=call$h(u,c)).done;p++)d=o?callWithSafeIterationClosing(c,i,[l.value,p],!0):l.value,createProperty(a,p,d);return a.length=p,a},wellKnownSymbol$6=wellKnownSymbol$n,ITERATOR=wellKnownSymbol$6("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR]=function(){return this},Array.from(iteratorWithReturn,function(){throw 2})}catch(e){}var checkCorrectnessOfIteration$2=function(e,t){if(!t&&!SAFE_CLOSING)return!1;var r=!1;try{var n={};n[ITERATOR]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},$$G=_export,from$7=arrayFrom,checkCorrectnessOfIteration$1=checkCorrectnessOfIteration$2,INCORRECT_ITERATION=!checkCorrectnessOfIteration$1(function(e){Array.from(e)});$$G({target:"Array",stat:!0,forced:INCORRECT_ITERATION},{from:from$7});var path$7=path$l,from$6=path$7.Array.from,parent$i=from$6,from$5=parent$i,parent$h=from$5,from$4=parent$h,parent$g=from$4,from$3=parent$g,from$2=from$3,from$1=from$2;function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _unsupportedIterableToArray(e,t){var r;if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=slice$1(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?from$1(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _createForOfIteratorHelper(e,t){var r=void 0!==symbol$1&&getIteratorMethod$3(e)||e["@@iterator"];if(!r){if(isArray$2(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}var isArray=isArray$6,defineProperty$3=defineProperty$9,symbol=symbol$5,getPrototypeOf$1=getPrototypeOf$6,setPrototypeOf$1=setPrototypeOf$6,getBuiltIn$7=getBuiltIn$h,uncurryThis$7=functionUncurryThis,getOwnPropertyNamesModule$1=objectGetOwnPropertyNames,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,anObject$i=anObject$s,concat=uncurryThis$7([].concat),ownKeys$1=getBuiltIn$7("Reflect","ownKeys")||function(e){var t=getOwnPropertyNamesModule$1.f(anObject$i(e)),r=getOwnPropertySymbolsModule.f;return r?concat(t,r(e)):t},hasOwn$2=hasOwnProperty_1,ownKeys=ownKeys$1,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,definePropertyModule$1=objectDefineProperty,copyConstructorProperties$1=function(e,t,r){for(var n=ownKeys(t),i=definePropertyModule$1.f,o=getOwnPropertyDescriptorModule.f,s=0;s<n.length;s++){var a=n[s];hasOwn$2(e,a)||r&&hasOwn$2(r,a)||i(e,a,o(t,a))}},uncurryThis$6=functionUncurryThis,$Error$1=Error,replace=uncurryThis$6("".replace),TEST=String($Error$1("zxcasd").stack),V8_OR_CHAKRA_STACK_ENTRY=/\n\s*at [^:]*:[^\n]*/,IS_V8_OR_CHAKRA_STACK=V8_OR_CHAKRA_STACK_ENTRY.test(TEST),clearErrorStack$1=function(e,t){if(IS_V8_OR_CHAKRA_STACK&&"string"==typeof e&&!$Error$1.prepareStackTrace)for(;t--;)e=replace(e,V8_OR_CHAKRA_STACK_ENTRY,"");return e},isObject$6=isObject$i,createNonEnumerableProperty$2=createNonEnumerableProperty$8,installErrorCause$1=function(e,t){isObject$6(t)&&"cause"in t&&createNonEnumerableProperty$2(e,"cause",t.cause)},bind$l=functionBindContext,call$g=functionCall,anObject$h=anObject$s,tryToString=tryToString$5,isArrayIteratorMethod=isArrayIteratorMethod$2,lengthOfArrayLike=lengthOfArrayLike$7,isPrototypeOf$6=objectIsPrototypeOf,getIterator$2=getIterator$4,getIteratorMethod=getIteratorMethod$9,iteratorClose=iteratorClose$2,$TypeError$6=TypeError,Result=function(e,t){this.stopped=e,this.result=t},ResultPrototype=Result.prototype,iterate$l=function(e,t,r){var n,i,o,s,a,l,c,u=r&&r.that,d=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),f=!(!r||!r.INTERRUPTED),_=bind$l(t,u),y=function(e){return n&&iteratorClose(n,"normal",e),new Result(!0,e)},g=function(e){return d?(anObject$h(e),f?_(e[0],e[1],y):_(e[0],e[1])):f?_(e,y):_(e)};if(h)n=e.iterator;else if(p)n=e;else{if(!(i=getIteratorMethod(e)))throw $TypeError$6(tryToString(e)+" is not iterable");if(isArrayIteratorMethod(i)){for(o=0,s=lengthOfArrayLike(e);s>o;o++)if((a=g(e[o]))&&isPrototypeOf$6(ResultPrototype,a))return a;return new Result(!1)}n=getIterator$2(e,i)}for(l=h?e.next:n.next;!(c=call$g(l,n)).done;){try{a=g(c.value)}catch(e){iteratorClose(n,"throw",e)}if("object"==typeof a&&a&&isPrototypeOf$6(ResultPrototype,a))return a}return new Result(!1)},toString$1=toString$6,normalizeStringArgument$1=function(e,t){return void 0===e?arguments.length<2?"":t:toString$1(e)},fails$7=fails$s,createPropertyDescriptor$1=createPropertyDescriptor$7,errorStackInstallable=!fails$7(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",createPropertyDescriptor$1(1,7)),7!==e.stack)}),$$F=_export,isPrototypeOf$5=objectIsPrototypeOf,getPrototypeOf=objectGetPrototypeOf,setPrototypeOf=objectSetPrototypeOf,copyConstructorProperties=copyConstructorProperties$1,create$1=objectCreate,createNonEnumerableProperty$1=createNonEnumerableProperty$8,createPropertyDescriptor=createPropertyDescriptor$7,clearErrorStack=clearErrorStack$1,installErrorCause=installErrorCause$1,iterate$k=iterate$l,normalizeStringArgument=normalizeStringArgument$1,wellKnownSymbol$5=wellKnownSymbol$n,ERROR_STACK_INSTALLABLE=errorStackInstallable,TO_STRING_TAG=wellKnownSymbol$5("toStringTag"),$Error=Error,push$3=[].push,$AggregateError=function(e,t){var r,n=arguments.length>2?arguments[2]:void 0,i=isPrototypeOf$5(AggregateErrorPrototype,this);setPrototypeOf?r=setPrototypeOf(new $Error,i?getPrototypeOf(this):AggregateErrorPrototype):(r=i?this:create$1(AggregateErrorPrototype),createNonEnumerableProperty$1(r,TO_STRING_TAG,"Error")),void 0!==t&&createNonEnumerableProperty$1(r,"message",normalizeStringArgument(t)),ERROR_STACK_INSTALLABLE&&createNonEnumerableProperty$1(r,"stack",clearErrorStack(r.stack,1)),installErrorCause(r,n);var o=[];return iterate$k(e,push$3,{that:o}),createNonEnumerableProperty$1(r,"errors",o),r};setPrototypeOf?setPrototypeOf($AggregateError,$Error):copyConstructorProperties($AggregateError,$Error,{name:!0});var AggregateErrorPrototype=$AggregateError.prototype=create$1($Error.prototype,{constructor:createPropertyDescriptor(1,$AggregateError),message:createPropertyDescriptor(1,""),name:createPropertyDescriptor(1,"AggregateError")});$$F({global:!0,constructor:!0,arity:2},{AggregateError:$AggregateError});var classof$2=classofRaw$1,global$c=global$p,engineIsNode="process"==classof$2(global$c.process),getBuiltIn$6=getBuiltIn$h,definePropertyModule=objectDefineProperty,wellKnownSymbol$4=wellKnownSymbol$n,DESCRIPTORS$3=descriptors,SPECIES$2=wellKnownSymbol$4("species"),setSpecies$2=function(e){var t=getBuiltIn$6(e),r=definePropertyModule.f;DESCRIPTORS$3&&t&&!t[SPECIES$2]&&r(t,SPECIES$2,{configurable:!0,get:function(){return this}})},isPrototypeOf$4=objectIsPrototypeOf,$TypeError$5=TypeError,anInstance$3=function(e,t){if(isPrototypeOf$4(t,e))return e;throw $TypeError$5("Incorrect invocation")},anObject$g=anObject$s,aConstructor$1=aConstructor$3,wellKnownSymbol$3=wellKnownSymbol$n,SPECIES$1=wellKnownSymbol$3("species"),speciesConstructor$5=function(e,t){var r,n=anObject$g(e).constructor;return void 0===n||null==(r=anObject$g(n)[SPECIES$1])?t:aConstructor$1(r)},$TypeError$4=TypeError,validateArgumentsLength$2=function(e,t){if(e<t)throw $TypeError$4("Not enough arguments");return e},userAgent$3=engineUserAgent,engineIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(userAgent$3),global$b=global$p,apply$2=functionApply,bind$k=functionBindContext,isCallable$6=isCallable$m,hasOwn$1=hasOwnProperty_1,fails$6=fails$s,html=html$2,arraySlice$2=arraySlice$5,createElement=documentCreateElement$1,validateArgumentsLength$1=validateArgumentsLength$2,IS_IOS$1=engineIsIos,IS_NODE$2=engineIsNode,set=global$b.setImmediate,clear=global$b.clearImmediate,process$2=global$b.process,Dispatch=global$b.Dispatch,Function$2=global$b.Function,MessageChannel=global$b.MessageChannel,String$1=global$b.String,counter=0,queue$1={},ONREADYSTATECHANGE="onreadystatechange",location$1,defer,channel,port;try{location$1=global$b.location}catch(e){}var run=function(e){if(hasOwn$1(queue$1,e)){var t=queue$1[e];delete queue$1[e],t()}},runner=function(e){return function(){run(e)}},listener=function(e){run(e.data)},post=function(e){global$b.postMessage(String$1(e),location$1.protocol+"//"+location$1.host)};set&&clear||(set=function(e){validateArgumentsLength$1(arguments.length,1);var t=isCallable$6(e)?e:Function$2(e),r=arraySlice$2(arguments,1);return queue$1[++counter]=function(){apply$2(t,void 0,r)},defer(counter),counter},clear=function(e){delete queue$1[e]},IS_NODE$2?defer=function(e){process$2.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel&&!IS_IOS$1?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=bind$k(port.postMessage,port)):global$b.addEventListener&&isCallable$6(global$b.postMessage)&&!global$b.importScripts&&location$1&&"file:"!==location$1.protocol&&!fails$6(post)?(defer=post,global$b.addEventListener("message",listener,!1)):defer=ONREADYSTATECHANGE in createElement("script")?function(e){html.appendChild(createElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(e)}}:function(e){setTimeout(runner(e),0)});var task$1={set,clear},userAgent$2=engineUserAgent,global$a=global$p,engineIsIosPebble=/ipad|iphone|ipod/i.test(userAgent$2)&&void 0!==global$a.Pebble,userAgent$1=engineUserAgent,engineIsWebosWebkit=/web0s(?!.*chrome)/i.test(userAgent$1),global$9=global$p,bind$j=functionBindContext,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,macrotask=task$1.set,IS_IOS=engineIsIos,IS_IOS_PEBBLE=engineIsIosPebble,IS_WEBOS_WEBKIT=engineIsWebosWebkit,IS_NODE$1=engineIsNode,MutationObserver=global$9.MutationObserver||global$9.WebKitMutationObserver,document$2=global$9.document,process$1=global$9.process,Promise$1=global$9.Promise,queueMicrotaskDescriptor=getOwnPropertyDescriptor(global$9,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify$1,toggle,node,promise$3,then;queueMicrotask||(flush=function(){var e,t;for(IS_NODE$1&&(e=process$1.domain)&&e.exit();head;){t=head.fn,head=head.next;try{t()}catch(e){throw head?notify$1():last=void 0,e}}last=void 0,e&&e.enter()},IS_IOS||IS_NODE$1||IS_WEBOS_WEBKIT||!MutationObserver||!document$2?!IS_IOS_PEBBLE&&Promise$1&&Promise$1.resolve?(promise$3=Promise$1.resolve(void 0),promise$3.constructor=Promise$1,then=bind$j(promise$3.then,promise$3),notify$1=function(){then(flush)}):IS_NODE$1?notify$1=function(){process$1.nextTick(flush)}:(macrotask=bind$j(macrotask,global$9),notify$1=function(){macrotask(flush)}):(toggle=!0,node=document$2.createTextNode(""),new MutationObserver(flush).observe(node,{characterData:!0}),notify$1=function(){node.data=toggle=!toggle}));var microtask$1=queueMicrotask||function(e){var t={fn:e,next:void 0};last&&(last.next=t),head||(head=t,notify$1()),last=t},global$8=global$p,hostReportErrors$1=function(e,t){var r=global$8.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},perform$5=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Queue$1=function(){this.head=null,this.tail=null};Queue$1.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var queue=Queue$1,global$7=global$p,promiseNativeConstructor=global$7.Promise,engineIsBrowser="object"==typeof window&&"object"!=typeof Deno,engineIsDeno="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,global$6=global$p,NativePromiseConstructor$5=promiseNativeConstructor,isCallable$5=isCallable$m,isForced=isForced_1,inspectSource=inspectSource$3,wellKnownSymbol$2=wellKnownSymbol$n,IS_BROWSER=engineIsBrowser,IS_DENO=engineIsDeno,V8_VERSION=engineV8Version,NativePromisePrototype$2=NativePromiseConstructor$5&&NativePromiseConstructor$5.prototype,SPECIES=wellKnownSymbol$2("species"),SUBCLASSING=!1,NATIVE_PROMISE_REJECTION_EVENT$1=isCallable$5(global$6.PromiseRejectionEvent),FORCED_PROMISE_CONSTRUCTOR$5=isForced("Promise",function(){var e=inspectSource(NativePromiseConstructor$5),t=e!==String(NativePromiseConstructor$5);if(!t&&66===V8_VERSION)return!0;if(!NativePromisePrototype$2.catch||!NativePromisePrototype$2.finally)return!0;if(V8_VERSION<51||!/native code/.test(e)){var r=new NativePromiseConstructor$5(function(e){e(1)}),n=function(e){e(function(){},function(){})};if((r.constructor={})[SPECIES]=n,!(SUBCLASSING=r.then(function(){})instanceof n))return!0}return!t&&(IS_BROWSER||IS_DENO)&&!NATIVE_PROMISE_REJECTION_EVENT$1}),promiseConstructorDetection={CONSTRUCTOR:FORCED_PROMISE_CONSTRUCTOR$5,REJECTION_EVENT:NATIVE_PROMISE_REJECTION_EVENT$1,SUBCLASSING},newPromiseCapability$2={},aCallable$h=aCallable$m,PromiseCapability=function(e){var t,r;this.promise=new e(function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n}),this.resolve=aCallable$h(t),this.reject=aCallable$h(r)};newPromiseCapability$2.f=function(e){return new PromiseCapability(e)};var $$E=_export,IS_NODE=engineIsNode,global$5=global$p,call$f=functionCall,defineBuiltIn$1=defineBuiltIn$6,setToStringTag$1=setToStringTag$7,setSpecies$1=setSpecies$2,aCallable$g=aCallable$m,isCallable$4=isCallable$m,isObject$5=isObject$i,anInstance$2=anInstance$3,speciesConstructor$4=speciesConstructor$5,task=task$1.set,microtask=microtask$1,hostReportErrors=hostReportErrors$1,perform$4=perform$5,Queue=queue,InternalStateModule$2=internalState,NativePromiseConstructor$4=promiseNativeConstructor,PromiseConstructorDetection=promiseConstructorDetection,newPromiseCapabilityModule$5=newPromiseCapability$2,PROMISE="Promise",FORCED_PROMISE_CONSTRUCTOR$4=PromiseConstructorDetection.CONSTRUCTOR,NATIVE_PROMISE_REJECTION_EVENT=PromiseConstructorDetection.REJECTION_EVENT,getInternalPromiseState=InternalStateModule$2.getterFor(PROMISE),setInternalState$2=InternalStateModule$2.set,NativePromisePrototype$1=NativePromiseConstructor$4&&NativePromiseConstructor$4.prototype,PromiseConstructor=NativePromiseConstructor$4,PromisePrototype=NativePromisePrototype$1,TypeError$1=global$5.TypeError,document$1=global$5.document,process=global$5.process,newPromiseCapability$1=newPromiseCapabilityModule$5.f,newGenericPromiseCapability=newPromiseCapability$1,DISPATCH_EVENT=!!(document$1&&document$1.createEvent&&global$5.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,isThenable=function(e){var t;return!(!isObject$5(e)||!isCallable$4(t=e.then))&&t},callReaction=function(e,t){var r,n,i,o=t.value,s=t.state==FULFILLED,a=s?e.ok:e.fail,l=e.resolve,c=e.reject,u=e.domain;try{a?(s||(t.rejection===UNHANDLED&&onHandleUnhandled(t),t.rejection=HANDLED),!0===a?r=o:(u&&u.enter(),r=a(o),u&&(u.exit(),i=!0)),r===e.promise?c(TypeError$1("Promise-chain cycle")):(n=isThenable(r))?call$f(n,r,l,c):l(r)):c(o)}catch(e){u&&!i&&u.exit(),c(e)}},notify=function(e,t){e.notified||(e.notified=!0,microtask(function(){for(var r,n=e.reactions;r=n.get();)callReaction(r,e);e.notified=!1,t&&!e.rejection&&onUnhandled(e)}))},dispatchEvent=function(e,t,r){var n,i;DISPATCH_EVENT?((n=document$1.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),global$5.dispatchEvent(n)):n={promise:t,reason:r},!NATIVE_PROMISE_REJECTION_EVENT&&(i=global$5["on"+e])?i(n):e===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",r)},onUnhandled=function(e){call$f(task,global$5,function(){var t,r=e.facade,n=e.value;if(isUnhandled(e)&&(t=perform$4(function(){IS_NODE?process.emit("unhandledRejection",n,r):dispatchEvent(UNHANDLED_REJECTION,r,n)}),e.rejection=IS_NODE||isUnhandled(e)?UNHANDLED:HANDLED,t.error))throw t.value})},isUnhandled=function(e){return e.rejection!==HANDLED&&!e.parent},onHandleUnhandled=function(e){call$f(task,global$5,function(){var t=e.facade;IS_NODE?process.emit("rejectionHandled",t):dispatchEvent(REJECTION_HANDLED,t,e.value)})},bind$i=function(e,t,r){return function(n){e(t,n,r)}},internalReject=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=REJECTED,notify(e,!0))},internalResolve=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw TypeError$1("Promise can't be resolved itself");var n=isThenable(t);n?microtask(function(){var r={done:!1};try{call$f(n,t,bind$i(internalResolve,r,e),bind$i(internalReject,r,e))}catch(t){internalReject(r,t,e)}}):(e.value=t,e.state=FULFILLED,notify(e,!1))}catch(t){internalReject({done:!1},t,e)}}};FORCED_PROMISE_CONSTRUCTOR$4&&(PromiseConstructor=function(e){anInstance$2(this,PromisePrototype),aCallable$g(e),call$f(Internal,this);var t=getInternalPromiseState(this);try{e(bind$i(internalResolve,t),bind$i(internalReject,t))}catch(e){internalReject(t,e)}},PromisePrototype=PromiseConstructor.prototype,Internal=function(e){setInternalState$2(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:new Queue,rejection:!1,state:PENDING,value:void 0})},Internal.prototype=defineBuiltIn$1(PromisePrototype,"then",function(e,t){var r=getInternalPromiseState(this),n=newPromiseCapability$1(speciesConstructor$4(this,PromiseConstructor));return r.parent=!0,n.ok=!isCallable$4(e)||e,n.fail=isCallable$4(t)&&t,n.domain=IS_NODE?process.domain:void 0,r.state==PENDING?r.reactions.add(n):microtask(function(){callReaction(n,r)}),n.promise}),OwnPromiseCapability=function(){var e=new Internal,t=getInternalPromiseState(e);this.promise=e,this.resolve=bind$i(internalResolve,t),this.reject=bind$i(internalReject,t)},newPromiseCapabilityModule$5.f=newPromiseCapability$1=function(e){return e===PromiseConstructor||e===PromiseWrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)}),$$E({global:!0,constructor:!0,wrap:!0,forced:FORCED_PROMISE_CONSTRUCTOR$4},{Promise:PromiseConstructor}),setToStringTag$1(PromiseConstructor,PROMISE,!1,!0),setSpecies$1(PROMISE);var NativePromiseConstructor$3=promiseNativeConstructor,checkCorrectnessOfIteration=checkCorrectnessOfIteration$2,FORCED_PROMISE_CONSTRUCTOR$3=promiseConstructorDetection.CONSTRUCTOR,promiseStaticsIncorrectIteration=FORCED_PROMISE_CONSTRUCTOR$3||!checkCorrectnessOfIteration(function(e){NativePromiseConstructor$3.all(e).then(void 0,function(){})}),$$D=_export,call$e=functionCall,aCallable$f=aCallable$m,newPromiseCapabilityModule$4=newPromiseCapability$2,perform$3=perform$5,iterate$j=iterate$l,PROMISE_STATICS_INCORRECT_ITERATION$1=promiseStaticsIncorrectIteration;$$D({target:"Promise",stat:!0,forced:PROMISE_STATICS_INCORRECT_ITERATION$1},{all:function(e){var t=this,r=newPromiseCapabilityModule$4.f(t),n=r.resolve,i=r.reject,o=perform$3(function(){var r=aCallable$f(t.resolve),o=[],s=0,a=1;iterate$j(e,function(e){var l=s++,c=!1;a++,call$e(r,t,e).then(function(e){c||(c=!0,o[l]=e,--a||n(o))},i)}),--a||n(o)});return o.error&&i(o.value),r.promise}});var $$C=_export,FORCED_PROMISE_CONSTRUCTOR$2=promiseConstructorDetection.CONSTRUCTOR,NativePromiseConstructor$2=promiseNativeConstructor;NativePromiseConstructor$2&&NativePromiseConstructor$2.prototype,$$C({target:"Promise",proto:!0,forced:FORCED_PROMISE_CONSTRUCTOR$2,real:!0},{catch:function(e){return this.then(void 0,e)}});var $$B=_export,call$d=functionCall,aCallable$e=aCallable$m,newPromiseCapabilityModule$3=newPromiseCapability$2,perform$2=perform$5,iterate$i=iterate$l,PROMISE_STATICS_INCORRECT_ITERATION=promiseStaticsIncorrectIteration;$$B({target:"Promise",stat:!0,forced:PROMISE_STATICS_INCORRECT_ITERATION},{race:function(e){var t=this,r=newPromiseCapabilityModule$3.f(t),n=r.reject,i=perform$2(function(){var i=aCallable$e(t.resolve);iterate$i(e,function(e){call$d(i,t,e).then(r.resolve,n)})});return i.error&&n(i.value),r.promise}});var $$A=_export,call$c=functionCall,newPromiseCapabilityModule$2=newPromiseCapability$2,FORCED_PROMISE_CONSTRUCTOR$1=promiseConstructorDetection.CONSTRUCTOR;$$A({target:"Promise",stat:!0,forced:FORCED_PROMISE_CONSTRUCTOR$1},{reject:function(e){var t=newPromiseCapabilityModule$2.f(this);return call$c(t.reject,void 0,e),t.promise}});var anObject$f=anObject$s,isObject$4=isObject$i,newPromiseCapability=newPromiseCapability$2,promiseResolve$2=function(e,t){if(anObject$f(e),isObject$4(t)&&t.constructor===e)return t;var r=newPromiseCapability.f(e);return(0,r.resolve)(t),r.promise},$$z=_export,getBuiltIn$5=getBuiltIn$h,IS_PURE=isPure,NativePromiseConstructor$1=promiseNativeConstructor,FORCED_PROMISE_CONSTRUCTOR=promiseConstructorDetection.CONSTRUCTOR,promiseResolve$1=promiseResolve$2,PromiseConstructorWrapper=getBuiltIn$5("Promise"),CHECK_WRAPPER=!FORCED_PROMISE_CONSTRUCTOR;$$z({target:"Promise",stat:!0,forced:IS_PURE},{resolve:function(e){return promiseResolve$1(CHECK_WRAPPER&&this===PromiseConstructorWrapper?NativePromiseConstructor$1:this,e)}});var $$y=_export,call$b=functionCall,aCallable$d=aCallable$m,newPromiseCapabilityModule$1=newPromiseCapability$2,perform$1=perform$5,iterate$h=iterate$l;$$y({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=newPromiseCapabilityModule$1.f(t),n=r.resolve,i=r.reject,o=perform$1(function(){var r=aCallable$d(t.resolve),i=[],o=0,s=1;iterate$h(e,function(e){var a=o++,l=!1;s++,call$b(r,t,e).then(function(e){l||(l=!0,i[a]={status:"fulfilled",value:e},--s||n(i))},function(e){l||(l=!0,i[a]={status:"rejected",reason:e},--s||n(i))})}),--s||n(i)});return o.error&&i(o.value),r.promise}});var $$x=_export,call$a=functionCall,aCallable$c=aCallable$m,getBuiltIn$4=getBuiltIn$h,newPromiseCapabilityModule=newPromiseCapability$2,perform=perform$5,iterate$g=iterate$l,PROMISE_ANY_ERROR="No one promise resolved";$$x({target:"Promise",stat:!0},{any:function(e){var t=this,r=getBuiltIn$4("AggregateError"),n=newPromiseCapabilityModule.f(t),i=n.resolve,o=n.reject,s=perform(function(){var n=aCallable$c(t.resolve),s=[],a=0,l=1,c=!1;iterate$g(e,function(e){var u=a++,d=!1;l++,call$a(n,t,e).then(function(e){d||c||(c=!0,i(e))},function(e){d||c||(d=!0,s[u]=e,--l||o(new r(s,PROMISE_ANY_ERROR)))})}),--l||o(new r(s,PROMISE_ANY_ERROR))});return s.error&&o(s.value),n.promise}});var $$w=_export,NativePromiseConstructor=promiseNativeConstructor,fails$5=fails$s,getBuiltIn$3=getBuiltIn$h,isCallable$3=isCallable$m,speciesConstructor$3=speciesConstructor$5,promiseResolve=promiseResolve$2,NativePromisePrototype=NativePromiseConstructor&&NativePromiseConstructor.prototype,NON_GENERIC=!!NativePromiseConstructor&&fails$5(function(){NativePromisePrototype.finally.call({then:function(){}},function(){})});$$w({target:"Promise",proto:!0,real:!0,forced:NON_GENERIC},{finally:function(e){var t=speciesConstructor$3(this,getBuiltIn$3("Promise")),r=isCallable$3(e);return this.then(r?function(r){return promiseResolve(t,e()).then(function(){return r})}:e,r?function(r){return promiseResolve(t,e()).then(function(){throw r})}:e)}});var path$6=path$l,promise$2=path$6.Promise,parent$f=promise$2,promise$1=parent$f,promise=promise$1,slice=slice$5,Flag$3=sync_proto.Flag;function flagToString(e){switch(e){case Flag$3.ACK:return"ack";case Flag$3.Data:return"data";case Flag$3.Sync:return"sync";case Flag$3.Poll:return"poll";case Flag$3.FIN:return"fin";default:return"none"}}function getMsgFlag(e){var t,r;return(null===(r=null===(t=null==e?void 0:e.topics)||void 0===t?void 0:t[0])||void 0===r?void 0:r.flag)||Flag$3.None}function getMsgStringFlag(e){return flagToString(getMsgFlag(e))}var BusinessManager=function(e){_inherits(r,EventEmitter);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getUniqKey",value:function(e){return"sync_biz_".concat(e)}},{key:"registerBusiness",value:function(e,t){this.on(this.getUniqKey(e),t)}},{key:"remove",value:function(e){this.off(this.getUniqKey(e))}}]),r}(),$$v=_export,bind$h=functionBind;$$v({target:"Function",proto:!0,forced:Function.bind!==bind$h},{bind:bind$h});var entryVirtual$4=entryVirtual$b,bind$g=entryVirtual$4("Function").bind,isPrototypeOf$3=objectIsPrototypeOf,method$2=bind$g,FunctionPrototype=Function.prototype,bind$f=function(e){var t=e.bind;return e===FunctionPrototype||isPrototypeOf$3(FunctionPrototype,e)&&t===FunctionPrototype.bind?method$2:t},parent$e=bind$f,bind$e=parent$e,bind$d=bind$e;function _arrayWithoutHoles(e){if(isArray$2(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if(void 0!==symbol$1&&null!=getIteratorMethod$3(e)||null!=e["@@iterator"])return from$1(e)}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}var internalMetadata={exports:{}},fails$4=fails$s,arrayBufferNonExtensible=fails$4(function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),fails$3=fails$s,isObject$3=isObject$i,classof$1=classofRaw$1,ARRAY_BUFFER_NON_EXTENSIBLE=arrayBufferNonExtensible,$isExtensible=Object.isExtensible,FAILS_ON_PRIMITIVES=fails$3(function(){$isExtensible(1)}),objectIsExtensible=FAILS_ON_PRIMITIVES||ARRAY_BUFFER_NON_EXTENSIBLE?function(e){return!!isObject$3(e)&&(!ARRAY_BUFFER_NON_EXTENSIBLE||"ArrayBuffer"!=classof$1(e))&&(!$isExtensible||$isExtensible(e))}:$isExtensible,fails$2=fails$s,freezing=!fails$2(function(){return Object.isExtensible(Object.preventExtensions({}))}),$$u=_export,uncurryThis$5=functionUncurryThis,hiddenKeys=hiddenKeys$6,isObject$2=isObject$i,hasOwn=hasOwnProperty_1,defineProperty$2=objectDefineProperty.f,getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertyNamesExternalModule=objectGetOwnPropertyNamesExternal,isExtensible=objectIsExtensible,uid=uid$4,FREEZING=freezing,REQUIRED=!1,METADATA=uid("meta"),id=0,setMetadata=function(e){defineProperty$2(e,METADATA,{value:{objectID:"O"+id++,weakData:{}}})},fastKey$1=function(e,t){if(!isObject$2(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!hasOwn(e,METADATA)){if(!isExtensible(e))return"F";if(!t)return"E";setMetadata(e)}return e[METADATA].objectID},getWeakData=function(e,t){if(!hasOwn(e,METADATA)){if(!isExtensible(e))return!0;if(!t)return!1;setMetadata(e)}return e[METADATA].weakData},onFreeze=function(e){return FREEZING&&REQUIRED&&isExtensible(e)&&!hasOwn(e,METADATA)&&setMetadata(e),e},enable=function(){meta.enable=function(){},REQUIRED=!0;var e=getOwnPropertyNamesModule.f,t=uncurryThis$5([].splice),r={};r[METADATA]=1,e(r).length&&(getOwnPropertyNamesModule.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===METADATA){t(n,i,1);break}return n},$$u({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:getOwnPropertyNamesExternalModule.f}))},meta=internalMetadata.exports={enable,fastKey:fastKey$1,getWeakData,onFreeze};hiddenKeys[METADATA]=!0;var $$t=_export,global$4=global$p,InternalMetadataModule=internalMetadata.exports,fails$1=fails$s,createNonEnumerableProperty=createNonEnumerableProperty$8,iterate$f=iterate$l,anInstance$1=anInstance$3,isCallable$2=isCallable$m,isObject$1=isObject$i,setToStringTag=setToStringTag$7,defineProperty$1=objectDefineProperty.f,forEach=arrayIteration.forEach,DESCRIPTORS$2=descriptors,InternalStateModule$1=internalState,setInternalState$1=InternalStateModule$1.set,internalStateGetterFor$1=InternalStateModule$1.getterFor,collection$1=function(e,t,r){var n,i=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),s=i?"set":"add",a=global$4[e],l=a&&a.prototype,c={};if(DESCRIPTORS$2&&isCallable$2(a)&&(o||l.forEach&&!fails$1(function(){(new a).entries().next()}))){var u=(n=t(function(t,r){setInternalState$1(anInstance$1(t,u),{type:e,collection:new a}),null!=r&&iterate$f(r,t[s],{that:t,AS_ENTRIES:i})})).prototype,d=internalStateGetterFor$1(e);forEach(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(e){var t="add"==e||"set"==e;!(e in l)||o&&"clear"==e||createNonEnumerableProperty(u,e,function(r,n){var i=d(this).collection;if(!t&&o&&!isObject$1(r))return"get"==e&&void 0;var s=i[e](0===r?0:r,n);return t?this:s})}),o||defineProperty$1(u,"size",{configurable:!0,get:function(){return d(this).collection.size}})}else n=r.getConstructor(t,e,i,s),InternalMetadataModule.enable();return setToStringTag(n,e,!1,!0),c[e]=n,$$t({global:!0,forced:!0},c),o||r.setStrong(n,e,i),n},defineBuiltIn=defineBuiltIn$6,defineBuiltIns$1=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:defineBuiltIn(e,n,t[n],r);return e},defineProperty=objectDefineProperty.f,create=objectCreate,defineBuiltIns=defineBuiltIns$1,bind$c=functionBindContext,anInstance=anInstance$3,iterate$e=iterate$l,defineIterator=defineIterator$3,setSpecies=setSpecies$2,DESCRIPTORS$1=descriptors,fastKey=internalMetadata.exports.fastKey,InternalStateModule=internalState,setInternalState=InternalStateModule.set,internalStateGetterFor=InternalStateModule.getterFor,collectionStrong$1={getConstructor:function(e,t,r,n){var i=e(function(e,i){anInstance(e,o),setInternalState(e,{type:t,index:create(null),first:void 0,last:void 0,size:0}),DESCRIPTORS$1||(e.size=0),null!=i&&iterate$e(i,e[n],{that:e,AS_ENTRIES:r})}),o=i.prototype,s=internalStateGetterFor(t),a=function(e,t,r){var n,i,o=s(e),a=l(e,t);return a?a.value=r:(o.last=a={index:i=fastKey(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=a),n&&(n.next=a),DESCRIPTORS$1?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},l=function(e,t){var r,n=s(e),i=fastKey(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return defineBuiltIns(o,{clear:function(){for(var e=s(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,DESCRIPTORS$1?e.size=0:this.size=0},delete:function(e){var t=this,r=s(t),n=l(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),DESCRIPTORS$1?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=s(this),n=bind$c(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!l(this,e)}}),defineBuiltIns(o,r?{get:function(e){var t=l(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),DESCRIPTORS$1&&defineProperty(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=internalStateGetterFor(t),o=internalStateGetterFor(n);defineIterator(e,t,function(e,t){setInternalState(this,{type:n,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})},r?"entries":"values",!r,!0),setSpecies(t)}},collection=collection$1,collectionStrong=collectionStrong$1;collection("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},collectionStrong);var path$5=path$l,map$5=path$5.Map,parent$d=map$5,map$4=parent$d,parent$c=map$4,map$3=parent$c,bind$b=functionBindContext,call$9=functionCall,aCallable$b=aCallable$m,aConstructor=aConstructor$3,iterate$d=iterate$l,push$2=[].push,collectionFrom=function(e){var t,r,n,i,o=arguments.length,s=o>1?arguments[1]:void 0;return aConstructor(this),(t=void 0!==s)&&aCallable$b(s),null==e?new this:(r=[],t?(n=0,i=bind$b(s,o>2?arguments[2]:void 0),iterate$d(e,function(e){call$9(push$2,r,i(e,n++))})):iterate$d(e,push$2,{that:r}),new this(r))},$$s=_export,from=collectionFrom;$$s({target:"Map",stat:!0,forced:!0},{from});var arraySlice$1=arraySlice$5,collectionOf=function(){return new this(arraySlice$1(arguments))},$$r=_export,of=collectionOf;$$r({target:"Map",stat:!0,forced:!0},{of});var call$8=functionCall,aCallable$a=aCallable$m,anObject$e=anObject$s,collectionDeleteAll=function(){for(var e,t=anObject$e(this),r=aCallable$a(t.delete),n=!0,i=0,o=arguments.length;i<o;i++)e=call$8(r,t,arguments[i]),n=n&&e;return!!n},$$q=_export,deleteAll=collectionDeleteAll;$$q({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll});var call$7=functionCall,aCallable$9=aCallable$m,anObject$d=anObject$s,mapEmplace=function(e,t){var r,n,i=anObject$d(this),o=aCallable$9(i.get),s=aCallable$9(i.has),a=aCallable$9(i.set);return call$7(s,i,e)?(r=call$7(o,i,e),"update"in t&&(r=t.update(r,e,i),call$7(a,i,e,r)),r):(n=t.insert(e,i),call$7(a,i,e,n),n)},$$p=_export,emplace=mapEmplace;$$p({target:"Map",proto:!0,real:!0,forced:!0},{emplace});var getIterator$1=getIterator$4,getMapIterator$a=getIterator$1,$$o=_export,anObject$c=anObject$s,bind$a=functionBindContext,getMapIterator$9=getMapIterator$a,iterate$c=iterate$l;$$o({target:"Map",proto:!0,real:!0,forced:!0},{every:function(e){var t=anObject$c(this),r=getMapIterator$9(t),n=bind$a(e,arguments.length>1?arguments[1]:void 0);return!iterate$c(r,function(e,r,i){if(!n(r,e,t))return i()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $$n=_export,getBuiltIn$2=getBuiltIn$h,bind$9=functionBindContext,call$6=functionCall,aCallable$8=aCallable$m,anObject$b=anObject$s,speciesConstructor$2=speciesConstructor$5,getMapIterator$8=getMapIterator$a,iterate$b=iterate$l;$$n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(e){var t=anObject$b(this),r=getMapIterator$8(t),n=bind$9(e,arguments.length>1?arguments[1]:void 0),i=new(speciesConstructor$2(t,getBuiltIn$2("Map"))),o=aCallable$8(i.set);return iterate$b(r,function(e,r){n(r,e,t)&&call$6(o,i,e,r)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var $$m=_export,anObject$a=anObject$s,bind$8=functionBindContext,getMapIterator$7=getMapIterator$a,iterate$a=iterate$l;$$m({target:"Map",proto:!0,real:!0,forced:!0},{find:function(e){var t=anObject$a(this),r=getMapIterator$7(t),n=bind$8(e,arguments.length>1?arguments[1]:void 0);return iterate$a(r,function(e,r,i){if(n(r,e,t))return i(r)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var $$l=_export,anObject$9=anObject$s,bind$7=functionBindContext,getMapIterator$6=getMapIterator$a,iterate$9=iterate$l;$$l({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(e){var t=anObject$9(this),r=getMapIterator$6(t),n=bind$7(e,arguments.length>1?arguments[1]:void 0);return iterate$9(r,function(e,r,i){if(n(r,e,t))return i(e)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var $$k=_export,call$5=functionCall,uncurryThis$4=functionUncurryThis,aCallable$7=aCallable$m,getIterator=getIterator$4,iterate$8=iterate$l,push$1=uncurryThis$4([].push);$$k({target:"Map",stat:!0,forced:!0},{groupBy:function(e,t){aCallable$7(t);var r=getIterator(e),n=new this,i=aCallable$7(n.has),o=aCallable$7(n.get),s=aCallable$7(n.set);return iterate$8(r,function(e){var r=t(e);call$5(i,n,r)?push$1(call$5(o,n,r),e):call$5(s,n,r,[e])},{IS_ITERATOR:!0}),n}});var sameValueZero$1=function(e,t){return e===t||e!=e&&t!=t},$$j=_export,anObject$8=anObject$s,getMapIterator$5=getMapIterator$a,sameValueZero=sameValueZero$1,iterate$7=iterate$l;$$j({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(e){return iterate$7(getMapIterator$5(anObject$8(this)),function(t,r,n){if(sameValueZero(r,e))return n()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $$i=_export,call$4=functionCall,iterate$6=iterate$l,aCallable$6=aCallable$m;$$i({target:"Map",stat:!0,forced:!0},{keyBy:function(e,t){var r=new this;aCallable$6(t);var n=aCallable$6(r.set);return iterate$6(e,function(e){call$4(n,r,t(e),e)}),r}});var $$h=_export,anObject$7=anObject$s,getMapIterator$4=getMapIterator$a,iterate$5=iterate$l;$$h({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(e){return iterate$5(getMapIterator$4(anObject$7(this)),function(t,r,n){if(r===e)return n(t)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var $$g=_export,getBuiltIn$1=getBuiltIn$h,bind$6=functionBindContext,call$3=functionCall,aCallable$5=aCallable$m,anObject$6=anObject$s,speciesConstructor$1=speciesConstructor$5,getMapIterator$3=getMapIterator$a,iterate$4=iterate$l;$$g({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(e){var t=anObject$6(this),r=getMapIterator$3(t),n=bind$6(e,arguments.length>1?arguments[1]:void 0),i=new(speciesConstructor$1(t,getBuiltIn$1("Map"))),o=aCallable$5(i.set);return iterate$4(r,function(e,r){call$3(o,i,n(r,e,t),r)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var $$f=_export,getBuiltIn=getBuiltIn$h,bind$5=functionBindContext,call$2=functionCall,aCallable$4=aCallable$m,anObject$5=anObject$s,speciesConstructor=speciesConstructor$5,getMapIterator$2=getMapIterator$a,iterate$3=iterate$l;$$f({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(e){var t=anObject$5(this),r=getMapIterator$2(t),n=bind$5(e,arguments.length>1?arguments[1]:void 0),i=new(speciesConstructor(t,getBuiltIn("Map"))),o=aCallable$4(i.set);return iterate$3(r,function(e,r){call$2(o,i,e,n(r,e,t))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var $$e=_export,aCallable$3=aCallable$m,anObject$4=anObject$s,iterate$2=iterate$l;$$e({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(e){for(var t=anObject$4(this),r=aCallable$3(t.set),n=arguments.length,i=0;i<n;)iterate$2(arguments[i++],r,{that:t,AS_ENTRIES:!0});return t}});var $$d=_export,anObject$3=anObject$s,aCallable$2=aCallable$m,getMapIterator$1=getMapIterator$a,iterate$1=iterate$l,$TypeError$3=TypeError;$$d({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=anObject$3(this),r=getMapIterator$1(t),n=arguments.length<2,i=n?void 0:arguments[1];if(aCallable$2(e),iterate$1(r,function(r,o){n?(n=!1,i=o):i=e(i,o,r,t)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw $TypeError$3("Reduce of empty map with no initial value");return i}});var $$c=_export,anObject$2=anObject$s,bind$4=functionBindContext,getMapIterator=getMapIterator$a,iterate=iterate$l;$$c({target:"Map",proto:!0,real:!0,forced:!0},{some:function(e){var t=anObject$2(this),r=getMapIterator(t),n=bind$4(e,arguments.length>1?arguments[1]:void 0);return iterate(r,function(e,r,i){if(n(r,e,t))return i()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var $$b=_export,call$1=functionCall,anObject$1=anObject$s,aCallable$1=aCallable$m,$TypeError$2=TypeError;$$b({target:"Map",proto:!0,real:!0,forced:!0},{update:function(e,t){var r=anObject$1(this),n=aCallable$1(r.get),i=aCallable$1(r.has),o=aCallable$1(r.set),s=arguments.length;aCallable$1(t);var a=call$1(i,r,e);if(!a&&s<3)throw $TypeError$2("Updating absent value");var l=a?call$1(n,r,e):aCallable$1(s>2?arguments[2]:void 0)(e,r);return call$1(o,r,e,t(l,e,r)),r}});var call=functionCall,aCallable=aCallable$m,isCallable$1=isCallable$m,anObject=anObject$s,$TypeError$1=TypeError,mapUpsert=function(e,t){var r,n=anObject(this),i=aCallable(n.get),o=aCallable(n.has),s=aCallable(n.set),a=arguments.length>2?arguments[2]:void 0;if(!isCallable$1(t)&&!isCallable$1(a))throw $TypeError$1("At least one callback required");return call(o,n,e)?(r=call(i,n,e),isCallable$1(t)&&(r=t(r),call(s,n,e,r))):isCallable$1(a)&&(r=a(),call(s,n,e,r)),r},$$a=_export,upsert$1=mapUpsert;$$a({target:"Map",proto:!0,real:!0,forced:!0},{upsert:upsert$1});var $$9=_export,upsert=mapUpsert;$$9({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:upsert});var parent$b=map$3,map$2=parent$b,map$1=map$2,map=map$1,$$8=_export,uncurryThis$3=functionUncurryThis,$IndexOf=arrayIncludes.indexOf,arrayMethodIsStrict$1=arrayMethodIsStrict$3,un$IndexOf=uncurryThis$3([].indexOf),NEGATIVE_ZERO=!!un$IndexOf&&1/un$IndexOf([1],1,-0)<0,STRICT_METHOD$1=arrayMethodIsStrict$1("indexOf");$$8({target:"Array",proto:!0,forced:NEGATIVE_ZERO||!STRICT_METHOD$1},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return NEGATIVE_ZERO?un$IndexOf(this,e,t)||0:$IndexOf(this,e,t)}});var entryVirtual$3=entryVirtual$b,indexOf$6=entryVirtual$3("Array").indexOf,isPrototypeOf$2=objectIsPrototypeOf,method$1=indexOf$6,ArrayPrototype$2=Array.prototype,indexOf$5=function(e){var t=e.indexOf;return e===ArrayPrototype$2||isPrototypeOf$2(ArrayPrototype$2,e)&&t===ArrayPrototype$2.indexOf?method$1:t},parent$a=indexOf$5,indexOf$4=parent$a,parent$9=indexOf$4,indexOf$3=parent$9,parent$8=indexOf$3,indexOf$2=parent$8,indexOf$1=indexOf$2,indexOf=indexOf$1;function _isNativeFunction(e){var t;return-1!==indexOf(t=Function.toString.call(e)).call(t,"[native code]")}var parent$7=bind$e,bind$3=parent$7,parent$6=bind$3,bind$2=parent$6,bind$1=bind$2,bind=bind$1;function _construct(e,t,r){return _construct=_isNativeReflectConstruct()?construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(bind(Function).apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i},_construct.apply(null,arguments)}function _wrapNativeSuper(e){var t="function"==typeof map?new map:void 0;return _wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=create$3(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)},_wrapNativeSuper(e)}var BaseError=function(e){_inherits(r,_wrapNativeSuper(Error));var t=_createSuper(r);function r(e){var n,i,o,s,a,l,c;_classCallCheck(this,r),o=t.call(this,concat$3(n=concat$3(i="".concat(e&&e.logid?"[".concat(e.logid,"] "):"")).call(i,e&&e.msg?'message: "'.concat(e.msg,'"'):"")).call(n,e&&e.innerError?', inner error: "'.concat(e.innerError,'"'):"")),assign(_assertThisInitialized(o),e),setPrototypeOf$1(_assertThisInitialized(o),r.prototype),(null===(s=o.innerError)||void 0===s?void 0:s.logid)&&(o.logid=o.innerError.logid);try{var u,d;"string"==typeof(null===(a=o.innerError)||void 0===a?void 0:a.stack)&&(o.stack=concat$3(u="".concat(o.innerError.stack,"\n")).call(u,null===(l=o.stack)||void 0===l?void 0:slice(d=l.split("\n")).call(d,2).join("\n")))}catch(e){var h,p;context.logger.warn(concat$3(h=concat$3(p="concat trace fail=".concat(e,", current stack=")).call(p,o.stack,", inner stack=")).call(h,null===(c=o.innerError)||void 0===c?void 0:c.stack))}return o}return _createClass(r)}();function encode(e){return window.btoa?window.btoa(e):Buffer.from(e).toString("base64")}function decode(e){return window.atob?window.atob(e):Buffer.from(e,"base64").toString("ascii")}var base64={encode,decode},Frame=sync_proto.Frame,BsyncProtocol$2=sync_proto.BsyncProtocol;function getBase64(e){return"undefined"!=typeof btoa?btoa(String.fromCharCode.apply(null,new Uint8Array(e))):""}function serialize(e){var t=BsyncProtocol$2.encode(e).finish();return new Uint8Array(t)}function deserialize(e){try{return BsyncProtocol$2.decode(e)}catch(r){var t=getBase64(e);throw context.logger.warn("decode response error: ",r),context.logger.debug("hex dump: ",t),t}}function serializeFrame(e){var t=Frame.encode(e).finish();return new Uint8Array(t)}function deserializeFrame(e){var t=new Uint8Array(e);try{return Frame.decode(t)}catch(e){var r=getBase64(t);throw context.logger.warn("decode frame error: ",e),context.logger.debug("hex dump: ",r),r}}function _regeneratorRuntime$i(){_regeneratorRuntime$i=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var HttpClient=function(){function e(t){_classCallCheck(this,e),this.option=t}return _createClass(e,[{key:"sendRequest",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$i().mark(function r(){var n,i,o,s,a;return _regeneratorRuntime$i().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.send(e,"POST",serialize(t));case 2:if(o=r.sent,s=map$6(n=base64.decode(map$6(i=_toConsumableArray(new Uint8Array(o))).call(i,function(e){return String.fromCharCode(e)}).join("")).split("")).call(n,function(e){return e.charCodeAt(0)}),0!==(a=new Uint8Array(s)).length){r.next=7;break}throw new BaseError({msg:"empty data",type:ErrorType.Unknown,allowRetry:!0,sender:this});case 7:return r.abrupt("return",sync_proto.BsyncProtocol.decode(a));case 8:case"end":return r.stop()}},r,this)}))}},{key:"headers",get:function(){return assign({Accept:"application/x-protobuf","Content-Type":"application/octet-stream"},this.option.httpHeaders)}},{key:"mime",get:function(){return"application/x-protobuf"}},{key:"dataType",get:function(){return"arraybuffer"}},{key:"method",get:function(){return"POST"}}]),e}();function _regeneratorRuntime$h(){_regeneratorRuntime$h=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var BrowserHttp=function(e){_inherits(r,HttpClient);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,e)).instance=axios__WEBPACK_IMPORTED_MODULE_3___default().create({headers:n.headers,responseType:n.dataType,method:n.method}),n}return _createClass(r,[{key:"send",value:function(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$h().mark(function n(){var i;return _regeneratorRuntime$h().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.instance.request({url:e,data:r,method:t});case 2:return i=n.sent,n.abrupt("return",i.data);case 4:case"end":return n.stop()}},n,this)}))}},{key:"sendByBeacon",value:function(e,t){return void 0!==navigator.sendBeacon&&navigator.sendBeacon(e,t)}}]),r}();function _regeneratorRuntime$g(){_regeneratorRuntime$g=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var TtHttp=function(e){_inherits(r,HttpClient);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"send",value:function(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$g().mark(function t(){var n=this;return _regeneratorRuntime$g().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new promise(function(t,i){tt.request({url:e,data:r,header:assign({},n.headers),method:n.method,dataType:n.dataType,responseType:n.dataType,success:function(e){t(e.data)},fail:function(e){i(e)}})}));case 1:case"end":return t.stop()}},t)}))}}]),r}();function _regeneratorRuntime$f(){_regeneratorRuntime$f=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var WxHttp=function(e){_inherits(r,HttpClient);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"send",value:function(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$f().mark(function n(){var i=this;return _regeneratorRuntime$f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new promise(function(n,o){wx.request({url:e,data:r,header:i.headers,method:t,dataType:i.dataType,responseType:i.dataType,success:function(e){n(e.data)},fail:function(){o()}})}));case 1:case"end":return n.stop()}},n)}))}}]),r}(),BrowserWebSocket=function(e){_inherits(r,SyncSocket);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"registerEvents",value:function(){var e=this;this.socket.onclose=function(t){e.emit("close",e)},this.socket.onopen=function(){e.emit("open",e)},this.socket.onmessage=function(t){e.emit("message",t.data,!0)},this.socket.onerror=function(t){e.emit("error",t)}}},{key:"open",value:function(){return this.isOpen()?(context.logger.warn("ws already open, close first"),promise.resolve(!0)):(this.socket=new WebSocket(this.frontierURL,SdkConsts.wsProtocols),this.socket.binaryType="arraybuffer",this.registerEvents(),this.on("open",function(){console.log("ws.opened"),e(!0)}),this.on("error",function(e){t(e)}),new promise(function(r,n){e=r,t=n}));var e,t}},{key:"close",value:function(){this.socket&&(this.socket.onmessage=null,this.socket.close()),this.socket=void 0}},{key:"send",value:function(e){this.socket.send(e)}},{key:"isOpen",value:function(){return void 0!==this.socket&&this.socket.readyState===WebSocket.OPEN}}]),r}(),TtWebSocket=function(e){_inherits(r,SyncSocket);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.apply(this,arguments)).innerOpen=!1,e}return _createClass(r,[{key:"registerEvents",value:function(){var e=this;this.socket.onOpen(function(){e.innerOpen=!0,e.emit("open",e)}),this.socket.onError(function(){e.emit("error",e)}),this.socket.onMessage(function(t){e.emit("message",t.data)}),this.socket.onClose(function(){e.innerOpen=!1,e.emit("close",e)})}},{key:"open",value:function(){var e=this;return new promise(function(t,r){e.socket=tt.connectSocket({url:e.frontierURL,protocols:SdkConsts.wsProtocols,success:function(e){t(e)},fail:function(e){r(e)}}),e.registerEvents()})}},{key:"close",value:function(){this.socket&&this.socket.close({}),this.socket=void 0}},{key:"send",value:function(e){this.socket&&this.socket.send({data:e.buffer})}},{key:"isOpen",value:function(){return this.innerOpen}}]),r}(),WxWebSocket=function(e){_inherits(r,SyncSocket);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.apply(this,arguments)).innerOpen=!1,e}return _createClass(r,[{key:"registerEvents",value:function(){var e=this;this.socket.onOpen(function(){e.innerOpen=!0,e.emit("open",e)}),this.socket.onError(function(){e.emit("error",e)}),this.socket.onMessage(function(t){e.emit("message",t.data)}),this.socket.onClose(function(){e.innerOpen=!1,e.emit("close",e)})}},{key:"open",value:function(){var e=this;return new promise(function(t,r){e.socket=wx.connectSocket({url:e.frontierURL,header:{},protocols:SdkConsts.wsProtocols,success:function(){t()},fail:function(e){r(e)}}),e.registerEvents()})}},{key:"close",value:function(){this.socket&&this.socket.close({}),this.socket=void 0}},{key:"send",value:function(e){this.socket&&this.socket.send({data:e.buffer})}},{key:"isOpen",value:function(){return this.innerOpen}}]),r}(),NetworkEnvironment,ConnectionStatus,NetworkType;function _regeneratorRuntime$e(){_regeneratorRuntime$e=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function getNetworkEnvironment(e){return void 0!==e?e:"undefined"!=typeof tt?NetworkEnvironment.Tt:"undefined"!=typeof wx?NetworkEnvironment.Wx:NetworkEnvironment.Browser}function getDefaultHttpClient(e){switch(getNetworkEnvironment(e)){case NetworkEnvironment.Wx:return WxHttp;case NetworkEnvironment.Tt:return TtHttp;default:return BrowserHttp}}function getDefaultWsClient(e){switch(getNetworkEnvironment(e)){case NetworkEnvironment.Wx:return WxWebSocket;case NetworkEnvironment.Tt:return TtWebSocket;default:return BrowserWebSocket}}function getConnectionStatus(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$e().mark(function t(){return _regeneratorRuntime$e().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=getNetworkEnvironment(e),t.next=t.t0===NetworkEnvironment.Browser?3:t.t0===NetworkEnvironment.Tt||t.t0===NetworkEnvironment.Wx?12:15;break;case 3:if("undefined"==typeof navigator||void 0===navigator.onLine){t.next=11;break}if(!navigator.onLine){t.next=8;break}return t.abrupt("return",ConnectionStatus.Connected);case 8:return t.abrupt("return",ConnectionStatus.Disconnected);case 9:t.next=12;break;case 11:case 14:case 15:return t.abrupt("return",ConnectionStatus.Unknown);case 12:if(!wx.getNetworkType){t.next=14;break}return t.abrupt("return",new promise(function(e){wx.getNetworkType({success:function(t){switch(t.networkType){case"none":return void e(ConnectionStatus.Disconnected);case"unknown":return void e(ConnectionStatus.Unknown);default:return void e(ConnectionStatus.Connected)}},fail:function(t){context.logger.error("get connection status error",t),e(ConnectionStatus.Disconnected)}})}));case 16:case"end":return t.stop()}},t)}))}!function(e){e[e.Browser=0]="Browser",e[e.Wx=1]="Wx",e[e.Tt=2]="Tt"}(NetworkEnvironment||(NetworkEnvironment={})),function(e){e[e.Connected=0]="Connected",e[e.Disconnected=1]="Disconnected",e[e.Unknown=2]="Unknown"}(ConnectionStatus||(ConnectionStatus={})),function(e){e[e.Cellular_2G=0]="Cellular_2G",e[e.Cellular_3G=1]="Cellular_3G",e[e.Cellular_4G=2]="Cellular_4G",e[e.Cellular_5G=3]="Cellular_5G",e[e.Wifi=4]="Wifi",e[e.Other=5]="Other",e[e.Unknown=6]="Unknown",e[e.None=7]="None"}(NetworkType||(NetworkType={}));var $$7=_export,uncurryThis$2=functionUncurryThis,$Date=Date,getTime=uncurryThis$2($Date.prototype.getTime);$$7({target:"Date",stat:!0},{now:function(){return getTime(new $Date)}});var path$4=path$l,now$2=path$4.Date.now,parent$5=now$2,now$1=parent$5,now=now$1;function _regeneratorRuntime$d(){_regeneratorRuntime$d=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Version=sync_proto.Version,BsyncProtocol$1=sync_proto.BsyncProtocol,Flag$2=sync_proto.Flag,TopicType$2=sync_proto.TopicType;function getSyncHeader(e){return assign({version:Version.V2,ts:long__WEBPACK_IMPORTED_MODULE_2__.A.fromNumber(now()),did:context.option.did,uid:context.option.uid,infos:{}},e)}function getSyncMsg(e){return BsyncProtocol$1.create({header:getSyncHeader(e),topics:[{flag:Flag$2.Sync,topic_type:TopicType$2.SpecTopic},{flag:Flag$2.Sync,topic_type:TopicType$2.GlobalTopic},{flag:Flag$2.Sync,topic_type:TopicType$2.CustomTopic}]})}function getPollMsg(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$d().mark(function e(){var t,r,n,i,o,s,a;return _regeneratorRuntime$d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=context.db,r=context.option,n=r.did,i=r.commonParams,e.next=5,t.getUidByDid(n);case 5:return o=e.sent,e.next=8,t.getSyncCursorsByDeviceInfo(n,o);case 8:return s=e.sent,a=map$6(s).call(s,function(e){return{flag:Flag$2.Poll,topic_type:e.topic_type,bucket:e.bucket,sync_id:e.sync_id,ref_cursor:e.recv_cursor}}),e.abrupt("return",BsyncProtocol$1.create({header:getSyncHeader({infos:i}),topics:a}));case 11:case"end":return e.stop()}},e)}))}function getReportMsg(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$d().mark(function r(){var n,i,o,s,a,l=this;return _regeneratorRuntime$d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=context.option,i=n.commonParams,o=now(),r.next=5,promise.all(map$6(t).call(t,function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(l,void 0,void 0,_regeneratorRuntime$d().mark(function t(){return _regeneratorRuntime$d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{cursor:{cursor:e.cursor},payload:{consume_type:e.consume_type,business:e.business.toNumber(),data:e.data},ts:long__WEBPACK_IMPORTED_MODULE_2__.A.fromNumber(o),extra:{msg_id:String(e.msg_id),msg_req_id:String(o),hit_sampling:"1"}});case 1:case"end":return t.stop()}},t)}))}));case 5:return s=r.sent,a={flag:Flag$2.Data,topic_type:TopicType$2.SpecTopic,sync_id:e,packets:s},r.abrupt("return",BsyncProtocol$1.create({header:getSyncHeader({infos:i}),topics:[a]}));case 8:case"end":return r.stop()}},r)}))}sync_proto.Bucket;var settings={version:1234,downstreamServiceID:20032,channel:1,sync:30,poll:600,disconnectInterval:5,reportSizeLimit:6144,submitSizeLimit:51200,dbStoreSizeLimit:51200,eventSendDelay:5};function _regeneratorRuntime$c(){_regeneratorRuntime$c=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var TopicType$1=sync_proto.TopicType,Bucket$3=sync_proto.Bucket;function eventReport(e,t){var r;t.header;var n=t.topics,i=null==n?void 0:n[0];try{null===(r=null==i?void 0:i.packets)||void 0===r||forEach$1(r).call(r,function(t){var r,n,o,s,a,l,c={msg_id:null===(r=t.extra)||void 0===r?void 0:r.msg_id,msg_req_id:null===(n=t.extra)||void 0===n?void 0:n.msg_req_id,business_id:null===(o=t.payload)||void 0===o?void 0:o.business,app_id:context.option.aid,device_platform:"web",sync_id:null===(s=i.sync_id)||void 0===s?void 0:s.toNumber(),cursor:t.cursor.cursor.toNumber(),channel:e?"0":"1",send_timestamp:null===(a=t.ts)||void 0===a?void 0:a.toNumber(),topic:"",topic_type:i.topic_type,consumer_type:null===(l=t.payload)||void 0===l?void 0:l.consume_type};context.monitor.collect("sync_sdk_event_report",c)})}catch(e){context.logger.error("sync_sdk_event_report error: ",e.stack)}}function bindCursor(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$c().mark(function r(){var n,i,o,s,a;return _regeneratorRuntime$c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=context.option,i=n.uid,o=n.did,s=[],e!==Bucket$3.Device){r.next=8;break}return r.next=5,context.db.queryUploadMsgByDeviceInfo(e,{did:o});case 5:s=r.sent,r.next=11;break;case 8:return r.next=10,context.db.queryUploadMsgByDeviceInfo(e,{did:o,uid:i});case 10:s=r.sent;case 11:if(!(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(s)){r.next=13;break}return r.abrupt("return",!0);case 13:return forEach$1(s).call(s,function(e){t.report_cursor=t.report_cursor?t.report_cursor.add(1):long__WEBPACK_IMPORTED_MODULE_2__.A.ONE,e.sync_id=t.sync_id,e.cursor=t.report_cursor,e.bucket=t.bucket}),r.next=16,context.db.updateUploadCursor(s,t);case 16:return(a=r.sent)&&context.logger.debug("save distributed payload to db success"),r.abrupt("return",a);case 19:case"end":return r.stop()}},r)}))}function sendWithSyncId(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$c().mark(function r(){var n,i,o,s,a;return _regeneratorRuntime$c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=0,i=!1,o=[];case 3:if((0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(t)){r.next=20;break}if(s=t.shift(),!(n+s.data.length<=settings.reportSizeLimit)){r.next=11;break}o.push(s),n+=s.data.length,r.next=18;break;case 11:if(!(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(o)){r.next=16;break}i=!0,o.push(s),r.next=18;break;case 16:return context.logger.error("the data is too large to report, report log id:",s.id),r.abrupt("break",23);case 18:r.next=21;break;case 20:return r.abrupt("break",23);case 21:r.next=3;break;case 23:if((0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(o)){r.next=42;break}return r.next=26,getReportMsg(e,o);case 26:if(null!==(a=r.sent)){r.next=29;break}return r.abrupt("return");case 29:return r.prev=29,r.next=32,context.network.send({body:a},{forceHttps:i});case 32:eventReport(r.sent.useWs,a),r.next=40;break;case 37:r.prev=37,r.t0=r.catch(29),context.monitor.send({name:"network error",categories:{message:r.t0.message||r.t0.msg,type:"report"}});case 40:r.next=43;break;case 42:context.logger.error("dataList is empty when send payload, maybe the first size too large or original data is empty");case 43:case"end":return r.stop()}},r,null,[[29,37]])}))}function uploadWithBucket(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$c().mark(function r(){var n;return _regeneratorRuntime$c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,bindCursor(e,t);case 2:if(r.sent){r.next=5;break}return context.logger.error("save distributed payload to db failed"),r.abrupt("return");case 5:return r.next=7,context.db.queryDistributeMsgs(t.sync_id,1e4);case 7:if(n=r.sent,!(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(n)){r.next=11;break}return context.logger.info("local db is empty, not upload ".concat(e)),r.abrupt("return");case 11:sendWithSyncId(t.sync_id,n);case 12:case"end":return r.stop()}},r)}))}function doSendMsg(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$c().mark(function e(){var t,r,n;return _regeneratorRuntime$c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,context.db.getSyncCursorsByDeviceInfo(context.option.did,context.option.uid);case 2:t=e.sent,r=filter(t).call(t,function(e){return e.topic_type===TopicType$1.SpecTopic}),(n=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.groupBy)(r,"bucket"))[Bucket$3.Device]&&uploadWithBucket(Bucket$3.Device,n[Bucket$3.Device][0]),n[Bucket$3.User]&&uploadWithBucket(Bucket$3.User,n[Bucket$3.User][0]);case 7:case"end":return e.stop()}},e)}))}function sendBizData(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$c().mark(function r(){var n,i;return _regeneratorRuntime$c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e||!t){r.next=10;break}return r.next=3,context.db.getBusiness(e.toNumber());case 3:if((n=r.sent).consume_type!==sync_proto.ConsumeType.Increment){r.next=7;break}return context.logger.warn("Increment does not support report"),r.abrupt("return");case 7:return i={msg_id:context.option.genMsgId?context.option.genMsgId():now(),did:context.option.did,uid:context.option.uid,data:t,business:e,md5:js_md5__WEBPACK_IMPORTED_MODULE_0___default()(t.toString()),cursor:long__WEBPACK_IMPORTED_MODULE_2__.A.ZERO,consume_type:n.consume_type},r.next=10,context.db.insertReportSyncLog(i);case 10:return r.next=12,doSendMsg();case 12:case"end":return r.stop()}},r)}))}function _regeneratorRuntime$b(){_regeneratorRuntime$b=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function sendSyncMsg(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$b().mark(function e(){return _regeneratorRuntime$b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,context.network.send({body:getSyncMsg()});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),context.monitor.send({name:"network error",categories:{message:e.t0.message||e.t0.msg,type:"sync"}});case 8:case"end":return e.stop()}},e,null,[[0,5]])}))}function sendPollMsg(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$b().mark(function t(){return _regeneratorRuntime$b().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=context.network,t.next=4,getPollMsg();case 4:return t.t1=t.sent,t.t2={body:t.t1},t.t3={forceHttps:e},t.next=9,t.t0.send.call(t.t0,t.t2,t.t3);case 9:t.next=14;break;case 11:t.prev=11,t.t4=t.catch(0),context.monitor.send({name:"network error",categories:{message:t.t4.message||t.t4.msg,type:"poll"}});case 14:case"end":return t.stop()}},t,null,[[0,11]])}))}var msgSender={sendPollMsg,sendSyncMsg,sendBizData},global$3=global$p,apply$1=functionApply,isCallable=isCallable$m,userAgent=engineUserAgent,arraySlice=arraySlice$5,validateArgumentsLength=validateArgumentsLength$2,MSIE=/MSIE .\./.test(userAgent),Function$1=global$3.Function,wrap=function(e){return MSIE?function(t,r){var n=validateArgumentsLength(arguments.length,1)>2,i=isCallable(t)?t:Function$1(t),o=n?arraySlice(arguments,2):void 0;return e(n?function(){apply$1(i,this,o)}:i,r)}:e},schedulersFix={setTimeout:wrap(global$3.setTimeout),setInterval:wrap(global$3.setInterval)},$$6=_export,global$2=global$p,setInterval=schedulersFix.setInterval;$$6({global:!0,bind:!0,forced:global$2.setInterval!==setInterval},{setInterval});var $$5=_export,global$1=global$p,setTimeout$3=schedulersFix.setTimeout;$$5({global:!0,bind:!0,forced:global$1.setTimeout!==setTimeout$3},{setTimeout:setTimeout$3});var path$3=path$l,setTimeout$2=path$3.setTimeout,setTimeout$1=setTimeout$2,TickerStatus;!function(e){e[e.Stopped=0]="Stopped",e[e.Running=1]="Running"}(TickerStatus||(TickerStatus={}));var Ticker=function(e){_inherits(r,EventEmitter);var t=_createSuper(r);function r(e,n){var i;return _classCallCheck(this,r),(i=t.call(this)).state=TickerStatus.Stopped,i.refreshRate=0,i.doneDuration=0,i.refreshRate=e,i.doneDuration=n,_possibleConstructorReturn(i,_assertThisInitialized(i))}return _createClass(r,[{key:"duration",get:function(){return this.state===TickerStatus.Stopped&&0!==this.lastStopTime?this.lastStopTime-this.startTime:this.state===TickerStatus.Running?now()-this.startTime:0}},{key:"setRefreshRate",value:function(e){this.refreshRate=1e3*e}},{key:"start",value:function(){var e=this;this.tickTimer&&this.stop(),this.state=TickerStatus.Running,this.tickTimer=setTimeout$1(function(){e.loopUpdate()},this.refreshRate),void 0!==this.doneDuration&&(this.doneTimer=setTimeout$1(function(){e.done()},this.doneDuration)),this.startTime=now(),this.lastStopTime=0}},{key:"loopUpdate",value:function(){var e;this.update(),this.tickTimer&&clearTimeout(this.tickTimer),this.tickTimer=setTimeout$1(bind$d(e=this.loopUpdate).call(e,this),this.refreshRate)}},{key:"stop",value:function(){this.state!==TickerStatus.Stopped&&(clearTimeout(this.tickTimer),clearTimeout(this.doneTimer),this.state=TickerStatus.Stopped,this.lastStopTime=now(),this.emit("stop",this))}},{key:"update",value:function(){this.emit("tick",this)}},{key:"done",value:function(){this.stop(),this.emit("done")}}]),r}();function _regeneratorRuntime$a(){_regeneratorRuntime$a=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Compensator=function(){function e(){var t;_classCallCheck(this,e),this.ticker=new Ticker(1e3*settings.sync),this.ticker.on("tick",bind$d(t=this.onTick).call(t,this))}return _createClass(e,[{key:"start",value:function(){this.ticker.start()}},{key:"destroy",value:function(){this.ticker.stop(),this.ticker.off("tick")}},{key:"onReceivedSync",value:function(){this.hasSynced=!0}},{key:"onTick",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$a().mark(function e(){return _regeneratorRuntime$a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getConnectionStatus();case 2:e.sent===ConnectionStatus.Disconnected?this.ticker.setRefreshRate(settings.disconnectInterval):this.ticker.setRefreshRate(this.hasSynced?settings.poll:settings.sync),this.hasSynced?(msgSender.sendPollMsg(),msgSender.sendBizData()):msgSender.sendSyncMsg(),this.tryConnectWs();case 6:case"end":return e.stop()}},e,this)}))}},{key:"tryConnectWs",value:function(){var e;return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$a().mark(function t(){return _regeneratorRuntime$a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,getConnectionStatus();case 2:if(t.t0=t.sent,t.t1=ConnectionStatus.Disconnected,t.t0!==t.t1){t.next=6;break}return t.abrupt("return");case 6:if(context.initResult===InitResult.Succeeded){t.next=8;break}return t.abrupt("return");case 8:if(t.prev=8,null===(e=context.network.ws)||void 0===e?void 0:e.isOpen()){t.next=12;break}return t.next=12,context.network.connectWs();case 12:t.next=17;break;case 14:t.prev=14,t.t2=t.catch(8),context.logger.warn("ticker running in ws check err:",t.t2);case 17:case"end":return t.stop()}},t,null,[[8,14]])}))}}]),e}(),$$4=_export,$includes=arrayIncludes.includes,fails=fails$s,BROKEN_ON_SPARSE=fails(function(){return!Array(1).includes()});$$4({target:"Array",proto:!0,forced:BROKEN_ON_SPARSE},{includes:function(e){return $includes(this,e,arguments.length>1?arguments[1]:void 0)}});var entryVirtual$2=entryVirtual$b,includes$4=entryVirtual$2("Array").includes,isObject=isObject$i,classof=classofRaw$1,wellKnownSymbol$1=wellKnownSymbol$n,MATCH$1=wellKnownSymbol$1("match"),isRegexp=function(e){var t;return isObject(e)&&(void 0!==(t=e[MATCH$1])?!!t:"RegExp"==classof(e))},isRegExp=isRegexp,$TypeError=TypeError,notARegexp=function(e){if(isRegExp(e))throw $TypeError("The method doesn't accept regular expressions");return e},wellKnownSymbol=wellKnownSymbol$n,MATCH=wellKnownSymbol("match"),correctIsRegexpLogic=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[MATCH]=!1,"/./"[e](t)}catch(e){}}return!1},$$3=_export,uncurryThis$1=functionUncurryThis,notARegExp=notARegexp,requireObjectCoercible=requireObjectCoercible$4,toString=toString$6,correctIsRegExpLogic=correctIsRegexpLogic,stringIndexOf=uncurryThis$1("".indexOf);$$3({target:"String",proto:!0,forced:!correctIsRegExpLogic("includes")},{includes:function(e){return!!~stringIndexOf(toString(requireObjectCoercible(this)),toString(notARegExp(e)),arguments.length>1?arguments[1]:void 0)}});var entryVirtual$1=entryVirtual$b,includes$3=entryVirtual$1("String").includes,isPrototypeOf$1=objectIsPrototypeOf,arrayMethod=includes$4,stringMethod=includes$3,ArrayPrototype$1=Array.prototype,StringPrototype=String.prototype,includes$2=function(e){var t=e.includes;return e===ArrayPrototype$1||isPrototypeOf$1(ArrayPrototype$1,e)&&t===ArrayPrototype$1.includes?arrayMethod:"string"==typeof e||e===StringPrototype||isPrototypeOf$1(StringPrototype,e)&&t===StringPrototype.includes?stringMethod:t},parent$4=includes$2,includes$1=parent$4,includes=includes$1;function long2string(e){return e?String(e):e}function string2long(e){return"string"==typeof e?long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e):e}function _syncLogToStore(e){return{sync_id:String(e.sync_id),uid:e.uid,did:e.did,sync_cursor:long2string(e.sync_cursor),data:e.data,md5:e.md5,business:String(e.business),consume_type:e.consume_type,data_type:e.data_type,publish_ts:long2string(e.publish_ts),receive_ts:long2string(e.receive_ts),bucket:e.bucket,req_id:e.req_id,packet_status:e.packet_status,topic_type:e.topic_type,extra:e.extra}}function syncLogToStore(e){return isArray(e)?map$6(e).call(e,_syncLogToStore):_syncLogToStore(e)}function _syncLogFromStore(e){return{sync_id:long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e.sync_id),uid:e.uid,did:e.did,sync_cursor:string2long(e.sync_cursor),data:e.data,md5:e.md5,business:string2long(e.business),consume_type:e.consume_type,data_type:e.data_type,publish_ts:string2long(e.publish_ts),receive_ts:string2long(e.receive_ts),bucket:e.bucket,req_id:e.req_id,packet_status:e.packet_status,topic_type:e.topic_type,extra:e.extra}}function syncLogFromStore(e){return isArray(e)?map$6(e).call(e,_syncLogFromStore):_syncLogFromStore(e)}function _syncCursorToStore(e){return{sync_id:String(e.sync_id),uid:e.uid,did:e.did,bucket:e.bucket,topic_type:e.topic_type,report_cursor:long2string(e.report_cursor),recv_cursor:long2string(e.recv_cursor),deliver_cursor:long2string(e.deliver_cursor)}}function syncCursorToStore(e){return isArray(e)?map$6(e).call(e,_syncCursorToStore):_syncCursorToStore(e)}function _syncCursorFromStore(e){return{sync_id:long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e.sync_id),uid:e.uid,did:e.did,bucket:e.bucket,topic_type:e.topic_type,report_cursor:string2long(e.report_cursor),recv_cursor:string2long(e.recv_cursor),deliver_cursor:string2long(e.deliver_cursor)}}function syncCursorFromStore(e){return isArray(e)?map$6(e).call(e,_syncCursorFromStore):_syncCursorFromStore(e)}function _reportSyncLogToStore(e){return{id:e.id,sync_id:long2string(e.sync_id),uid:e.uid,did:e.did,bucket:e.bucket,business:long2string(e.business),cursor:long2string(e.cursor),data:e.data,md5:e.md5,msg_id:e.msg_id}}function reportSyncLogToStore(e){return isArray(e)?map$6(e).call(e,_reportSyncLogToStore):_reportSyncLogToStore(e)}function _reportSyncLogFromStore(e){return{id:e.id,sync_id:string2long(e.sync_id),uid:e.uid,did:e.did,bucket:e.bucket,business:string2long(e.business),cursor:string2long(e.cursor),data:e.data,md5:e.md5,msg_id:e.msg_id}}function reportSyncLogFromStore(e){return isArray(e)?map$6(e).call(e,_reportSyncLogFromStore):_reportSyncLogFromStore(e)}function _businessToStore(e){return{id:e.id,consume_type:e.consume_type,bucket:e.bucket}}function businessToStore(e){return isArray(e)?map$6(e).call(e,_businessToStore):_businessToStore(e)}function _regeneratorRuntime$9(){_regeneratorRuntime$9=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Bucket$2=sync_proto.Bucket,IndexDBDriver=function(e){_inherits(r,dexie__WEBPACK_IMPORTED_MODULE_5__.Ay);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,e)).version(1).stores({business:"id, consume_type, bucket",reportSyncLog:"++id, sync_id, msg_id, business, did, uid, bucket, cursor, data, md5, consume_type",snapshot:"[sync_id+business], uid, did, cursor, data, notified, bucket, data_type, publish_ts, receive_ts, consume_type, patch_cnt",syncCursor:"sync_id, uid, did, topic_type, bucket, recv_cursor, report_cursor",syncLog:"[sync_id+sync_cursor], uid, did, data, md5, business, consume_type, data_type, publish_ts, receive_ts, bucket, req_id, packet_status, extra, topic_type"}),n}return _createClass(r,[{key:"getBusiness",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.business.get(e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}},t,this)}))}},{key:"queryUploadMsgByDeviceInfo",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function r(){var n,i,o,s,a;return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.did,r.t0=map$6,r.next=4,this.business.where({bucket:e}).distinct().toArray();case 4:return r.t1=n=r.sent,r.next=7,(0,r.t0)(r.t1).call(n,function(e){return e.id});case 7:return s=r.sent,r.next=10,filter(i=this.reportSyncLog).call(i,function(e){return e.did===o&&long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e.cursor).lte(0)&&includes(s).call(s,Number(e.business))}).toArray();case 10:return a=r.sent,r.abrupt("return",reportSyncLogFromStore(a));case 12:case"end":return r.stop()}},r,this)}))}},{key:"queryDistributeMsgs",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function r(){var n,i;return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,filter(n=this.reportSyncLog).call(n,function(t){return long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(t.cursor).gt(0)&&String(e)===t.sync_id}).limit(t).toArray();case 2:return i=r.sent,r.abrupt("return",reportSyncLogFromStore(i));case 4:case"end":return r.stop()}},r,this)}))}},{key:"deleteUploadData",value:function(e,t){var r;return filter(r=this.reportSyncLog).call(r,function(r){var n=long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(r.cursor);return r.sync_id===String(e)&&n.gt(0)&&n.le(t)}).delete()}},{key:"insertReportSyncLog",value:function(e){var t=reportSyncLogToStore(e);return this.reportSyncLog.put(t)}},{key:"insertSyncLog",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=syncLogToStore(e),t.abrupt("return",isArray(r)?this.syncLog.bulkPut(r):this.syncLog.put(r));case 2:case"end":return t.stop()}},t,this)}))}},{key:"deleteSyncLogs",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=map$6(e).call(e,function(e){return[e.sync_id.toString(),e.sync_cursor.toString()]}),t.abrupt("return",this.syncLog.where("[sync_id+sync_cursor]").anyOf(r).delete());case 2:case"end":return t.stop()}},t,this)}))}},{key:"getSyncLogBySyncIds",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.syncLog.where("sync_id").anyOf(map$6(e).call(e,String)).toArray();case 2:return r=t.sent,t.abrupt("return",syncLogFromStore(r));case 4:case"end":return t.stop()}},t,this)}))}},{key:"insertBusiness",value:function(e){var t=businessToStore(e);return isArray(t)?this.business.bulkPut(t):this.business.put(t)}},{key:"insertSyncCursor",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=syncCursorToStore(e),t.abrupt("return",isArray(r)?this.syncCursor.bulkPut(r):this.syncCursor.put(r));case 2:case"end":return t.stop()}},t,this)}))}},{key:"deleteSyncCursors",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.syncCursor.bulkDelete(map$6(e).call(e,function(e){return e.toString()})));case 1:case"end":return t.stop()}},t,this)}))}},{key:"getSyncCursor",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.syncCursor.get({sync_id:String(e)});case 2:return r=t.sent,t.abrupt("return",syncCursorFromStore(r));case 4:case"end":return t.stop()}},t,this)}))}},{key:"getSyncCursorsBySyncIds",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.syncCursor.where("sync_id").anyOf(map$6(e).call(e,String)).toArray();case 2:return r=t.sent,t.abrupt("return",syncCursorFromStore(r));case 4:case"end":return t.stop()}},t,this)}))}},{key:"getSyncCursorsByDeviceInfo",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function r(){var n,i,o;return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=filter,r.next=3,this.syncCursor.where({did:e}).toArray();case 3:return r.t1=n=r.sent,i=(0,r.t0)(r.t1).call(n,function(e){return e.bucket===Bucket$2.Device||e.uid===t}),o=syncCursorFromStore(i),r.abrupt("return",o);case 7:case"end":return r.stop()}},r,this)}))}},{key:"getUidByDid",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function t(){var r;return _regeneratorRuntime$9().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.syncCursor.where({did:e}).first();case 2:return r=t.sent,t.abrupt("return",(null==r?void 0:r.uid)||"0");case 4:case"end":return t.stop()}},t,this)}))}},{key:"updateSyncCursorAndBusiness",value:function(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function n(){var i=this;return _regeneratorRuntime$9().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.transaction("rw",this.business,this.syncCursor,function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(i,void 0,void 0,_regeneratorRuntime$9().mark(function n(){return _regeneratorRuntime$9().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.insertBusiness(r);case 2:return n.next=4,this.insertSyncCursor(e);case 4:return n.next=6,this.deleteSyncCursors(t);case 6:case"end":return n.stop()}},n,this)}))}));case 1:case"end":return n.stop()}},n,this)}))}},{key:"insertSyncLogsAndCursor",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function r(){var n=this;return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.transaction("rw",this.syncLog,this.syncCursor,function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(n,void 0,void 0,_regeneratorRuntime$9().mark(function r(){return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.insertSyncLog(e);case 2:return r.next=4,this.insertSyncCursor(t);case 4:case"end":return r.stop()}},r,this)}))}));case 1:case"end":return r.stop()}},r,this)}))}},{key:"updateUploadCursor",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$9().mark(function r(){var n=this;return _regeneratorRuntime$9().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new promise(function(r,i){n.transaction("rw",n.syncCursor,n.reportSyncLog,function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(n,void 0,void 0,_regeneratorRuntime$9().mark(function n(){var o;return _regeneratorRuntime$9().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.reportSyncLog.bulkPut(reportSyncLogToStore(e));case 3:return n.next=5,this.syncCursor.update(String(t.sync_id),{report_cursor:null===(o=t.report_cursor)||void 0===o?void 0:o.toString()});case 5:r(!0),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),i(n.t0);case 11:case"end":return n.stop()}},n,this,[[0,8]])}))})}));case 1:case"end":return r.stop()}},r)}))}}]),r}();function _regeneratorRuntime$8(){_regeneratorRuntime$8=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Database=function(){function e(){_classCallCheck(this,e),this.driver=new IndexDBDriver("sync-sdk-db")}return _createClass(e,[{key:"getUidByDid",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.getUidByDid(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return","0");case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"getBusiness",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.driver.getBusiness(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"insertReportSyncLog",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.insertReportSyncLog(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return");case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"updateUploadCursor",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.updateUploadCursor(e,t);case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0),r.abrupt("return",!1);case 10:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"queryUploadMsgByDeviceInfo",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.queryUploadMsgByDeviceInfo(e,t);case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0),r.abrupt("return",[]);case 10:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"queryDistributeMsgs",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.queryDistributeMsgs(e,t);case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0),r.abrupt("return",[]);case 10:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"deleteUploadData",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.deleteUploadData(e,t);case 3:return r.abrupt("return",r.sent);case 6:r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0);case 9:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"getSyncLogBySyncIds",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.getSyncLogBySyncIds(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return",[]);case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"getSyncCursorsBySyncIds",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.getSyncCursorsBySyncIds(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return",[]);case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"insertSyncLog",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.insertSyncLog(e);case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"deleteSyncLogs",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.deleteSyncLogs(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return",-1);case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"insertSyncLogsAndCursor",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.insertSyncLogsAndCursor(e,t);case 3:return r.abrupt("return",r.sent);case 6:r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0);case 9:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"insertSyncCursor",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.insertSyncCursor(e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),context.monitor.captureException(t.t0);case 8:case"end":return t.stop()}},t,this,[[0,5]])}))}},{key:"getSyncCursor",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.getSyncCursor(e);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0),t.abrupt("return",null);case 10:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"getSyncCursorsByDeviceInfo",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function r(){return _regeneratorRuntime$8().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.driver.getSyncCursorsByDeviceInfo(e,t);case 3:return r.abrupt("return",r.sent);case 6:return r.prev=6,r.t0=r.catch(0),context.monitor.captureException(r.t0),r.abrupt("return",[]);case 10:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"deleteSyncCursors",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.deleteSyncCursors(e);case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"updateSyncCursorAndBusiness",value:function(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function n(){return _regeneratorRuntime$8().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.driver.updateSyncCursorAndBusiness(e,t,r);case 3:return n.abrupt("return",n.sent);case 6:n.prev=6,n.t0=n.catch(0),context.monitor.captureException(n.t0);case 9:case"end":return n.stop()}},n,this,[[0,6]])}))}},{key:"insertBusiness",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$8().mark(function t(){return _regeneratorRuntime$8().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.driver.insertBusiness(e);case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),context.monitor.captureException(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))}}]),e}(),_colorTable,LoggerLevel;function _defineProperty(e,t,r){return t in e?defineProperty$5(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e){e[e.debug=0]="debug",e[e.info=1]="info",e[e.warn=2]="warn",e[e.error=3]="error",e[e.none=4]="none"}(LoggerLevel||(LoggerLevel={}));var colorTable=(_colorTable={},_defineProperty(_colorTable,LoggerLevel.info,"#1890ff"),_defineProperty(_colorTable,LoggerLevel.debug,"#19be6b"),_defineProperty(_colorTable,LoggerLevel.warn,"#ff9900"),_defineProperty(_colorTable,LoggerLevel.error,"#ed4014"),_colorTable);LoggerLevel.debug,LoggerLevel.info,LoggerLevel.warn,LoggerLevel.error,LoggerLevel.none;var Logger=function(){function e(){_classCallCheck(this,e),this.level=LoggerLevel.debug}return _createClass(e,[{key:"info",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.log.apply(this,concat$3(e=["info"]).call(e,r))}},{key:"log",value:function(e){if(context.option.debug&&"none"!==e&&this.level<=LoggerLevel[e]){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console)[e].apply(t,concat$3(r=["%c [Sync SDK] [".concat(e,"]:"),"color: ".concat(colorTable[LoggerLevel[e]],"; font-weight: 700")]).call(r,i))}}},{key:"debug",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.log.apply(this,concat$3(e=["debug"]).call(e,r))}},{key:"warn",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.log.apply(this,concat$3(e=["warn"]).call(e,r))}},{key:"error",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];this.log.apply(this,concat$3(e=["error"]).call(e,r))}}]),e}();Logger.Instance=new Logger;var path$2=path$l,apply=functionApply;path$2.JSON||(path$2.JSON={stringify:JSON.stringify});var stringify$2=function(e,t,r){return apply(path$2.JSON.stringify,null,arguments)},parent$3=stringify$2,stringify$1=parent$3,stringify=stringify$1;function _regeneratorRuntime$7(){_regeneratorRuntime$7=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var EMPTY_FUNC=function(){},TEA_FALLBACK={event:EMPTY_FUNC},SLARDAR_FALLBACK={sendEvent:EMPTY_FUNC,sendLog:EMPTY_FUNC,captureException:EMPTY_FUNC},SyncMonitor=function(){function e(t){_classCallCheck(this,e),this.slardar=SLARDAR_FALLBACK,this.tea=TEA_FALLBACK,!1===t&&(this.disabledMonitor=!0)}return _createClass(e,[{key:"init",value:function(){this.initSlardar(),this.initTea()}},{key:"initSlardar",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$7().mark(function e(){var t,r,n,i,o,s;return _regeneratorRuntime$7().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.disabledMonitor){e.next=2;break}return e.abrupt("return");case 2:if(n=context.option,i=n.aid,o=n.slardar,s=null,!o){e.next=8;break}s=o,e.next=11;break;case 8:return e.next=10,Promise.resolve().then(function(){return index$1}).then(function(e){return e.default});case 10:s=e.sent;case 11:s.init({bid:"sync_web_sdk",pid:String(i),userId:concat$3(t=concat$3(r="".concat(i,":")).call(r,context.option.uid,":")).call(t,context.option.did||""),env:context.option.boe?"boe":"production",plugins:{pageview:!1,jsError:{onerror:!1,onunhandledrejection:!1,dedupe:!1},breadcrumb:!1,resource:!1,ajax:!1,fetch:!1,fmp:!1,blankScreen:!1,tti:!1,performance:!1}}),s.start(),this.slardar=s;case 14:case"end":return e.stop()}},e,this)}))}},{key:"initTea",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$7().mark(function e(){var t,r,n,i;return _regeneratorRuntime$7().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.disabledMonitor){e.next=2;break}return e.abrupt("return");case 2:if(!(t=context.option.tea)){e.next=7;break}r=t,e.next=13;break;case 7:return e.next=9,Promise.resolve().then(__webpack_require__.bind(__webpack_require__,80249));case 9:n=e.sent,i=n.Collector,(r=new i("sync-web-sdk")).init({app_id:context.option.aid,channel:"sg",log:!0});case 13:r.start(),this.tea=r;case 15:case"end":return e.stop()}},e,this)}))}},{key:"collect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.disabledMonitor||this.tea.event(e,assign(assign({},t),{params_for_special:"bytesync_sdk"}))}},{key:"send",value:function(e){try{if(this.disabledMonitor)return;return this.slardar.sendEvent(assign(assign({},e),{content:e.content?stringify(e.content):void 0}))}catch(e){context.logger.error(e)}}},{key:"sendLog",value:function(e){try{if(this.disabledMonitor)return;return this.slardar.sendLog(e)}catch(e){context.logger.error(e)}}},{key:"captureException",value:function(e,t){try{if(this.disabledMonitor)return;return this.slardar.captureException(e,t)}catch(e){context.logger.error(e)}}}]),e}();function traceMsgSend(e){context.monitor.send({name:"socket_percentage",categories:assign(assign({},e),{ws_connect:String(!!e.ws_connect)})})}function _regeneratorRuntime$6(){_regeneratorRuntime$6=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var BsyncProtocol=sync_proto.BsyncProtocol,NetworkManager=function(e){_inherits(r,EventEmitter);var t=_createSuper(r);function r(e,n){var i,o;_classCallCheck(this,r),(i=t.call(this)).getSeqId=(o=1e4,function(){return o+=1});var s=context.option,a=s.networkEnv;return i.http=null!=e?e:new(getDefaultHttpClient(a))(s),i.ws=null!=n?n:new(getDefaultWsClient(a))(s),i.prepareWs(),i}return _createClass(r,[{key:"createSendData",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function t(){var r,n,i,o;return _regeneratorRuntime$6().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=BsyncProtocol.create(e),n=_createForOfIteratorHelper(context.plugin),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=11;break}return o=i.value,t.next=8,o.sendPacket(r);case 8:r=t.sent;case 9:t.next=4;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),n.e(t.t0);case 16:return t.prev=16,n.f(),t.finish(16);case 19:return t.abrupt("return",r);case 20:case"end":return t.stop()}},t,null,[[2,13,16,19]])}))}},{key:"sendByHttp",value:function(e){var t,r,n=e.body;return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function e(){var i,o,s,a;return _regeneratorRuntime$6().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createSendData(n);case 2:return o=e.sent,context.logger.debug("send-by-http",getMsgStringFlag(n)),s=concat$3(i="/v2/bytesync/api/pipeline?device_id=".concat(context.option.did,"&platform=0&aid=")).call(i,context.option.aid),e.prev=5,e.next=8,this.http.sendRequest(context.option.apiUrl+s,o);case 8:a=e.sent,this.receive(a),traceMsgSend({send_method:"http",send_result:"success",send_msg_type:getMsgStringFlag(n),ws_connect:null===(t=this.ws)||void 0===t?void 0:t.isOpen()}),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(5),traceMsgSend({send_method:"http",send_result:"failed",send_msg_type:getMsgStringFlag(n),ws_connect:null===(r=this.ws)||void 0===r?void 0:r.isOpen()}),new BaseError({msg:"network error",type:ErrorType.NetworkError,innerError:e.t0,allowRetry:!0,sender:this,ignoreEvent:!0});case 17:case"end":return e.stop()}},e,this,[[5,13]])}))}},{key:"sendByWs",value:function(e){var t,r,n=e.seqId,i=e.body;return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function e(){var o,s,a,l;return _regeneratorRuntime$6().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createSendData(i);case 2:o=e.sent,context.logger.debug("send-by-socket",getMsgStringFlag(i),i),s=serialize(o),a=context.option.frontier,l=sync_proto.Frame.create({service:a.service,method:a.method,seqid:long__WEBPACK_IMPORTED_MODULE_2__.A.fromNumber(n),logid:long__WEBPACK_IMPORTED_MODULE_2__.A.fromNumber(now()),payload_type:"2",payload:s}),e.prev=7,this.ws.send(serializeFrame(l)),traceMsgSend({send_method:"socket",send_result:"success",send_msg_type:getMsgStringFlag(i),ws_connect:null===(t=this.ws)||void 0===t?void 0:t.isOpen()}),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(7),traceMsgSend({send_method:"socket",send_result:"failed",send_msg_type:getMsgStringFlag(i),ws_connect:null===(r=this.ws)||void 0===r?void 0:r.isOpen()}),new BaseError({msg:"network error",type:ErrorType.NetworkError,innerError:e.t0,allowRetry:!0,sender:this});case 16:return e.abrupt("return",promise.resolve(!0));case 17:case"end":return e.stop()}},e,this,[[7,12]])}))}},{key:"receiveRaw",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function e(){var r,n,i,o,s,a;return _regeneratorRuntime$6().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t[0],n=t[1],e.prev=2,(i=deserializeFrame(r)).service===settings.downstreamServiceID){e.next=7;break}return context.logger.warn(concat$3(o="WS Response dropped, serviceID must be ".concat(settings.downstreamServiceID,", but received serviceId is ")).call(o,i.service)),e.abrupt("return");case 7:if(null!=(s=i.payload)){e.next=11;break}return context.logger.warn("payload undefined or null"),e.abrupt("return");case 11:if("gzip"!==i.payload_encoding){e.next=16;break}return e.next=15,pako__WEBPACK_IMPORTED_MODULE_6__.Ay.ungzip(s);case 15:s=e.sent;case 16:a=deserialize(s),this.receive(a,n),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),context.logger.warn("WS Response dropped, Frame deserialize fail，received data：",r);case 23:case"end":return e.stop()}},e,this,[[2,20]])}))}},{key:"send",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function r(){var n,i;return _regeneratorRuntime$6().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n=this.getSeqId(),!(i=!(null==t?void 0:t.forceHttps)&&void 0!==this.ws&&this.ws.isOpen())){r.next=7;break}return r.next=5,this.sendByWs(assign({seqId:n},e));case 5:r.next=9;break;case 7:return r.next=9,this.sendByHttp(assign({seqId:n},e));case 9:return r.abrupt("return",promise.resolve({useWs:i}));case 10:case"end":return r.stop()}},r,this)}))}},{key:"receive",value:function(e,t){this.emit("message",e,t)}},{key:"onWsClose",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function e(){return _regeneratorRuntime$6().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.ws.off("open"),context.logger.debug("ws closed");case 2:case"end":return e.stop()}},e,this)}))}},{key:"prepareWs",value:function(){var e=this;this.ws.on("message",function(){return e.receiveRaw.apply(e,arguments)}),this.ws.on("close",function(){return e.onWsClose()}),this.ws.on("error",function(){return e.onWsClose()}),this.ws.on("open",function(){context.logger.debug("ws connected")})}},{key:"closeWs",value:function(){var e;null===(e=this.ws)||void 0===e||e.close()}},{key:"connectWs",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$6().mark(function e(){return _regeneratorRuntime$6().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.closeWs(),e.prev=1,e.next=4,this.ws.open();case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),e.t0;case 9:case"end":return e.stop()}},e,this,[[1,6]])}))}}]),r}();function _arrayWithHoles(e){if(isArray$2(e))return e}function _iterableToArrayLimit(e,t){var r=null==e?null:void 0!==symbol$1&&getIteratorMethod$3(e)||e["@@iterator"];if(null!=r){var n,i,o=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw i}}return o}}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}var DESCRIPTORS=descriptors,uncurryThis=functionUncurryThis,objectKeys=objectKeys$4,toIndexedObject=toIndexedObject$9,$propertyIsEnumerable=objectPropertyIsEnumerable.f,propertyIsEnumerable=uncurryThis($propertyIsEnumerable),push=uncurryThis([].push),createMethod=function(e){return function(t){for(var r,n=toIndexedObject(t),i=objectKeys(n),o=i.length,s=0,a=[];o>s;)r=i[s++],DESCRIPTORS&&!propertyIsEnumerable(n,r)||push(a,e?[r,n[r]]:n[r]);return a}},objectToArray={entries:createMethod(!0),values:createMethod(!1)},$$2=_export,$entries=objectToArray.entries;$$2({target:"Object",stat:!0},{entries:function(e){return $entries(e)}});var path$1=path$l,entries$2=path$1.Object.entries,parent$2=entries$2,entries$1=parent$2,entries=entries$1,$$1=_export,$some=arrayIteration.some,arrayMethodIsStrict=arrayMethodIsStrict$3,STRICT_METHOD=arrayMethodIsStrict("some");$$1({target:"Array",proto:!0,forced:!STRICT_METHOD},{some:function(e){return $some(this,e,arguments.length>1?arguments[1]:void 0)}});var entryVirtual=entryVirtual$b,some$3=entryVirtual("Array").some,isPrototypeOf=objectIsPrototypeOf,method=some$3,ArrayPrototype=Array.prototype,some$2=function(e){var t=e.some;return e===ArrayPrototype||isPrototypeOf(ArrayPrototype,e)&&t===ArrayPrototype.some?method:t},parent$1=some$2,some$1=parent$1,some=some$1,DataType;function _regeneratorRuntime$5(){_regeneratorRuntime$5=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function monitor(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$5().mark(function n(){return _regeneratorRuntime$5().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:context.monitor.send({name:"submit_data",metrics:{time_consuming:now()-r.toNumber(),submit_cnt:t},categories:{business:e}});case 1:case"end":return n.stop()}},n)}))}function eventSubmit(e){var t,r,n,i,o,s,a,l;if(e)try{var c={msg_id:(null===(t=e.extra)||void 0===t?void 0:t.msg_id)||"",msg_req_id:(null===(r=e.extra)||void 0===r?void 0:r.msg_req_id)||"",business_id:(null===(n=e.business)||void 0===n?void 0:n.toNumber())||0,app_id:context.option.aid,device_platform:"web",topic_type:e.topic_type,topic:(0,lodash__WEBPACK_IMPORTED_MODULE_4__.last)((null===(i=e.req_id)||void 0===i?void 0:i.split(":"))||[]),sync_id:e.sync_id.toNumber(),cursor:null===(o=e.sync_cursor)||void 0===o?void 0:o.toNumber(),channel:null===(s=e.extra)||void 0===s?void 0:s.channel,consumer_type:e.consume_type,send_timestamp:null===(a=e.publish_ts)||void 0===a?void 0:a.toNumber(),receive_timestamp:now(),duration:now()-((null===(l=e.receive_ts)||void 0===l?void 0:l.toNumber())||0)};context.monitor.collect("sync_sdk_event_submit",c)}catch(e){context.logger.error("sync_sdk_event_submit error: ",e.stack)}}!function(e){e[e.Origin=0]="Origin",e[e.FilePath=1]="FilePath"}(DataType||(DataType={}));var deletingSyncLogs={};function patchWithSyncIdAndBusinessId(e,t,r){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$5().mark(function e(){var n,i=this;return _regeneratorRuntime$5().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r[0].consume_type,sync_proto.ConsumeType.OneByOne,n=context.businessManager,forEach$1(r).call(r,function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(i,void 0,void 0,_regeneratorRuntime$5().mark(function i(){var o,s,a;return _regeneratorRuntime$5().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=concat$3(o="".concat(e.sync_id.toString(),"_")).call(o,null===(s=e.sync_cursor)||void 0===s?void 0:s.toString()),deletingSyncLogs[a]){i.next=9;break}return n.emit(n.getUniqKey(t),e),deletingSyncLogs[a]=!0,i.next=6,context.db.deleteSyncLogs([e]);case 6:delete deletingSyncLogs[a],monitor(t,r.length,e.receive_ts),eventSubmit(e);case 9:case"end":return i.stop()}},i)}))});case 3:case"end":return e.stop()}},e)}))}function patch(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$5().mark(function t(){var r,n;return _regeneratorRuntime$5().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,context.db.getSyncLogBySyncIds(map$6(e).call(e,function(e){return long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e)}));case 2:n=t.sent,forEach$1(r=entries((0,lodash__WEBPACK_IMPORTED_MODULE_4__.groupBy)(n,"sync_id"))).call(r,function(e){var t,r=_slicedToArray(e,2),n=r[0],i=r[1];forEach$1(t=entries((0,lodash__WEBPACK_IMPORTED_MODULE_4__.groupBy)(i,"business"))).call(t,function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];patchWithSyncIdAndBusinessId(n,r,i)})});case 4:case"end":return t.stop()}},t)}))}function _regeneratorRuntime$4(){_regeneratorRuntime$4=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}sync_proto.BsyncHeader;var Bucket$1=sync_proto.Bucket,DataHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"canHandle",value:function(e){return e===sync_proto.Flag.Data}},{key:"handle",value:function(e,t){var r,n=this,i=e.header,o=e.topics,s=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.groupBy)(o,"sync_id"),a=map$6(r=entries(s)).call(r,function(e){var r=_slicedToArray(e,2),o=r[0],s=r[1];return n.dealWithTopic(long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(o),i,s,t)});promise.all(a).then(function(e){if(patch(keys(s)),some(e).call(e,function(e){return e}))return n.refreshSync();n.continuePoll()})}},{key:"dealWithTopic",value:function(e,t,r,n){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$4().mark(function i(){var o,s,a,l,c,u,d,h,p;return _regeneratorRuntime$4().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(o=context.db,this.processedCursor){i.next=5;break}return i.next=4,o.getSyncCursor(e);case 4:this.processedCursor=i.sent;case 5:if(null!==this.processedCursor){i.next=9;break}return context.logger.error("".concat(e," can't be found in local db")),context.monitor.send({name:"cursor_not_found",categories:{syncId:e.toString(),time:now().toString()}}),i.abrupt("return",!0);case 9:if(this.ensureSyncCursor(e,t,this.processedCursor)){i.next=12;break}return context.monitor.send({name:"cursor_not_found",categories:{syncId:e.toString(),time:now().toString(),type:t.did!==this.processedCursor.did?"did":"uid",receive_did:t.did||"",local_did:this.processedCursor.did||"",receive_uid:t.uid||"",local_uid:this.processedCursor.uid||""}}),i.abrupt("return",!0);case 12:s=_createForOfIteratorHelper((0,lodash__WEBPACK_IMPORTED_MODULE_4__.sortBy)(r,"ref_cursor")),i.prev=13,s.s();case 15:if((a=s.n()).done){i.next=30;break}if(!(l=a.value).ref_cursor.lte(this.processedCursor.recv_cursor||0)){i.next=27;break}return i.next=20,this.patchAndSave(e,this.processedCursor,t,l,n);case 20:c=i.sent,u=c.success,d=c.cursor,u&&null!==d||context.logger.error("patchAndSave failed. break process data"),this.processedCursor=d,i.next=28;break;case 27:context.logger.error(concat$3(h=concat$3(p="".concat(l.ref_cursor," > ")).call(p,this.processedCursor.recv_cursor,", server cursor > db cursor when patch syncId = ")).call(h,e));case 28:i.next=15;break;case 30:i.next=35;break;case 32:i.prev=32,i.t0=i.catch(13),s.e(i.t0);case 35:return i.prev=35,s.f(),i.finish(35);case 38:case"end":return i.stop()}},i,this,[[13,32,35,38]])}))}},{key:"ensureSyncCursor",value:function(e,t,r){var n,i;return t.did!==r.did?(context.logger.error(concat$3(n="did not match. server.did = ".concat(t.did,", local.did = ")).call(n,r.did)),!1):r.bucket!==Bucket$1.User||t.uid===r.uid||(context.logger.error(concat$3(i="uid not match. server.uid = ".concat(t.uid,", local.uid = ")).call(i,r.uid)),!1)}},{key:"patchAndSave",value:function(e,t,r,n,i){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$4().mark(function o(){var s,a,l,c,u=this;return _regeneratorRuntime$4().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(a=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.sortBy)(filter(s=n.packets).call(s,function(e){return e.cursor.cursor.gt(t.recv_cursor||0)}),function(e){return e.cursor.cursor}),context.logger.info("patchAndSave ->",a),l=[],forEach$1(a).call(a,function(t){u.monitorReceive(e,t,n),u.eventReceive(t,n,i);var o=t.payload;(t.extra||{}).channel=i?"0":"1";var s={business:long__WEBPACK_IMPORTED_MODULE_2__.A.fromInt(o.business),consume_type:o.consume_type,sync_id:e,md5:o.md5,publish_ts:t.ts,receive_ts:long__WEBPACK_IMPORTED_MODULE_2__.A.fromNumber(now()),sync_cursor:t.cursor.cursor,did:r.did,uid:r.uid,bucket:n.bucket,req_id:n.req_id,topic_type:n.topic_type,extra:t.extra,packet_status:t.status};null===o.data?(s.data=new Uint8Array([]),s.data_type=DataType.Origin):(s.data=o.data,s.data_type=DataType.Origin),l.push(s)}),(c=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.cloneDeep)(t)).recv_cursor=n.new_cursor,!(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(l)){o.next=9;break}return context.logger.debug("sync logs is empty,throw it ,syncId = ".concat(e)),o.abrupt("return",{success:!0,cursor:t});case 9:return context.logger.debug("save sync_logs to db :",c,l),o.next=12,context.db.insertSyncLogsAndCursor(l,c);case 12:return o.abrupt("return",{success:!0,cursor:c});case 13:case"end":return o.stop()}},o)}))}},{key:"continuePoll",value:function(){context.logger.info("handle data finished. continue poll again..."),msgSender.sendPollMsg()}},{key:"refreshSync",value:function(){context.logger.info("got some unrecognized message, try to get new sync ids"),msgSender.sendSyncMsg()}},{key:"monitorReceive",value:function(e,t,r){var n;context.monitor.send({name:"sync_sdk_receive_data",categories:{topic:r.topic_type.toString()},metrics:{time_consuming:now()-t.ts.toNumber(),receive_cnt:1},content:{sync_id:e.toString(),business:(null===(n=null==t?void 0:t.payload)||void 0===n?void 0:n.business)||0}})}},{key:"eventReceive",value:function(e,t,r){var n,i,o,s,a,l,c=e.extra;if(e.extra&&"1"===e.extra.hit_sampling)try{var u={msg_id:(null==c?void 0:c.msg_id)||"",msg_req_id:(null==c?void 0:c.msg_req_id)||"",business_id:Number(null===(n=e.payload)||void 0===n?void 0:n.business),app_id:context.option.aid,device_platform:"web",topic_type:t.topic_type,topic:(0,lodash__WEBPACK_IMPORTED_MODULE_4__.last)((null===(i=t.req_id)||void 0===i?void 0:i.split(":"))||[]),sync_id:null===(o=t.sync_id)||void 0===o?void 0:o.toNumber(),cursor:e.cursor.cursor.toNumber(),channel:r?"0":"1",consumer_type:null===(s=e.payload)||void 0===s?void 0:s.consume_type,send_timestamp:null===(a=e.ts)||void 0===a?void 0:a.toNumber(),receive_timestamp:now(),duration:((null===(l=e.ts)||void 0===l?void 0:l.toNumber())||0)-now()};context.monitor.collect("sync_sdk_event_receive",u)}catch(e){context.logger.error("eventReceive error: ",e.stack)}}}]),e}();function _regeneratorRuntime$3(){_regeneratorRuntime$3=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Ctrl$1=sync_proto.Ctrl,HttpPollHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"canHandle",value:function(e){return e===Ctrl$1.HttpPoll}},{key:"handle",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$3().mark(function e(){return _regeneratorRuntime$3().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:msgSender.sendPollMsg(!0);case 1:case"end":return e.stop()}},e)}))}}]),e}();function _regeneratorRuntime$2(){_regeneratorRuntime$2=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var Flag$1=sync_proto.Flag,ReportAckHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"canHandle",value:function(e){return e===Flag$1.ACK}},{key:"handle",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$2().mark(function t(){var r,n;return _regeneratorRuntime$2().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.topics,n=map$6(r).call(r,function(e){return context.db.deleteUploadData(e.sync_id,e.new_cursor)}),t.next=4,promise.all(n);case 4:msgSender.sendBizData();case 5:case"end":return t.stop()}},t)}))}}]),e}(),$=_export,$values=objectToArray.values;$({target:"Object",stat:!0},{values:function(e){return $values(e)}});var path=path$l,values$2=path.Object.values,parent=values$2,values$1=parent,values=values$1;function _regeneratorRuntime$1(){_regeneratorRuntime$1=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var TopicType=sync_proto.TopicType,TopicStatus=sync_proto.TopicStatus,Flag=sync_proto.Flag,Bucket=sync_proto.Bucket;sync_proto.BsyncCursor;var SyncHandler=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"canHandle",value:function(e){return e===Flag.Sync}},{key:"handle",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$1().mark(function t(){var r,n,i,o,s,a;return _regeneratorRuntime$1().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.header,n=e.topics,t.next=3,this.transform(r,n);case 3:i=t.sent,o=i.pendingDeleteSyncId,s=i.pendingSaveOrUpdate,a=i.businesses,context.db.updateSyncCursorAndBusiness(s,o,a),context.compensator.onReceivedSync(),msgSender.sendPollMsg();case 10:case"end":return t.stop()}},t,this)}))}},{key:"transform",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime$1().mark(function r(){var n,i,o,s,a,l,c,u,d,h,p,f,_=this;return _regeneratorRuntime$1().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.uniq)(map$6(t).call(t,function(e){return e.topic_type})),l=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.keyBy)(filter(t).call(t,function(e){return e.topic_type!==TopicType.CustomTopic||e.topic_status===TopicStatus.Active}),"sync_id"),c=keys(l),r.next=5,context.db.getSyncCursorsByDeviceInfo(e.did,e.uid);case 5:return u=r.sent,d=map$6(n=filter(i=filter(u).call(u,function(e){return includes(a).call(a,e.topic_type)})).call(i,function(e){return!includes(c).call(c,String(e.sync_id))})).call(n,function(e){return e.sync_id}),h=(0,lodash__WEBPACK_IMPORTED_MODULE_4__.keyBy)(u,"sync_id"),p=map$6(o=entries(l)).call(o,function(t){var r=_slicedToArray(t,2),n=r[0],i=r[1],o=h[n]||{};return _.bindSyncCursor(o,i,e)}),f=[],map$6(s=values(l)).call(s,function(e){var t;null===(t=e.packets)||void 0===t||forEach$1(t).call(t,function(t){null!==t&&t.payload&&f.push({id:t.payload.business,bucket:e.bucket,consume_type:t.payload.consume_type})})}),r.abrupt("return",{pendingDeleteSyncId:d,pendingSaveOrUpdate:p,businesses:f});case 12:case"end":return r.stop()}},r)}))}},{key:"bindSyncCursor",value:function(e,t,r){return e.sync_id=t.sync_id,e.did=String(r.did),e.uid=t.bucket===Bucket.Device?"0":String(r.uid),e.bucket=t.bucket,e.topic_type=t.topic_type,t.ref_cursor&&e.report_cursor&&t.ref_cursor.gt(e.report_cursor||0)&&(e.report_cursor=t.ref_cursor),e}}]),e}(),Ctrl=sync_proto.Ctrl,ProtocolProcessor=function(){function e(){_classCallCheck(this,e),this.flagHandlers=[new SyncHandler,new DataHandler,new ReportAckHandler],this.ctrlHandlers=[new HttpPollHandler]}return _createClass(e,[{key:"dispatchByCtrl",value:function(e){var t,r=_createForOfIteratorHelper(this.ctrlHandlers);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.canHandle(e.header.ctrl)&&n.handle(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"dispatchByFlag",value:function(e,t){var r=this,n=e.topics||[];if((0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(n))context.logger.info("topic is empty");else{var i=[],o=n[0].flag;forEach$1(n).call(n,function(n){n.flag===o?i.push(n):(o&&!(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(i)&&r.dispatch(o,e.header,i,t),o=n.flag,i=[n])}),(0,lodash__WEBPACK_IMPORTED_MODULE_4__.isEmpty)(i)||this.dispatch(o,e.header,i,t)}}},{key:"dispatch",value:function(e,t,r,n){var i,o=_createForOfIteratorHelper(this.flagHandlers);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.canHandle(e)&&s.handle({header:t,topics:r},n)}}catch(e){o.e(e)}finally{o.f()}}},{key:"process",value:function(e,t){null!==e.header.ctrl&&e.header.ctrl!==Ctrl.Default&&this.dispatchByCtrl(e),this.dispatchByFlag(e,t)}}]),e}();function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=defineProperty$3||function(e,t,r){e[t]=r.value},i="function"==typeof symbol?symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return defineProperty$3(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=create$9(o.prototype),a=new k(i||[]);return n(s,"_invoke",{value:b(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=getPrototypeOf$1&&getPrototypeOf$1(getPrototypeOf$1(T([])));y&&y!==t&&r.call(y,o)&&(_=y);var g=f.prototype=h.prototype=create$9(_);function m(e){var t;forEach$1(t=["next","throw","return"]).call(t,function(t){l(e,t,function(e){return this._invoke(t,e)})})}function v(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==_typeof(d)&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function b(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],forEach$1(e).call(e,C,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=f,n(g,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return setPrototypeOf$1?setPrototypeOf$1(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=create$9(g),e},e.awrap=function(e){return{__await:e}},m(v.prototype),l(v.prototype,s,function(){return this}),e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},m(g),l(g,a,"Generator"),l(g,o,function(){return this}),l(g,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return reverse(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=T,k.prototype={constructor:k,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,forEach$1(t=this.tryEntries).call(t,E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+slice(n).call(n,1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;E(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}var SyncSdk=function(){function e(t,r){var n=this;_classCallCheck(this,e),this.disposed=!1,this.plugins=[],t.headers||(t.headers={}),t.httpHeaders||(t.httpHeaders={}),t.boe?("string"==typeof(t=applyDefaultBoe(t)).boe&&(t.headers[SdkConsts.envKey]=t.boe,t.headers[SdkConsts.boeHeaderKey]="1",t.httpHeaders[SdkConsts.envKey]=t.boe,t.httpHeaders[SdkConsts.boeHeaderKey]="1"),"boolean"==typeof t.boe&&(t.headers[SdkConsts.boeHeaderKey]="1",t.httpHeaders[SdkConsts.boeHeaderKey]="1")):"string"==typeof(t=applyDefault(t)).ppe?(t.headers[SdkConsts.envKey]=t.ppe,t.headers[SdkConsts.ppeHeaderKey]="1",t.httpHeaders[SdkConsts.envKey]=t.ppe,t.httpHeaders[SdkConsts.ppeHeaderKey]="1"):t.canary&&(t.headers[SdkConsts.envKey]="canary",t.httpHeaders[SdkConsts.envKey]="canary"),this.processor=new ProtocolProcessor,context.option=t,context.db=new Database,context.businessManager=new BusinessManager,context.logger=new Logger,context.monitor=new SyncMonitor(t.monitor),this.compensator=new Compensator,context.compensator=this.compensator,optionCheck(t);var i=new NetworkManager(t.httpClient,t.wsClient);i.on("message",function(e,t){return n.receivePacket(e,t)}),context.network=i,isArray(r)&&forEach$1(r).call(r,function(e){var t=new e;t.preInstall(n,context),t.install(),n.plugins.push(t)}),context.plugin=this.plugins}return _createClass(e,[{key:"getContext",value:function(){return context}},{key:"init",value:function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.initResult=InitResult.Start,e.prev=1,e.next=4,context.network.connectWs();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),context.logger.warn("skip websocket, init open fail:",e.t0);case 9:return context.monitor.init(),this.compensator.start(),this.initResult=InitResult.Succeeded,context.initResult=InitResult.Succeeded,msgSender.sendSyncMsg(),e.abrupt("return",this.initResult);case 15:case"end":return e.stop()}},e,this,[[1,6]])}))}},{key:"registerBusiness",value:function(e,t){context.businessManager.registerBusiness(e,t)}},{key:"sendData",value:function(e,t){msgSender.sendBizData(long__WEBPACK_IMPORTED_MODULE_2__.A.fromString(e),new Uint8Array(function(e){var t=0,r=e.length,n=new Array(r);for(t=0;t<r;++t)n[t]=255&e.charCodeAt(t);return new Uint8Array(n).buffer}(t)))}},{key:"changeAccount",value:function(e){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime().mark(function t(){var r,n=this;return _regeneratorRuntime().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return context.option.uid=e.uid,context.option.did=e.did,context.option.frontier&&e.sid&&(context.option.frontier.sid=e.sid),t.next=5,context.network.closeWs();case 5:return r=context.option,context.network=new NetworkManager(r.httpClient,r.wsClient),context.network.on("message",function(e,t){return n.receivePacket(e,t)}),t.next=10,context.network.connectWs();case 10:return t.next=12,msgSender.sendSyncMsg();case 12:case"end":return t.stop()}},t)}))}},{key:"dispose",value:function(){var e,t;context.network.closeWs(),null===(t=context.network.ws)||void 0===t||t.dispose(),context.network.clearAll();var r,n=_createForOfIteratorHelper(this.plugins);try{for(n.s();!(r=n.n()).done;)r.value.dispose()}catch(e){n.e(e)}finally{n.f()}forEach$1(e=this.plugins).call(e,function(e){return e.dispose()}),this.plugins=[],context.option.monitor=void 0,this.disposed=!0,context.logger.warn("sdk unloaded, do not invoke this instance")}},{key:"receivePacket",value:function(e,t){return(0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(this,void 0,void 0,_regeneratorRuntime().mark(function r(){var n,i,o;return _regeneratorRuntime().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(this.initResult===InitResult.Succeeded){r.next=2;break}return r.abrupt("return");case 2:n=_createForOfIteratorHelper(this.plugins),r.prev=3,n.s();case 5:if((i=n.n()).done){r.next=11;break}return o=i.value,r.next=9,o.receivePacket(e);case 9:r.next=5;break;case 11:r.next=16;break;case 13:r.prev=13,r.t0=r.catch(3),n.e(r.t0);case 16:return r.prev=16,n.f(),r.finish(16);case 19:context.logger.debug("receive-packet",getMsgStringFlag(e),e),this.processor.process(e,t);case 21:case"end":return r.stop()}},r,this,[[3,13,16,19]])}))}}]),e}(),oci={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};function r(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function n(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var i=function(e){return JSON.stringify({ev_type:"batch",list:e})},o=["init","start","config","beforeDestroy","provide","beforeReport","report","beforeBuild","build","beforeSend","send","beforeConfig"],s=function(){return{}};function a(e){return e}function l(e){return"object"==typeof e&&null!==e}var c=Object.prototype;function u(e){if(l(e)){if("function"==typeof Object.getPrototypeOf){var t=Object.getPrototypeOf(e);return t===c||null===t}return"[object Object]"===c.toString.call(e)}return!1}function d(e){return"[object Array]"===c.toString.call(e)}function h(e){return"function"==typeof e}function p(e){return"number"==typeof e}function f(e){return"string"==typeof e}function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function y(e,r){var n=t({},e);for(var i in r)_(r,i)&&void 0!==r[i]&&(l(r[i])&&u(r[i])?n[i]=y(l(e[i])?e[i]:{},r[i]):d(r[i])&&d(e[i])?n[i]=g(e[i],r[i]):n[i]=r[i]);return n}function g(e,t){var r=d(e)?e:[],n=d(t)?t:[];return Array.prototype.concat.call(r,n).map(function(e){return e instanceof RegExp?e:l(e)&&u(e)?y({},e):d(e)?g([],e):e})}function m(e,t){if(!d(e))return!1;if(0===e.length)return!1;for(var r=0;r<e.length;){if(e[r]===t)return!0;r++}return!1}var v=function(e,t){if(!d(e))return e;var r=e.indexOf(t);if(r>=0){var n=e.slice();return n.splice(r,1),n}return e},b=function(e,t,n){for(var i,o=r(t.split(".")),s=o[0],a=o.slice(1);e&&a.length>0;)e=e[s],s=(i=r(a))[0],a=i.slice(1);if(e)return n(e,s)},w=function(e,t,r){return b(e,t,function(e,t){if(e&&t in e&&h(e[t]))try{return e[t].apply(e,r)}catch(e){return}})},C=function(e,t){var r=function(e){return d(e)&&e.length?function(e){for(var t=[],r=e.length,n=0;n<r;n++){var i=e[n];f(i)?t.push(i.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")):i&&i.source&&t.push(i.source)}return new RegExp(t.join("|"),"i")}(e):null}(e||[]);return!!r&&r.test(t)};function E(e){try{return f(e)?e:JSON.stringify(e)}catch(e){return"[FAILED_TO_STRINGIFY]:"+String(e)}}var k=function(e,t,i,o){return void 0===o&&(o=!0),function(){for(var a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];if(!e)return s;var c=e[t],u=i.apply(void 0,n([c],r(a),!1)),d=u;return h(d)&&o&&(d=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return u.apply(this,e)}catch(t){return h(c)&&c.apply(this,e)}}),e[t]=d,function(r){r||(d===e[t]?e[t]=c:u=c)}}},T=function(e,t,i){return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!e)return s;var l=e[t],c=i.apply(void 0,n([l],r(o),!1)),u=c;return h(u)&&(u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c.apply(this,e)}),e[t]=u,function(){u===e[t]?e[t]=l:c=l}}},S="".padStart?function(e,t){return void 0===t&&(t=8),e.padStart(t," ")}:function(e){return e},O=0,A=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,n(["[SDK]",Date.now(),S(""+O++)],r(e),!1))},$=0,P=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,n(["[SDK]",Date.now(),S(""+$++)],r(e),!1))},R=function(e){return Math.random()<Number(e)},x=function(e,t){return e<Number(t)},L=function(e){return function(t){for(var r=t,n=0;n<e.length&&r;n++)try{r=e[n](r)}catch(e){A(e)}return r}};function I(){var e=function(){for(var e=new Array(16),t=0,r=0;r<16;r++)!(3&r)&&(t=4294967296*Math.random()),e[r]=t>>>((3&r)<<3)&255;return e}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,function(e){for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);var n=0,i=t;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}(e)}var M=function(e,t){var r=[];try{r=t.reduce(function(t,r){try{var n=r(e);"function"==typeof n&&t.push(n)}catch(e){}return t},[])}catch(e){}return function(e){return M(e,r)}},D=function(e,t,r){var n=function(e){void 0===e&&(e=3e5);var t,r=[],n=[],i=!1,o=function(e,t,r){var n=0;return-1===r?s:function(){if(e())return n&&clearTimeout(n),void(n=0);0===n&&(n=setTimeout(t,r))}}(function(){return!!r.length},function(){i=!0,t&&t[0](),n.forEach(function(e){return e()}),n.length=0,t=void 0},e),a=function(e){r=v(r,e),!i&&o()};return{next:function(e){return M(e,r)},complete:function(e){n.push(e)},attach:function(e,r){t=[e,r]},subscribe:function(e){if(i)throw new Error("Observer is closed");return r.push(e),t&&t[1]&&t[1](e),o(),function(){return a(e)}},unsubscribe:a}}(r);try{e(n.next,n.attach),t&&n.complete(t)}catch(e){}return[n.subscribe,n.unsubscribe]},B=function(e,t){var n=r(e,1)[0];return function(e,r){var i=n(function(r){var n;return(n=t,function(e){for(var t=!0,r=0;r<n.length&&t;r++)try{t=n[r](e)}catch(e){A(e)}return t})(r)?e(r):s});r(function(){i()})}},N=function(e,t,r,n){return e.destroyAgent.set(t,r,n)};function j(e){var t,i,s=e.builder,a=e.createSender,c=e.createDefaultConfig,u=e.createConfigManager,d=e.userConfigNormalizer,h=e.initConfigNormalizer,p=e.validateInitConfig,f={};o.forEach(function(e){return f[e]=[]});var _=!1,y=!1,g=!1,b=[],w=[],C=function(){var e=!1,t={},r=function(e){e.length&&e.forEach(function(e){try{e()}catch(e){}}),e.length=0},n=function(e){t[e]&&t[e].forEach(function(e){r(e[1])}),t[e]=void 0};return{set:function(n,i,o){t[n]?t[n].push([i,o]):t[n]=[[i,o]],e&&r(o)},has:function(e){return!!t[e]},remove:n,removeByEvType:function(e){Object.keys(t).forEach(function(n){t[n]&&t[n].forEach(function(t){t[0]===e&&r(t[1])})})},clear:function(){e=!0,Object.keys(t).forEach(function(e){n(e)})}}}(),E={getBuilder:function(){return s},getSender:function(){return t},getPreStartQueue:function(){return b},init:function(e){if(_)P("already inited");else{if(!(e&&l(e)&&p(e)))throw new Error("invalid InitConfig, init failed");var r=c(e);if(!r)throw new Error("defaultConfig missing");var n=h(e);if((i=u(r)).setConfig(n),i.onChange(function(){k("config")}),!(t=a(i.getConfig())))throw new Error("sender missing");_=!0,k("init",!0)}},set:function(e){_&&e&&l(e)&&(k("beforeConfig",!1,e),null==i||i.setConfig(e))},config:function(e){if(_)return e&&l(e)&&(k("beforeConfig",!1,e),null==i||i.setConfig(d(e))),null==i?void 0:i.getConfig()},provide:function(e,t){m(w,e)?P("cannot provide "+e+", reserved"):(E[e]=t,k("provide",!1,e))},start:function(){var e=this;_&&(y||null==i||i.onReady(function(){y=!0,k("start",!0),b.forEach(function(t){return e.build(t)}),b.length=0}))},report:function(e){if(e){var t=L(f.beforeReport)(e);if(t){var r=L(f.report)(t);r&&(y?this.build(r):b.push(r))}}},build:function(e){if(y){var t=L(f.beforeBuild)(e);if(t){var r=s.build(t);if(r){var n=L(f.build)(r);n&&this.send(n)}}}},send:function(e){if(y){var r=L(f.beforeSend)(e);r&&(t.send(r),k("send",!1,r))}},destroy:function(){C.clear(),g=!0,b.length=0,k("beforeDestroy",!0)},on:function(e,t){if("init"===e&&_||"start"===e&&y||"beforeDestroy"===e&&g)try{t()}catch(e){}else f[e]&&f[e].push(t)},off:function(e,t){f[e]&&(f[e]=v(f[e],t))},destroyAgent:C};return w=Object.keys(E),E;function k(e,t){void 0===t&&(t=!1);for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];f[e].forEach(function(e){try{e.apply(void 0,n([],r(i),!1))}catch(e){}}),t&&(f[e].length=0)}}function U(e,t){return e.initSubject(t)}function V(e,t,n){var i=r(t,2),o=i[0],s=i[1],a=e.privateSubject||{};return a[o]||(a[o]=D(s,function(){a[o]=void 0},n)),a[o]}var F=function(){return Date.now()};function H(){if("object"==typeof window&&l(window))return window}function G(){if("object"==typeof document&&l(document))return document}function W(){return H()&&window.location}function q(e){var t=G();if(!t||!e)return"";var r=t.createElement("a");return r.href=e,r.href}function K(e){var t=G();if(!t||!e)return{url:e,protocol:"",domain:"",query:"",path:"",hash:""};var r=t.createElement("a");r.href=e;var n=r.pathname||"/";return"/"!==n[0]&&(n="/"+n),{url:r.href,protocol:r.protocol.slice(0,-1),domain:r.hostname,query:r.search.substring(1),path:n,hash:r.hash}}function z(){var e=H()&&W();return e?e.href:""}var Z=function(e){var t,r={pid:(t=e.config()).pid,view_id:t.viewId,url:z()};return r.context=e.context?e.context.toString():{},r},Y=function(e,r){void 0===r&&(r=!1);var n=Z(e);return r&&(n.timestamp=F()),function(r){e.report(t(t({},r),{overrides:n}))}},X=function(e){return function(t,r){var n=Z(e);r(s,function(e){n&&e(n)})}},Q=function(e){if(e)return e.__SLARDAR_REGISTRY__||(e.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[],subject:{}}}),e.__SLARDAR_REGISTRY__.Slardar},J=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Q(H());r&&(r.errors||(r.errors=[]),r.errors.push(e))},ee=function(e){var t={url:z(),timestamp:F()},r=e.config();return(null==r?void 0:r.pid)&&(t.pid=r.pid),(null==e?void 0:e.context)&&(t.context=e.context.toString()),t},te=function(e,t){return function(r){var n=function(e){return e.overrides=t,e};e.on("report",n),r(),e.off("report",n)}},re=function(e,t,r,n){return void 0===n&&(n=!1),e.addEventListener(t,r,n),function(){e.removeEventListener(t,r,n)}},ne=function(e,t,r,n){return void 0===n&&(n=!1),e.addEventListener(t,r,n),function(){e.removeEventListener(t,r,n)}},ie=function(e){var t=!1;return[function(r){t||(t=!0,e&&e(r))}]},oe=function(e,t){var r,n=G();if(n){var i=n.createElement("script");i.src=e,i.crossOrigin="anonymous",i.onload=t,null===(r=n.head)||void 0===r||r.appendChild(i)}},se=function(e,r){return l(e)?t(t({},r),e):!!e&&r},ae=function(){return!!btoa&&!!atob},le=function(e){try{var t=localStorage.getItem(e),r=t;t&&"string"==typeof t&&(r=JSON.parse(function(e){return ae()?decodeURI(atob(e)):e}(t)));var n=r,i=n.expires,o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(n,["expires"]);return i>=F()?o:void 0}catch(e){return}},ce=function(e,r,n){var i;if(!(n<=0))try{localStorage.setItem(e,(i=JSON.stringify(t(t({},r),{expires:F()+n})),ae()?btoa(encodeURI(i)):i))}catch(e){}},ue=function(e){return!1===e?0:!0!==e&&void 0!==e&&p(e)?e:7776e6},de=function(){var e=new RegExp("\\/monitor_web\\/collect|\\/monitor_browser\\/collect\\/batch","i");return function(t){return e.test(t)}},he=function(e){return function(){for(var t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return t=r(n,2),this._method=t[0],this._url=t[1],e.apply(this,n)}},pe=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._reqHeaders=this._reqHeaders||{};var i=r(t,2),o=i[0],s=i[1];return this._reqHeaders[o]=s,e&&e.apply(this,t)}},fe=function(e,t){var r=de();return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return this._start=F(),this._data=null==n?void 0:n[0],r(this._url)||function(e,t){return T(e,"onreadystatechange",function(r){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return 4===this.readyState&&t(e),r&&r.apply(this,n)}})}(this,t([this._method,this._url,this._start,this]))(),e.apply(this,n)}},_e=function(e){return function(t,r){if(e){var n=[];n.push(T(e,"open",he)()),n.push(T(e,"setRequestHeader",pe)()),n.push(T(e,"send",fe)(t)),r(function(){n.forEach(function(e){return e()})})}}},ye=function(e,t){return function(r,n){void 0===n&&(n={});var i=t([r,n]),o=e(r,n);return o.then(function(e){i(e)},function(){i(void 0)}),o}},ge=["fetch_0",function(e,t){var r=H();if(r&&fetch){var n=[];n.push(T(r,"fetch",ye)(e)),t(function(){n.forEach(function(e){return e()})})}}],me=["resource"],ve=["resource_0",function(e,t){var n=function(){if(H()&&h(window.PerformanceObserver))return window.PerformanceObserver}();if(n){var i=de();t(function(e,t,n){var i=r(function(e,t,r){var n=e&&new e(function(e,r){e.getEntries&&e.getEntries().forEach(function(e,n,i){return t(e,n,i,r)})});return[function(t){if(!e||!n)return r;try{n.observe({entryTypes:t})}catch(e){return r}},function(t,i){if(!e||!n)return r;try{var o={type:t,buffered:!0};void 0!==i&&(o.durationThreshold=i),n.observe(o)}catch(e){return r}n.observe({type:t,buffered:!1})},function(){return n&&n.disconnect()}]}(e,t),3),o=i[0],s=i[2];return o(n),s}(n,function(t){!i(t.name)&&e(t)},me))}}],be="pageview",we="session",Ce="js_error",Ee="http",ke="custom",Te="action",Se={sampleRate:1,origins:[]},Oe=function(){var e=window&&(window.crypto||window.msCrypto);if(void 0!==e&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t);var r=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return r(t[0])+r(t[1])+r(t[2])+r(t[3])+r(t[4])+r(t[5])+r(t[6])+r(t[7])}return"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(){return(16*Math.random()|0).toString(16)})},Ae=function(e){var t=se(e,Se);if(t&&R(t.sampleRate))return function(e,r){var n=t.origins;n.length&&C(n,e)&&r("traceparent","03-"+Oe()+"-"+Oe().substring(16)+"-01")}},$e=new RegExp("(cookie|auth|jwt|token|key|ticket|secret|credential|session|password)","i"),Pe=new RegExp("(bearer|session)","i"),Re=function(e,t){return!e||!t||$e.test(e)||Pe.test(t)},xe=function(e,r){try{if(r){var n=e.request.url;e.request.url=r(n),e.extra=t(t({},e.extra),{original_url:n})}}catch(e){}},Le=function(e,t,n){var i=r(t,2),o=i[0],a=i[1],l=n.setTraceHeader,c=n.ignoreUrls,u=n.setContextAtReq,d=n.extractUrl;e.push(o[0](function(e){var t=r(e,4);t[0];var i=t[1];t[2];var o=t[3];if(!i)return s;var h=q(i);if(C(c,h))return s;l&&l(h,function(e,t){return o.setRequestHeader(e,t)});var p=u(),f=void 0,_=a()[0](function(e){h===e.name&&!f&&(f=e)});return function(e){var t=Ie(e,n);setTimeout(function(){f&&(t.response.timing=f),xe(t,d),p&&p({ev_type:Ee,payload:t}),_()},100)}}))},Ie=function(e,t){var n,i=e._method,o=e._reqHeaders,s=e._url,a=e._start,l=e._data,c={api:"xhr",request:{url:q(s),method:(i||"").toLowerCase(),headers:o&&(n=o,Object.keys(n).reduce(function(e,t){return!Re(t,n[t])&&(e[t.toLowerCase()]=n[t]),e},{})),timestamp:a},response:{status:e.status||0,is_custom_error:!1,timestamp:F()},duration:F()-a};"function"==typeof e.getAllResponseHeaders&&(c.response.headers=function(e){return f(e)&&e?e.split("\r\n").reduce(function(e,t){if(f(t)){var n=r(t.split(": "),2),i=n[0],o=n[1];!Re(i,o)&&(e[i.toLowerCase()]=o)}return e},{}):{}}(e.getAllResponseHeaders()));var u=c.response.status,d=t.collectBodyOnError,h=t.extraExtractor;try{var p=null==h?void 0:h(e.response,c,l);p&&(c.extra=p),p&&(c.response.is_custom_error=!0),d&&(p||u>=400)&&(c.request.body=l?""+l:void 0,c.response.body=e.response?""+e.response:void 0)}catch(e){}return c},Me={autoWrap:!0,setContextAtReq:function(){return a},ignoreUrls:[],collectBodyOnError:!1},De=function(e,t,n){var i=r(t,2),o=i[0],a=i[1],l=n.setTraceHeader,c=n.ignoreUrls,u=n.setContextAtReq,d=n.extractUrl,h=window.Headers,p=window.Request;p&&h&&e.push(o[0](function(e){var t=r(e,2),i=t[0],o=t[1],f=q(i instanceof p?i.url:i);if(!Be(f)||C(c,f))return s;l&&l(f,function(e,t){return je(e,t,i,o,p,h)});var _=u(),y=F(),g=void 0,m=a()[0](function(e){f===e.name&&!g&&(g=e)});return function(e){var t,r,s=He(i,o,e,p,h,n,y),a=(t=function(e){g&&(e.response.timing=g),xe(e,d),_&&_({ev_type:Ee,payload:e}),m()},r=!1,function(e){r||(r=!0,t(e))});setTimeout(function(){a(s)},1e3)}}))},Be=function(e){if(!f(e))return!1;var t=r(e.split(":"),2),n=t[0];return!t[1]||"http"===n||"https"===n},Ne=function(e,t){return e instanceof t},je=function(e,r,n,i,o,s){var a;Ne(n,o)?n.headers.set(e,r):i.headers instanceof s?i.headers.set(e,r):i.headers=t(t({},i.headers),((a={})[e]=r,a))},Ue=function(e,t,r){var n=t&&t.method||"get";return Ne(e,r)&&(n=e.method||n),n.toLowerCase()},Ve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];try{return t.reduce(function(t,r){return new e(r||{}).forEach(function(e,r){return!Re(r,e)&&(t[r]=e)}),t},{})}catch(e){return{}}},Fe=function(e,t,r){return Ne(e,r)?e.body:null==t?void 0:t.body},He=function(e,t,r,n,i,o,a){var l={api:"fetch",request:{method:Ue(e,t,n),timestamp:a,url:q(e instanceof n?e.url:e),headers:Ve(i,e.headers,t.headers)},response:{status:r&&r.status||0,is_custom_error:!1,timestamp:F()},duration:F()-a},c=o.collectBodyOnError,u=o.extraExtractor,d=function(){var r;c&&(l.request.body=null===(r=Fe(e,t,n))||void 0===r?void 0:r.toString())};if(r)try{var h=Ve(i,r.headers);l.response.headers=h;try{-1!==(h["content-type"]||"").indexOf("application/json")&&u&&r.clone().json().then(function(r){var i,o=u(r,l,null===(i=Fe(e,t,n))||void 0===i?void 0:i.toString());o&&(l.extra=o,l.response.is_custom_error=!0,d())}).catch(s)}catch(e){}r.status>=400&&d()}catch(e){}else d();return l},Ge={autoWrap:!0,setContextAtReq:function(){return a},ignoreUrls:[],collectBodyOnError:!1},We=["name","message","stack","filename","lineno","colno"],qe=function(e){var t;return function(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMError]":case"[object DOMException]":return!0;default:return e instanceof Error}}(e)?t=function(e,t){return e&&l(e)?t.reduce(function(t,r){return t[r]=e[r],t},{}):e}(e,We):(u(e)||"undefined"!=typeof Event&&function(e,t){try{return e instanceof t}catch(e){return!1}}(e,Event)||f(e))&&(t={message:E(e)}),t},Ke=function(e){return r=e,"[object ErrorEvent]"===Object.prototype.toString.call(r)?function(e){var t=qe(e.error);if(!t)return t;var r=e.colno,n=e.lineno,i=e.filename;return r&&!t.colno&&(t.colno=String(r)),n&&!t.lineno&&(t.lineno=String(n)),i&&!t.filename&&(t.filename=i),t}(e):function(e){return"[object PromiseRejectionEvent]"===Object.prototype.toString.call(e)}(e)?function(e){var r;try{var n=void 0;if("reason"in e?n=e.reason:"detail"in e&&"reason"in e.detail&&(n=e.detail.reason),n){var i=qe(n);return t(t({},i),{name:null!==(r=i&&i.name)&&void 0!==r?r:"UnhandledRejection"})}}catch(e){}}(e):qe(e);var r},ze=function(e){return"hidden"===e.visibilityState},Ze=["hidden_3",function(e,t){var r=G(),n=H();if(r&&n){var i=function(t){e("pagehide"===t.type||ze(r))},o=ne(r,"visibilitychange",i,!0),s=re(n,"pagehide",i,!0);t(function(){o(),s()},function(e){e(ze(r))})}}],Ye=["unload_0",function(e,t){var n=H();if(n){var i=r(ie(e),1)[0],o=function(){i()},s=[];["unload","beforeunload","pagehide"].forEach(function(e){s.push(re(n,e,o,!1))}),t(function(){s.forEach(function(e){return e()})})}}],Xe=["hash_0",function(e,t){var r=H();if(r){var n=re(r,"hashchange",function(){return e(location.href)},!0);t(function(){n()})}}],Qe=["history_0",function(e,t){var r=H()&&window.history,n=H();if(r&&n){var i=[],o=function(){return e(location.href)},s=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{e.apply(r,t)}finally{o()}}};i.push(k(r,"pushState",s)(),k(r,"replaceState",s)()),i.push(re(n,"popstate",o,!0)),t(function(){i.forEach(function(e){return e()})})}}],Je=function(e){return et(e,F())},et=function(e,t){return e+"_"+t},tt=function(e){return"manual"===e},rt=function(e,t){var r=e[0]+e[1]+e[2],n=e[0]/r;return e[2]/r>t.frustrating_threshold?2:n>t.satisfying_threshold||0===r?0:1},nt=function(e,t){return function(r,n){var i=r.payload;switch(r.ev_type){case"performance":var o=i.name;i.isSupport&&e(n.perf_apdex,o,i.value);break;case Te:e(n.perf_apdex,"action",i.duration||0);break;case Ce:t(n.error_weight,0);break;case Ee:if(i.response.is_custom_error||i.response.status>=400)t(n.error_weight,1);else{var s=i.response.timing;s&&e(n.duration_apdex,0,s.duration)}break;case"resource_error":t(n.error_weight,2);break;case"blank_screen":t(n.error_weight,3);break;case"resource":e(n.duration_apdex,1,i.duration);break;case"performance_longtask":i.longtasks.forEach(function(t){e(n.duration_apdex,2,t.duration)})}}},it=function(){var e,t,r=function(){e=[0,0,0],t=function(){var e;return(e={error_count:[0,0,0,0],duration_count:[0,0,0]}).perf_apdex={},e}()};return r(),[function(r,n,i){var o=r&&r[n];if(o&&!(i<=0)){var s=i<(o[0].threshold||0)?0:i>(o[1].threshold||0)?2:1;if(e[s]+=o[s].weight,"string"==typeof n){var a=et(n,s),l=t.perf_apdex[a];t.perf_apdex[a]=(l||0)+1}else 2===s&&(t.duration_count[n]+=1)}},function(r,n){r&&(e[2]+=r[n],t.error_count[n]+=1)},function(){return[e,t]},r]},ot="pageview",st={sendInit:!0,routeMode:"history",apdex:2};function at(e){return(null==e?void 0:e.effectiveType)||(null==e?void 0:e.type)||""}var lt=function(e,t){var r=e.common||{};return r.sample_rate=t,e.common=r,e},ct=function(e,t,r,n,i){return e?(o=i(n,t),function(){return o}):function(){return r(t)};var o},ut=function(e,t){try{return"rule"===t.type?function(e,t,r,n){var i=b(e,t,function(e,t){return e[t]});return void 0!==i&&function(e,t,r){switch(r){case"eq":return m(t,e);case"neq":return!m(t,e);case"gt":return e>t[0];case"gte":return e>=t[0];case"lt":return e<t[0];case"lte":return e<=t[0];case"regex":return Boolean(e.match(new RegExp(t.join("|"))));case"not_regex":return!e.match(new RegExp(t.join("|")));default:return!1}}(i,function(e,t){return e.map(function(e){switch(t){case"number":return Number(e);case"boolean":return"1"===e;default:return String(e)}})}(n,"boolean"==typeof i?"bool":p(i)?"number":"string"),r)}(e,t.field,t.op,t.values):"and"===t.type?t.children.every(function(t){return ut(e,t)}):t.children.some(function(t){return ut(e,t)})}catch(e){return J(e),!1}},dt=function(e,t,r){var n=t.url,i=t.data,o=t.success,a=void 0===o?s:o,l=t.fail,c=void 0===l?s:l,u=t.getResponseText,d=void 0===u?s:u,h=t.withCredentials,p=void 0!==h&&h,f=new r;f.withCredentials=p,f.open(e,n,!0),f.setRequestHeader("Content-Type","application/json"),f.onload=function(){null==d||d(this.responseText);try{if(this.status>=400)c(new Error(this.responseText||this.statusText));else if(this.responseText){var e=JSON.parse(this.responseText);a(e)}else a({})}catch(e){c(e)}},f.onerror=function(){c(new Error("Network request failed"))},f.onabort=function(){c(new Error("Network request aborted"))},f.send(i)},ht=function(){var e=function(){if("function"==typeof XMLHttpRequest&&h(XMLHttpRequest))return XMLHttpRequest}();return e?{useBeacon:!0,get:function(t){dt("GET",t,e)},post:function(t){dt("POST",t,e)}}:{get:s,post:s}};function pt(e){var t=function(e){var t,r=e.transport,n=e.endpoint,o=e.size,s=void 0===o?10:o,a=e.wait,l=void 0===a?1e3:a,c=[],u=0;function d(){if(c.length){var e=this.getBatchData();r.post({url:n,data:e,fail:function(r){t&&t(r,e)}}),c=[]}}return{getSize:function(){return s},getWait:function(){return l},setSize:function(e){s=e},setWait:function(e){l=e},getEndpoint:function(){return n},setEndpoint:function(e){n=e},send:function(e){c.push(e),c.length>=s&&d.call(this),clearTimeout(u),u=setTimeout(d.bind(this),l)},flush:function(){clearTimeout(u),d.call(this)},getBatchData:function(){return c.length?i(c):""},clear:function(){clearTimeout(u),c=[]},fail:function(e){t=e}}}(e),n=t.send;return function(e){var t=H();if(t){var n=r(ie(e),1)[0];["unload","beforeunload","pagehide"].forEach(function(e){re(t,e,n,!1)})}}(function(){if(e.transport.useBeacon){var r=function(){var e=H();return e&&e.navigator.sendBeacon?{get:function(){},post:function(t,r){e.navigator.sendBeacon(t,r)}}:{get:s,post:s}}(),o=t.getBatchData();o&&(r.post(t.getEndpoint(),o),t.clear()),t.send=function(e){r.post(t.getEndpoint(),i([e]))},function(e){var t=G(),r=H();if(t&&r){var n=s;n=ne(t,"visibilitychange",function(){"visible"===t.visibilityState&&(e(),n())},!0)}}(function(){t.send=n})}else t.flush()}),t}var ft="mon16-normal-useast5.tiktokv.us",_t="https://lf16-cdn-tos.tiktokcdn-us.com/obj/static-tx/slardar/fe/sdk-web/plugins",yt="1.14.4",gt="SDK_SLARDAR_WEB",mt="/monitor_web/settings/browser-settings",vt="/monitor_browser/collect/batch/",bt="SLARDAR",wt=["/log/sentry/",vt,mt],Ct="session",Et=["blankScreen","action"],kt={sample_rate:1,include_users:[],sample_granularity:Ct,rules:{}};function Tt(e,t,r){void 0===r&&(r=At),function(e){var t=H(),r=G();t&&r&&("complete"!==r.readyState?re(t,"load",function(){setTimeout(function(){e()},0)},!1):e())}(function(){e.on("init",function(){r(e,t)})})}var St=function(e,t,r,n){void 0===n&&(n=$t);var i=t.config(),o=i.plugins,s=i.pluginBundle,a=e.filter(function(e){return o[e]&&!t.destroyAgent.has(e)}),l=function(){return a.forEach(function(e){return Pt(t,e,r)})};a.every(function(e){return xt(e,r)})?l():n(t,{name:s.name},l)},Ot=function(e,t,r,n){void 0===n&&(n=$t);var i=t.config().plugins;e.filter(function(e){return i[e]&&!t.destroyAgent.has(e)}).forEach(function(e){xt(e,r)?Pt(t,e,r):n(t,{name:e,config:i[e]},function(){return Pt(t,e,r)})})};function At(e,r,n){void 0===n&&(n=$t);var i=e.config().pluginBundle,o=i?i.plugins:[];St(o,e,r,n),Ot(Et,e,r,n),e.provide("reloadPlugin",function(e){return function(r,n){var i,o=e.config().pluginBundle;e.destroyAgent.has(r)&&e.destroyAgent.remove(r),void 0!==n&&e.set({plugins:t(t({},e.config().plugins),(i={},i[r]=n,i))}),o&&~o.plugins.indexOf(r)?St([r],e):Ot([r],e)}}(e))}function $t(e,t,r,n){var i=t.name,o=t.config;void 0===n&&(n=oe);var s=function(e,t,r){var n;return null!==(n=null==r?void 0:r.path)&&void 0!==n?n:e.config().pluginPathPrefix+"/"+t.replace(/([a-z])([A-Z])/g,function(e,t,r){return t+"-"+r.toLowerCase()})+".1.14.4.js"}(e,i,o);n(s,function(){r()})}function Pt(e,t,r){if(void 0===r&&(r=Q(H())),r){var n=Rt(r,t);if(n)try{if(e.destroyAgent.has(t))return;n.apply(e)}catch(e){J(e),P("[loader].applyPlugin failed",t,e)}else P("[loader].applyPlugin not found",t)}}function Rt(e,t){return e.plugins.filter(function(e){return e.name===t&&e.version===yt})[0]}function xt(e,t){return void 0===t&&(t=Q(H())),!(!t||!t.plugins||!Rt(t,e))}function Lt(e,t,r){void 0===r&&(r=Q(H())),r&&r.plugins&&(Rt(r,e)||r.plugins.push({name:e,version:yt,apply:t}))}function It(e){var t,r;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(["userId","deviceId","sessionId","env"]),i=n.next();!i.done;i=n.next()){var o=i.value;e[o]||delete e[o]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return e}function Mt(e){var r=e.plugins||{};for(var n in r)r[n]&&!l(r[n])&&(r[n]={});return It(t(t({},e),{plugins:r}))}function Dt(e){return l(e)&&"bid"in e}function Bt(e){return It(t({},e))}function Nt(e){var t;if(!e)return{};var r=e.sample,n=e.plugins,i=e.timestamp,o=e.quota_rate,s=void 0===o?1:o,a=e.apdex;if(!r)return{};var l=r.sample_rate,c=r.sample_granularity,u=void 0===c?Ct:c,d=r.include_users,h=r.rules;return{sample:{include_users:d,sample_rate:l*s,sample_granularity:u,rules:(void 0===h?[]:h).reduce(function(e,t){var r=t.name,n=t.enable,i=t.sample_rate,o=t.conditional_sample_rules;return e[r]={enable:n,sample_rate:i,conditional_sample_rules:o},e},{})},plugins:{heatmap:null!==(t=null==n?void 0:n.heatmap)&&void 0!==t&&t},apdex:a,serverTimestamp:i}}var jt=function(e,t){return void 0===t&&(t=vt),(e&&e.indexOf("//")>=0?"":"https://")+e+t},Ut=function(e,t){return void 0===t&&(t=mt),(e&&e.indexOf("//")>=0?"":"https://")+e+t},Vt=function(){return I()},Ft=function(e){var t=[];return e.observe=function(e){t.push(e)},e.push=function(){for(var i,o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return o.forEach(function(e){t.forEach(function(t){return t(e)})}),(i=[].push).call.apply(i,n([e],r(o),!1))},e},Ht=function(){var e,t,r,n=H(),i=G();if(n&&i)return(null===(r=null===(t=null===(e=function(){if(!document)return null;if(document.currentScript)return document.currentScript;try{throw new Error}catch(c){var e=0,t=/at\s+(.*)\s+\((.*):(\d*):(\d*)\)/i.exec(c.stack),r=t&&t[2]||!1,n=t&&t[3]||0,i=document.location.href.replace(document.location.hash,""),o="",s=document.getElementsByTagName("script");if(r===i){var a=document.documentElement.outerHTML,l=new RegExp("(?:[^\\n]+?\\n){0,"+(n-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i");o=a.replace(l,"$1").trim()}for(;e<s.length;e++){if("interactive"===s[e].readyState)return s[e];if(s[e].src===r)return s[e];if(r===i&&s[e].innerHTML&&s[e].innerHTML.trim()===o)return s[e]}return null}}())||void 0===e?void 0:e.getAttribute("src"))||void 0===t?void 0:t.match(/globalName=(.+)$/))||void 0===r?void 0:r[1])||"Slardar"},Gt=function(e){return bt+e},Wt=function(e,t){try{var r=localStorage.getItem(e);if(!r||!ae()||"{"!==r[0])return;ce(e,JSON.parse(r),t)}catch(e){}},qt=function(e,t){void 0===e&&(e="");var r={userId:I(),deviceId:I()};if(t<=0)return r;var n=Gt(e);Wt(n,t);var i=le(n);return{userId:(null==i?void 0:i.userId)||r.userId,deviceId:(null==i?void 0:i.deviceId)||r.deviceId}},Kt=function(e){var t=e.bid,r=e.userId,n=e.deviceId,i=e.storageExpires,o=Gt(t);ce(o,{userId:r,deviceId:n},ue(i))},zt={get:function(){return this.__SLARDAR__REPALCE__HOLDER__}},Zt=function(e){var r,n,i=e,o={},a=zt.get(),l=s,c=s;return{getConfig:function(){return i},setConfig:function(e){return o=t(t({},o),e||{}),u(),r||(r=e,i.useLocalConfig||!i.bid?(n={},l()):a?d():Yt(i.transport,i.domain,i.bid,function(e){a=e,d()})),i},onChange:function(e){c=e},onReady:function(e){l=function(){Kt(i),e()},n&&l()}};function u(){var r=t(t(t({},e),n||{}),o);r.plugins=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0;n<e.length;)r=y(r,e[n++]);return r}(e.plugins,(null==n?void 0:n.plugins)||{},o.plugins||{}),r.sample=Xt(Xt(e.sample,null==n?void 0:n.sample),o.sample),i=r,c()}function d(){n=Nt(a),u(),l()}};function Yt(e,t,r,n){e.get({withCredentials:!0,url:Ut(t)+"?bid="+r+"&store=1",success:function(e){n(e.data||{})},fail:function(){n({sample:{sample_rate:.001}})}})}function Xt(e,i){if(!e||!i)return e||i;var o=t(t({},e),i);return o.include_users=n(n([],r(e.include_users||[]),!1),r(i.include_users||[]),!1),o.rules=n(n([],r(Object.keys(e.rules||{})),!1),r(Object.keys(i.rules||{})),!1).reduce(function(o,s){var a,l;return s in o||(s in(e.rules||{})&&s in(i.rules||{})?(o[s]=t(t({},e.rules[s]),i.rules[s]),o[s].conditional_sample_rules=n(n([],r(e.rules[s].conditional_sample_rules||[]),!1),r(i.rules[s].conditional_sample_rules||[]),!1)):o[s]=(null===(a=e.rules)||void 0===a?void 0:a[s])||(null===(l=i.rules)||void 0===l?void 0:l[s])),o},{}),o}var Qt,Jt={build:function(e){return{ev_type:e.ev_type,payload:e.payload,common:t(t({},e.extra||{}),e.overrides||{})}}},er=function(e,r){var n=r||{},i=n.pid,o=void 0===i?"":i,s=n.viewId,a=void 0===s?"":s,l={url:z(),timestamp:F(),sdk_version:yt,sdk_name:gt,pid:o,view_id:a};return t(t({},e),{extra:t(t({},l),e.extra||{})})},tr=function(e){e.on("report",function(t){return er(t,e.config())}),e.on("init",function(){var r=e.config(),n=r.pid,i=r.viewId,o=e.getPreStartQueue();o.forEach(function(e,r){var s=e.extra||{};o[r]=t(t({},e),{extra:t(t({},s),{pid:s.pid||n,view_id:s.view_id||i})})})})},rr={sri:"reportSri",st:"reportResourceError",err:"captureException",reject:"captureException"},nr=function(e){return Object.keys(e).reduce(function(e,t){return e[t]=[],e},{})},ir=function(e){return Object.keys(e).reduce(function(t,r){return t[e[r]]?t[e[r]].push(r):t[e[r]]=[r],t},{})},or=function(e,r,n){return function(i,o,s,a){var l;void 0===s&&(s=F()),void 0===a&&(a=location.href);var c=t(t({},ee(e)),{url:a,timestamp:s});r[i]&&(e[n[i]]?te(e,c)(function(){e[n[i]](o)}):null===(l=r[i])||void 0===l||l.push([o,c]))}},sr=function(e,t,n){return function(i){i in n&&n[i].forEach(function(n){var o;null===(o=t[n])||void 0===o||o.forEach(function(t){var n=r(t,2),o=n[0],s=n[1];te(e,s)(function(){e[i](o)})}),t[n]=null})}},ar=function(e,t){return"err"===t?!1!==b(e,"plugins.jsError.onerror",function(e,t){return e[t]}):"reject"!==t||!1!==b(e,"plugins.jsError.onunhandledrejection",function(e,t){return e[t]})},lr=function(e,t){var n;void 0===t&&(t=rr);var i=nr(t),o=ir(t),s=or(e,i,t);(null===(n=e.p)||void 0===n?void 0:n.a)&&"observe"in e.p.a&&e.p.a.observe(function(t){var n=r(t,5);n[0];var i=n[1],o=n[2],a=n[3],l=n[4],c=e.config();ar(c,i)&&s(i,o,a,l)}),e.on("init",function(){var t,n=e.config();null===(t=e.p)||void 0===t||t.a.forEach(function(e){var t=r(e,5);t[0];var i=t[1],o=t[2],a=t[3],l=t[4];ar(n,i)&&s(i,o,a,l)}),e.p&&e.p.a&&(e.p.a.length=0),e.provide("precollect",function(e,t,r,i){void 0===r&&(r=F()),void 0===i&&(i=location.href),ar(n,e)&&s(e,t,r,i)})}),e.on("provide",sr(e,i,o))},cr=function(e){var t=r(e,2),n=t[0],i=t[1];return{ev_type:Ce,payload:{error:Ke(n),breadcrumbs:[],extra:i||{}},extra:{bid:"slardar_sdk"}}},ur=function(e,t){void 0===t&&(t=.001);var r=Q(H());r&&(r.errors||(r.errors=[]),"observe"in r.errors||R(t)&&(r.errors=Ft(r.errors),r.errors.forEach(function(t){e.report(cr(t))}),r.errors.observe(function(t){e.report(cr(t))})))},dr=function(e){var r,n=!1;e.on("init",function(){r=(new Date).getTime(),e.on("config",function(){var i,o=null===(i=e.config())||void 0===i?void 0:i.serverTimestamp;if(!(isNaN(o)||Number(o)<=0||n)){n=!0;var s=(new Date).getTime();if(s-r<700&&o){var a=o-(s+r)/2;!isNaN(a)&&(a>0||a<-6e5)&&e.on("beforeBuild",function(e){var r;return t(t({},e),{extra:t(t({},null!==(r=e.extra)&&void 0!==r?r:{}),{sdk_offset:null!=a?a:0})})})}}})})},hr=function(e,r){var n={};return n.bid=r.bid,n.user_id=r.userId,n.device_id=r.deviceId,n.session_id=r.sessionId,n.release=r.release,n.env=r.env,t(t({},e),{extra:t(t({},n),e.extra||{})})},pr=function(e){e.on("beforeBuild",function(t){return hr(t,e.config())})},fr=function(e){e.on("start",function(){var t=e.config().bid,r=e.getSender();r.setEndpoint(r.getEndpoint()+"?biz_id="+t)})},_r=function(e){var t=ue(e.storageExpires),r=qt(e.bid,t);return{bid:"",pid:"",viewId:Je("_"),userId:r.userId,deviceId:r.deviceId,storageExpires:t,sessionId:Vt(),domain:ft,pluginBundle:{name:"commonMonitors",plugins:["breadcrumb","jsError","performance","resourceError","resource"]},pluginPathPrefix:_t,plugins:{ajax:{ignoreUrls:wt},fetch:{ignoreUrls:wt},breadcrumb:{},pageview:{},jsError:{},resource:{},resourceError:{},performance:{},tti:{},fmp:{},blankScreen:!1,heatmap:!1},release:"",env:"production",sample:kt,transport:ht()}},yr=function(e){var i=void 0===e?{}:e,o=i.createSender,s=void 0===o?function(e){return pt({size:20,endpoint:jt(e.domain),transport:e.transport})}:o,a=i.builder,l=void 0===a?Jt:a,c=i.createDefaultConfig,u=j({validateInitConfig:Dt,initConfigNormalizer:Mt,userConfigNormalizer:Bt,createSender:s,builder:l,createDefaultConfig:void 0===c?_r:c,createConfigManager:Zt});ur(u),function(e){var r=function(){var e={},r={},n={set:function(t,i){return e[t]=i,r[t]=E(i),n},merge:function(i){return e=t(t({},e),i),Object.keys(i).forEach(function(e){r[e]=E(i[e])}),n},delete:function(t){return delete e[t],delete r[t],n},clear:function(){return e={},r={},n},get:function(e){return r[e]},toString:function(){return t({},r)}};return n}();e.provide("context",r),e.on("report",function(e){return e.extra||(e.extra={}),e.extra.context=r.toString(),e})}(u);var d=Q(H());!function(e,t){var n=t||{},i={};e.provide("setFilter",function(e,t){i[e]||(i[e]=[]),i[e].push(t)}),e.provide("initSubject",function(t){var o=r(t,2),s=o[0],a=o[1],l=function(e){return e.split("_")[0]}(s),c=!!l&&i[l];return n[s]||(n[s]=D(a,function(){n[s]=void 0})),c?V(e,[s,B(n[s],c)]):n[s]}),e.provide("getSubject",function(e){return n[e]}),e.provide("privateSubject",{})}(u,d&&d.subject),dr(u),pr(u),tr(u),function(e){var r=function(){var e=function(){if(H()&&"navigator"in window)return window.navigator}();if(e)return e.connection||e.mozConnection||e.webkitConnection}(),n=at(r);r&&(r.onchange=function(){n=at(r)}),e.on("report",function(e){return t(t({},e),{extra:t(t({},e.extra||{}),{network_type:n})})})}(u),fr(u);var h=function(e,t,i){var o={},s=function(){for(var i,a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];var c=a[0];if(c){var u=c.split(".")[0];if(!(u in s)){var d=o[u]||[],h=null!==(i=null==t?void 0:t(e))&&void 0!==i?i:{};return d.push(n([h],r(a),!1)),void(o[u]=d)}return w(s,c,[].slice.call(a,1))}};for(var a in k(e,"provide",function(t){return function(r,n){s[r]=n,t.call(e,r,n)}})(),e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=e[a]);return e.on("provide",function(t){o[t]&&(o[t].forEach(function(t){var n=r(t),o=n[0],s=n.slice(1);null==i||i(e,o,s)}),o[t]=null)}),s}(u,ee,function(e,t,i){return te(e,t)(function(){var e=r(i),t=e[0],o=e.slice(1);u[t].apply(u,n([],r(o),!1))})});return function(e,t){e.on("init",function(){var r=[],n=function(n){n.forEach(function(n){var i=n.name;m(r,i)||(r.push(i),n.setup(e),t&&t(i,n.setup),e.destroyAgent.set(i,i,[function(){r=v(r,i),n.tearDown&&n.tearDown()}]))})};e.provide("applyIntegrations",n);var i=e.config();i&&i.integrations&&n(i.integrations)})}(h,Lt),h},gr=((Qt={}).pageview=function(e){e.on("init",function(){var n,i=null===(n=e.config())||void 0===n?void 0:n.plugins.pageview;!function(e,n){var i,o=se(n,st);if(o&&W()){var a=o.routeMode,l=o.apdex,c=e.report.bind(e),u=s;if(l){var d=[],h=r(function(e,t,n,i){var o,s,a,l=r(n,2),c=l[0],u=l[1],d=2===i.apdex,h=void 0,p=void 0,f=void 0,_=!1,y=r(it(),4),g=y[0],m=y[1],v=y[2],b=y[3],w=r(it(),4),C=w[0],E=w[1],k=w[2],T=w[3],S=r((o={start:F(),end:0,time_spent:0,is_bounced:!1,entry:"",exit:"",p_count:0,a_count:0},[function(e,t){var n=r(e,3),i=n[0],s=n[1],a=n[2];o.end=F(),o.time_spent+=t&&t.time_spent||0,o.last_page=t,o.p_count+=1,o.rank=i,o.apdex=s,o.apdex_detail=a;var l=G();l&&(o.is_bounced=!function(e){return"complete"===e.readyState}(l))},function(e,t){o.time_spent+=e.time_spent,o.p_count+=1,o.exit=t},function(){o.a_count+=1},function(e){o.entry=e,o.exit=e},function(){return o}]),5),O=S[0],A=S[1],$=S[2],P=S[3],R=S[4],x=r((s=0,a=void 0,[function(e){if(e){if(!a)return;s+=F()-a,a=void 0}else a=F()},function(){a&&(s+=F()-a);var e=s;return s=0,a=F(),e}]),2),L=x[0],I=x[1];t.push(c[0](L)),!d&&t.push(u[0](function(){if(_){var t=r(k(),2),n=t[0],i=t[1],o=rt(n,f);O([o,n,i],B()),e({ev_type:we,payload:R()}),T()}}));var M=nt(g,m),D=nt(C,E),B=function(){var e=r(v(),2),t=e[0],n=e[1];return{start:h[0],pid:h[1],view_id:h[2],end:F(),time_spent:I(),apdex:t,rank:rt(t,f),detail:n}};return t.push(function(){_=!1}),[function(e,t){if(!h)return h=[F(),e,t],P(e),void(_=!(!f||!h));_&&(p=B(),A(p,e)),h=[F(),e,t],b()},function(e){_&&(d||(D(e,f),e.ev_type===Te&&$()),e.common.pid===h[1]&&M(e,f))},function(t){_&&(t.payload.last=p),e(t)},function(e){if(!e)return t.forEach(function(e){return e()}),void(t.length=0);_=!(!(f=e)||!h)}]}(e.report.bind(e),d,[U(e,Ze),U(e,Ye)],o),4),p=h[0],f=h[1],_=h[2],y=h[3];c=_,u=p,e.on("send",f),d.push(function(){return e.off("send",f)}),e.on("start",function(){y(e.config().apdex)}),N(e,ot,we,d)}var g=[],m=r(function(e,t,n,i){var o,s,a=i.sendInit,l=i.initPid,c=i.routeMode,u=i.extractPid,d=i.onPidUpdate,h=tt(c)?function(){return""}:function(e){return function(t){var r;return"hash"===e?(null===(r=K(t).hash)||void 0===r?void 0:r.replace(/^#/,""))||"/":K(t).path}}(c),p=u||function(){},f=r(function(e,t,r,n){var i=r,o=t;return n&&n(t),[function(t,r,s){"user_set"!==t&&r!==i?(i=r,o=null!=s?s:i,n&&n(o),e(t,o)):"user_set"===t&&r!==o&&(o=r,n&&n(o),e(t,o))},function(){t&&e("init",t)}]}(function(e){return function(t,r){e(function(e,t){return{ev_type:be,payload:{pid:t,source:e}}}(t,r))}}(e),l||function(e){var t;return null!==(t=p(e))&&void 0!==t?t:h(e)}(location.href),h(location.href),d),2),_=f[0],y=f[1];if(!tt(c)){var g=r((o=function(e,t){return _(e,h(t),p(t))},s="",[function(e,t){t!==s&&o(e,s=t)}]),1)[0];n.length&&n.forEach(function(e){return t.push(e[0](function(e){return g(c,e)}))})}return a&&y(),[_.bind(null,"user_set")]}(c,g,tt(a)?[]:[e.initSubject(Xe),e.initSubject(Qe)],t(t({},o),{initPid:null===(i=e.config())||void 0===i?void 0:i.pid,onPidUpdate:function(t){var r=Je(t);u(t,r),e.set({pid:t,viewId:r,actionId:void 0})}})),1)[0];V(e,["f_view_0",X(e)],-1);var v=function(){m(e.config().pid)};e.on("config",v),g.push(function(){return e.off("config",v)}),N(e,ot,be,g),e.provide("sendPageview",m)}}(e,i)})},Qt.ajax=function(e){e.on("init",function(){var r,n=null===(r=e.config())||void 0===r?void 0:r.plugins.ajax;!function(e,r){var n=se(r,Me);if(n){var i=[],o=t(t({},n),{setContextAtReq:function(){return Y(e,!0)},setTraceHeader:Ae(n.trace)}),s=function(){return U(e,ve)};o.autoWrap&&Le(i,[U(e,["xhr_0",_e(XMLHttpRequest&&XMLHttpRequest.prototype)]),s],o),N(e,"ajax",Ee,i),e.provide("wrapXhr",function(e){function t(){var t=new e;return Le(i,[D(_e(t)),s],o),t}return t.prototype=new e,["DONE","HEADERS_RECIEVED","LOADING","OPENED","UNSENT"].forEach(function(r){t[r]=e[r]}),t})}}(e,n)})},Qt.fetch=function(e){e.on("init",function(){var r,n=null===(r=e.config())||void 0===r?void 0:r.plugins.fetch;!function(e,r){var n=se(r,Ge);if(n){var i=[],o=t(t({},n),{setContextAtReq:function(){return Y(e,!0)},setTraceHeader:Ae(n.trace)}),s=function(){return U(e,ve)};o.autoWrap&&De(i,[U(e,ge),s],o),N(e,"fetch",Ee,i),e.provide("wrapFetch",function(e){var t=void 0;return De(i,[D(function(r){t=ye(e,r)}),s],o),t})}}(e,n)})},Qt),mr=function(e){void 0===e&&(e={});var t=yr(e);return function(e){e.on("start",function(){var t=e.config(),r=function(e,t,r,n,i){if(!t)return a;var o=t.sample_rate,s=t.include_users,l=t.sample_granularity,c=t.rules,u=t.r,d=void 0===u?Math.random():u;if(m(s,e))return function(e){return lt(e,1)};var h="session"===l,p=ct(h,o,r,d,n),f=function(e,t,r,n,i,o){var s={};return Object.keys(e).forEach(function(a){var l=e[a],c=l.enable,u=l.sample_rate,d=l.conditional_sample_rules;c?(s[a]={enable:c,sample_rate:u,effectiveSampleRate:u*r,hit:ct(t,u,n,i,o)},d&&(s[a].conditional_hit_rules=d.map(function(e){var s=e.sample_rate,a=e.filter;return{sample_rate:s,hit:ct(t,s,n,i,o),effectiveSampleRate:s*r,filter:a}}))):s[a]={enable:c,hit:function(){return!1},sample_rate:0,effectiveSampleRate:0}}),s}(c,h,o,r,d,n);return function(e){var t;if(!p())return h&&i[0](),!1;if(!(e.ev_type in f))return lt(e,o);if(!f[e.ev_type].enable)return h&&i[1](e.ev_type),!1;if(null===(t=e.common)||void 0===t?void 0:t.sample_rate)return e;var r=f[e.ev_type],n=r.conditional_hit_rules;if(n)for(var s=0;s<n.length;s++)if(ut(e,n[s].filter))return!!n[s].hit()&&lt(e,n[s].effectiveSampleRate);return r.hit()?lt(e,r.effectiveSampleRate):((!n||!n.length)&&h&&i[1](e.ev_type),!1)}}(t.userId,t.sample,R,x,[function(){e.destroy()},function(t){e.destroyAgent.removeByEvType(t)}]);e.on("build",r)})}(t),lr(t),function(e){var t=function(r){var n=function(e){if(e&&l(e)&&e.name&&f(e.name)){var t={name:e.name,type:"event"};if("metrics"in e&&l(e.metrics)){var r=e.metrics,n={};for(var i in r)p(r[i])&&(n[i]=r[i]);t.metrics=n}if("categories"in e&&l(e.categories)){var o=e.categories,s={};for(var i in o)s[i]=E(o[i]);t.categories=s}return"attached_log"in e&&f(e.attached_log)&&(t.attached_log=e.attached_log),t}}(r);if(n){var i=function(e){var t;if("object"==typeof window&&window.__perfsee__){var r={};return null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,r,e),r.stack}}(t);i&&(n.stacks=i),e.report({ev_type:ke,payload:n,extra:{timestamp:F()}})}};e.provide("sendEvent",t),e.provide("sendLog",function(t){var r=function(e){if(e&&l(e)&&e.content&&f(e.content)){var t={content:E(e.content),type:"log",level:"info"};if("level"in e&&(t.level=e.level),"extra"in e&&l(e.extra)){var r=e.extra,n={},i={};for(var o in r)p(r[o])?n[o]=r[o]:i[o]=E(r[o]);t.metrics=n,t.categories=i}return"attached_log"in e&&f(e.attached_log)&&(t.attached_log=e.attached_log),t}}(t);r&&e.report({ev_type:ke,payload:r,extra:{timestamp:F()}})})}(t),Object.keys(gr).forEach(function(e){Lt(e,gr[e]),gr[e](t)}),Tt(t),t.provide("create",mr),t},vr="precollect",br=3e5,wr=mr(),Cr=H();Cr&&function(e,t){if("addEventListener"in e){t.pcErr=function(r){var n=(r=r||e.event).target||r.srcElement||{};n instanceof Element||n instanceof HTMLElement?t(vr,"st",{tagName:n.tagName,url:n.getAttribute("href")||n.getAttribute("src")}):t(vr,"err",r.error)},t.pcRej=function(r){r=r||e.event,t(vr,"reject",r.reason||r.detail&&r.detail.reason)};var r=[];r.push(re(e,"error",t.pcErr,!0)),r.push(re(e,"unhandledrejection",t.pcRej,!0)),setTimeout(function(){r.forEach(function(e){return e()})},br)}"PerformanceObserver"in e&&"PerformanceLongTaskTiming"in e&&(t.pp={entries:[]},t.pp.observer=new PerformanceObserver(function(e){t.pp.entries=t.pp.entries.concat(e.getEntries())}),t.pp.observer.observe({entryTypes:["longtask"]}),setTimeout(function(){t.pp.observer.disconnect()},br))}(Cr,wr),e.BATCH_REPORT_PATH=vt,e.DEFAULT_IGNORE_PATHS=wt,e.DEFAULT_SAMPLE_CONFIG=kt,e.DEFAULT_SAMPLE_GRANULARITY=Ct,e.DEFAULT_SENDER_SIZE=20,e.DEVICE_ID_COOKIE_NAME="MONITOR_DEVICE_ID",e.EV_METHOD_MAP=rr,e.EXTRA_INDEPENDENT_PLUGINS=Et,e.InjectConfigPlugin=pr,e.InjectEnvPlugin=tr,e.InjectQueryPlugin=fr,e.ObserveErrorPlugin=ur,e.PLUGINS_LOAD_PREFIX=_t,e.PluginMap=gr,e.PrecollectPlugin=lr,e.REPORT_DOMAIN=ft,e.SDK_NAME=gt,e.SDK_VERSION=yt,e.SETTINGS_DOMAIN="mon16-normal-useast5.tiktokv.us",e.SETTINGS_PATH=mt,e.STORAGE_PREFIX=bt,e.TimeCalibrationPlugin=dr,e.USER_ID_COOKIE_NAME="MONITOR_WEB_ID",e.addConfigToReportEvent=hr,e.addEnvToSendEvent=er,e.applyPlugin=Pt,e.browserBuilder=Jt,e.buildSelfErrorEvent=cr,e.configHolder=zt,e.createBrowserClient=mr,e.createBrowserConfigManager=Zt,e.createMinimalBrowserClient=yr,e.createStore=nr,e.default=wr,e.doesPluginExistInRegistry=xt,e.filterIfPluginDisabled=ar,e.getConsumeStored=sr,e.getDefaultConfig=_r,e.getDefaultSessionId=Vt,e.getDefaultUserIdAndDeviceId=qt,e.getGlobalInstance=function(){var e=H(),t=Ht();if(e&&t)return e[t]},e.getGlobalName=Ht,e.getPluginFromRegistry=Rt,e.getReportUrl=jt,e.getServerConfig=Yt,e.getSettingsUrl=Ut,e.getStorageKey=Gt,e.getStoreOrConsume=or,e.glueCodeForStorageSecurity=Wt,e.hasSetStorageItem=function(e){void 0===e&&(e="");var t=Gt(e);return!!le(t)},e.loadCombinedPlugins=St,e.loadIndependentPlugins=Ot,e.loadNow=$t,e.loadPlugins=At,e.loadPluginsOnPageLoad=Tt,e.mergeSampleConfig=Xt,e.normalizeInitConfig=Mt,e.normalizeStrictFields=It,e.normalizeUserConfig=Bt,e.parseServerConfig=Nt,e.register=Lt,e.reverseMap=ir,e.setStorageUserIdAndDeviceId=Kt,e.toObservableArray=Ft,e.validateInitConfig=Dt}(oci);var index=getDefaultExportFromCjs(oci),index$1=Object.freeze(_mergeNamespaces({__proto__:null,default:index},[oci]))},14178:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.7125 32.0323C24.3109 32.5525 23.5252 32.5505 23.1263 32.0282L14.4015 20.6071C13.8988 19.949 14.368 19 15.1962 19H32.7385C33.569 19 34.0375 19.9537 33.53 20.6111L24.7125 32.0323Z"}))}},14496:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.4977 9C10.1195 9 9.0013 10.1153 8.99767 11.4934L8.94239 32.4934C8.93875 33.8767 10.0591 35 11.4424 35H18.7895L22.0656 39.004C23.0659 40.2265 24.9352 40.2264 25.9354 39.0039L29.2111 35H36.5587C37.942 35 39.0623 33.8767 39.0587 32.4934L39.0029 11.4934C38.9993 10.1152 37.8811 9 36.5029 9H11.4977ZM29 21H19C18.4477 21 18 21.4477 18 22V23C18 23.5523 18.4477 24 19 24H29C29.5523 24 30 23.5523 30 23V22C30 21.4477 29.5523 21 29 21Z"}))}},14873:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.7321 7.00001C45.3748 6.3812 44.7146 6 44 6H4.00004C3.20826 6 2.49103 6.4671 2.17085 7.19125C1.85068 7.9154 1.98785 8.76026 2.52068 9.34592L12.9607 20.8209C13.5137 21.4288 14.3824 21.6365 15.1506 21.3445L29.65 15.8336C29.8188 15.7694 29.8953 15.796 29.9287 15.8092C29.9872 15.8325 30.0709 15.8928 30.1366 16.0041C30.2023 16.1154 30.2147 16.2179 30.2068 16.2802C30.2023 16.3159 30.1885 16.3958 30.0509 16.5125L18.1464 26.6098C17.5329 27.1301 17.2908 27.9674 17.5321 28.7348L22.0921 43.2398C22.33 43.9967 22.9928 44.5413 23.7815 44.628C24.5701 44.7147 25.3354 44.3271 25.7321 43.64L45.7321 9.00002C46.0894 8.38122 46.0894 7.61882 45.7321 7.00001Z"}))}},15162:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 45 44",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.5 44C34.6503 44 44.5 34.1503 44.5 22C44.5 9.84974 34.6503 0 22.5 0C10.3497 0 0.5 9.84974 0.5 22C0.5 34.1503 10.3497 44 22.5 44Z",fill:"#161823",fillOpacity:"0.03"}),n.createElement("mask",{id:"SuccessColor_mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"45",height:"44"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.5 44C34.6503 44 44.5 34.1503 44.5 22C44.5 9.84974 34.6503 0 22.5 0C10.3497 0 0.5 9.84974 0.5 22C0.5 34.1503 10.3497 44 22.5 44Z",fill:"white"})),n.createElement("g",{mask:"url(#SuccessColor_mask0)"},n.createElement("path",{d:"M19.828 25.5057L29.7826 15.4812C29.8891 15.374 30.0622 15.3728 30.1702 15.4786L31.6903 16.968C31.7993 17.0748 31.8005 17.2499 31.6929 17.3582L20.7845 28.3432C20.2583 28.873 19.3976 28.873 18.8715 28.3432L13.5049 22.9389C13.3974 22.8307 13.3986 22.6555 13.5076 22.5487L15.0277 21.0593C15.1356 20.9535 15.3087 20.9547 15.4152 21.062L19.828 25.5057Z",fill:"#13C15A"})))}},16188:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6ZM2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24C46 36.1503 36.1503 46 24 46C11.8497 46 2 36.1503 2 24Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 23C18.6569 23 20 21.2091 20 19C20 16.7909 18.6569 15 17 15C15.3431 15 14 16.7909 14 19C14 21.2091 15.3431 23 17 23Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M31 23C32.6569 23 34 21.2091 34 19C34 16.7909 32.6569 15 31 15C29.3431 15 28 16.7909 28 19C28 21.2091 29.3431 23 31 23Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 28.3431C16 31.4673 19.5817 36 24 36C28.4183 36 32 31.4673 32 28.3431C32 25.219 16 25.219 16 28.3431Z"}))}},16300:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.0484 7.84003C23.6014 7.38666 24.3975 7.38666 24.9504 7.84001L41.051 21.04C41.5411 21.4418 41.7258 22.1082 41.5125 22.705C41.2991 23.3017 40.7338 23.7 40.1 23.7H37.769L36.5769 36.7278C36.4592 38.0149 35.3798 39 34.0873 39H13.9127C12.6202 39 11.5409 38.0149 11.4231 36.7278L10.231 23.7H7.89943C7.2657 23.7 6.70035 23.3017 6.487 22.705C6.27364 22.1083 6.45833 21.4418 6.9484 21.04L23.0484 7.84003ZM23.9995 10.9397L12.0948 20.7H12.969L14.369 36H22.4994V28.3138C22.4994 27.7616 22.9471 27.3138 23.4994 27.3138H24.4994C25.0517 27.3138 25.4994 27.7616 25.4994 28.3138V36H33.631L35.031 20.7H35.9045L23.9995 10.9397Z"}))}},16537:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.3359 8.37236C22.3296 7.04325 25 8.47242 25 10.8685V37.1315C25 39.5276 22.3296 40.9567 20.3359 39.6276L10.3944 33H6C4.34314 33 3 31.6568 3 30V18C3 16.3431 4.34315 15 6 15H10.3944L20.3359 8.37236ZM21 12.737L12.1094 18.6641C11.7809 18.8831 11.3948 19 11 19H7V29H11C11.3948 29 11.7809 29.1169 12.1094 29.3359L21 35.263V12.737ZM32.9998 24C32.9998 21.5583 32.0293 19.3445 30.4479 17.7211C30.0625 17.3255 29.9964 16.6989 30.3472 16.2724L31.6177 14.7277C31.9685 14.3011 32.6017 14.2371 33.0001 14.6195C35.4628 16.9832 36.9998 20.3128 36.9998 24C36.9998 27.6872 35.4628 31.0168 33.0001 33.3805C32.6017 33.7629 31.9685 33.6989 31.6177 33.2724L30.3472 31.7277C29.9964 31.3011 30.0625 30.6745 30.4479 30.2789C32.0293 28.6556 32.9998 26.4418 32.9998 24ZM37.0144 11.05C36.6563 11.4705 36.7094 12.0995 37.1069 12.4829C40.1263 15.3951 42.0002 19.4778 42.0002 23.9999C42.0002 28.522 40.1263 32.6047 37.1069 35.5169C36.7094 35.9003 36.6563 36.5293 37.0144 36.9498L38.3109 38.4727C38.6689 38.8932 39.302 38.9456 39.7041 38.5671C43.5774 34.9219 46.0002 29.7429 46.0002 23.9999C46.0002 18.2569 43.5774 13.078 39.7041 9.43271C39.302 9.05421 38.6689 9.10664 38.3109 9.52716L37.0144 11.05Z"}))}},16734:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M24.0173 3C12.4102 3 3 12.3947 3 23.9827C3 32.8766 8.53541 40.4753 16.3542 43.5321C16.1639 41.8742 16.0082 39.3183 16.4234 37.5049C16.8039 35.8643 18.8797 27.074 18.8797 27.074C18.8797 27.074 18.257 25.8133 18.257 23.9655C18.257 21.0469 19.9522 18.8709 22.0626 18.8709C23.8616 18.8709 24.7265 20.2179 24.7265 21.824C24.7265 23.6201 23.5848 26.3141 22.9794 28.8183C22.4777 30.9079 24.0345 32.6176 26.093 32.6176C29.8294 32.6176 32.7009 28.6801 32.7009 23.0156C32.7009 17.9901 29.0856 14.4844 23.9135 14.4844C17.9283 14.4844 14.4168 18.9572 14.4168 23.5855C14.4168 25.3816 15.1087 27.3158 15.9736 28.3692C16.1466 28.5765 16.1639 28.7664 16.112 28.9737C15.9563 29.6299 15.5931 31.0633 15.5239 31.3569C15.4374 31.7368 15.2125 31.8232 14.8146 31.6332C12.1853 30.4071 10.542 26.5905 10.542 23.4992C10.542 16.8849 15.3509 10.8059 24.4324 10.8059C31.7149 10.8059 37.3887 15.9868 37.3887 22.9293C37.3887 30.1653 32.822 35.9852 26.4909 35.9852C24.3632 35.9852 22.3566 34.8799 21.682 33.5674C21.682 33.5674 20.6268 37.574 20.3673 38.5584C19.9003 40.389 18.6202 42.6686 17.7553 44.0674C19.7273 44.6719 21.8031 45 23.9827 45C35.5897 45 44.9999 35.6053 44.9999 24.0173C45.0345 12.3947 35.6243 3 24.0173 3Z",fill:"#E60019"}))}},16993:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 32 32",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.09751 6.63192C4.27438 6.24712 4.66288 6 5.09093 6H26.9091C27.298 6 27.6574 6.20436 27.8526 6.53639C28.0478 6.86842 28.0492 7.27791 27.8563 7.61122L16.9472 26.4574C16.7322 26.8288 16.3148 27.0394 15.8839 26.9939C15.453 26.9483 15.0902 26.6553 14.9597 26.2474L11.7558 16.2317L4.26993 7.78608C3.98806 7.46807 3.92063 7.01672 4.09751 6.63192ZM14.0238 16.1691L16.2896 23.2521L25.0293 8.15384H7.49503L12.941 14.298L19.3274 10.4183C19.5839 10.2624 19.9199 10.3414 20.0778 10.5947L20.6495 11.5118C20.8074 11.7651 20.7274 12.0968 20.4708 12.2526L14.0238 16.1691Z"}))}},17189:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 4C26.2091 4 28 5.79086 28 8C28 10.2091 26.2091 12 24 12C21.7909 12 20 10.2091 20 8C20 5.79086 21.7909 4 24 4ZM24 20C26.2091 20 28 21.7909 28 24C28 26.2091 26.2091 28 24 28C21.7909 28 20 26.2091 20 24C20 21.7909 21.7909 20 24 20ZM24 36C26.2091 36 28 37.7909 28 40C28 42.2091 26.2091 44 24 44C21.7909 44 20 42.2091 20 40C20 37.7909 21.7909 36 24 36Z"}))}},20101:(e,t,r)=>{"use strict";r.d(t,{D:()=>a});var n=r(35895),i=r(73282),o=r(47483),s=r(52598);function a(e){const{experimentalUseShortDl:t=!1,autoFillWhiteList:r,enableApiOptimization:a=!1,installedApps:l,experimentalEnableCoinApiOptimization:c=!0,experimentalUseAppLink:u,experimentalUseBetterAppLink:d,disableAfdp:h}=e.providerContext;try{const p=null!=h?h:function(){if((0,n.fU)())return!1;const e=(0,n.KJ)(),t=(0,s.a)();return e&&"facebook"===t}(),{processedSchemes:f,processedFallbackURL:_}=(0,i.FR)({strategy:e,customs:{disableAfdp:p}});if(u){const n=a&&(0,o.gb)({installedApps:l,launchType:e.launchType,experimentalEnableCoinApiOptimization:c});return d&&n?_:(0,i.wx)({processedSchemes:f,processedFallbackURL:_,launchType:e.launchType,useShortDl:t,autoFillWhiteList:r})}return _}catch(e){return console.warn(e),""}}},21189:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6ZM2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24C46 36.1503 36.1503 46 24 46C11.8497 46 2 36.1503 2 24ZM24.0909 15C22.172 15 20.3433 16.2292 19.2617 18.61C19.0332 19.1128 18.4726 19.4 17.9487 19.2253L16.0513 18.5929C15.5274 18.4182 15.2406 17.8497 15.4542 17.3405C16.9801 13.7031 20.0581 11 24.0909 11C28.459 11 32 14.541 32 18.9091C32 21.2138 30.7884 23.4606 29.2167 25.074C27.8157 26.5121 25.5807 27.702 22.9988 27.9518C22.4491 28.0049 22.0001 27.5523 22.0001 27V25C22.0001 24.4477 22.4504 24.0057 22.9955 23.9167C24.2296 23.7153 25.5034 23.1533 26.3515 22.2828C27.4389 21.1666 28 19.8679 28 18.9091C28 16.7502 26.2498 15 24.0909 15ZM24 36C22.3431 36 21 34.6569 21 33C21 31.3431 22.3431 30 24 30C25.6569 30 27 31.3431 27 33C27 34.6569 25.6569 36 24 36Z"}))}},22006:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 3C17.9249 3 13 7.92487 13 14V21H8C6.89543 21 6 21.8954 6 23V41C6 42.1046 6.89543 43 8 43H40C41.1046 43 42 42.1046 42 41V23C42 21.8954 41.1046 21 40 21H35V14C35 7.92487 30.0751 3 24 3ZM31 21V14C31 10.134 27.866 7 24 7C20.134 7 17 10.134 17 14V21H31Z"}))}},22993:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M25.5 17C25.5 21.1421 22.1421 24.5 18 24.5C13.8579 24.5 10.5 21.1421 10.5 17C10.5 12.8579 13.8579 9.5 18 9.5C22.1421 9.5 25.5 12.8579 25.5 17Z"}),n.createElement("path",{d:"M7.10396 34.7906C8.78769 30.2189 12.8204 27 18.0009 27C23.1818 27 27.2107 30.2213 28.8958 34.7898C29.3075 35.906 28.6141 37 27.5 37H8.5C7.38629 37 6.69289 35.9067 7.10396 34.7906Z"}),n.createElement("path",{d:"M40.6308 37H32C31.2264 34.1633 30.0098 31.5927 28.144 29.7682C29.5384 28.9406 31.1829 28.5 33 28.5C37.239 28.5 40.536 30.8992 41.9148 35.0108C42.2516 36.0154 41.5423 37 40.6308 37Z"}),n.createElement("path",{d:"M33 26.5C36.0376 26.5 38.5 24.0376 38.5 21C38.5 17.9624 36.0376 15.5 33 15.5C29.9624 15.5 27.5 17.9624 27.5 21C27.5 24.0376 29.9624 26.5 33 26.5Z"}))}},23359:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.5522 6.91656C22.0988 4.28733 25.9011 4.28734 27.4477 6.91656L43.9509 34.9719C45.5194 37.6385 43.5968 41 40.5031 41H7.49679C4.40313 41 2.48051 37.6385 4.04906 34.9719L20.5522 6.91656ZM24 8.94464L7.49679 37H40.5031L24 8.94464ZM22 18C22 17.4477 22.4477 17 23 17H25C25.5522 17 26 17.4477 26 18V27C26 27.5523 25.5522 28 25 28H23C22.4477 28 22 27.5523 22 27V18ZM24 35C25.3807 35 26.5 33.8807 26.5 32.5C26.5 31.1193 25.3807 30 24 30C22.6192 30 21.5 31.1193 21.5 32.5C21.5 33.8807 22.6192 35 24 35Z"}))}},23914:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.1716 26L7 26C6.44771 26 6 25.5523 6 25L6 23C6 22.4477 6.44771 22 7 22L24.1716 22L20.2929 18.1213C19.9024 17.7308 19.9024 17.0976 20.2929 16.7071L21.7071 15.2929C22.0976 14.9024 22.7308 14.9024 23.1213 15.2929L30.4142 22.5858C31.1953 23.3668 31.1953 24.6332 30.4142 25.4142L23.1213 32.7071C22.7308 33.0976 22.0976 33.0976 21.7071 32.7071L20.2929 31.2929C19.9024 30.9024 19.9024 30.2692 20.2929 29.8787L24.1716 26ZM36 43L27 43C26.4477 43 26 42.5523 26 42L26 40C26 39.4477 26.4477 39 27 39L36 39C37.1046 39 38 38.1046 38 37L38 11C38 9.89543 37.1046 9 36 9L27 9C26.4477 9 26 8.55228 26 8L26 6C26 5.44771 26.4477 5 27 5L36 5C39.3137 5 42 7.68629 42 11L42 37C42 40.3137 39.3137 43 36 43Z"}))}},23973:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M8 6C8 5.44771 8.44772 5 9 5H17C17.5523 5 18 5.44772 18 6V42C18 42.5523 17.5523 43 17 43H9C8.44772 43 8 42.5523 8 42V6Z"}),n.createElement("path",{d:"M30 6C30 5.44771 30.4477 5 31 5H39C39.5523 5 40 5.44772 40 6V42C40 42.5523 39.5523 43 39 43H31C30.4477 43 30 42.5523 30 42V6Z"}))}},25333:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C30.6274 6 36 11.3726 36 18V26C36 28.0577 36.4561 30.2073 37.4628 32H10.5372C11.544 30.2073 12 28.0577 12 26V18C12 11.3726 17.3726 6 24 6ZM44 32C42.7758 32 41.8568 31.4296 41.1641 30.3906C40.4319 29.2923 40 27.7033 40 26V18C40 9.16344 32.8366 2 24 2C15.1634 2 8 9.16344 8 18V26C8 27.7033 7.56811 29.2923 6.8359 30.3906C6.1432 31.4296 5.22419 32 4 32C2.89543 32 2 32.8954 2 34C2 35.1046 2.89543 36 4 36H44C45.1046 36 46 35.1046 46 34C46 32.8954 45.1046 32 44 32ZM18.2987 40.9485C18.6631 40.3589 19.3068 40 20 40H28C28.6932 40 29.3369 40.3589 29.7013 40.9485C30.0657 41.5382 30.0988 42.2745 29.7889 42.8944L28 42C29.7889 42.8944 29.7878 42.8965 29.7878 42.8965L29.7867 42.8987L29.7844 42.9032L29.7796 42.9128L29.7684 42.9343C29.7604 42.9496 29.7511 42.967 29.7405 42.9863C29.7193 43.0248 29.6928 43.0711 29.6607 43.1239C29.5967 43.2293 29.5097 43.3621 29.3969 43.5125C29.1719 43.8125 28.8387 44.1903 28.3744 44.5617C27.4203 45.325 25.9858 46 24 46C22.0142 46 20.5797 45.325 19.6256 44.5617C19.1613 44.1903 18.8281 43.8125 18.6031 43.5125C18.4903 43.3621 18.4033 43.2293 18.3393 43.1239C18.3072 43.0711 18.2807 43.0248 18.2595 42.9863C18.2489 42.967 18.2396 42.9496 18.2316 42.9343L18.2204 42.9128L18.2156 42.9032L18.2133 42.8987L18.2122 42.8965C18.2122 42.8965 18.2111 42.8944 20 42L18.2111 42.8944C17.9012 42.2745 17.9343 41.5382 18.2987 40.9485Z"}))}},25435:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 10H67C67.5523 10 68 10.4477 68 11V38.6587L58.5286 28.5108C57.1645 27.0493 54.8555 27.0253 53.4614 28.4582L38.0517 44.2959L32.4507 38.8026C31.0896 37.4677 28.9104 37.4677 27.5493 38.8026L4.24641 61.6574C4.09296 61.4816 4 61.2517 4 61V11C4 10.4477 4.44771 10 5 10ZM56.103 62L40.1936 46.3965L55.6115 30.5502C55.8107 30.3456 56.1406 30.349 56.3354 30.5578L68 43.0555V61C68 61.5523 67.5523 62 67 62H56.103ZM67 65H55.0193H55H54.8774H5.12266H5L4.98071 65C2.78045 64.9896 1 63.2027 1 61V11C1 8.79086 2.79086 7 5 7H67C69.2091 7 71 8.79086 71 11V41.873L71.0966 41.9765L71 42.0667V61C71 63.2091 69.2091 65 67 65ZM30.3501 40.9444L51.8186 62H8.18149L29.6499 40.9444C29.8444 40.7537 30.1557 40.7537 30.3501 40.9444ZM19.5 30C21.9853 30 24 27.9853 24 25.5C24 23.0147 21.9853 21 19.5 21C17.0147 21 15 23.0147 15 25.5C15 27.9853 17.0147 30 19.5 30Z"}))}},26027:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46Z",fill:"url(#InstagramCircleColor_paint0_radial)"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46Z",fill:"url(#InstagramCircleColor_paint1_radial)"}),n.createElement("path",{d:"M12.2689 29.0393L12.2683 29.0257L12.2674 29.0121C12.2581 28.8681 12.2467 28.7257 12.2361 28.5942L12.2357 28.5899C12.2259 28.4679 12.2168 28.3551 12.2093 28.2443V19.8627C12.21 19.8592 12.2108 19.8558 12.2115 19.8523C12.2258 19.7843 12.2503 19.6567 12.2525 19.5033C12.2783 18.5107 12.3298 17.6235 12.5372 16.7855C13.0067 14.9166 14.0499 13.622 15.7951 12.8635C16.7343 12.4582 17.7702 12.3191 18.9552 12.2691C19.2441 12.2596 19.5271 12.2332 19.7741 12.2093H28.1373C28.1408 12.21 28.1442 12.2108 28.1477 12.2115C28.2157 12.2258 28.3433 12.2503 28.4967 12.2525C29.4893 12.2783 30.3765 12.3298 31.2145 12.5372C33.0835 13.0068 34.3781 14.05 35.1366 15.7954C35.5419 16.7345 35.6809 17.7702 35.7309 18.9552C35.7404 19.244 35.7668 19.5271 35.7907 19.7741V28.1373C35.79 28.1408 35.7892 28.1442 35.7885 28.1477C35.7742 28.2157 35.7497 28.3433 35.7475 28.4967C35.7217 29.4894 35.6701 30.3768 35.4627 31.2149C34.9931 33.0836 33.9499 34.3781 32.2048 35.1366C31.2656 35.5418 30.2298 35.6809 29.0448 35.7309C28.756 35.7404 28.4729 35.7668 28.2259 35.7907H19.8627C19.8592 35.79 19.8558 35.7892 19.8523 35.7885C19.7843 35.7742 19.6567 35.7497 19.5033 35.7475C18.5106 35.7217 17.6232 35.6701 16.7851 35.4627C14.9165 34.9931 13.622 33.95 12.8635 32.205C12.4575 31.2643 12.3187 30.2267 12.2689 29.0393Z",stroke:"white",strokeWidth:"2.4186"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 28.207C26.3015 28.207 28.2068 26.327 28.2068 24.0508C28.2068 21.7071 26.3437 19.8017 24.0421 19.7933C21.69 19.7933 19.7931 21.6649 19.7931 23.9917C19.7931 26.3186 21.6731 28.207 24 28.207ZM30.5 24.0084C30.5 27.6083 27.583 30.5084 23.9831 30.5C20.4001 30.4916 17.5 27.583 17.5 23.9916C17.5 20.3917 20.417 17.4916 24.0169 17.5C27.5999 17.5084 30.5 20.417 30.5 24.0084Z",fill:"white"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M30.4921 15.3327C31.2981 15.3327 31.9446 15.9712 31.9446 16.7692C31.9446 17.5672 31.2981 18.2216 30.5001 18.2216C29.7101 18.2216 29.0557 17.5672 29.0557 16.7692C29.0636 15.9791 29.7101 15.3327 30.4921 15.3327Z",fill:"white"}),n.createElement("defs",null,n.createElement("radialGradient",{id:"InstagramCircleColor_paint0_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(13.6876 49.3889) rotate(-90) scale(43.6073 40.5582)"},n.createElement("stop",{stopColor:"#FFDD55"}),n.createElement("stop",{offset:"0.1",stopColor:"#FFDD55"}),n.createElement("stop",{offset:"0.5",stopColor:"#FF543E"}),n.createElement("stop",{offset:"1",stopColor:"#C837AB"})),n.createElement("radialGradient",{id:"InstagramCircleColor_paint1_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(-5.37023 5.16969) rotate(78.6806) scale(19.4926 80.3494)"},n.createElement("stop",{stopColor:"#3771C8"}),n.createElement("stop",{offset:"0.128",stopColor:"#3771C8"}),n.createElement("stop",{offset:"1",stopColor:"#6600FF",stopOpacity:"0"}))))}},26059:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"24",cy:"24",r:"24"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 16.9118C21 15.2513 20.8942 15.0909 20.709 15.0221C20.5238 14.9763 20.3122 14.9992 20.1799 15.1138L15.0741 19.5258H11.4762C11.2116 19.5258 11 19.7092 11 19.9384V28.084C11 28.3132 11.2116 28.4965 11.4762 28.4965H15.0741L20.1799 32.8862C20.3122 33.0008 20.5238 33.0237 20.709 32.9779C20.8942 32.9091 21 32.7487 21 32.5882V16.9118Z",fill:"white"}),n.createElement("path",{d:"M30.6653 15C32.7348 17.2304 34.0001 20.2174 34.0001 23.5C34.0001 26.7826 32.7348 29.7696 30.6653 32",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"}),n.createElement("path",{d:"M26.8799 17.8833C28.1994 19.381 28.9999 21.347 28.9999 23.5C28.9999 25.653 28.1994 27.6191 26.8799 29.1168",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"}))}},26354:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.58579 22.5858L20.8787 6.29289C21.2692 5.90237 21.9024 5.90237 22.2929 6.29289L23.7071 7.70711C24.0976 8.09763 24.0976 8.7308 23.7071 9.12132L10.8284 22H39C39.5523 22 40 22.4477 40 23V25C40 25.5523 39.5523 26 39 26H10.8284L23.7071 38.8787C24.0976 39.2692 24.0976 39.9024 23.7071 40.2929L22.2929 41.7071C21.9024 42.0976 21.2692 42.0976 20.8787 41.7071L4.58579 25.4142C3.80474 24.6332 3.80474 23.3668 4.58579 22.5858Z"}))}},26722:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M31.8549 23.3698C32.1558 23.7421 32.5944 23.9308 33.0382 23.9308C33.3799 23.9308 33.7216 23.8186 34.0073 23.584L44.5999 14.9006C44.992 14.7196 45.3058 14.3749 45.4323 13.928C45.5702 13.4408 45.454 12.9406 45.1634 12.5692C45.145 12.5441 45.1258 12.5196 45.1058 12.4957L36.0372 1.58075C35.5017 0.932996 34.5326 0.841188 33.8848 1.38183C33.2371 1.91738 33.1453 2.88646 33.6859 3.53421L40.007 11.1434C33.6606 10.3212 27.2427 11.5509 21.5521 14.7339C14.5492 18.651 9.49471 25.0572 7.31683 32.7792C5.13384 40.4962 6.09272 48.6058 10.0099 55.6036C13.927 62.6014 20.3382 67.661 28.0552 69.8389C30.7737 70.604 33.5126 70.9712 36.2057 70.9712C49.3087 70.9712 61.3814 62.3158 65.1251 49.1057C65.9513 46.178 66.3339 43.1586 66.2523 40.1442C66.2268 39.3129 65.5484 38.6549 64.7221 38.6549H64.6813C63.8347 38.6804 63.1716 39.3792 63.192 40.2258C63.2634 42.9342 62.9217 45.6425 62.177 48.2743C58.1324 62.5861 43.2034 70.9406 28.8916 66.9011C21.9551 64.9425 16.2018 60.4031 12.6825 54.1143C9.16318 47.8306 8.30121 40.5472 10.2598 33.6157C12.2183 26.6791 16.7577 20.9258 23.0465 17.4065C28.4154 14.3996 34.5141 13.3326 40.4996 14.3072L32.0691 21.2174C31.4162 21.7529 31.3193 22.7169 31.8549 23.3698Z"}))}},27010:(e,t,r)=>{"use strict";r.d(t,{p:()=>u});var n=r(40099);const i={snapchat:[/(?:Safari\/[\d.]+)?Snapchat\/?([\d.]+)/,/CronetSnapDevSheldon/],line:[/Line(?:[ /]([\d.]+))/],google_search_app:[/(?:com.google.GoogleMobile|GSA|GoogleApp)\/([\d.]+)?/],instagram_app:[/Instagram[ /]([\d.]+)?/],facebook_messenger:[/(?:MessengerForiOS|MESSENGER|FB_IAB\/Orca-Android).(?:FBAV)(?:[ /]([\d.]+))?/],facebook_messenger_lite:[/(?:mLite|MessengerLite(?:ForiOS)?).(?:FBAV)(?:[ /]([\d.]+))?/],facebook_lite:[/FBAN\/EMA.+FBAV(?:[ /]([\d.]+))?/],facebook:[/(?:FBAV|com.facebook.katana)(?:[ /]([\d.]+))?/,/(?:FBAN|FBSV|FBID|FBBV)\//],hey_tab_browser:[/HeyTapBrowser\/([\d.]+)/],vivo_browser:[/VivoBrowser(?:\/(\d+[.\d]+))?/],yandex_browser:[/YaBrowser(?:\/(\d+[.\d]*))(?: \((alpha|beta)\))?/],yandex_browser_alisa:[/Ya(?:ndex)?SearchBrowser(?:\/(\d+[.\d]*))/],samsung_browser:[/Samsung ?Browser(?:[/ ](\d+[.\d]+))?/],opera:[/(?:Opera Tablet.*Version|Opera\/.+Opera Mobi.+Version|Mobile.+OPR)\/(\d+[.\d]+)/,/Opera\/(\d+\.[.\d]+) .*Opera Mobi/],chrome_webview:[/Version\/.* Chrome(?:\/(\d+[.\d]+))?/],chrome:[/CrMo(?:\/(\d+[.\d]+))?/,/CriOS(?:\/(\d+[.\d]+))?/,/Chrome(?:\/(\d+[.\d]+))? Mobile/],safari:[/(?:(?:iPod|iPad|iPhone).+Version|MobileSafari)\/(\d+[.\d]+)/,/(?:Version\/(\d+\.[.\d]+) .)?Mobile.Safari\//,/Version\/(\d+\.[.\d]+) .*Safari\/|(?:Safari|Safari(?:%20)?%E6%B5%8F%E8%A7%88%E5%99%A8)\/?\d+/],unknown:[]};const o=e=>new Promise(t=>setTimeout(t,e));const s=3e4,a={yandex:!0},l=e=>{return t=void 0,r=void 0,l=function*(){var t,r;if(null===window||void 0===window?void 0:window.__RELATED_APPS_CACHE)return window.__RELATED_APPS_CACHE;const{ignores:n,timeout:l=s}=null!=e?e:{};return Object.assign(Object.assign({},n),a).yandex&&function(e){const t=function(e=(null===navigator||void 0===navigator?void 0:navigator.userAgent)){for(const[t,r]of Object.entries(i))if(r.some(t=>null==t?void 0:t.test(e)))return t;return"unknown"}(e);return"yandex_browser"===t||"yandex_browser_alisa"===t}(null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)?Promise.resolve(void 0):(null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.getInstalledRelatedApps)?(c=[window.navigator.getInstalledRelatedApps(),o(l)],new Promise((e,t)=>{c.forEach(r=>{Promise.resolve(r).then(e,t).catch(t)})})):Promise.resolve(void 0);var c},new((n=void 0)||(n=Promise))(function(e,i){function o(e){try{a(l.next(e))}catch(e){i(e)}}function s(e){try{a(l.throw(e))}catch(e){i(e)}}function a(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n(function(e){e(r)})).then(o,s)}a((l=l.apply(t,r||[])).next())});var t,r,n,l},c=(0,n.createContext)({strategy:{banners:[],buttons:[],popups:[],wrappers:[]},schemeParams:{},fallbackURLParams:{},experimentalFallbackTemplateURLParams:{}}),u=({strategy:e={},schemeParams:t={},fallbackURLParams:r={},experimentalFallbackTemplateURLParams:i={},checkOpenTime:o,useNewRedirectPath:s,uniqueId:a,experimentalSkipSchemes:u,enableApiOptimization:d,onInstalledRelatedAppsLoad:h,children:p,enableImpression:f=!1,experimentalUseAppLink:_,experimentalUseBetterAppLink:y,onImpression:g,experimentalEnableCoinApiOptimization:m,jumpHook:v,disableAfdp:b,experimentalUseShortDl:w,autoFillWhiteList:C,enableImpAfdp:E,enableImpParamsUrl:k})=>{const{relatedApps:T,initialized:S,costTime:O}=(e=>{const[t,r]=(0,n.useState)(),[i,o]=(0,n.useState)(!1),[s,a]=(0,n.useState)(0);return(0,n.useEffect)(()=>{const t=Date.now();l(e).then(e=>r(e)).catch(e=>{console.warn("getRelatedApps failed",e)}).then(()=>{a(Date.now()-t),o(!0)})},[e]),{relatedApps:t,initialized:i,costTime:s}})(),A=(0,n.useRef)(!1);(0,n.useEffect)(()=>{S&&(null==h||h({relatedApps:T,initialized:S,costTime:O}))},[T,S,O]);const $=(0,n.useMemo)(()=>({strategy:e,schemeParams:t,fallbackURLParams:r,experimentalFallbackTemplateURLParams:i,checkOpenTime:o,uniqueId:a,useNewRedirectPath:s,experimentalSkipSchemes:u,enableApiOptimization:d,installedApps:T,initialized:S,enableImpression:f,impressionReported:A,onImpression:g,experimentalEnableCoinApiOptimization:m,experimentalUseBetterAppLink:y,experimentalUseAppLink:_,jumpHook:v,disableAfdp:b,experimentalUseShortDl:w,autoFillWhiteList:C,enableImpAfdp:E,enableImpParamsUrl:k}),[e,t,r,i,o,a,s,u,d,T,S,f,A,g,m,y,_,v,b,w,C,E,k]);return n.createElement(c.Provider,{value:$},p)}},28319:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6ZM2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24C46 36.1503 36.1503 46 24 46C11.8497 46 2 36.1503 2 24ZM27 16C27 17.6569 25.6569 19 24 19C22.3431 19 21 17.6569 21 16C21 14.3431 22.3431 13 24 13C25.6569 13 27 14.3431 27 16ZM23 22C22.4477 22 22 22.4477 22 23V34C22 34.5523 22.4477 35 23 35H25C25.5523 35 26 34.5523 26 34V23C26 22.4477 25.5523 22 25 22H23Z"}))}},28367:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 12.5C17.6487 12.5 12.5 17.6487 12.5 24C12.5 30.3513 17.6487 35.5 24 35.5C26.8172 35.5 29.3919 34.4902 31.3919 32.8101C32.4491 31.9219 34.026 32.059 34.9142 33.1161C35.8023 34.1733 35.6653 35.7503 34.6081 36.6384C31.741 39.0471 28.0369 40.5 24 40.5C14.8873 40.5 7.5 33.1127 7.5 24C7.5 14.8873 14.8873 7.5 24 7.5C33.1127 7.5 40.5 14.8873 40.5 24C40.5 25.3807 39.3807 26.5 38 26.5C36.6193 26.5 35.5 25.3807 35.5 24C35.5 17.6487 30.3513 12.5 24 12.5Z"}))}},28436:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 2C7.68629 2 5 4.68629 5 8V40C5 43.3137 7.68629 46 11 46H37C40.3137 46 43 43.3137 43 40V8C43 4.68629 40.3137 2 37 2H11ZM9 8C9 6.89543 9.89543 6 11 6H37C38.1046 6 39 6.89543 39 8V40C39 41.1046 38.1046 42 37 42H11C9.89543 42 9 41.1046 9 40V8ZM26.063 14.1175C25.7306 13.4415 25.0465 13.0096 24.2933 13.0002C23.54 12.9907 22.8453 13.4054 22.4961 14.0729L15.6945 27.0746L12.4672 33.1814C12.2092 33.6697 12.3958 34.2747 12.8841 34.5328L14.6524 35.4672C15.1407 35.7253 15.7457 35.5386 16.0038 35.0503L18.6718 30.0017H29.4421L32.0324 35.0274C32.2854 35.5183 32.8885 35.7112 33.3794 35.4581L35.1572 34.5419C35.6481 34.2888 35.8409 33.6858 35.5879 33.1948L32.4477 27.1022L26.063 14.1175ZM27.4492 26.0017H20.77L24.213 19.4202L27.4492 26.0017Z"}))}},29098:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"24",cy:"24",r:"24",fill:"#20D5EC"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M37.1213 15.8787C38.2929 17.0503 38.2929 18.9497 37.1213 20.1213L23.6213 33.6213C22.4497 34.7929 20.5503 34.7929 19.3787 33.6213L10.8787 25.1213C9.70711 23.9497 9.70711 22.0503 10.8787 20.8787C12.0503 19.7071 13.9497 19.7071 15.1213 20.8787L21.5 27.2574L32.8787 15.8787C34.0503 14.7071 35.9497 14.7071 37.1213 15.8787Z",fill:"white"}))}},29212:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M26 7C26 6.44772 25.5523 6 25 6H23C22.4477 6 22 6.44772 22 7V22H7C6.44772 22 6 22.4477 6 23V25C6 25.5523 6.44772 26 7 26H22V41C22 41.5523 22.4477 42 23 42H25C25.5523 42 26 41.5523 26 41V26H41C41.5523 26 42 25.5523 42 25V23C42 22.4477 41.5523 22 41 22H26V7Z"}))}},29405:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var n=r(40099),i=r(47483),o=r(50321);const s=({strategy:e={},schemeParams:t={},fallbackURLParams:r={},experimentalFallbackTemplateURLParams:s={},checkOpenTime:a,useNewRedirectPath:l,uniqueId:c,experimentalSkipSchemes:u,enableApiOptimization:d,onInstalledRelatedAppsLoad:h,children:p,enableImpression:f=!1,experimentalUseAppLink:_,experimentalUseBetterAppLink:y,onImpression:g,experimentalEnableCoinApiOptimization:m,jumpHook:v,disableAfdp:b,experimentalUseShortDl:w,autoFillWhiteList:C,enableImpAfdp:E,enableImpParamsUrl:k})=>{const{relatedApps:T,initialized:S,costTime:O}=(0,i.xp)(),A=(0,n.useRef)(!1);(0,n.useEffect)(()=>{S&&(null==h||h({relatedApps:T,initialized:S,costTime:O}))},[T,S,O]);const $=(0,n.useMemo)(()=>({strategy:e,schemeParams:t,fallbackURLParams:r,experimentalFallbackTemplateURLParams:s,checkOpenTime:a,uniqueId:c,useNewRedirectPath:l,experimentalSkipSchemes:u,enableApiOptimization:d,installedApps:T,initialized:S,enableImpression:f,impressionReported:A,onImpression:g,experimentalEnableCoinApiOptimization:m,experimentalUseBetterAppLink:y,experimentalUseAppLink:_,jumpHook:v,disableAfdp:b,experimentalUseShortDl:w,autoFillWhiteList:C,enableImpAfdp:E,enableImpParamsUrl:k}),[e,t,r,s,a,c,l,u,d,T,S,f,A,g,m,y,_,v,b,w,C,E,k]);return n.createElement(o.J.Provider,{value:$},p)}},29580:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 11C9 8.23858 11.2386 6 14 6H34C36.7614 6 39 8.23858 39 11V40C39 40.7439 38.5871 41.4263 37.9282 41.7716C37.2693 42.1168 36.4732 42.0678 35.8616 41.6444L24 33.4325L12.1384 41.6444C11.5268 42.0678 10.7307 42.1168 10.0718 41.7716C9.41286 41.4263 9 40.7439 9 40V11ZM14 10C13.4477 10 13 10.4477 13 11V36.1829L22.8616 29.3556C23.5465 28.8815 24.4535 28.8815 25.1384 29.3556L35 36.1829V11C35 10.4477 34.5523 10 34 10H14Z"}))}},30459:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M6.5 17.5714C6.5 14.7292 8.86029 12.5 11.6782 12.5H27.8621C30.6799 12.5 33.0402 14.7292 33.0402 17.5714V18.6843L36.745 15.9435C37.6399 15.2815 38.8324 15.1731 39.8318 15.6537C40.8365 16.1369 41.5 17.1486 41.5 18.2857V29.7143C41.5 30.8514 40.8365 31.8631 39.8318 32.3463C38.8324 32.8269 37.6399 32.7185 36.745 32.0565L33.0402 29.3158V30.4286C33.0402 33.2708 30.6799 35.5 27.8621 35.5H11.6782C8.86029 35.5 6.5 33.2708 6.5 30.4286V17.5714Z"}),n.createElement("path",{d:"M23.25 23.134C23.9167 23.5189 23.9167 24.4811 23.25 24.866L17.25 28.3301C16.5833 28.715 15.75 28.2339 15.75 27.4641L15.75 20.5359C15.75 19.7661 16.5833 19.285 17.25 19.6699L23.25 23.134Z",fill:"white"}))}},30699:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 24 24",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{clipPath:"url(#HeartFill_clip0)"},n.createElement("g",{filter:"url(#HeartFill_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.5 2.25C10.5 2.25 12 4.25 12 4.25C12 4.25 13.5 2.25 16.5 2.25C20 2.25 22.5 4.99999 22.5 8.5C22.5 12.5 19.2311 16.0657 16.25 18.75C14.4095 20.4072 13 21.5 12 21.5C11 21.5 9.55051 20.3989 7.75 18.75C4.81949 16.0662 1.5 12.5 1.5 8.5C1.5 4.99999 4 2.25 7.5 2.25Z"})),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.40179 12.1998C3.58902 14.6966 5.7592 16.9269 7.74989 18.75C9.5504 20.3989 10.9999 21.5 11.9999 21.5C12.9999 21.5 14.4094 20.4072 16.2499 18.75C19.231 16.0657 22.4999 12.5 22.4999 8.49997C22.4999 8.41258 22.4983 8.32566 22.4952 8.23923C20.5671 13.6619 13.6787 18.5 11.75 18.5C10.3127 18.5 5.61087 15.8131 2.40179 12.1998Z",fillOpacity:"0.03"})),n.createElement("defs",null,n.createElement("filter",{id:"HeartFill_filter0_d",x:"-0.9",y:"1.05",width:"25.8",height:"24.05",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),n.createElement("feOffset",{dy:"1.2"}),n.createElement("feGaussianBlur",{stdDeviation:"1.2"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})),n.createElement("clipPath",{id:"HeartFill_clip0"},n.createElement("rect",{width:"24",height:"24",fill:"white"}))))}},30988:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.125 2.5C2.9514 2.5 2 3.45139 2 4.625V21.5C2 21.9045 2.24364 22.2691 2.61732 22.4239C2.99099 22.5787 3.42111 22.4931 3.70711 22.2071L7.35171 18.5625H19.875C21.0486 18.5625 22 17.6111 22 16.4375V4.625C22 3.45141 21.0486 2.5 19.875 2.5H4.125Z",fill:"#FE2C55"}),n.createElement("path",{d:"M10.9658 8.84675C11.2397 8.28818 11.6356 8.03174 12.058 8.03174C12.618 8.03174 13.0719 8.48569 13.0719 9.04566C13.0719 9.18801 12.9609 9.47812 12.5922 9.78372C12.3734 9.96507 12.1352 10.0902 11.9219 10.1603C11.7251 10.2249 11.5545 10.3953 11.5545 10.6024V11.8524C11.5545 12.0595 11.7231 12.2295 11.9285 12.2028C12.6448 12.1098 13.3386 11.7627 13.8685 11.3235C14.4804 10.8163 15.0719 10.0156 15.0719 9.04566C15.0719 7.38112 13.7226 6.03174 12.058 6.03174C10.5004 6.03174 9.53101 7.10786 9.06051 8.21109C8.97926 8.40159 9.08687 8.6147 9.28335 8.68019L10.4692 9.07547C10.6657 9.14097 10.8746 9.03271 10.9658 8.84675Z",fill:"white"}),n.createElement("path",{d:"M12.1245 15.2822C12.7458 15.2822 13.2495 14.7785 13.2495 14.1572C13.2495 13.5359 12.7458 13.0322 12.1245 13.0322C11.5032 13.0322 10.9995 13.5359 10.9995 14.1572C10.9995 14.7785 11.5032 15.2822 12.1245 15.2822Z",fill:"white"}))}},31147:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24C46 36.1503 36.1503 46 24 46C11.8497 46 2 36.1503 2 24ZM22 14C22 13.4477 22.4477 13 23 13H25C25.5523 13 26 13.4477 26 14V25C26 25.5523 25.5523 26 25 26H23C22.4477 26 22 25.5523 22 25V14ZM27 32C27 33.6569 25.6569 35 24 35C22.3431 35 21 33.6569 21 32C21 30.3431 22.3431 29 24 29C25.6569 29 27 30.3431 27 32Z"}))}},32778:(e,t,r)=>{"use strict";r.d(t,{F:()=>u});var n=r(40099),i=r(50321),o=r(73282);var s=r(20101),a=r(61978),l=r.n(a),c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const u=e=>{var{customStyle:t={},customClassNames:r=[],jumpStartHandler:a,jumpFailHandler:u,jumpCheckHandler:d,jumpEventHandler:h,jumpHook:p,onClick:f,target:_,children:y,schemeParams:g={},fallbackURLParams:m={},experimentalFallbackTemplateURLParams:v={},type:b="div",withDefaultHref:w=!1}=e,C=c(e,["customStyle","customClassNames","jumpStartHandler","jumpFailHandler","jumpCheckHandler","jumpEventHandler","jumpHook","onClick","target","children","schemeParams","fallbackURLParams","experimentalFallbackTemplateURLParams","type","withDefaultHref"]);const E=(0,n.useContext)(i.J),{strategy:k}=E,T=c(E,["strategy"]),S=null!=p?p:T.jumpHook,O=(0,n.useMemo)(()=>{if(null==k?void 0:k.wrappers)return k.wrappers.find(e=>e.name===_)},[k,_]),A=(0,n.useMemo)(()=>O&&O.wrapper_url?("enhance"===w?s.D:o.Ac)({launchType:O.launch_type,links:O.wrapper_url,schemeParams:g,fallbackURLParams:m,experimentalFallbackTemplateURLParams:v,providerContext:T}):"",[O,g,m,v,T]),$=null==k?void 0:k.page_context;(({links:e,fallbackURLParams:t,experimentalFallbackTemplateURLParams:r,launchType:s=""})=>{const a=(0,n.useContext)(i.J),{impressionReported:l,enableImpression:c=!1,onImpression:u,enableImpAfdp:d,enableImpParamsUrl:h}=a,p=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}(a,["impressionReported","enableImpression","onImpression","enableImpAfdp","enableImpParamsUrl"]),f=(0,n.useMemo)(()=>e?(0,o.FR)({strategy:{links:e,schemeParams:{},fallbackURLParams:t,experimentalFallbackTemplateURLParams:r,providerContext:p},customs:{disableAfdp:!d,removeParamsUrlForAfdp:d,addParamsUrl:h}}).processedFallbackURL:"",[e,t,r,p]);(0,n.useEffect)(()=>{if(c&&f&&!1===(null==l?void 0:l.current)){const[e,t]=(0,o.Vu)(f,s);if(t){l.current=!0;const t=`${f}&s2sAppType=${e}`;null==u||u(t),function(e,t="impression"){const r=new XMLHttpRequest,n=`https://www.tiktok.com/impression?onelink=${encodeURIComponent(e)}&type=${t}`;r.open("GET",n),r.send()}(t)}}},[f,s,c])})({links:null==O?void 0:O.wrapper_url,fallbackURLParams:m,experimentalFallbackTemplateURLParams:v,launchType:null==O?void 0:O.launch_type});const P=(0,n.useCallback)(e=>{var t;null==f||f(e),w&&e.preventDefault(),(null==O?void 0:O.wrapper_url)&&(0,o.s$)({target:null!==(t=O.name)&&void 0!==t?t:"",jumpLinkType:O.jump_link_type,launchType:O.launch_type,links:O.wrapper_url,jumpStartHandler:a,jumpFailHandler:u,jumpCheckHandler:d,jumpEventHandler:h,jumpHook:S,schemeParams:g,fallbackURLParams:m,experimentalFallbackTemplateURLParams:v,providerContext:T,strategyContext:$})},[a,u,d,h,S,f,O,g,m,v,T,$,w]);return w?n.createElement("a",Object.assign({style:t,className:l()("matrix-smart-wrapper","matrix-smart-wrapper-a",r),onClick:P,href:A},C),y):n.createElement(b,Object.assign({style:t,className:l()("matrix-smart-wrapper",r),onClick:P},C),y)}},32826:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M65.5598 8.58301C65.7634 7.98288 65.6085 7.31926 65.1604 6.87117C64.7123 6.42308 64.0487 6.26824 63.4486 6.47175L46.9398 12.07C46.3294 12.277 45.6562 12.1704 45.1397 11.7849L31.1689 1.35914C30.661 0.980141 29.982 0.922335 29.4174 1.21003C28.8528 1.49772 28.5004 2.08101 28.5085 2.71465L28.7313 20.1454C28.7396 20.7899 28.4301 21.3972 27.9039 21.7693L13.6712 31.8346C13.1538 32.2005 12.889 32.8284 12.9881 33.4543C13.0872 34.0802 13.5331 34.5955 14.1382 34.7836L29.4599 39.5463L1.31103 67.6952C0.934451 68.0718 0.934451 68.6823 1.31103 69.0589L2.30171 70.0496C2.67828 70.4262 3.28884 70.4262 3.66541 70.0496L32.167 41.548L37.248 57.8934C37.4361 58.4985 37.9514 58.9444 38.5773 59.0435C39.2032 59.1426 39.8311 58.8778 40.197 58.3604L50.2623 44.1277C50.6344 43.6015 51.2417 43.292 51.8862 43.3003L69.3169 43.5231C69.9506 43.5312 70.5339 43.1788 70.8216 42.6142C71.1093 42.0496 71.0515 41.3706 70.6725 40.8627L60.2467 26.8919C59.8612 26.3754 59.7546 25.7022 59.9616 25.0918L65.5598 8.58301ZM48.0091 15.2233L61.3233 10.7083L56.8083 24.0225C56.2494 25.6707 56.5373 27.4884 57.5782 28.8833L65.9865 40.1506L51.9288 39.9709C50.1885 39.9487 48.5487 40.7842 47.5438 42.2052L39.4262 53.6838L35.253 40.2586C34.7364 38.5966 33.435 37.2952 31.773 36.7786L18.3478 32.6054L29.8264 24.4878C31.2474 23.4829 32.0829 21.8431 32.0606 20.1028L31.881 6.04508L43.1483 14.4534C44.5432 15.4943 46.3609 15.7822 48.0091 15.2233ZM59.0797 48.8828C59.1765 48.6157 59.4714 48.4777 59.7384 48.5746L68.1621 51.6287C68.4291 51.7255 68.5671 52.0205 68.4703 52.2875L67.686 54.4507C67.5892 54.7177 67.2942 54.8557 67.0272 54.7589L58.6035 51.7048C58.3365 51.608 58.1985 51.313 58.2953 51.046L59.0797 48.8828ZM54.8495 53.3404C54.7864 53.0635 54.5107 52.8902 54.2338 52.9533L51.9903 53.4647C51.7134 53.5279 51.5401 53.8035 51.6032 54.0805L53.5947 62.8166C53.6578 63.0935 53.9335 63.2668 54.2104 63.2037L56.4539 62.6923C56.7309 62.6291 56.9042 62.3535 56.841 62.0765L54.8495 53.3404ZM19.2837 20.9359C19.2608 21.219 19.0127 21.4299 18.7296 21.407L9.79862 20.6839C9.51552 20.6609 9.30459 20.4129 9.32752 20.1297L9.51322 17.8362C9.53614 17.5531 9.78422 17.3422 10.0673 17.3651L18.9983 18.0882C19.2814 18.1112 19.4924 18.3592 19.4694 18.6423L19.2837 20.9359ZM20.639 15.0928C20.773 15.3432 21.0846 15.4376 21.335 15.3037L23.3641 14.2184C23.6145 14.0844 23.7089 13.7728 23.575 13.5223L19.3488 5.62135C19.2149 5.37089 18.9032 5.27646 18.6528 5.41042L16.6238 6.49571C16.3733 6.62968 16.2789 6.94131 16.4129 7.19177L20.639 15.0928Z"}))}},33758:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{clipPath:"url(#PCShare_clip0)"},n.createElement("g",{opacity:"1",filter:"url(#PCShare_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.9376 3.17495C10.9376 2.58272 11.6469 2.27873 12.0758 2.68715L18.6021 8.90241C19.1764 9.44937 19.1564 10.3717 18.5588 10.8931L12.0541 16.5689C11.6184 16.9491 10.9376 16.6397 10.9376 16.0614V13.4894C10.9376 13.4894 3.95344 12.2312 1.7131 16.3434C1.50423 16.7268 0.690072 16.8609 0.855563 14.948C1.54761 11.4273 2.96196 5.93084 10.9376 5.93084V3.17495Z"})),n.createElement("path",{opacity:"0.03",fillRule:"evenodd",clipRule:"evenodd",d:"M15.7538 6.21161L17.0486 8.80136C17.2777 9.25947 17.1677 9.81453 16.7812 10.1506L10.9824 15.193C10.9824 15.193 10.7017 16.5964 11.5437 16.5964C12.3857 16.5964 19.1218 10.4217 19.1218 10.4217C19.1218 10.4217 19.4025 9.57964 18.5605 8.73763C17.7185 7.89563 15.7538 6.21161 15.7538 6.21161Z"}),n.createElement("path",{opacity:"0.09",fillRule:"evenodd",clipRule:"evenodd",d:"M10.9374 6.22983V13.5272C10.9374 13.5272 4.25359 12.5854 2.16026 15.7726C0.146021 18.8394 0.331011 12.3091 3.36331 9.05711C6.39561 5.8051 10.9374 6.22983 10.9374 6.22983Z",fill:"url(#PCShare_paint0_radial)"})),n.createElement("defs",null,n.createElement("filter",{id:"PCShare_filter0_d",x:"-0.166473",y:"2.5",width:"20.1867",height:"16.2363",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",{dy:"1"}),n.createElement("feGaussianBlur",{stdDeviation:"0.5"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})),n.createElement("radialGradient",{id:"PCShare_paint0_radial",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(11.1827 18.2553) rotate(-113.046) scale(8.93256 8.78076)"},n.createElement("stop",null),n.createElement("stop",{offset:"0.995496",stopOpacity:"0.01"}),n.createElement("stop",{offset:"1",stopOpacity:"0.01"})),n.createElement("clipPath",{id:"PCShare_clip0"},n.createElement("rect",{width:"20",height:"20",fill:"white"}))))}},33958:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M15 14C14.4477 14 14 14.4478 14 15V33C14 33.5523 14.4477 34 15 34H17C17.5523 34 18 33.5523 18 33V21L21.9562 33.3061C22.0891 33.7196 22.4738 34 22.9082 34H25.0911C25.5255 34 25.9102 33.7196 26.0431 33.3061L30 21V33C30 33.5523 30.4477 34 31 34H33C33.5523 34 34 33.5523 34 33V15C34 14.4477 33.5523 14 33 14L29.7129 14.0001C29.2863 14.0001 28.9067 14.2707 28.7676 14.6741L24 28.5L19.2324 14.6741C19.0933 14.2707 18.7137 14.0001 18.287 14.0001L15 14Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 11C3 6.58172 6.58172 3 11 3H37C41.4183 3 45 6.58172 45 11V37C45 41.4183 41.4183 45 37 45H11C6.58172 45 3 41.4183 3 37V11ZM11 7H37C39.2091 7 41 8.79086 41 11V37C41 39.2091 39.2091 41 37 41H11C8.79086 41 7 39.2091 7 37V11C7 8.79086 8.79086 7 11 7Z"}))}},34475:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.41 17L18.9739 7.47047C18.9895 7.20626 19.2083 7 19.473 7H20.4682C20.7558 7 20.9841 7.24206 20.9673 7.52919L20.4135 17H28.41L28.9739 7.47047C28.9895 7.20626 29.2083 7 29.473 7H30.4682C30.7558 7 30.9841 7.24206 30.9673 7.52919L30.4135 17H38.5C38.7761 17 39 17.2239 39 17.5V18.5C39 18.7761 38.7761 19 38.5 19H30.2958L29.7664 28H37.5C37.7761 28 38 28.2239 38 28.5V29.5C38 29.7761 37.7761 30 37.5 30H29.6488L29.0276 40.5596C29.0114 40.8353 28.7748 41.0456 28.4991 41.0294L27.5009 40.9706C27.2252 40.9544 27.0149 40.7178 27.0311 40.4422L27.6453 30H19.6488L19.0276 40.5596C19.0114 40.8353 18.7748 41.0456 18.4991 41.0294L17.5009 40.9706C17.2252 40.9544 17.0149 40.7178 17.0311 40.4422L17.6453 30H9.5C9.22386 30 9 29.7761 9 29.5V28.5C9 28.2239 9.22386 28 9.5 28H17.763L18.2924 19H10.5C10.2239 19 10 18.7761 10 18.5V17.5C10 17.2239 10.2239 17 10.5 17H18.41ZM20.2958 19L19.7664 28H27.763L28.2924 19H20.2958Z"}))}},34922:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 28 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{filter:"url(#RedPlusCircleColor_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 25C20.6274 25 26 19.6274 26 13C26 6.37258 20.6274 1 14 1C7.37258 1 2 6.37258 2 13C2 19.6274 7.37258 25 14 25Z",fill:"#FE2C55"})),n.createElement("path",{d:"M9.5 14C9.22386 14 9 13.7761 9 13.5V12.5C9 12.2239 9.22386 12 9.5 12H18.5C18.7761 12 19 12.2239 19 12.5V13.5C19 13.7761 18.7761 14 18.5 14H9.5Z",fill:"white"}),n.createElement("path",{d:"M13 8.5C13 8.22386 13.2239 8 13.5 8H14.5C14.7761 8 15 8.22386 15 8.5V17.5C15 17.7761 14.7761 18 14.5 18H13.5C13.2239 18 13 17.7761 13 17.5V8.5Z",fill:"white"}),n.createElement("defs",null,n.createElement("filter",{id:"RedPlusCircleColor_filter0_d",x:"0",y:"0",width:"28",height:"28",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",{dy:"1"}),n.createElement("feGaussianBlur",{stdDeviation:"1"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"}))))}},35877:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M31.5 33C31.5 33.5523 31.0523 34 30.5 34H20.5C19.3954 34 18.5 33.1046 18.5 32V15C18.5 14.4477 18.9477 14 19.5 14H21.5C22.0523 14 22.5 14.4477 22.5 15V30H30.5C31.0523 30 31.5 30.4477 31.5 31V33Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 11C3 6.58172 6.58172 3 11 3H37C41.4183 3 45 6.58172 45 11V37C45 41.4183 41.4183 45 37 45H11C6.58172 45 3 41.4183 3 37V11ZM11 7H37C39.2091 7 41 8.79086 41 11V37C41 39.2091 39.2091 41 37 41H11C8.79086 41 7 39.2091 7 37V11C7 8.79086 8.79086 7 11 7Z"}))}},35895:(e,t,r)=>{"use strict";r.d(t,{Aq:()=>v,Bw:()=>$,E4:()=>y,KJ:()=>l,Kg:()=>c,NC:()=>i,NK:()=>S,PW:()=>u,SC:()=>h,TS:()=>x,Yp:()=>n,bB:()=>P,dX:()=>k,f:()=>O,fU:()=>d,hQ:()=>a,hh:()=>f,k5:()=>A,mX:()=>w,qE:()=>_,qo:()=>R,uG:()=>T,wl:()=>s});const n="https://www.tiktokv.com",i="https://app-va.tiktokv.com";var o,s;!function(e){e.I18N="I18N",e.ALISG="ALISG",e.MALIVA="MALIVA",e["US-TTP"]="US-TTP"}(o||(o={})),function(e){e.DEFAULT="default",e.APP_LINK="AppLink",e.ONE_LINK="OneLink"}(s||(s={})),o.I18N,o.ALISG,o.MALIVA,o["US-TTP"];const a={tiktok_app:"redirect/",now_app:"now_redirect/",alligator_app:"alligator_redirect/",tiktok_lite_app:"lite_redirect/",tiktok_pro:"lite_redirect/"};function l(){return"android"===function(){const e=navigator.userAgent;return/android/i.test(e)?"android":/iPhone|iPad|iPod|iOS/i.test(e)?"ios":/\(Macintosh; Intel /.test(e)?"mac":/Win\d{2}|Windows/.test(e)?"windows":"unknown"}()}function c(e){return"string"==typeof e}function u(e){return e.reduce((e,t)=>(e[t[0]]=t[1],e),{})}function d(){return"undefined"==typeof window}function h(){return void 0!==window.melonapp}function p(){return Boolean(document.hidden||document.webkitHidden)}function f(e){return new Promise(t=>{const r=null!=e?e:1e3;let n=0;const i=Number(new Date),o=r/20,s=()=>{p()&&(t(!0),document.removeEventListener("visibilitychange",s))};document.addEventListener("visibilitychange",s);const a=setInterval(()=>{n++;const e=Number(new Date)-i,l=Boolean(e>Math.max(2*r,1e3)||p());(n>=o||l)&&(clearInterval(a),t(l),document.removeEventListener("visibilitychange",s))},20)})}function _(e,t={}){const r=Object.assign({},t),n=e.replace(/\{\{([\w.]*)\}\}/g,function(e,n){const i=t[n];return delete r[n],null!=i?i:""}),i=Object.entries(r).map(([e,t])=>`${e}=${t}`).join("&");return`${n}${i?n.includes("?")?`&${i}`:`?${i}`:""}`}const y={Snapchat:/Snapchat/gi,WeChat:/MicroMessenger/gi,Band:/Band/gi,KakaoTalk:/KAKAOTALK/gi,Messenger:/Messenger/gi,Line:/Line/gi,Facebook:/FBAN|FBAV/gi};function g(e){return null==e?void 0:e.startsWith("snssdk1180")}function m(e){return null==e?void 0:e.startsWith("snssdk1340")}function v(e){return m(e)?"lite":g(e)?"t":"m"}const b={t:"BAuo",m:"bIdt",lite:"k3Nj",coin:"4P4E",pro:"EGgf"};function w(e){return function(e){return e.startsWith("https://snssdk1180")||e.includes(`/${b.t}`)}(e)?"t":function(e){return e.startsWith("https://snssdk1233")||e.includes(`/${b.m}`)}(e)?"m":function(e){return e.startsWith("https://snssdk1340")||e.includes(`/${b.lite}`)}(e)?"lite":function(e){return(null==e?void 0:e.startsWith("https://snssdk473824"))&&e.includes(`/${b.coin}`)}(e)?"coin":function(e){return(null==e?void 0:e.startsWith("https://snssdk473824"))&&e.includes(`/${b.pro}`)}(e)?"pro":void 0}const C=["MO","TW","JP","KR","ID","MY","KH","MM","LA","PH","TH","VN","SG","PK","LK","NP"],E=["PK","LK","NP"];function k(e=""){return"t"===function(e){return C.includes(e)&&!E.includes(e)?"t":"m"}(e)}const T="com.zhiliaoapp.musically",S="com.ss.android.ugc.trill",O="com.zhiliaoapp.musically.go",A="com.ss.android.ugc.tiktok.lite",$=["af_dp","tt_target"];function P(e,t){const r=new URL(e),n=new URLSearchParams(r.search);return n.delete(t),r.search=n.toString(),r.toString()}function R(e,...t){if("function"==typeof e)try{e=e(...t)}catch(t){e={}}return e}function x({links:e}){const{url_schemes:t,extra:r}=null!=e?e:{},n=null!=t?t:[];let i="m";g(n[0])?i="t":m(n[0])&&(i="lite");const o={appType:i};try{const e=JSON.parse(null!=r?r:"{}");return Object.assign(Object.assign({},o),e)}catch(e){}return o}},36970:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 6C14.0589 6 6 14.0589 6 24C6 33.9411 14.0589 42 24 42C33.9411 42 42 33.9411 42 24C42 14.0589 33.9411 6 24 6ZM2 24C2 11.8497 11.8497 2 24 2C36.1503 2 46 11.8497 46 24C46 36.1503 36.1503 46 24 46C11.8497 46 2 36.1503 2 24ZM27 32C27 33.6569 25.6569 35 24 35C22.3431 35 21 33.6569 21 32C21 30.3431 22.3431 29 24 29C25.6569 29 27 30.3431 27 32ZM23 13C22.4477 13 22 13.4477 22 14V25C22 25.5523 22.4477 26 23 26H25C25.5523 26 26 25.5523 26 25V14C26 13.4477 25.5523 13 25 13H23Z"}))}},37694:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 9.31286V27.0626C9.98685 26.7378 11.184 26.4042 12.5108 26.1585C16.1115 25.4917 21.0181 25.4123 25.1625 28.3726C28.0181 30.4123 31.6115 30.4917 34.7608 29.9085C36.306 29.6223 37.6602 29.1908 38.6289 28.8293C38.7603 28.7803 38.8841 28.7328 39 28.6872V10.9374C38.0131 11.2623 36.816 11.5959 35.4892 11.8416C31.8885 12.5084 26.9819 12.5878 22.8375 9.62751C19.9819 7.58781 16.3885 7.5084 13.2392 8.09161C11.694 8.37776 10.3398 8.80927 9.37105 9.17072C9.23971 9.21973 9.11586 9.2673 9 9.31286ZM40.1067 6.21064C40.7264 5.90123 41.4622 5.93453 42.0515 6.29874C42.6411 6.66315 43 7.30688 43 8.00004V30C43 30.7576 42.572 31.4501 41.8944 31.7889L41 30C41.8944 31.7889 41.8931 31.7895 41.8931 31.7895L41.8916 31.7903L41.8878 31.7922L41.8775 31.7973L41.846 31.8127C41.831 31.82 41.8128 31.8288 41.7915 31.839C41.7761 31.8464 41.7589 31.8545 41.7401 31.8634C41.651 31.9055 41.525 31.9637 41.3654 32.0343C41.0466 32.1753 40.5919 32.3663 40.0273 32.577C38.9023 32.9967 37.319 33.5027 35.4892 33.8416C31.8885 34.5084 26.9819 34.5878 22.8375 31.6275C19.9819 29.5878 16.3885 29.5084 13.2392 30.0916C11.694 30.3778 10.3398 30.8093 9.37105 31.1707C9.23971 31.2197 9.11586 31.2673 9 31.3129V44.0001C9 44.5524 8.55228 45.0001 8 45.0001H6C5.44772 45.0001 5 44.5524 5 44.0001V8.00004C5 7.24249 5.42801 6.54996 6.10558 6.21118L7 8.00004C6.10558 6.21118 6.10688 6.21053 6.10688 6.21053L6.10842 6.20976L6.11219 6.20789L6.12249 6.20279L6.15404 6.18734C6.17988 6.17477 6.21529 6.15773 6.25987 6.13667C6.34902 6.09457 6.47498 6.03636 6.63455 5.9658C6.95342 5.8248 7.4081 5.63378 7.9727 5.42311C9.09774 5.00332 10.681 4.49734 12.5108 4.15849C16.1115 3.49171 21.0181 3.4123 25.1625 6.37257C28.0181 8.41227 31.6115 8.49167 34.7608 7.90846C36.306 7.62231 37.6602 7.1908 38.6289 6.82935C39.1112 6.6494 39.4925 6.48886 39.7478 6.37595C39.8754 6.31956 39.9711 6.27523 40.0318 6.24653C40.0622 6.23219 40.0838 6.22177 40.0962 6.21572L40.1056 6.21118L40.1067 6.21064Z"}))}},37801:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M24 47C36.7025 47 47 36.7025 47 24C47 11.2975 36.7025 1 24 1C11.2975 1 1 11.2975 1 24C1 36.7025 11.2975 47 24 47Z",fill:"white"}),n.createElement("path",{d:"M24 1C11.2964 1 1 11.2964 1 24C1 35.4775 9.40298 44.9804 20.3846 46.7205L20.3936 30.6629H14.5151V24.009H20.3936C20.3936 24.009 20.3665 20.2223 20.3936 18.5363C20.4206 16.8503 20.7542 15.2274 21.6288 13.7487C22.9722 11.4586 25.0639 10.3407 27.6335 10.0251C29.7432 9.76362 31.826 10.0521 33.9087 10.3407C34.0529 10.3587 34.125 10.3767 34.2693 10.4038C34.2693 10.4038 34.2783 10.6472 34.2693 10.8005C34.2603 12.4053 34.2693 16.0839 34.2693 16.0839C33.2685 16.0659 31.6096 15.9667 30.5096 16.138C28.6884 16.4175 27.6425 17.5806 27.6064 19.4108C27.5704 20.8354 27.5884 24.009 27.5884 24.009H33.9988L32.962 30.6629H27.5974V46.7205C38.597 44.9984 47.009 35.4775 47.009 24C47 11.2964 36.7036 1 24 1Z",fill:"#0075FA"}))}},38017:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{filter:"url(#LikeRedShadowColor_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 4.5C21 4.5 24 8.5 24 8.5C24 8.5 27 4.5 33 4.5C40 4.5 45 9.99998 45 17C45 25 38.4622 32.1314 32.5 37.5C28.8191 40.8144 26 43 24 43C22 43 19.101 40.7978 15.5 37.5C9.63898 32.1325 3 25 3 17C3 9.99998 8 4.5 15 4.5Z",fill:"#FE2C55"})),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.80371 24.3995C7.17815 29.3932 11.5185 33.8538 15.4999 37.4999C19.1009 40.7978 21.9999 42.9999 23.9999 42.9999C25.9999 42.9999 28.819 40.8144 32.4999 37.4999C38.4621 32.1314 44.9999 24.9999 44.9999 16.9999C44.9999 16.8252 44.9968 16.6513 44.9906 16.4785C41.1344 27.3238 27.3575 37 23.5001 37C20.6255 37 11.2219 31.6262 4.80371 24.3995Z",fill:"black",fillOpacity:"0.03"}),n.createElement("defs",null,n.createElement("filter",{id:"LikeRedShadowColor_filter0_d",x:"0.6",y:"3.3",width:"46.8",height:"43.3",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",{dy:"1.2"}),n.createElement("feGaussianBlur",{stdDeviation:"1.2"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"}))))}},38155:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 24 24",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 5.5C1.5 3.29086 3.29086 1.5 5.5 1.5H18.5C20.7091 1.5 22.5 3.29086 22.5 5.5V18.5C22.5 20.7091 20.7091 22.5 18.5 22.5H5.5C3.29086 22.5 1.5 20.7091 1.5 18.5V5.5ZM5.5 3.5H18.5C19.6046 3.5 20.5 4.39543 20.5 5.5V18.5C20.5 19.6046 19.6046 20.5 18.5 20.5H5.5C4.39543 20.5 3.5 19.6046 3.5 18.5V5.5C3.5 4.39543 4.39543 3.5 5.5 3.5Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.6771 6.2998C8.46886 6.2998 8.30005 6.46862 8.30005 6.67685V17.4228C8.30005 17.631 8.46886 17.7998 8.6771 17.7998H10.0421C10.2504 17.7998 10.4192 17.631 10.4192 17.4228V12.8987H15.537C15.7452 12.8987 15.914 12.7299 15.914 12.5217V11.3405C15.914 11.1323 15.7452 10.9635 15.537 10.9635H10.4192V8.23508H15.6525C15.8607 8.23508 16.0296 8.06627 16.0296 7.85803V6.67685C16.0296 6.46862 15.8607 6.2998 15.6525 6.2998H8.6771Z"}))}},38470:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"24",cy:"24",r:"24",fill:"000",fillOpacity:"1"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21 16.9118C21 15.2513 20.8942 15.0909 20.709 15.0221C20.5238 14.9763 20.3122 14.9992 20.1799 15.1138L15.0741 19.5258H11.4762C11.2116 19.5258 11 19.7092 11 19.9384V28.084C11 28.3132 11.2116 28.4965 11.4762 28.4965H15.0741L20.1799 32.8862C20.3122 33.0008 20.5238 33.0237 20.709 32.9779C20.8942 32.9091 21 32.7487 21 32.5882V16.9118Z",fill:"white"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M35.098 18.9489C34.5998 18.4508 33.7921 18.4508 33.2939 18.949L30.1368 22.1061L26.9797 18.949C26.4815 18.4508 25.6738 18.4508 25.1756 18.9489C24.6775 19.4471 24.6775 20.2548 25.1756 20.753L28.3327 23.9101L25.1757 27.0672C24.6775 27.5654 24.6775 28.3731 25.1757 28.8713C25.6738 29.3694 26.4815 29.3694 26.9797 28.8713L30.1368 25.7142L33.2939 28.8713C33.7921 29.3694 34.5998 29.3694 35.0979 28.8713C35.5961 28.3731 35.5961 27.5654 35.0979 27.0672L31.9409 23.9101L35.098 20.753C35.5962 20.2548 35.5962 19.4471 35.098 18.9489Z",fill:"white"}))}},40815:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 47.001C36.7026 47.001 47 36.7035 47 24.001C47 11.2984 36.7026 1.00098 24 1.00098C11.2975 1.00098 1 11.2984 1 24.001C1 36.7035 11.2975 47.001 24 47.001Z",fill:"#00B900"}),n.createElement("path",{d:"M40.0001 22.4324C40.0001 15.2729 32.8228 9.44822 23.9999 9.44822C15.1782 9.44822 8 15.2729 8 22.4324C8 28.8509 13.6922 34.2263 21.3811 35.2427C21.9022 35.355 22.6114 35.5863 22.7908 36.0316C22.9522 36.4362 22.8963 37.0699 22.8423 37.4784C22.8423 37.4784 22.6546 38.6075 22.6141 38.848C22.5445 39.2525 22.2927 40.43 23.9999 39.7105C25.7078 38.9909 33.2145 34.2848 36.5713 30.421H36.5707C38.8895 27.8783 40.0001 25.2978 40.0001 22.4324Z",fill:"white"}),n.createElement("path",{d:"M20.7494 18.9727H19.6271C19.4551 18.9727 19.3152 19.1123 19.3152 19.2837V26.2556C19.3152 26.4273 19.4551 26.5666 19.6271 26.5666H20.7494C20.9215 26.5666 21.0611 26.4273 21.0611 26.2556V19.2837C21.0611 19.1123 20.9215 18.9727 20.7494 18.9727Z",fill:"#00B900"}),n.createElement("path",{d:"M28.4738 18.9727H27.3515C27.1794 18.9727 27.0399 19.1123 27.0399 19.2837V23.4257L23.845 19.1111C23.8377 19.1 23.8294 19.0896 23.8208 19.0795L23.8187 19.0776C23.8125 19.0706 23.8064 19.0644 23.7999 19.0583C23.7981 19.0565 23.7963 19.0549 23.7941 19.0531C23.7889 19.0482 23.7834 19.0436 23.7776 19.0393C23.7751 19.0368 23.7723 19.035 23.7696 19.0328C23.7641 19.0292 23.7588 19.0252 23.7533 19.0218C23.7503 19.0197 23.7472 19.0178 23.7438 19.0163C23.7383 19.0129 23.7328 19.0095 23.7272 19.0068C23.7239 19.0052 23.7208 19.0034 23.7174 19.0022C23.7116 18.9994 23.7058 18.9967 23.6996 18.9945C23.696 18.9933 23.6929 18.9921 23.6895 18.9908C23.6834 18.9887 23.6773 18.9865 23.6708 18.985C23.6674 18.9838 23.6638 18.9832 23.6601 18.9819C23.6539 18.9807 23.6481 18.9792 23.6423 18.9779C23.638 18.9773 23.6334 18.9767 23.6291 18.9764C23.6236 18.9752 23.6181 18.9749 23.6125 18.9743C23.6073 18.9737 23.6021 18.9737 23.5966 18.9733C23.5926 18.9733 23.5895 18.9727 23.5855 18.9727H22.4635C22.2915 18.9727 22.1516 19.1123 22.1516 19.2837V26.2556C22.1516 26.4273 22.2915 26.5666 22.4635 26.5666H23.5855C23.7579 26.5666 23.8975 26.4273 23.8975 26.2556V22.1148L27.0963 26.435C27.1184 26.4663 27.1457 26.4917 27.1754 26.512C27.1764 26.5126 27.1776 26.5135 27.1785 26.5144C27.1849 26.5184 27.1914 26.5224 27.1978 26.5261C27.2009 26.5279 27.2037 26.5292 27.2067 26.5307C27.2113 26.5335 27.2165 26.5359 27.2214 26.5381C27.2267 26.5402 27.2313 26.5424 27.2368 26.5445C27.2398 26.5457 27.2429 26.547 27.246 26.5479C27.2533 26.5506 27.2601 26.5528 27.2671 26.5549C27.2687 26.5549 27.2702 26.5555 27.2717 26.5559C27.2972 26.5626 27.3239 26.5666 27.3515 26.5666H28.4738C28.6462 26.5666 28.7854 26.4273 28.7854 26.2556V19.2837C28.7854 19.1123 28.6462 18.9727 28.4738 18.9727Z",fill:"#00B900"}),n.createElement("path",{d:"M18.0433 24.821H14.9939V19.2843C14.9939 19.1123 14.8543 18.9727 14.6825 18.9727H13.5599C13.3879 18.9727 13.2483 19.1123 13.2483 19.2843V26.2549V26.2555C13.2483 26.3393 13.2817 26.415 13.3354 26.4709C13.3366 26.4724 13.3379 26.4739 13.3397 26.4755C13.3412 26.477 13.3428 26.4782 13.3443 26.4798C13.4004 26.5337 13.4759 26.5669 13.5596 26.5669H13.5599H18.0433C18.2154 26.5669 18.3543 26.427 18.3543 26.2549V25.1326C18.3543 24.9606 18.2154 24.821 18.0433 24.821Z",fill:"#00B900"}),n.createElement("path",{d:"M34.6715 20.7186C34.8435 20.7186 34.9825 20.5793 34.9825 20.4069V19.2846C34.9825 19.1126 34.8435 18.9727 34.6715 18.9727H30.1881H30.1875C30.1034 18.9727 30.0277 19.0064 29.9715 19.0607C29.9703 19.062 29.9688 19.0629 29.9679 19.0641C29.966 19.0659 29.9645 19.0678 29.963 19.0696C29.9096 19.1254 29.8765 19.2009 29.8765 19.2843V19.2846V26.2552V26.2555C29.8765 26.3393 29.9099 26.415 29.9636 26.4709C29.9648 26.4724 29.9663 26.4742 29.9679 26.4755C29.9691 26.477 29.9709 26.4785 29.9725 26.4798C30.0283 26.5334 30.1041 26.5669 30.1875 26.5669H30.1881H34.6715C34.8435 26.5669 34.9825 26.427 34.9825 26.2552V25.1326C34.9825 24.9609 34.8435 24.821 34.6715 24.821H31.6223V23.6426H34.6715C34.8435 23.6426 34.9825 23.503 34.9825 23.3309V22.2086C34.9825 22.0366 34.8435 21.8967 34.6715 21.8967H31.6223V20.7186H34.6715Z",fill:"#00B900"}))}},41432:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{clipPath:"url(#LogoColor_clip0_21014_132420)"},n.createElement("rect",{width:"20",height:"20",fill:"black"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.4698 3.72282C12.404 3.46505 12.369 3.19488 12.369 2.9165H10.0511V7.47007V8.22037V12.1248C10.0511 13.1867 9.1938 14.0475 8.13627 14.0475C7.07875 14.0475 6.22145 13.1867 6.22145 12.1248C6.22145 11.063 7.07875 10.2022 8.13627 10.2022C8.34757 10.2022 8.55088 10.2366 8.74095 10.3V7.81567C8.54335 7.78797 8.34147 7.77365 8.13627 7.77365C5.74292 7.77365 3.80273 9.72174 3.80273 12.1248C3.80273 14.5279 5.74292 16.476 8.13627 16.476C10.4959 16.476 12.4163 14.5824 12.4698 12.226V12.1248V7.51436C13.3594 8.12491 14.4351 8.48198 15.594 8.48198V6.1546C14.0901 6.1546 12.8267 5.12106 12.4698 3.72282Z",fill:"#25F4EE"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.0733 4.33024C13.0075 4.07247 12.9725 3.8023 12.9725 3.52393H10.6546V8.0775V8.82779V12.7323C10.6546 13.7941 9.79731 14.6549 8.73979 14.6549C7.68226 14.6549 6.82497 13.7941 6.82497 12.7323C6.82497 11.6704 7.68226 10.8096 8.73979 10.8096C8.95109 10.8096 9.15439 10.844 9.34447 10.9075V8.42309C9.14686 8.39539 8.94499 8.38107 8.73979 8.38107C6.34644 8.38107 4.40625 10.3292 4.40625 12.7323C4.40625 15.1354 6.34644 17.0834 8.73979 17.0834C11.0994 17.0834 13.0198 15.1898 13.0733 12.8334V12.7323V8.12179C13.9629 8.73233 15.0387 9.0894 16.1975 9.0894V6.76202C14.6936 6.76202 13.4302 5.72848 13.0733 4.33024Z",fill:"white"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.424 3.52344C12.4367 3.59054 12.4514 3.65691 12.4681 3.72247C12.6502 4.43577 13.0682 5.05415 13.6337 5.48883C13.3749 5.1491 13.1816 4.7564 13.0727 4.32975C13.0069 4.07198 12.9719 3.80181 12.9719 3.52344H12.424ZM15.5923 6.70473V8.48163C14.4335 8.48163 13.3577 8.12456 12.4681 7.51401V12.1245V12.2257C12.4146 14.582 10.4943 16.4757 8.13461 16.4757C7.09154 16.4757 6.13455 16.1057 5.38672 15.4892C6.18146 16.4622 7.3881 17.083 8.73913 17.083C11.0988 17.083 13.0191 15.1893 13.0727 12.833V12.7318V8.1213C13.9622 8.73184 15.038 9.08891 16.1968 9.08891V6.76153C15.9902 6.76153 15.7881 6.74202 15.5923 6.70473ZM8.73929 8.38058V10.2997C8.54922 10.2362 8.34591 10.2019 8.13461 10.2019C7.07708 10.2019 6.21979 11.0627 6.21979 12.1245C6.21979 12.8107 6.57783 13.4129 7.11657 13.7532C6.93141 13.4572 6.82432 13.1071 6.82432 12.7318C6.82432 11.6699 7.68161 10.8092 8.73913 10.8092C8.95043 10.8092 9.15374 10.8435 9.34381 10.907V8.4226C9.14626 8.39491 8.94444 8.38059 8.73929 8.38058Z",fill:"#FE2C55"})),n.createElement("defs",null,n.createElement("clipPath",{id:"LogoColor_clip0_21014_132420"},n.createElement("rect",{width:"20",height:"20",rx:"4",fill:"white"}))))}},42891:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 24 24",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.5 22.5C3.29086 22.5 1.5 20.7091 1.5 18.5L1.5 5.5C1.5 3.29086 3.29086 1.5 5.5 1.5L18.5 1.5C20.7091 1.5 22.5 3.29086 22.5 5.5L22.5 18.5C22.5 20.7091 20.7091 22.5 18.5 22.5L5.5 22.5ZM3.5 18.5L3.5 5.5C3.5 4.39543 4.39543 3.5 5.5 3.5L18.5 3.5C19.6046 3.5 20.5 4.39543 20.5 5.5L20.5 18.5C20.5 19.6046 19.6046 20.5 18.5 20.5L5.5 20.5C4.39543 20.5 3.5 19.6046 3.5 18.5Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 10.3C7 10.1343 7.13431 10 7.3 10H8.19733C8.36301 10 8.49733 10.1343 8.49733 10.3V13.5714L15.5027 13.5714V10.3C15.5027 10.1343 15.637 10 15.8027 10H16.7C16.8657 10 17 10.1343 17 10.3V14.7C17 14.8657 16.8657 15 16.7 15L16.2513 15L15.5027 15H8.49733H7.74866H7.3C7.13431 15 7 14.8657 7 14.7V10.3Z",stroke:"black",strokeWidth:"0.5"}))}},43039:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 36 36",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 13V4C0 1.79086 1.79086 0 4 0H13C13.5523 0 14 0.447715 14 1V3C14 3.55228 13.5523 4 13 4H5C4.44772 4 4 4.44772 4 5V13C4 13.5523 3.55228 14 3 14H1C0.447715 14 0 13.5523 0 13ZM36 13V4C36 1.79086 34.2091 0 32 0H23C22.4477 0 22 0.447715 22 1V3C22 3.55228 22.4477 4 23 4H31C31.5523 4 32 4.44772 32 5V13C32 13.5523 32.4477 14 33 14H35C35.5523 14 36 13.5523 36 13ZM36 32V23C36 22.4477 35.5523 22 35 22H33C32.4477 22 32 22.4477 32 23V31C32 31.5523 31.5523 32 31 32H23C22.4477 32 22 32.4477 22 33V35C22 35.5523 22.4477 36 23 36H32C34.2091 36 36 34.2091 36 32ZM0 23V32C0 34.2091 1.79086 36 4 36H13C13.5523 36 14 35.5523 14 35V33C14 32.4477 13.5523 32 13 32H5C4.44772 32 4 31.5523 4 31V23C4 22.4477 3.55228 22 3 22H1C0.447715 22 0 22.4477 0 23Z",fillOpacity:"0.9"}))}},43338:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.4263 15L16.9566 3.95205C16.9822 3.41902 17.4218 2.99999 17.9554 2.99999H19.9494C20.5202 2.99999 20.9752 3.47701 20.9483 4.04718L20.4308 15H28.4263L28.9566 3.95205C28.9822 3.41902 29.4218 2.99999 29.9554 2.99999H31.9494C32.5202 2.99999 32.9752 3.47701 32.9483 4.04718L32.4308 15H43C43.5523 15 44 15.4477 44 16V18C44 18.5523 43.5523 19 43 19H32.2404L31.8118 28H42C42.5523 28 43 28.4477 43 29V31C43 31.5523 42.5523 32 42 32H31.6213L31.0434 44.0479C31.0178 44.581 30.5782 45 30.0446 45H28.0507C27.4798 45 27.0248 44.523 27.0518 43.9528L27.6168 32H19.6213L19.0434 44.0479C19.0178 44.581 18.5782 45 18.0446 45H16.0507C15.4798 45 15.0248 44.523 15.0518 43.9528L15.6168 32H5C4.44772 32 4 31.5523 4 31V29C4 28.4477 4.44772 28 5 28H15.8073L16.2358 19H6C5.44772 19 5 18.5523 5 18V16C5 15.4477 5.44772 15 6 15H16.4263ZM20.2404 19L19.8118 28H27.8073L28.2358 19H20.2404Z"}))}},44445:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M22.1086 20.3412C23.1028 19.2196 24.8972 19.2196 25.8914 20.3412L42.8955 39.5236C44.2806 41.0861 43.1324 43.5 41.004 43.5L6.99596 43.5C4.86764 43.5 3.71945 41.0861 5.10454 39.5235L22.1086 20.3412Z"}),n.createElement("path",{d:"M4.5 7.5C4.5 5.84315 5.84315 4.5 7.5 4.5L40.5 4.5C42.1569 4.5 43.5 5.84315 43.5 7.5C43.5 9.15685 42.1569 10.5 40.5 10.5L7.5 10.5C5.84315 10.5 4.5 9.15685 4.5 7.5Z"}))}},44786:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.59922 63.1209H51.2069C55.3809 63.1209 58.7776 59.7242 58.7826 55.5503V45.1431L68.4428 53.8141C68.887 54.2128 69.5279 54.3188 70.073 54.0715C70.6181 53.8292 70.9714 53.2841 70.9714 52.6886V18.661C70.9714 18.0654 70.6181 17.5203 70.073 17.278C69.5229 17.0358 68.887 17.1367 68.4428 17.5354L58.7826 26.2064V15.7992C58.7826 11.6253 55.3859 8.22858 51.212 8.22858H8.59922C4.42526 8.22858 1.02855 11.6253 1.02855 15.7992V55.5503C1.02855 59.7242 4.42526 63.1209 8.59922 63.1209ZM4.05681 15.7995C4.05681 13.2961 6.09585 11.2571 8.59921 11.2571H51.212C53.7153 11.2571 55.7544 13.2961 55.7544 15.7995V29.6033C55.7544 30.1989 56.1077 30.744 56.6528 30.9862C57.2029 31.2285 57.8388 31.1276 58.283 30.7288L67.9431 22.0579V49.2972L58.283 40.6262C57.8388 40.2275 57.1978 40.1266 56.6528 40.3688C56.1077 40.6111 55.7544 41.1562 55.7544 41.7517V55.5505C55.7544 58.0539 53.7153 60.0929 51.212 60.0929H8.59921C6.09585 60.0929 4.05681 58.0539 4.05681 55.5505V15.7995Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.217 47.3887C21.4491 47.525 21.7116 47.5906 21.974 47.5906C22.2365 47.5906 22.4989 47.52 22.7311 47.3837L40.7442 36.9866C41.2136 36.7141 41.5013 36.2144 41.5013 35.6744C41.5013 35.1344 41.2136 34.6347 40.7442 34.3621L22.7311 23.9601C22.2617 23.6875 21.6864 23.6875 21.217 23.9601C20.7476 24.2326 20.4599 24.7323 20.4599 25.2723V46.0765C20.4599 46.6165 20.7476 47.1162 21.217 47.3887ZM36.9589 35.6744L23.4882 43.452V27.8968L36.9589 35.6744Z"}))}},46508:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.17877 7.17357C2.50304 6.45894 3.21528 6 4.00003 6H44C44.713 6 45.372 6.37952 45.7299 6.99615C46.0877 7.61278 46.0902 8.37327 45.7365 8.99228L25.7365 43.9923C25.3423 44.6821 24.5772 45.0732 23.7872 44.9886C22.9972 44.9041 22.3321 44.3599 22.0929 43.6023L16.219 25.0017L2.49488 9.31701C1.97811 8.72642 1.85449 7.88819 2.17877 7.17357ZM20.377 24.8856L24.531 38.0397L40.5537 10H8.40757L18.3918 21.4106L30.1002 14.2054C30.5705 13.9159 31.1865 14.0626 31.4759 14.533L32.5241 16.2363C32.8136 16.7066 32.6669 17.3226 32.1966 17.612L20.377 24.8856Z"}))}},47009:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.59923 63.1216H51.2069C55.3809 63.1216 58.7776 59.7249 58.7826 55.5509V45.1438L68.4428 53.8147C68.887 54.2134 69.5279 54.3194 70.073 54.0721C70.6181 53.8298 70.9714 53.2847 70.9714 52.6892V18.6616C70.9714 18.066 70.6181 17.5209 70.073 17.2787C69.5229 17.0364 68.887 17.1373 68.4428 17.5361L58.7826 26.207V15.7999C58.7826 11.6259 55.3859 8.22919 51.212 8.22919H8.59923C4.42527 8.22919 1.02856 11.6259 1.02856 15.7999V55.5509C1.02856 59.7249 4.42527 63.1216 8.59923 63.1216ZM4.05679 15.7993C4.05679 13.2959 6.09582 11.2569 8.59919 11.2569H51.2119C53.7153 11.2569 55.7543 13.2959 55.7543 15.7993V29.6031C55.7543 30.1987 56.1076 30.7438 56.6527 30.986C57.2029 31.2283 57.8388 31.1274 58.2829 30.7286L67.9431 22.0577V49.297L58.2829 40.626C57.8388 40.2273 57.1978 40.1264 56.6527 40.3686C56.1076 40.6109 55.7543 41.156 55.7543 41.7515V55.5503C55.7543 58.0537 53.7153 60.0927 51.2119 60.0927H8.59919C6.09582 60.0927 4.05679 58.0537 4.05679 55.5503V15.7993ZM41.4447 47.3681C41.0177 47.3681 40.5958 47.1873 40.2944 46.8357C37.8 43.904 34.18 42.2061 30.3387 42.1698C30.3005 42.1727 30.2619 42.1742 30.223 42.1742C26.3351 42.1742 22.6632 43.872 20.1416 46.8406C19.8403 47.1872 19.4183 47.3681 18.9914 47.3681C18.6448 47.3681 18.2982 47.2525 18.0169 47.0114C17.384 46.474 17.3036 45.5196 17.8461 44.8867C20.9099 41.2807 25.3626 39.2015 30.0824 39.161C30.1255 39.1573 30.1691 39.1554 30.2131 39.1554C34.985 39.1554 39.4957 41.245 42.59 44.8817C43.1274 45.5146 43.0521 46.469 42.4192 47.0065C42.1379 47.2476 41.7913 47.3681 41.4447 47.3681ZM19.1819 34.3382C18.3481 34.3382 17.675 33.6651 17.675 32.8313V28.2502C17.675 27.4164 18.3481 26.7433 19.1819 26.7433C20.0158 26.7433 20.6889 27.4164 20.6889 28.2502V32.8313C20.6889 33.6651 20.0158 34.3382 19.1819 34.3382ZM39.7466 32.8313C39.7466 33.6651 40.4197 34.3382 41.2535 34.3382C42.0874 34.3382 42.7605 33.6651 42.7605 32.8313V28.2502C42.7605 27.4164 42.0874 26.7433 41.2535 26.7433C40.4197 26.7433 39.7466 27.4164 39.7466 28.2502V32.8313Z"}))}},47483:(e,t,r)=>{"use strict";r.d(t,{gb:()=>h,xp:()=>u});var n=r(40099),i=r(52598);const o=e=>new Promise(t=>setTimeout(t,e));var s=r(35895);const a=3e4,l={yandex:!0},c=e=>{return t=void 0,r=void 0,s=function*(){var t,r;if(null===window||void 0===window?void 0:window.__RELATED_APPS_CACHE)return window.__RELATED_APPS_CACHE;const{ignores:n,timeout:s=a}=null!=e?e:{};return Object.assign(Object.assign({},n),l).yandex&&(0,i.W)(null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)?Promise.resolve(void 0):(null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.getInstalledRelatedApps)?(c=[window.navigator.getInstalledRelatedApps(),o(s)],new Promise((e,t)=>{c.forEach(r=>{Promise.resolve(r).then(e,t).catch(t)})})):Promise.resolve(void 0);var c},new((n=void 0)||(n=Promise))(function(e,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function a(e){try{l(s.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n(function(e){e(r)})).then(o,a)}l((s=s.apply(t,r||[])).next())});var t,r,n,s},u=e=>{const[t,r]=(0,n.useState)(),[i,o]=(0,n.useState)(!1),[s,a]=(0,n.useState)(0);return(0,n.useEffect)(()=>{const t=Date.now();c(e).then(e=>r(e)).catch(e=>{console.warn("getRelatedApps failed",e)}).then(()=>{a(Date.now()-t),o(!0)})},[e]),{relatedApps:t,initialized:i,costTime:s}},d=(e,t)=>{if(!t)return{installed:-1,version:void 0};const r={m:s.uG,t:s.NK,lite:s.f,coin:s.k5}[e];for(const{id:e,version:n}of Object.values(t))if(e===r)return{installed:1,version:n};return{installed:0,version:void 0}},h=({installedApps:e,launchType:t,experimentalEnableCoinApiOptimization:r})=>{const{mInstall:n,tInstall:i,liteInstall:o,coinInstall:s}=(e=>{const{installed:t,version:r}=d("m",e),{installed:n,version:i}=d("t",e),{installed:o,version:s}=d("lite",e),{installed:a,version:l}=d("coin",e);return{mInstall:t,mVersion:r,tInstall:n,tVersion:i,liteInstall:o,liteVersion:s,coinInstall:a,coinVersion:l}})(e);return["tiktok_lite_app","tiktok_pro"].includes(t)?!!r&&0===s:[n,i,o].every(e=>0===e)}},49589:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 24C6 14.0589 14.0589 6 24 6C33.9411 6 42 14.0589 42 24C42 33.9411 33.9411 42 24 42C14.0589 42 6 33.9411 6 24ZM24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2ZM15 14C14.4477 14 14 14.4477 14 15V17C14 17.5523 14.4477 18 15 18H17C17.5523 18 18 17.5523 18 17V15C18 14.4477 17.5523 14 17 14H15ZM14 31C14 30.4477 14.4477 30 15 30H33C33.5523 30 34 30.4477 34 31V33C34 33.5523 33.5523 34 33 34H15C14.4477 34 14 33.5523 14 33V31ZM15 22C14.4477 22 14 22.4477 14 23V25C14 25.5523 14.4477 26 15 26H17C17.5523 26 18 25.5523 18 25V23C18 22.4477 17.5523 22 17 22H15ZM22 15C22 14.4477 22.4477 14 23 14H25C25.5523 14 26 14.4477 26 15V17C26 17.5523 25.5523 18 25 18H23C22.4477 18 22 17.5523 22 17V15ZM23 22C22.4477 22 22 22.4477 22 23V25C22 25.5523 22.4477 26 23 26H25C25.5523 26 26 25.5523 26 25V23C26 22.4477 25.5523 22 25 22H23ZM30 15C30 14.4477 30.4477 14 31 14H33C33.5523 14 34 14.4477 34 15V17C34 17.5523 33.5523 18 33 18H31C30.4477 18 30 17.5523 30 17V15ZM31 22C30.4477 22 30 22.4477 30 23V25C30 25.5523 30.4477 26 31 26H33C33.5523 26 34 25.5523 34 25V23C34 22.4477 33.5523 22 33 22H31Z"}))}},49605:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 73 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{clipPath:"url(#QuestionLarge_clip0)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.625 3C4.5184 3 2 5.5184 2 8.625V70.5C2 71.1067 2.36546 71.6536 2.92597 71.8858C3.48649 72.118 4.13166 71.9897 4.56066 71.5607L18.5588 57.5625H65.375C68.4817 57.5625 71 55.0441 71 51.9375V8.625C71 5.51841 68.4817 3 65.375 3H7.625ZM16.8768 55.0018L5 66.8787V8.625C5 7.17525 6.17525 6 7.625 6H65.375C66.8248 6 68 7.17524 68 8.625V51.9375C68 53.3873 66.8248 54.5625 65.375 54.5625H17.9375C17.5397 54.5625 17.1582 54.7205 16.8768 55.0018ZM37.1664 18.8333C34.0038 18.8333 31.7171 21.1943 30.5897 24.5767L27.7436 23.628C29.0776 19.626 32.1724 15.8333 37.1664 15.8333C42.0731 15.8333 46.0508 19.811 46.0508 24.7177C46.0508 27.3775 44.4024 29.7604 42.4221 31.4018C40.4271 33.0554 37.7923 34.2174 35.3203 34.2174V31.2174C36.9266 31.2174 38.907 30.4188 40.5077 29.0921C42.1231 27.7531 43.0508 26.1362 43.0508 24.7177C43.0508 21.4679 40.4163 18.8333 37.1664 18.8333ZM38.9444 41.7777C38.9444 43.1278 37.85 44.2222 36.5 44.2222C35.1499 44.2222 34.0555 43.1278 34.0555 41.7777C34.0555 40.4277 35.1499 39.3333 36.5 39.3333C37.85 39.3333 38.9444 40.4277 38.9444 41.7777Z",fillOpacity:"0.34"})),n.createElement("defs",null,n.createElement("clipPath",{id:"QuestionLarge_clip0"},n.createElement("rect",{width:"72",height:"72",fill:"white",transform:"translate(0.5)"}))))}},50321:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});const n=(0,r(40099).createContext)({strategy:{banners:[],buttons:[],popups:[],wrappers:[]},schemeParams:{},fallbackURLParams:{},experimentalFallbackTemplateURLParams:{}})},50475:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 7C8 4.23858 10.2386 2 13 2H35C37.7614 2 40 4.23858 40 7V41C40 43.7614 37.7614 46 35 46H13C10.2386 46 8 43.7614 8 41V7ZM13 6C12.4477 6 12 6.44772 12 7V41C12 41.5523 12.4477 42 13 42H35C35.5523 42 36 41.5523 36 41V7C36 6.44772 35.5523 6 35 6H13ZM18 10C18 9.44772 18.4477 9 19 9H29C29.5523 9 30 9.44772 30 10V12C30 12.5523 29.5523 13 29 13H19C18.4477 13 18 12.5523 18 12V10ZM24 39C25.6569 39 27 37.6569 27 36C27 34.3431 25.6569 33 24 33C22.3431 33 21 34.3431 21 36C21 37.6569 22.3431 39 24 39Z"}))}},50517:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.3019 6.38068C21.723 6.08373 22.9615 7.16986 23.009 8.50693C23.2751 16.0034 29.4377 22 37 22C37.8141 22 38.6105 21.9307 39.3839 21.7982C40.7019 21.5723 42 22.5655 42 24C42 33.9411 33.9411 42 24 42C14.0589 42 6 33.9411 6 24C6 15.3248 12.1351 8.0871 20.3019 6.38068ZM19.2223 10.8358C13.8426 12.7885 10 17.9473 10 24C10 31.732 16.268 38 24 38C31.06 38 36.8994 32.7742 37.8611 25.9797C37.5756 25.9932 37.2886 26 37 26C28.0237 26 20.5827 19.4301 19.2223 10.8358Z"}))}},51404:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M25.2809 18.7113C24.641 17.8563 23.359 17.8563 22.7191 18.7113L15.9152 27.8012C15.1256 28.8562 15.8784 30.36 17.1962 30.36L30.8038 30.36C32.1216 30.36 32.8744 28.8562 32.0848 27.8012L25.2809 18.7113Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 11C3 6.58172 6.58172 3 11 3H37C41.4183 3 45 6.58172 45 11V37C45 41.4183 41.4183 45 37 45H11C6.58172 45 3 41.4183 3 37V11ZM11 7H37C39.2091 7 41 8.79086 41 11V37C41 39.2091 39.2091 41 37 41H11C8.79086 41 7 39.2091 7 37V11C7 8.79086 8.79086 7 11 7Z"}))}},52016:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("mask",{id:"ZoomIn_path-1-inside-1",fill:"white"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.0005 7V16C28.0005 18.2091 29.7913 20 32.0005 20H41.0005C41.5527 20 42.0005 19.5523 42.0005 19V17C42.0005 16.4477 41.5527 16 41.0005 16L33.0005 16C32.4482 16 32.0005 15.5523 32.0005 15L32.0005 7C32.0005 6.44772 31.5527 6 31.0005 6L29.0005 6C28.4482 6 28.0005 6.44772 28.0005 7ZM20 16L20 7C20 6.44772 19.5523 6 19 6L17 6C16.4477 6 16 6.44772 16 7L16 15C16 15.5523 15.5523 16 15 16L7 16C6.44772 16 6 16.4477 6 17L6 19C6 19.5523 6.44772 20 7 20L16 20C18.2091 20 20 18.2091 20 16ZM28.0005 41.0001V32.0001C28.0005 29.791 29.7913 28.0001 32.0005 28.0001H41.0005C41.5527 28.0001 42.0005 28.4478 42.0005 29.0001V31.0001C42.0005 31.5524 41.5527 32.0001 41.0005 32.0001H33.0005C32.4482 32.0001 32.0005 32.4478 32.0005 33.0001V41.0001C32.0005 41.5524 31.5527 42.0001 31.0005 42.0001H29.0005C28.4482 42.0001 28.0005 41.5524 28.0005 41.0001ZM20 32.0001V41.0001C20 41.5524 19.5523 42.0001 19 42.0001H17C16.4477 42.0001 16 41.5524 16 41.0001V33.0001C16 32.4478 15.5523 32.0001 15 32.0001H7C6.44772 32.0001 6 31.5524 6 31.0001L6 29.0001C6 28.4478 6.44772 28.0001 7 28.0001H16C18.2091 28.0001 20 29.791 20 32.0001Z"})),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.0005 7V16C28.0005 18.2091 29.7913 20 32.0005 20H41.0005C41.5527 20 42.0005 19.5523 42.0005 19V17C42.0005 16.4477 41.5527 16 41.0005 16L33.0005 16C32.4482 16 32.0005 15.5523 32.0005 15L32.0005 7C32.0005 6.44772 31.5527 6 31.0005 6L29.0005 6C28.4482 6 28.0005 6.44772 28.0005 7ZM20 16L20 7C20 6.44772 19.5523 6 19 6L17 6C16.4477 6 16 6.44772 16 7L16 15C16 15.5523 15.5523 16 15 16L7 16C6.44772 16 6 16.4477 6 17L6 19C6 19.5523 6.44772 20 7 20L16 20C18.2091 20 20 18.2091 20 16ZM28.0005 41.0001V32.0001C28.0005 29.791 29.7913 28.0001 32.0005 28.0001H41.0005C41.5527 28.0001 42.0005 28.4478 42.0005 29.0001V31.0001C42.0005 31.5524 41.5527 32.0001 41.0005 32.0001H33.0005C32.4482 32.0001 32.0005 32.4478 32.0005 33.0001V41.0001C32.0005 41.5524 31.5527 42.0001 31.0005 42.0001H29.0005C28.4482 42.0001 28.0005 41.5524 28.0005 41.0001ZM20 32.0001V41.0001C20 41.5524 19.5523 42.0001 19 42.0001H17C16.4477 42.0001 16 41.5524 16 41.0001V33.0001C16 32.4478 15.5523 32.0001 15 32.0001H7C6.44772 32.0001 6 31.5524 6 31.0001L6 29.0001C6 28.4478 6.44772 28.0001 7 28.0001H16C18.2091 28.0001 20 29.791 20 32.0001Z",fillOpacity:"0.9"}),n.createElement("path",{d:"M28.0005 16H26.0005H28.0005ZM28.0005 7L30.0005 7V7H28.0005ZM32.0005 20V22V20ZM41.0005 16V18V16ZM33.0005 16L33.0005 14H33.0005V16ZM32.0005 15H30.0005H32.0005ZM32.0005 7L34.0005 7V7H32.0005ZM31.0005 6V8V6ZM29.0005 6L29.0005 4H29.0005V6ZM20 7L22 7V7H20ZM20 16H18H20ZM19 6V8V6ZM17 6V4V6ZM16 7L18 7V7H16ZM16 15H14H16ZM15 16V18V16ZM7 16L7 14H7V16ZM6 17L8 17V17H6ZM6 19H4H6ZM7 20L7 18H7V20ZM16 20V22V20ZM28.0005 32.0001L26.0005 32.0001V32.0001H28.0005ZM20 32.0001L18 32.0001V32.0001H20ZM6 31.0001H4H6ZM6 29.0001H8H6ZM30.0005 16L30.0005 7L26.0005 7L26.0005 16L30.0005 16ZM32.0005 18C30.8959 18 30.0005 17.1046 30.0005 16H26.0005C26.0005 19.3137 28.6867 22 32.0005 22L32.0005 18ZM41.0005 18H32.0005V22H41.0005V18ZM40.0005 19C40.0005 18.4477 40.4482 18 41.0005 18V22C42.6573 22 44.0005 20.6569 44.0005 19H40.0005ZM40.0005 17V19H44.0005V17H40.0005ZM41.0005 18C40.4482 18 40.0005 17.5523 40.0005 17H44.0005C44.0005 15.3432 42.6573 14 41.0005 14V18ZM33.0005 18L41.0005 18V14L33.0005 14L33.0005 18ZM30.0005 15C30.0005 16.6569 31.3436 18 33.0005 18V14C33.5527 14 34.0005 14.4477 34.0005 15H30.0005ZM30.0005 7L30.0005 15L34.0005 15L34.0005 7L30.0005 7ZM31.0005 8C30.4482 8 30.0005 7.55229 30.0005 7H34.0005C34.0005 5.34314 32.6573 4 31.0005 4V8ZM29.0005 8L31.0005 8L31.0005 4L29.0005 4L29.0005 8ZM30.0005 7C30.0005 7.55228 29.5527 8 29.0005 8V4C27.3436 4 26.0005 5.34315 26.0005 7H30.0005ZM18 7L18 16L22 16L22 7L18 7ZM19 8C18.4477 8 18 7.55229 18 7H22C22 5.34315 20.6569 4 19 4V8ZM17 8L19 8V4L17 4V8ZM18 7C18 7.55228 17.5523 8 17 8V4C15.3431 4 14 5.34315 14 7H18ZM18 15L18 7L14 7L14 15H18ZM15 18C16.6569 18 18 16.6569 18 15H14C14 14.4477 14.4477 14 15 14V18ZM7 18L15 18V14L7 14L7 18ZM8 17C8 17.5523 7.55229 18 7 18V14C5.34315 14 4 15.3431 4 17H8ZM8 19L8 17L4 17L4 19L8 19ZM7 18C7.55228 18 8 18.4477 8 19H4C4 20.6569 5.34315 22 7 22V18ZM16 18L7 18L7 22L16 22V18ZM18 16C18 17.1046 17.1046 18 16 18V22C19.3137 22 22 19.3137 22 16H18ZM26.0005 32.0001V41.0001H30.0005V32.0001H26.0005ZM32.0005 26.0001C28.6867 26.0001 26.0005 28.6864 26.0005 32.0001L30.0005 32.0001C30.0005 30.8955 30.8959 30.0001 32.0005 30.0001V26.0001ZM41.0005 26.0001H32.0005V30.0001H41.0005V26.0001ZM44.0005 29.0001C44.0005 27.3433 42.6573 26.0001 41.0005 26.0001V30.0001C40.4482 30.0001 40.0005 29.5524 40.0005 29.0001H44.0005ZM44.0005 31.0001V29.0001H40.0005V31.0001H44.0005ZM41.0005 34.0001C42.6573 34.0001 44.0005 32.657 44.0005 31.0001H40.0005C40.0005 30.4478 40.4482 30.0001 41.0005 30.0001V34.0001ZM33.0005 34.0001H41.0005V30.0001H33.0005V34.0001ZM34.0005 33.0001C34.0005 33.5524 33.5527 34.0001 33.0005 34.0001V30.0001C31.3436 30.0001 30.0005 31.3433 30.0005 33.0001H34.0005ZM34.0005 41.0001V33.0001H30.0005V41.0001H34.0005ZM31.0005 44.0001C32.6573 44.0001 34.0005 42.657 34.0005 41.0001H30.0005C30.0005 40.4478 30.4482 40.0001 31.0005 40.0001V44.0001ZM29.0005 44.0001H31.0005V40.0001H29.0005V44.0001ZM26.0005 41.0001C26.0005 42.657 27.3436 44.0001 29.0005 44.0001V40.0001C29.5527 40.0001 30.0005 40.4478 30.0005 41.0001H26.0005ZM22 41.0001V32.0001H18V41.0001H22ZM19 44.0001C20.6569 44.0001 22 42.657 22 41.0001H18C18 40.4478 18.4477 40.0001 19 40.0001V44.0001ZM17 44.0001H19V40.0001H17V44.0001ZM14 41.0001C14 42.657 15.3432 44.0001 17 44.0001V40.0001C17.5523 40.0001 18 40.4478 18 41.0001H14ZM14 33.0001V41.0001H18V33.0001H14ZM15 34.0001C14.4477 34.0001 14 33.5524 14 33.0001H18C18 31.3433 16.6569 30.0001 15 30.0001V34.0001ZM7 34.0001H15V30.0001H7V34.0001ZM4 31.0001C4 32.657 5.34315 34.0001 7 34.0001V30.0001C7.55229 30.0001 8 30.4478 8 31.0001H4ZM4 29.0001L4 31.0001H8L8 29.0001H4ZM7 26.0001C5.34315 26.0001 4 27.3433 4 29.0001H8C8 29.5524 7.55229 30.0001 7 30.0001V26.0001ZM16 26.0001H7V30.0001H16V26.0001ZM22 32.0001C22 28.6864 19.3137 26.0001 16 26.0001V30.0001C17.1046 30.0001 18 30.8955 18 32.0001L22 32.0001Z",fillOpacity:"0.9",mask:"url(#ZoomIn_path-1-inside-1)"}))}},52178:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 12.5C15.5897 12.5 13.5849 14.5018 13.5849 17.0345C13.5849 19.5672 15.5897 21.569 18 21.569C20.4103 21.569 22.4151 19.5672 22.4151 17.0345C22.4151 14.5018 20.4103 12.5 18 12.5ZM10.5849 17.0345C10.5849 12.9017 13.8766 9.5 18 9.5C22.1234 9.5 25.4151 12.9017 25.4151 17.0345C25.4151 21.1673 22.1234 24.569 18 24.569C13.8766 24.569 10.5849 21.1673 10.5849 17.0345ZM18 29.8793C14.0801 29.8793 10.7403 32.5616 9.69697 36.2673C9.5473 36.7989 9.03833 37.1708 8.49337 37.0811L7.50662 36.9189C6.96166 36.8292 6.58837 36.3131 6.72325 35.7776C8.00732 30.6788 12.5509 26.8793 18 26.8793C23.449 26.8793 27.9927 30.6788 29.2767 35.7776C29.4116 36.3131 29.0383 36.8292 28.4934 36.9189L27.5066 37.0811C26.9617 37.1708 26.4527 36.7989 26.303 36.2673C25.2597 32.5616 21.9199 29.8793 18 29.8793Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M33 31.5371C32.2445 31.5371 31.5198 31.668 30.8447 31.9093C30.3246 32.0951 29.7189 31.9243 29.4549 31.4392L28.9769 30.5608C28.713 30.0757 28.8907 29.463 29.4009 29.2516C30.513 28.791 31.7285 28.5371 33 28.5371C37.4554 28.5371 41.1594 31.6303 42.2706 35.7812C42.4135 36.3147 42.0386 36.8308 41.4935 36.9196L40.5065 37.0804C39.9614 37.1692 39.4546 36.7956 39.2894 36.2686C38.4217 33.5 35.91 31.5371 33 31.5371Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M33 18.5C31.6193 18.5 30.5 19.6193 30.5 21C30.5 22.3807 31.6193 23.5 33 23.5C34.3807 23.5 35.5 22.3807 35.5 21C35.5 19.6193 34.3807 18.5 33 18.5ZM27.5 21C27.5 17.9624 29.9624 15.5 33 15.5C36.0376 15.5 38.5 17.9624 38.5 21C38.5 24.0376 36.0376 26.5 33 26.5C29.9624 26.5 27.5 24.0376 27.5 21Z"}))}},52598:(e,t,r)=>{"use strict";r.d(t,{W:()=>o,a:()=>i});const n={snapchat:[/(?:Safari\/[\d.]+)?Snapchat\/?([\d.]+)/,/CronetSnapDevSheldon/],line:[/Line(?:[ /]([\d.]+))/],google_search_app:[/(?:com.google.GoogleMobile|GSA|GoogleApp)\/([\d.]+)?/],instagram_app:[/Instagram[ /]([\d.]+)?/],facebook_messenger:[/(?:MessengerForiOS|MESSENGER|FB_IAB\/Orca-Android).(?:FBAV)(?:[ /]([\d.]+))?/],facebook_messenger_lite:[/(?:mLite|MessengerLite(?:ForiOS)?).(?:FBAV)(?:[ /]([\d.]+))?/],facebook_lite:[/FBAN\/EMA.+FBAV(?:[ /]([\d.]+))?/],facebook:[/(?:FBAV|com.facebook.katana)(?:[ /]([\d.]+))?/,/(?:FBAN|FBSV|FBID|FBBV)\//],hey_tab_browser:[/HeyTapBrowser\/([\d.]+)/],vivo_browser:[/VivoBrowser(?:\/(\d+[.\d]+))?/],yandex_browser:[/YaBrowser(?:\/(\d+[.\d]*))(?: \((alpha|beta)\))?/],yandex_browser_alisa:[/Ya(?:ndex)?SearchBrowser(?:\/(\d+[.\d]*))/],samsung_browser:[/Samsung ?Browser(?:[/ ](\d+[.\d]+))?/],opera:[/(?:Opera Tablet.*Version|Opera\/.+Opera Mobi.+Version|Mobile.+OPR)\/(\d+[.\d]+)/,/Opera\/(\d+\.[.\d]+) .*Opera Mobi/],chrome_webview:[/Version\/.* Chrome(?:\/(\d+[.\d]+))?/],chrome:[/CrMo(?:\/(\d+[.\d]+))?/,/CriOS(?:\/(\d+[.\d]+))?/,/Chrome(?:\/(\d+[.\d]+))? Mobile/],safari:[/(?:(?:iPod|iPad|iPhone).+Version|MobileSafari)\/(\d+[.\d]+)/,/(?:Version\/(\d+\.[.\d]+) .)?Mobile.Safari\//,/Version\/(\d+\.[.\d]+) .*Safari\/|(?:Safari|Safari(?:%20)?%E6%B5%8F%E8%A7%88%E5%99%A8)\/?\d+/],unknown:[]};function i(e=(null===navigator||void 0===navigator?void 0:navigator.userAgent)){for(const[t,r]of Object.entries(n))if(r.some(t=>null==t?void 0:t.test(e)))return t;return"unknown"}function o(e){const t=i(e);return"yandex_browser"===t||"yandex_browser_alisa"===t}},52973:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M42 13.875C36.4081 13.875 31.875 9.34188 31.875 3.75H25.125V31.3125C25.125 34.7298 22.3548 37.5 18.9375 37.5C15.5202 37.5 12.75 34.7298 12.75 31.3125C12.75 27.8952 15.5202 25.125 18.9375 25.125C19.4439 25.125 19.9318 25.1851 20.3962 25.2971C20.4731 25.3157 20.5493 25.3356 20.625 25.357V18.4844C20.0716 18.4122 19.5082 18.375 18.9375 18.375C11.7923 18.375 6 24.1673 6 31.3125C6 38.4577 11.7923 44.25 18.9375 44.25C26.0827 44.25 31.875 38.4577 31.875 31.3125V17.2512C34.6954 19.3697 38.2011 20.625 42 20.625V13.875Z"}))}},53362:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.6667 13.2748C11.6667 12.6798 11.9838 12.13 12.4988 11.8321C13.9977 10.965 15 9.34859 15 7.49998C15 4.73856 12.7614 2.49998 10 2.49998C7.23859 2.49998 5.00001 4.73856 5.00001 7.49998C5.00001 9.34859 6.00237 10.965 7.50122 11.8321C8.01621 12.13 8.33334 12.6798 8.33334 13.2748V14.7916C8.33334 14.9067 8.42662 15 8.54168 15H11.4583C11.5734 15 11.6667 14.9067 11.6667 14.7916V13.2748ZM13.3333 13.2748V15.8333C13.3333 16.2935 12.9602 16.6666 12.5 16.6666H7.50001C7.03977 16.6666 6.66668 16.2935 6.66668 15.8333V13.2748C4.67401 12.1221 3.33334 9.96759 3.33334 7.49998C3.33334 3.81808 6.31811 0.833313 10 0.833313C13.6819 0.833313 16.6667 3.81808 16.6667 7.49998C16.6667 9.96759 15.326 12.1221 13.3333 13.2748Z"}),n.createElement("path",{d:"M7.50001 17.9166C7.50001 17.6865 7.68656 17.5 7.91668 17.5H12.0833C12.3135 17.5 12.5 17.6865 12.5 17.9166V18.75C12.5 18.9801 12.3135 19.1666 12.0833 19.1666H7.91668C7.68656 19.1666 7.50001 18.9801 7.50001 18.75V17.9166Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.46401 4.45524C8.67291 4.3393 8.92711 4.34959 9.12639 4.48207L12.8301 6.94419C13.014 7.06647 13.125 7.27561 13.125 7.49998C13.125 7.72435 13.014 7.93349 12.8301 8.05576L9.12639 10.5179C8.92711 10.6504 8.67291 10.6607 8.46401 10.5447C8.2551 10.4288 8.12501 10.2052 8.12501 9.9621V5.03786C8.12501 4.79477 8.2551 4.57119 8.46401 4.45524ZM11.2876 7.49998L9.42131 8.74062V6.25934L11.2876 7.49998Z"}))}},53577:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M12 24C5.3736 24 0 18.6264 0 12C0 5.3736 5.3736 0 12 0C18.6264 0 24 5.3736 24 12C24 18.6264 18.6264 24 12 24Z",fill:"#FF4500"}),n.createElement("path",{d:"M14.5765 14.4872C13.9304 14.4872 13.4036 13.9552 13.4036 13.3027C13.4036 12.6502 13.9304 12.1182 14.5765 12.1182C15.2226 12.1182 15.7494 12.6502 15.7494 13.3027C15.7494 13.9552 15.2226 14.4872 14.5765 14.4872ZM14.7837 16.431C13.9822 17.2381 12.4491 17.3018 11.9989 17.3018C11.5486 17.3018 10.0133 17.2381 9.21409 16.431C9.09478 16.3105 9.09478 16.1173 9.21409 15.9968C9.33341 15.8763 9.52476 15.8763 9.64408 15.9968C10.1484 16.5061 11.2267 16.6879 11.9989 16.6879C12.7688 16.6879 13.8494 16.5061 14.3537 15.9968C14.473 15.8763 14.6643 15.8763 14.7837 15.9968C14.9007 16.1173 14.9007 16.3105 14.7837 16.431ZM8.24381 13.3027C8.24381 12.6502 8.7706 12.1182 9.4167 12.1182C10.0628 12.1182 10.5896 12.6502 10.5896 13.3027C10.5896 13.9552 10.0628 14.4872 9.4167 14.4872C8.7706 14.4872 8.24381 13.9552 8.24381 13.3027ZM19.5 12.1182C19.5 11.202 18.7661 10.4608 17.8588 10.4608C17.4154 10.4608 17.0146 10.6382 16.7197 10.9269C15.5986 10.1085 14.052 9.581 12.3298 9.51962L13.0772 5.96615L15.5198 6.49133C15.5491 7.11881 16.0579 7.61898 16.686 7.61898C17.3343 7.61898 17.8588 7.08926 17.8588 6.43449C17.8588 5.77972 17.3343 5.25 16.686 5.25C16.2244 5.25 15.8305 5.52055 15.6391 5.91159L12.9106 5.32503C12.8341 5.30911 12.7553 5.32275 12.69 5.36595C12.6247 5.40914 12.5797 5.47508 12.5639 5.55237L11.7445 9.45141C11.74 9.47415 11.7445 9.49461 11.7445 9.51735C9.99077 9.56282 8.4149 10.0925 7.27578 10.9224C6.98086 10.6359 6.5824 10.4608 6.14115 10.4608C5.2339 10.4608 4.5 11.2043 4.5 12.1182C4.5 12.7912 4.89847 13.3709 5.47028 13.6301C5.44552 13.7938 5.43201 13.962 5.43201 14.1325C5.43201 16.6834 8.37213 18.75 11.9989 18.75C15.6256 18.75 18.5657 16.6834 18.5657 14.1325C18.5657 13.9643 18.5522 13.7983 18.5275 13.6346C19.097 13.3755 19.5 12.7957 19.5 12.1182Z",fill:"white"}))}},53602:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.6276 20.2241C16.6276 30.8074 25.2394 39.4192 35.8227 39.4192C46.4059 39.4192 55.0178 30.8074 55.0178 20.2241C55.0178 9.64086 46.4059 1.02899 35.8227 1.02899C25.2394 1.02899 16.6276 9.64086 16.6276 20.2241ZM19.7405 20.2244C19.7405 11.3583 26.9568 4.14202 35.8229 4.14202C44.689 4.14202 51.9053 11.3583 51.9053 20.2244C51.9053 29.0905 44.689 36.3068 35.8229 36.3068C26.9568 36.3068 19.7405 29.0905 19.7405 20.2244Z"}),n.createElement("path",{d:"M6.69813 70.9717C6.56844 70.9717 6.43874 70.9562 6.30904 70.9199C5.47898 70.7072 4.97576 69.8563 5.19365 69.0263C8.79922 55.045 21.3954 45.2762 35.8228 45.2762C50.2503 45.2762 62.8465 55.0398 66.4572 69.0211C66.6699 69.8512 66.1719 70.702 65.3366 70.9147C64.5014 71.1326 63.6558 70.6293 63.4379 69.7941C60.1851 57.1876 48.8288 48.3837 35.8176 48.3837C22.8117 48.3837 11.4554 57.1876 8.19743 69.7941C8.02104 70.5048 7.39331 70.9717 6.69813 70.9717Z"}))}},53873:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 96 96",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M48 96C74.5097 96 96 74.5097 96 48C96 21.4903 74.5097 0 48 0C21.4903 0 0 21.4903 0 48C0 74.5097 21.4903 96 48 96Z",fill:"#79DBF2"}),n.createElement("path",{d:"M23.184 38.4961C28.8571 38.4961 33.456 33.8971 33.456 28.2241C33.456 22.551 28.8571 17.9521 23.184 17.9521C17.511 17.9521 12.912 22.551 12.912 28.2241C12.912 33.8971 17.511 38.4961 23.184 38.4961Z",fill:"black"}),n.createElement("path",{d:"M72.8161 38.4961C78.4892 38.4961 83.0881 33.8971 83.0881 28.2241C83.0881 22.551 78.4892 17.9521 72.8161 17.9521C67.1431 17.9521 62.5441 22.551 62.5441 28.2241C62.5441 33.8971 67.1431 38.4961 72.8161 38.4961Z",fill:"black"}),n.createElement("path",{d:"M48.0001 84.912C68.9958 84.912 86.0161 70.7713 86.0161 53.328C86.0161 35.8846 68.9958 21.744 48.0001 21.744C27.0045 21.744 9.98413 35.8846 9.98413 53.328C9.98413 70.7713 27.0045 84.912 48.0001 84.912Z",fill:"white"}),n.createElement("path",{d:"M38.0972 59.8531C42.2755 52.2576 40.974 43.5211 35.1903 40.3394C29.4066 37.1578 21.3308 40.7359 17.1525 48.3314C12.9742 55.9269 14.2757 64.6635 20.0594 67.8451C25.8431 71.0267 33.9189 67.4486 38.0972 59.8531Z",fill:"black"}),n.createElement("path",{d:"M75.9118 67.86C81.6955 64.6784 82.997 55.9418 78.8187 48.3463C74.6404 40.7508 66.5646 37.1727 60.7809 40.3543C54.9972 43.536 53.6957 52.2725 57.874 59.868C62.0523 67.4635 70.1281 71.0416 75.9118 67.86Z",fill:"black"}),n.createElement("path",{d:"M27.6479 58.416C29.7687 58.416 31.4879 56.6968 31.4879 54.576C31.4879 52.4553 29.7687 50.736 27.6479 50.736C25.5271 50.736 23.8079 52.4553 23.8079 54.576C23.8079 56.6968 25.5271 58.416 27.6479 58.416Z",fill:"white"}),n.createElement("path",{d:"M68.352 58.416C70.4728 58.416 72.192 56.6968 72.192 54.576C72.192 52.4553 70.4728 50.736 68.352 50.736C66.2312 50.736 64.512 52.4553 64.512 54.576C64.512 56.6968 66.2312 58.416 68.352 58.416Z",fill:"white"}),n.createElement("path",{d:"M54.7681 67.344C54.7681 69.744 51.7441 72.8159 48.0001 72.8159C44.2561 72.8159 41.2321 69.744 41.2321 67.344C41.2321 64.944 44.2561 64.128 48.0001 64.128C51.7441 64.128 54.7681 64.944 54.7681 67.344Z",fill:"black"}))}},54502:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 16 12",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.9637 0.370662C14.1617 0.168152 14.4882 0.170371 14.6834 0.375552L15.6676 1.40986C15.8531 1.60483 15.851 1.91164 15.6629 2.10407L6.33538 11.644C5.86141 12.1288 5.09629 12.1169 4.6365 11.6177L0.326723 6.93829C0.144403 6.74033 0.151478 6.43358 0.342731 6.24424L1.35546 5.24162C1.55673 5.04237 1.88315 5.0499 2.07502 5.25822L5.5238 9.0028L13.9637 0.370662Z"}))}},55340:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>ot,DS:()=>tt,K:()=>it,Tx:()=>H});const n=typeof window<"u"&&window.location.href.indexOf("loggerdebug")>-1;function i(e,t,...r){n&&console.log(`[logger>${e}]`,t,...r)}function o(){try{return Math.round(window.performance.now())}catch{return(new Date).getTime()}}function s(){return(new Date).getTime()}function a(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}function l(e,t=2){const r=Math.pow(10,t);return Math.round(e*r)/r}function c(e){return parseInt((1e3*e).toFixed(0),10)}function u(e){return parseInt(e,10)}function d(e){return e&&e instanceof window.HTMLMediaElement}function h(e){if(!e||"string"!=typeof e)return"";const t=e.split("/");let r="";return t.length>3&&t[2]&&(r=t[2]),r}function p(e){try{return JSON.stringify(e)}catch{return""}}function f(e){return"string"==typeof e&&/^blob/.test(e)}function _(e){return null!=e&&e.media&&(e=e.media),!!(e&&e instanceof HTMLMediaElement)&&(f(null==e?void 0:e.currentSrc)||f(null==e?void 0:e.src))}function y(e){return null==e}function g(e,t,r){return e>0&&t>0?t-e:0}const m=[new RegExp("(\\?|&)expire=([^&]*)(&|$)"),new RegExp("(\\?|&)x-tos-expires=([^&]*)(&|$)"),new RegExp("(\\?|&)x-expires=([^&]*)(&|$)")];function v(e){if(!e||"string"!=typeof e)return 0;let t=0;try{const r=[];if(m.forEach(t=>{const n=e.match(t);n&&r.push(n)}),r.length>0)t=parseInt(r[0][2],10);else{const r=e.split("/");r.length>5&&8===r[4].length&&(t=parseInt(r[4],16))}if(t>0){const e=new Date;return t<=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),0)/1e3?1:2}return 0}catch{return 0}}function b(e){try{return e.toString()}catch{return""}}function w(e,t){Object.keys(e).forEach(r=>{y(t[r])||(e[r]=t[r])})}function C(e,t){return t[e]}const E="0.3.16",k=[{key:"QQBrowser",reg:/(qqbrowser)\/([\d.]+)/},{key:"2345Explorer",reg:/(2345explorer)\/([\d.]+)/},{key:"Wexin",reg:/(micromessenger)\/([\d.]+)/},{key:"Openlanguage",reg:/(openlanguage)\/([\d.]+)/},{key:"NewsArticle",reg:/(newsarticle)\/([\d.]+)/},{key:"VideoArticle",reg:/(videoarticle)\/([\d.]+)/},{key:"Hotsoon",reg:/(live_stream)_([\d.]+)/},{key:"Aweme",reg:/(aweme)_([\d.]+)/},{key:"Lark",reg:/(lark)\/([\d.]+)/},{key:"PlayStation",reg:/(playstation)/},{key:"BingPreview",reg:/(bingpreview)\/([\d.]+)/},{key:"Baiduspider",reg:/(baiduspider-render)\/([\d.]+)/},{key:"YandexBot",reg:/(yandexbot)\/([\d.]+)/},{key:"Chrome",reg:/(chrome)\/([\d.]+)/},{key:"Safari",reg:/(version)\/([\d.]+)\s*(safari)/}],T=[{key:"Trident",reg:/(rv:)([\d.]+)/},{key:"Trident",reg:/(msie)\s*([\d.]+)/}],S=["Baiduspider","YandexBot"],O=!(typeof window>"u"),A={isIOS:!1,isAndroid:!1,isMobile:!1,isPC:!1,isPad:!1,isSpider:!1,isSupportMP4:!0,mime:"",name:"",appVersion:"",isChrome:!1,isSafari:!1};typeof navigator<"u"&&function(e){if(typeof navigator>"u")return e;const t=window.navigator.userAgent.toLocaleLowerCase(),r=/(iphone)/.test(t)||/(ipad)/.test(t),n=/(android)/.test(t),i=/(windows phone)/.test(t),o=r||n||i;e.isIOS=r,e.isAndroid=n,e.isPC=!o,e.isPad=/(ipad)/.test(t);const s=function(){const e={isSupport:!1,mime:""};if(typeof document>"u")return e;let t=document.createElement("video");return"function"==typeof t.canPlayType?(["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"].map(r=>{"probably"===(null==t?void 0:t.canPlayType(`video/mp4; codecs="${r}"`))&&(e.isSupport=!0,e.mime+=`||${r}`)}),e):(t=null,e)}();e.isSupportMP4=s.isSupport,e.mime=s.mime;let a="",l="",c=[],u=k;/trident/.test(t)&&(u=T);for(let e=0;e<u.length;e++)if(c=u[e].reg.exec(t),c){a=u[e].key,l=c.length>2?c[2]:"";break}a?(e[`is${a}`]=!0,e.name=a,e.appVersion=l):function(){const{mimeTypes:e}=navigator;if(e){for(let t=0;t<e.length;t++)if(e[t].type&&e[t].type.indexOf("360")>-1||e[t].type&&e[t].type.indexOf("application/vnd.chromium.remoting-viewer")>-1||e[t].description&&e[t].description.indexOf("360")>-1)return!0;return!1}}()&&(e.name="360EE"),e.name&&"Trident"!==e.name&&/(trident)/.exec(t)&&(e.name=e.name?`${e.name}_Trident`:"Trident"),e.isSpider=function(e,t){let r=!1;return S.map(t=>{t===e&&(r=!0)}),/spider/.test(t)&&(r=!0),r}(e.name,t)}(A);const $=!(typeof navigator>"u"),P={sdk_version:E,pc:"",pv:"",sv:"",line_app_id:0,line_user_id:"",app_version:"",platform:A.isPad?"pad":A.isMobile?"mobile":"pc",cpu_core:0,memory_size:0,support:0,absdkVersion:"",d_score:-1,vendor:"",gpu:"",deviceScore:{},ua:""};let R="",x=0;function L(e){Object.keys(e).forEach(t=>{void 0!==e[t]&&("playerCoreVersion"===t?P.pc=e[t]:"playerVersion"===t?P.pv=e[t]:"appVersion"===t?P.app_version=e[t]:"strategyVersion"===t?P.sv=e[t]:void 0!==P[t]&&(P[t]=e[t]))})}!function(){if(!$)return;const e=window.navigator,t=e&&e.hardwareConcurrency||0,r=e&&e.deviceMemory||0,n=e&&e.webdriver?1:0,o=e&&e.userAgent||"";P.cpu_core=t,P.memory_size=r,P.webdriver=n,P.ua=o,function(e){let t=A.isSupportMP4?1e4:0;t=typeof MediaSource>"u"||!MediaSource.isTypeSupported||!(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))?t:t+1e3,function(e){const t={supported:!1,smooth:!1,powerEfficient:!1};if(!e||typeof navigator>"u")return Promise.resolve(t);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(e);{const r=e.video||{contentType:""},n=e.audio||{contentType:""};try{const e=MediaSource.isTypeSupported(r.contentType||""),t=MediaSource.isTypeSupported(n.contentType);return Promise.resolve({supported:e&&t,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(t)}}}({type:"file",video:{contentType:'video/mp4;codecs="hev1.1.6.L120.90"',width:1920,height:1080,bitrate:1e4,framerate:30}}).then(r=>{r&&r.supported?t+=100:t+=10,e(t)}).catch(r=>{t+=1,e(t)})}(e=>{P.support=e}),i("CommonData",P)}();var I=(e=>(e.PLAY="play",e.PAUSE="pause",e.PLAYING="playing",e.WAITING="waiting",e.ENDED="ended",e.SEEKING="seeking",e.SEEKED="seeked",e.LOAD_START="loadstart",e.LOADED_DATA="loadeddata",e.TIMEUPDATE="timeupdate",e.PROGRESS="progress",e.CANPLAY="canplay",e.VOLUME_CHANGE="volumechange",e.RATE_CHANGE="ratechange",e.LOADED_METADATA="loadedmetadata",e.DURATION_CHANGE="durationchange",e.EMPTIED="emptied",e.ERROR="error",e.SUSPEND="suspend",e.ABORT="abort",e.STALLED="stalled",e))(I||{}),M=(e=>(e.PLAY_CATCH="playCatch",e.AUTOPLAY_PREVENTED="autoplay_was_prevented",e.AUTOPLAY_STARTED="autoplay_started",e.DESTROY="destroy",e.NEXT="playnext",e.RESET="reset",e.SOURCE_ERROR="source_error",e.INITIAL_URL="initialUrl",e.RENDER_STATE_CHANGE="renderStateChange",e.LOADSTART_MSE="loadstart_mse",e.DEFI_CHANGE="definitionChange",e.BEFORE_DEFI_CHANGE="beforeDefinitionChange",e.DEFI_CHANGE_SUCCESS="definitionChangeSuccess",e.XG_LOG_CACHE="xglog_cache",e.DEGRADE="degrade",e.ABR_CHANGE="ABR_CHANGE",e.DEFI_CHANGE_DETAIL="definitionChangeDetail",e.PRF_DATA_SIZE="prf_data_size",e.MEDIA_FORMAT_ERROR="media_format_error",e.META_READY="metaReady",e.HIT_CACHE="hitcache",e.DOWNGRADE="downgrade",e.EXCEPTION="exception",e))(M||{}),D=(e=>(e.ONE_PLAY="videoplayer_oneplay",e.ONE_OPERA="videoplayer_oneopera",e.ONE_ERROR="videoplayer_oneerror",e.ONE_EVENT="videoplayer_oneevent",e.ONE_TEMP="videoplayer_onetemp",e.MDL_DATA_SIZE="mdl_video_data_size",e.MDL_PRELOAD="mdl_video_preload",e))(D||{});const B={videoplayer_oneplay:"play_session_events",mdl_video_preload:"mdl_video_preload"},N="unknown";var j=(e=>(e.ERROR="error",e.PLAY_CATCH="playcatch",e.SEEKING="seeking",e.PAUSE="pause",e.ENDED="ended",e.WAITING="waiting",e.SWITCH="switch",e.LOG_DESTROY="log_destroy",e.DESTROY="destroy",e.PLAY_NEXT="playnext",e.RESET="reset",e.PAGE_UNLOAD="page_unload",e.DEGRADE="degrade",e.DOWNGRADE="downgrade",e.EXCEPTION="exception",e))(j||{}),U=(e=>(e[e.INIT=0]="INIT",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.PLAYING=3]="PLAYING",e[e.ERROR=5]="ERROR",e[e.WAITING=7]="WAITING",e[e.SEEKING=8]="SEEKING",e[e.AUTO_PLAY_PREVENTED=9]="AUTO_PLAY_PREVENTED",e[e.LOADED_METADATA=10]="LOADED_METADATA",e))(U||{}),V=(e=>(e[e.INIT=0]="INIT",e[e.LOADSTART=1]="LOADSTART",e[e.META=2]="META",e[e.PLAYABLE=9]="PLAYABLE",e[e.ERROR=10]="ERROR",e[e.STALLED=11]="STALLED",e))(V||{}),F=(e=>(e.DEFAULT="default",e.ACTIVE="active",e.RETAIN="retain",e.RELEASE="release",e.BACKUP="backup",e.DESTROY="destroy",e))(F||{}),H=(e=>(e[e.NONE=0]="NONE",e[e.RELOAD=1]="RELOAD",e[e.CONTINUE=2]="CONTINUE",e))(H||{}),G=(e=>(e.STAGE_1="1",e.STAGE_2="2",e.MSE_1="mse_1",e.MSE_2="mse_2",e.SOFT_1="soft_1",e.SOFT_2="soft_2",e.HEVC_1="hevc_1",e.HEVC_2="hevc_2",e))(G||{});function W(e,t){const r={startPos:0,endPos:0,include:0,diff:0,cur:t,start:-1,end:-1},n=e?e.length:0;if(n<1)return r;r.start=c(e.start(0)),r.end=c(e.end(n-1));let i=-1,o=-1;const s=c(t);for(let t=e.length-1;t>-1;t--){const n=c(e.start(t)),a=c(e.end(t));if(s>=n&&s<=a){r.include=1,r.startPos=n,r.endPos=a,r.diff=a-s;break}s<n&&(i<0||n-s<i)?(i=n-s,o=t):s>a&&(i<0||s-a<i)&&(i=s-a,o=t)}return 1!==r.include&&(o<0&&(o=e.length-1),r.startPos=c(e.start(o)),r.endPos=c(e.end(o))),r}function q(e){const t=[];if(!e||e.length<1)return t;const r=e.length;for(let n=0;n<r;n++){const r=c(e.start(n))/1e3,i=c(e.end(n))/1e3;t.push({start:r,end:i,diff:u(i-r)})}return t}function K(e){if(!e||e.length<1)return{start:0,end:0,diff:0};const t=c(e.start(0)),r=c(e.end(0));return{start:t/1e3,end:r/1e3,diff:(r-t)/1e3}}function z(e,t=0,r=1){if(!e)return!1;t=c(t);for(let n=0;n<e.length;n++){const i=c(e.start(n))+r,o=c(e.end(n))-r;if(t>i&&t<o)return!0}return!1}function Z(e){var t;return d(e)?e:(null==e?void 0:e.media)||(null==e?void 0:e.video)||(null==(t=null==e?void 0:e.getElement)?void 0:t.call(e))||null}function Y(e){return e.rawSrc||e.currentSrc||e.src}function X(e){return Q(e,["readyState","networkState"])}function Q(e,t){const r=Z(e);if(!r)return{};if(Array.isArray(t)){const e={};return t.forEach(t=>{e[t]=r[t]}),e}return r[t]}function J(e){var t;return e?(e.vtype?e.vtype:(null==(t=e.config)?void 0:t.vtype)||"")||(e.dash?"DASH":""):""}function ee(e){var t,r;const n=(null==(t=null==e?void 0:e.config)?void 0:t.codecType)||"",i=(null==(r=null==e?void 0:e.config)?void 0:r.mediaType)||"";return n?"tt-video"===i?`soft_${n}`:n:""}function te(e,t){let r=0;return e>0&&t>0&&e<t?(r=parseInt((t-e).toFixed(0),10),r>6e4?6e4:r):0}function re(e){return e&&!!e.coreName}function ne(e,t){var r;if(function(e){var t;return"TT-VIDEO"===(null==(t=null==e?void 0:e.video)?void 0:t.tagName)}(e)){const n=null==(r=e.video)?void 0:r.getStats();return{code:(null==t?void 0:t.errorCode)||(null==n?void 0:n.code)||0,message:(null==t?void 0:t.errorMessage)||(null==n?void 0:n.message)||"",passive:(null==t?void 0:t.passive)||0,renderrate:(null==n?void 0:n.renderRate)||0,workercost:(null==n?void 0:n.workerCost)||0,rfps:(null==n?void 0:n.renderFps)||0,dfps:(null==n?void 0:n.decodeFps)||0,fps:(null==n?void 0:n.fps)||0,ffcost:(null==n?void 0:n.ffCost)||0,decoderate:(null==n?void 0:n.decodeRate)||0}}return null}function ie(e,t){const r=Math.min(e,t);return r>0?r>2160?"8K":r>1792?"4K":r>1216?"2K":r>896?"1080P":r>640?"720P":r>512?"540P":r>416?"480P":r>288?"360P":"240P":N}function oe(e){let t=0;for(const r of e)r.end<0||r.start>r.end||(t+=1e3*r.end-1e3*r.start);return Math.round(t)/1e3}function se(e,t){return`${e}_${t}`}const ae="Operate";class le{constructor(e){this.suspendCallback=e,this.init()}reset(){this.init()}init(){this.seekCount=0,this.sat=0,this.ops=[],this.seek=this.getOperaInfo("seeked"),this.latestSeek=null,this.firstSeek=null,this.latestSwitch=this.getOperaInfo("switch"),this.firstSwitch=null,this.pauseLog={start:-1,acuTime:0,totalCount:0}}getOperaInfo(e){return{op:e,stateBefore:-1,stateAfter:-1,start:0,end:0,pos:0,inBuffer:!1,intervalId:0,readyState:-1,networkState:-1}}pushOP(e){const{ops:t}=this;t.length>10&&t.splice(0,t.length-10),t.push(e)}clearTimer(){const{seek:e}=this;e.intervalId&&(clearTimeout(e.intervalId),e.intervalId=0)}startSeekTimeout(){const{seek:e}=this;this.clearTimer(),e.intervalId=setTimeout(()=>{e.start&&this.suspendSeek("timeout","timeout"),this.clearTimer()},6e4)}startSeek(e,t){const{seek:r}=this;if(i(ae,"startSeek",`start1: ${s()-r.start} start:${r.start} currentTime:${e.currentTime} pos:${r.pos}`,t),r.start&&s()-r.start>6e3&&this.suspendSeek("seeking","seeking"),r.start)return;r.start=s();const{readyState:n,networkState:o}=X(e);r.pos=e.currentTime,r.stateBefore=t,r.inBuffer=z(e.buffered,e.currentTime,1),r.readyState=n,r.networkState=o,i(ae,"startSeek",`start: ${s()-r.start} pos:${r.pos} inBuffer:${r.inBuffer}`,q(e.buffered)),this.seekCount++,this.startSeekTimeout()}suspendSeek(e,t){const{seek:r}=this;if(!r.start)return;const n=s()-r.start;i(ae,"suspendSeek",`endType:${t} cost: ${n} inBuffer:${r.inBuffer}`);const{latestSeek:o}=this,a={costTime:n,stateBefore:r.stateBefore,stateAfter:e,start:r.start,end:s(),pos:r.pos,inBuffer:r.inBuffer,op:"seek",endType:t,interval:o?r.start-o.start:0,readyState:r.readyState,networkState:r.networkState};this.latestSeek=a,this.firstSeek||(this.firstSeek=a),this.pushOP(a),this.clearTimer(),r.start=0,r.intervalId=0,r.pos=0,r.inBuffer=!1,this.sat+=n,this.suspendCallback&&this.suspendCallback(D.ONE_OPERA,this.latestSeek)}startPause(){const{pauseLog:e}=this;i(ae,`endPause>pauseLog.start:${e.start}`),e.start<0&&(e.start=s(),e.totalCount++)}endPause(){const{pauseLog:e}=this;e.start>0&&(e.acuTime+=s()-e.start,e.start=-1,i(ae,`endPause>pauseLog.acuTime:${e.acuTime}`))}}class ce{constructor(e){this._last=e,this._current=e,this._initVal=e}set initial(e){this._initVal=e}get current(){return this._current}set current(e){const{_current:t}=this;t!==e&&(this._last=this._current,this._current=e)}get last(){return this._last}reset(){this._current=this._initVal,this._last=this._initVal}}class ue{constructor(){this.reset()}reset(){this.t=0,this.visible=!1,this.fAcc=0,this.bAcc=0,this.acc=0,this.loopAcc=0}update(e,t){if(this.t){const e=s()-this.t;this.acc+=e,this.t=0,this.visible?this.fAcc+=e:this.bAcc+=e,t&&(this.loopAcc=this.acc)}}start(e){this.t||(i("ACC","startACC",e,this.t,this.visible),this.t=s())}getWatchDuration(e=0){switch(e){case 1:return this.fAcc;case 2:return this.bAcc;default:return this.acc}}}function de(){return{networkState:-1,readyState:-1,pos:-1,inBuffer:!1,start:0,end:0,startDiff:-1,endDiff:-1,rate:0,endType:N,costTime:0,endPos:-1}}const he="PlayPerformance";class pe{constructor(e){this.timeline=null,this.vtype="",this.softDecodeInfo={code:0,message:""},this._reuseCount=0,this._reuseType=H.NONE,this.timeline=e,this.switchPlayerTime=0,this._renderState=new ce(F.DEFAULT),this._reuseCount=0,this.init()}updateReuseCount(e){e!==H.NONE&&this._reuseCount++,this._reuseType=e}get reuseCount(){return this._reuseCount}get reuseType(){return this._reuseType}get isActive(){const{current:e}=this._renderState;return e===F.ACTIVE||e===F.DEFAULT}get renderState(){return this._renderState.current}get preRenderState(){return this._renderState.last}init(){this.isMSE=!1,this.loadState=V.INIT,this.playbackState=U.INIT,this.seeking=!1,this.ended=!1,this.paused=!1,this.duration=0,this.currentTime=new ce(0),this.playbackRate=new ce(0),this.muted=new ce(!1),this.volume=new ce(1),this.resolution=new ce(""),this.definition=new ce(N),this.bitrate=new ce(0),this.width=0,this.height=0,this.state=new ce(N),this.newTime=s(),this.startLoadTime=0,this.autoplayStart=1,this.playTime=0,this.prepareBeforePlayTime=0,this.loadedTime=0,this.bufferFinishTime=0,this.playCount=0,this.vvTime=0,this.metaTime=0,this.firstUpdateTime=0,this.autoplayTime=0,this.startPlayInfo={bufEnd:0,bufStart:0,vvBuffer:0,startPos:-1,mvt:0,loadedVT:0,updateVT:0,autoPlayVT:0,playVT:0,fplayTime:0,pos:0,loadstartT:0,msestartT:0,activeT:0,loadedT:0,dvt:0,muted:-1,cachetime:0,cachesize:0},this.leave={time:0,method:""},this.exit={time:0,method:""},this.fvt=0,this.nvt=0,this.lpt=0,this.loadvt=0,this.switchPt=0,this.userFvt=0,this.buffFinishTime=0,this.loopCount=0,this.br={time:0,method:"",count:0,lTime:0,lPos:-1,pos:-1},this.visible="visible"===document.visibilityState,this.initialUrl={url:"",ip:"",host:"",resolution:"",definition:"",bitrate:0,width:0,height:0},this.curUrlInfo={url:"",ip:"",host:"",resolution:"",definition:"",bitrate:0,width:0,height:0},this.accPlayed=new ue,this.accPlayed.visible=this.visible,this.startStep=0,this.buffered={init:0,list:[],cur:{}},this.buffered=null,this.readyState=-1,this.networkState=-1,this.preloadData={size:0,time:0},this.meta={a_codec:"",v_codec:"",f_time:0}}reset(e,t=!1){i(he,"reset",e,t,this._renderState.current),e?(this.loopCount++,this.startStep=0,this.playTime=0,this.vvTime=0,this.metaTime=0,this.firstUpdateTime=0,this.autoplayTime=0,this.bufferFinishTime=0,this.br={time:0,method:"",count:0,lTime:0,lPos:-1,pos:-1},this.seeking=!1,this.ended=!1,this.accPlayed.reset(),this.autoplayStart=1,this.prepareBeforePlayTime=0,t||(this.startPlayInfo={bufEnd:0,bufStart:0,vvBuffer:0,startPos:0,mvt:0,loadedVT:0,updateVT:0,autoPlayVT:0,pos:0,playVT:0,fplayTime:0,loadstartT:0,msestartT:0,loadedT:0,activeT:0,dvt:0,muted:-1,cachetime:0,cachesize:0})):this.init()}setInitData(e){["playbackRate","volume","currentTime","muted"].forEach(t=>{this.change(t,e[t])})}setMeta(e){e?w(this.meta,e):this.meta={a_codec:"",v_codec:"",f_time:0,a_dur:0,v_dur:0}}setVtype(e){this.vtype=e}updateUrl(e){const{initialUrl:t}=this;t.url||(t.url=e.url||"",t.host=h(e.url)),e.definition&&(t.definition=e.definition),e.ip&&(t.ip=e.ip),e.bitrate&&(t.bitrate=e.bitrate)}updatePState(e,t){const{readyState:r,networkState:n}=X(e);this.readyState=r,this.networkState=n}setLoadStartTime(e){const t=s();e?(this.startLoadTime=t,this.startPlayInfo.msestartT=t,this.switchPt=this.switchPlayerTime?te(this.switchPlayerTime,this.startLoadTime):0):this.startPlayInfo.loadstartT=t}setPlayStartTime(){const{startPlayInfo:e}=this;e.fplayTime||(e.fplayTime=s(),e.playVT=this.prepareBeforePlayTime>0?s()-this.prepareBeforePlayTime:-1)}setPT(e){this.prepareBeforePlayTime||(this.prepareBeforePlayTime=s()),this.isActive?(i(he,`setPT>${e} playTime:${this.playTime} renderState:${this.renderState}`),this.startStep=1,this.startLoadTime||this.setLoadStartTime(!0),this.playTime||(this.playTime=s(),i(he,"setPT",`init pt:${this.playTime}, document.visibilityState:${this.visible}`))):i(he,`setPT>${e} preparePlayTime:${this.prepareBeforePlayTime} renderState:${this.renderState}`)}setVT(e,t,r){if(this.loadedTime||(this.loadedTime=s(),this.startPlayInfo.loadedVT=te(this.prepareBeforePlayTime,this.loadedTime),this.loadvt=this.loadedTime-this.startLoadTime),this.isActive){if(1===this.startStep){if(i(he,`setVT>${e} renderState:${this.renderState}`),!this.vvTime){const e=s();this.vvTime=e,this.fvt=e-this.playTime,this.nvt=e-this.newTime,this.userFvt=this.switchPlayerTime>0?e-this.switchPlayerTime:this.loadvt;const{startPlayInfo:n,muted:o}=this,{start:a,end:l,endPos:u}=W(t,0);n.bufEnd=l,n.vvBuffer=u,n.bufStart=a,n.pos=c(r),n.muted=o.current?1:0;const d=this.resolution.current;d&&(this.initialUrl.resolution=d),i(he,"setVT: firstframe inited",`vt-pt:${this.fvt} vt-nt:${this.nvt} loadvt:${this.loadvt} start:${a} end:${l} endPos:${u}`,this.startPlayInfo)}this.startStep=2}}else i(he,`setVT>${e} renderState:${this.renderState} return`)}changeRenderState(e,t){const r=this._renderState.current;r!==e&&(this._renderState.current=e);const n="statechange",{startPlayInfo:o}=this;if(i(he,"changeRenderState setPV",`preState:${r} state:${e}`),this.isActive){const e=W(t.buffered,t.currentTime),{bitrate:r}=this.initialUrl;this.startPlayInfo.activeT=s(),o.loadstartT&&this.setPT(n),o.cachetime=e.end,o.cachesize=e.end*r/1e3,this.loadedTime&&this.setVT(n,t.buffered,t.currentTime),this.startAccTime(n)}}setResolution(e){this.resolution.current=e}setMetaDataInfo(e){if(!this.metaTime){this.metaTime=s();const{startPlayInfo:t}=this;t.mvt=te(t.loadstartT,s()),t.pos=c(e),i(he,"setMetaTime",`mvt:${t.mvt}`)}}setLoadedData(){const{startPlayInfo:e}=this,t=s();e.loadedT=t,e.dvt=t-e.loadstartT}setBreak(e,t){const{br:r}=this;r.method=e,r.time||(r.time=s(),r.pos=t),r.lTime=s(),r.count++,r.lPos=t}setPreload(e){this.preloadData=e}setFirstPlayInfo(e){const{startPlayInfo:t,state:r}=this;if(this.firstUpdateTime>0||"playing"!==r.current)return;const{start:n,end:o}=W(e.buffered,e.currentTime),a=s();this.firstUpdateTime=a,t.startPos=c(e.currentTime),t.updateVT=te(this.vvTime,a),t.autoPlayVT=te(this.autoplayTime,a),t.bufEnd=o,t.bufStart=n,i(he,"setFirstPlayInfo",`updateVT:${t.updateVT} autoPlayVT:${t.autoPlayVT} mvt:${t.mvt} fvt: ${this.fvt} start:${n} end:${o}`,t)}updateBuffed(e,t){if(this.bufferFinishTime)return;const r=q(e);for(let e=r.length-1;e>=0;e--)if(r[e].end>=this.duration-1){this.bufferFinishTime=s();break}}setExit(e,t){const{leave:r,exit:n}=this,{startPos:o,endPos:a,diff:l}=W(t.buffered,t.currentTime);i(he,"setExit",`isActive:${this.isActive}`),!this.vvTime&&this.isActive&&(r.method=e,r.time=s(),this.playTime&&(this.lpt=r.time-this.playTime)),n.method=e,n.time=s(),n.bufDiff=l,n.bufStart=o,n.bufEnd=a,n.codec=ee(t),n.ismse=_(t)?1:0,n.vtype=J(t),n.endDiff=function(e){const{currentTime:t=0,duration:r=0}=e;return c(r)-c(t)}(t);const u=function(e){var t;const r=(null==(t=e.getPlugin)?void 0:t.call(e,"mp4encryptplayer"))||null;return(null==r?void 0:r.mseEndInfo)||{}}(t);u&&(n.mseEndType=u.mseEndType,n.mseEndTime=u.mseEndTime);const d=Y(t);n.host=h(d),i(he,"setExit",e,n)}updateAcc(e,t=!1){this.accPlayed.update(e,t)}startAccTime(e){this.accPlayed.start(e)}change(e,t){const r=a(e);"string"==typeof e?this[e]&&(this[e].current=t):"Object"===r&&Object.keys(e).forEach(t=>{"undefined"!==this[t]&&(this[t].current=e[t])})}changeWidthHeight(e,t){if(!e||!t)return;this.width=e,this.height=t;const{current:r}=this.resolution;r||(this.resolution.current=ie(e,t))}getWatchDuration(e=0){return this.accPlayed.getWatchDuration(e)}setSoftDecodeInfo(e){e&&(this.softDecodeInfo={...this.softDecodeInfo,...e})}get ifFirstTimeUpdate(){return this.firstUpdateTime>0}}const fe="WaitData";class _e{constructor(e){this.suspendCallback=e,this.init()}reset(){this.init()}init(){this._startTime=-1,this._realStartTime=-1,this._intervalId=0,this._tIntervalId=0,this._startPos=0,this._inBuffer=!1,this._startDiff=0,this._endDiff=0,this._playRate=-1,this.nbc=0,this.dbc=0,this.dAcuTime=0,this.nAcuTime=0,this.firstWait=de(),this.latestWait=de(),this.waitList=[]}_clearTimer(e){const t=this[e];t&&(clearTimeout(t),this[e]=void 0)}_startTimeout(e){this._clearTimer("_tIntervalId"),this._tIntervalId=setTimeout(()=>{this.suspendWait("timeout",e),this._clearTimer("_tIntervalId")},6e4)}_realStartWait(e){if(this._startTime>0){this._realStartTime=s();const{buffered:t,currentTime:r,networkState:n,readyState:o}=e,a=z(t,r,1);i(fe,"_realStartWait",`realStartTime:${this._realStartTime-this._startTime}\n       startPos:${this._startPos} curPos:${r} isInBuf:${a}`),a?this.dbc++:this.nbc++;const l={networkState:n,readyState:o,pos:this._startPos,inBuffer:this._inBuffer,start:this._startTime,end:0,startDiff:this._startDiff,endDiff:0,rate:this._playRate,endType:N,costTime:0,interval:this.latestWait.end>0?this._startTime-this.latestWait.end:0,endPos:-1};this.latestWait=l,this.firstWait.start||(this.firstWait=l)}}startWait(e){if(this._startTime>0)return;this._tIntervalId&&this._clearTimer("_tIntervalId"),this._startTime=s(),this._startPos=e.currentTime;const t=e?W(e.buffered,this._startPos):null;this._inBuffer=1===(null==t?void 0:t.include),this._startDiff=(null==t?void 0:t.diff)||0,this._playRate=e.playbackRate,i(fe,`startWait>inBuffer:${this._inBuffer} startDiff:${this._startDiff} startPos:${this._startPos} seeking:${e.seeking}`),this._intervalId=setTimeout(()=>{this._startTime>0&&(this._realStartWait(e),this._startTimeout(e)),this._clearTimer("_intervalId")},200)}suspendWait(e,t){if(this._startTime<0)return;this._clearTimer("_intervalId"),this._clearTimer("_tIntervalId");const r=s();let n=r-this._startTime;if(n=n>6e4?6e4:n,this._realStartTime<0)return i(fe,`suspendWait>${e} not realStart cost:${n}`),this._startTime=-1,this._inBuffer=!1,void(this._startDiff=0);const{latestWait:o}=this;this._inBuffer?this.dAcuTime+=n:this.nAcuTime+=n;const a=t?W(t.buffered,o.pos):null;o.endType=e,o.costTime=n,o.endDiff=(null==a?void 0:a.diff)||0,o.end=r,o.endPos=t.currentTime,i(fe,`suspendWait>inBuffer:${this._inBuffer} endDiff:${o.endDiff} startDiff:${o.startDiff} startPos:${o.pos} realCost:${n} ${e}`),this._startTime=-1,this._realStartTime=-1,this._inBuffer=!1,this._playRate=-1,this.suspendCallback&&this.suspendCallback(D.ONE_EVENT,o)}}class ye{constructor(e){this.codec_type="unknown",this.vtype="default",this.defaultBitrate=0,this.defaultDefinition="unknown",this.play_type=0,this.source_type="dir_url",this.playMode="unknown",this.vid="",this.tag="default",this.subtag="default",this.preSubtag="unknown",this.preTag="unknown",this.envInfo={},this.ext={},this.bitrateSetHevc=[],this.bitrateSet=[],this.volumeInfo={},this.init(e)}init(e){Object.keys(e).forEach(t=>{(function(e,t){return Object.prototype.hasOwnProperty.call(e,t)})(this,t)&&!y(e[t])&&(this[t]=e[t])})}reset(e){this.init(e)}}function ge(e){return e.map(e=>{if(!e)return"";if("string"==typeof e)return e;const t=[];return e.qualityType&&t.push(e.qualityType),e.definition&&t.push(e.definition),e.gearName&&t.push(e.gearName),t.join("|")})}const me={manifest:1e3,network:2e3,demux:3e3,remux:4e3,media:5e3,drm:7e3,other:8e3,runtime:9e3,no_error_handler:9997,custom_error:9998,notSupport:1005},ve={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106};function be(e){const t=[];return["errorMessage","message","httpCode"].forEach(r=>{void 0!==e[r]&&t.push(e[r])}),e.response&&t.push(e.response.statusText||""),t.join("_")}function we(e){const{errorType:t}=e;return C(t,me)||("number"==typeof t?t:me.media)}class Ce{constructor(){this.first=null,this.latest=null,this.final=null,this.errors=[],this.count=0,this.retryCount=0}parseError(e,t){var r;let n=null;if(e)if(d(t)||e.code)n={code:C(e.code,ve)||e.code,type:me.media,message:e.message};else{const t=e;n={code:t.errorCode,type:we(t),message:be(t)}}else n={code:8101,type:me.other,message:"error_is_undefined"};n.pos=e.currentTime||t.currentTime;const o=e.url||e.src||Q(t,"currentSrc");n.isExpired=v(o);const{readyState:a,networkState:l}=X(t),c={...n,cdnUrl:o,cdnHost:h(o),time:s(),readyState:a,networkState:l};return this.first?c.interval=c.time-((null==(r=this.latest)?void 0:r.time)||0):(c.interval=0,this.first=c),i("ERROR","setError",c),(A.isPC&&!A.isSupportMP4||A.isSpider)&&(c.code=ve[5],c.type=me.notSupport),c.stage=t.currentTime>0?"playing":"beforePlay",c}setError(e,t){this.count++;const r=this.parseError(e,t);this.latest=r,this.errors.length>=5&&this.errors.splice(0,1),this.errors.push(r)}setFinal(e,t){const r=this.parseError(e,t);this.final=r}get errorCodes(){const e=[];return this.errors.forEach(t=>{e.push(t.code)}),e.join(";")}reset(){this.first=null,this.latest=null,this.errors=[],this.count=0}}var Ee,ke=((Ee=ke||{}).INIT="init",Ee[Ee.LOAD_START=I.LOAD_START]="LOAD_START",Ee[Ee.LOADED_METADATA=I.LOADED_METADATA]="LOADED_METADATA",Ee[Ee.LOADED_DATA=I.LOADED_DATA]="LOADED_DATA",Ee[Ee.PLAY=I.PLAY]="PLAY",Ee[Ee.PLAYING=I.PLAYING]="PLAYING",Ee[Ee.SEEKING=I.SEEKING]="SEEKING",Ee[Ee.SEEKED=I.SEEKED]="SEEKED",Ee[Ee.TIME_UPDATE=I.TIMEUPDATE]="TIME_UPDATE",Ee[Ee.CANPLAY=I.CANPLAY]="CANPLAY",Ee[Ee.ERROR=I.ERROR]="ERROR",Ee[Ee.META_READY=M.META_READY]="META_READY",Ee.LEAVE="leave",Ee.ACTIVE="active",Ee.FIRST_FRAME="first_frame",Ee.FRAME_2="frame_2",Ee.FRAME_5="frame_5",Ee.START_ERROR="start_error",Ee.PLAY_ERROR="play_error",Ee.PREPARE_BEFORE="prepare_before",Ee.PLAY_TIME="play_time",Ee.VV_TIME="vv_time",Ee.ENDED="ended",Ee);let Te=null;function Se(e,t={}){const{currentTime:r=-1,readyState:n=0,networkState:i=0,duration:o=0,buffered:s=null}=e||{};return{currentTime:r,duration:o,readyState:n,networkState:i,firstBuffer:K(s),presentedFrames:0,...t}}class Oe{constructor(){this.timeline=new Map,this.t=0,this._pid=""}log(e,...t){const r=o();i("TimeLine",this._pid,`[${e}][${r-this.t}]`,...t),this.t=r}set playerId(e){if("string"==typeof e&&e.length>15){const t=e.split("-");this._pid=t.length>0?t[t.length-1]:e}else this._pid=e}get playerId(){return this._pid}getExtKey(e){let t=e;return t=e===ke.ERROR?this.get(ke.LOADED_DATA)?"play_error":"start_error":e,t}isTimeLineKey(e){return Te||(Te=Object.values(ke)),Te.includes(e)}add(e,t,r=!1){if(!this.isTimeLineKey(e)||(e=this.getExtKey(e),!r&&this.timeline.has(e))||e===ke.TIME_UPDATE&&!this.get(ke.LOADED_DATA))return;const{currentTime:n=0,readyState:i=0,networkState:a=0,firstBuffer:l=null,state:c}=t||{};(e===ke.SEEKING||e===ke.PLAY)&&((null==l?void 0:l.diff)||0)>=1&&[ke.LOAD_START,ke.LOADED_METADATA,ke.LOADED_DATA].forEach(e=>{this.add(e,t)});const u=o(),d=this.getIntervalTime(ke.LOAD_START,u),h=this.getIntervalTime("init",u),p=this.getIntervalTime(ke.LOADED_DATA,u),f=this.getIntervalTime("active",u);this.timeline.set(e,{key:e,time:u,timeStamp:s(),fromInit:h,fromStart:d,fromLoaded:p,fromActive:f,...t}),this.log(e,`state:${c}|readyState:${i}|networkState:${a}|fromInit:${h} fromStart:${d} fromLoaded:${p} fromActive:${f} curTime:${n}`,l)}delete(e){this.timeline.delete(e)}addByPre(e,t,r){this.get(t)&&this.add(e,r)}get(e){return this.timeline.get(e)||null}getTimeStamp(e){var t;return(null==(t=this.timeline.get(e))?void 0:t.timeStamp)||0}getTime(e){var t;return(null==(t=this.timeline.get(e))?void 0:t.time)||0}getIntervalTime(e,t){const r=this.getTime(e);return t<=0||r<=0?-1:t<r?0:t-r}getInterval(e,t){const r=this.getTime(e),n=this.getTime(t);return n<=0||r<=0?-1:n<r?0:n-r}clear(){this.t=0,this.timeline.clear()}getAll(){return this.timeline}getDurations(){return{start_error:this.getInterval(ke.LOAD_START,"start_error"),start_meta:this.getInterval(ke.LOAD_START,ke.LOADED_METADATA),meta_loaded:this.getInterval(ke.LOADED_METADATA,ke.LOADED_DATA),start_loaded:this.getInterval(ke.LOAD_START,ke.LOADED_DATA),start_fframe:this.getInterval(ke.LOAD_START,"first_frame"),loaded_error:this.getInterval(ke.LOADED_DATA,"play_error"),meta_fframe:this.getInterval(ke.LOADED_METADATA,"first_frame"),a_fframe2:this.getInterval("active","frame_2"),init_loaded:this.getInterval("init",ke.LOADED_DATA),loaded_fframe:this.getInterval(ke.LOADED_DATA,"first_frame"),playing_update:this.getInterval(ke.PLAYING,ke.TIME_UPDATE),a_update:this.getInterval("active",ke.TIME_UPDATE),a_leave:this.getInterval("active","leave"),a_seek:this.getInterval("active",ke.SEEKING),a_loaded:this.getInterval("active",ke.LOADED_DATA),a_play:this.getInterval("active",ke.PLAY),loaded_a:this.getInterval(ke.LOADED_DATA,"active"),a_ended:this.getInterval("active","ended")}}}function Ae(e,t,r,n,i){const{source_type:o,codec_type:a,preTag:l,tag:u,subtag:h,preSubtag:f,vid:_,play_type:y,envInfo:g,ext:m,playMode:v}=t,{networkState:b,readyState:w,duration:C,currentTime:E,width:k,height:T,isMSE:S,reuseType:O,vtype:A}=r,$=c(n.currentTime||E.current),R=J(n)||A,x=ee(n)||a,L=d(n)?y+2:y,I=P.pv?P.pv:n?n.version:"",{deviceScore:M={}}=P,D={local_time:s(),player_sessionid:e,...P,...M,pv:I||N,codec_type:x,play_type:L,source_type:o,v:_,width:k,height:T,vtype:R,tag:u||N,subtag:h||v||N,pre_tag:l,pre_subtag:f,video_net_s:b,video_ready_s:w,vd:c(C),cur_play_pos:$,visible:r.visible?1:0,net:navigator.onLine?"online":"offline",is_mse:S?1:0,env_info:p(g),ext:p(m),player_type:i.playerType,p_index:i.pIndex||-1,ins_index:i.insIndex||-1,reuse_type:O};return delete D.deviceScore,D}const $e={player_sessionid:"play_sess",p_index:"play_order",vd:"vduration"},Pe={autoplay_started:"_onAutoPlayStart",autoplay_was_prevented:"_onAutoPlayPrevented",source_error:"_onSourceError",initialUrl:"_onInitialUrl",renderStateChange:"_onRenderStateChange",destroy:"_onPlayerDestroy",playnext:"_onPlayNext",loadstart_mse:"_onLoadstartMse",definitionChange:"_onDefiChange",beforeDefinitionChange:"_onBeforeDefiChange",definitionChangeSuccess:"_onDefiChangeSuccess",xglog_cache:"_onXgLogCache",degrade:"_onDegrade",downgrade:"_onDowngrade",exception:"_onException",ABR_CHANGE:"_onAbrChange",definitionChangeDetail:"_onDefiChangeDetail",prf_data_size:"_onPrfDataSize",media_format_error:"_onMediaFormatError",metaReady:"_onMetaReady",hitcache:"_onHitcache"};function Re(e,t,r=1){if(!e||!t)return;const n=d(e),i=Object.keys(I).map(e=>I[e]),o=Object.keys(M).map(e=>M[e]);(n?i:[...i,...o]).forEach(i=>{const{handler:o,evt:s}=function(e,t){let r;const n=`_on${e.charAt(0).toUpperCase()}${e.slice(1)}`;return r=t[n]?t[n]:t[Pe[e]],{evt:e,handler:r}}(i,t);if(o)if(n){const t=e;1===r?t.addEventListener(s,o):t.removeEventListener(s,o)}else{const t=e;1===r?t.on(s,o):t.off(s,o)}})}function xe(e,t){e&&e instanceof HTMLVideoElement&&"requestVideoFrameCallback"in HTMLVideoElement.prototype&&e.requestVideoFrameCallback(t)}const Le=[];function Ie(e,t,r){Le.push({id:e,name:t,handler:r})}function Me(e,t){let r=-1;for(let n=0;n<Le.length;n++)if(Le[n].id===e&&Le[n].name===t){r=n;break}r>-1&&Le.splice(r,1)}const De="beforeunload",Be="visibilitychange";function Ne(e,t,...r){Le.forEach(n=>{const{name:i,handler:o}=n;i===e&&o(t,...r)})}typeof document<"u"&&(i("GLOBAL_EVENTS","bindGlobalEvents",A.isPC,A.isMobile,A.isPad),!(typeof document>"u")&&(A.isPC?window.addEventListener("beforeunload",()=>{Ne("beforeunload")}):(A.isMobile||A.isPad)&&window.addEventListener("pagehide",()=>{Ne("beforeunload")}),document.addEventListener("visibilitychange",e=>{Ne("visibilitychange",document.visibilityState)})));const je=new class{constructor(){this._instances=0,this._pCount=0}increment(){this._instances++}incrementPlay(){this._pCount++}get instanceCount(){return this._instances}get playCount(){return this._pCount}};function Ue(e){switch(e){case 0:return"duration";case 1:return"size";default:return N}}function Ve(e){let t="";return t="Array"===a(e.url)&&e.url.length>0?e.url[0].src||"":e.url||"",{cdn_url:t||"",cdn_host:h(t)||"",cdn_ip:e.ip||""}}const Fe={preload_start:"onLoadStart",preload_ended:"onLoadEnded",error:"onError",prf_data_size:"onPrfDataSize",prf_meta_ready:"onPrfMetaReady",preloadstart:"onLoadStartNew",preloadend:"onLoadEndedNew",preloadedmetadata:"onLoadMetadataNew"},He="MDLPreload";class Ge{constructor(e){this.onLoadStartNew=e=>{const{getCurrentUrl:t}=e||{},r=function(e){var t,r;if(!e)return null;const{config:n}=e,i=null==(t=null==e?void 0:e.getStats)?void 0:t.call(e),{src:o,priority:s=-1}=n,a="string"==typeof o?{}:(null==o?void 0:o.extra)||{},{vid:l="",definition:c="",codecType:u="",qualityType:d=0,vtype:h="",width:p=0,height:f=0,bitrate:_=0}=a;return{url:null==(r=null==e?void 0:e.getCurrentUrl)?void 0:r.call(e),vid:l,definition:c,qualityType:d,vtype:h,codecType:u,mediaType:"video",order:s,width:p,height:f,bitrate:_,preloadSize:(null==i?void 0:i.byteSize)||0,preloadTime:Math.round(1e3*((null==i?void 0:i.duration)||0))/1e3,errc:0,err_msg:""}}(e),n=(null==r?void 0:r.vid)||"",o=Ve({url:(null==t?void 0:t())||""});i(He,"onLoadStartNew",n,e,r);const{data:a}=this;let l=N;const{width:c,height:u}=r||{};l=c&&u?ie(c,u):null==r?void 0:r.definition;const d={...a,...o,v:n,codec_type:(null==r?void 0:r.codecType)||"",vtype:(null==r?void 0:r.vtype)||"MP4",bitrate:null==r?void 0:r.bitrate,fileid:(null==r?void 0:r.fileid)||"",df:l,task_type:0,errc:0,vds:0,pvds:0,vvds:0,pvvds:0,player_type:"NEW_TT"};this.vid=n,this.data=d,this.meta={a_codec:"",v_codec:""},this.startTime=s(),this.state="start"},this.onLoadStart=e=>{i(He,"onPreloadStart",e.cacheKey,e);const{codecType:t,vtype:r,vid:n,width:o,height:a,bitrate:l,file_id:c,definition:u,type:d}=e,{data:h}=this,p=Ve(e);let f=N;f=o&&a?ie(o,a):u;const _={...h,...p,v:n,codec_type:t,vtype:r,bitrate:l,fileid:c||"",df:f,task_type:y(d)?-1:d,player_type:"XG"};this.vid=n,this.data=_,this.meta={a_codec:"",v_codec:"",f_time:0,f_size:0},this.startTime=s(),this.state="start",i(He,"onPreloadStart",n,this.data)},this.onLoadEndedNew=e=>{i(He,"onLoadEndedNew",e);const{getCurrentUrl:t,getStats:r,error:n}=e,o=Ve({url:t()}),a=r(),c=s()-this.startTime,u=a.byteSize,d=l(a.duration,2),{data:h}=this;n&&(h.errc=n.code||-1,h.err_msg=n.message),h.cdn_url=o.cdn_url,h.cdn_host=o.cdn_host,h.isexpired=v(o.cdn_url),h.cost_time=c,h.vpls=u,h.vplt=d,h.vvds=u,h.vds=u,i(He,"onLoadEndedNew END",h),this.sendMDLEvent("loadended",h),this._reInit()},this.onLoadEnded=e=>{if(i(He,"onPreloadEnded",e.cacheKey,e),this.vid&&this.vid===e.vid){const t=Ve(e),r=s()-this.startTime,n=this.data.vds;this.setMetaFirst(e);const o={...this.data,vplt:l(e.preloadTime,2),vpls:n||e.preloadSize,cost_time:e.costTime||r,bitrate:e.bitrate,fileid:e.file_id||"",isexpired:v(t.cdn_url)};i(He,"onPreloadEnded1",e.cacheKey,o),this.sendMDLEvent("loadended",o)}else console.warn(He,"onLoadEnded","cacheKey_not_match",this.vid,e.cacheKey);this._reInit()},this.onError=e=>{if(i(He,"onError",this.data,e),this.vid){const{context:t}=e,r=s()-this.startTime,n=t?Ve(t||{}):null,o={...this.data,errc:e.errorCode||-1,err_msg:be(e),cost_time:e.costTime||r,fileid:e.file_id||"",isexpired:v((null==n?void 0:n.cdn_url)||this.data.cdn_url),...n};i(He,"loaderror",JSON.stringify(o),e.code,e.message),this.sendMDLEvent("loaderror",o)}this._reInit()},this.onPrfDataSize=e=>{if(this.vid){const{cdn_size:t,pcdn_size:r,mediaType:n}=e,{data:i}=this,o=t||0,s=r||0;let a=0,l=0;"audio"!==n&&(a=o,l=s),i.vds+=o,i.pvds+=s,i.vvds+=a,i.pvvds+=l}this.state="load"},this.onLoadMetadataNew=e=>{i(He,"onLoadMetadataNew",e);const{tracks:t=[]}=e;t.forEach(e=>{"audio"===e.type?this.meta.a_codec=e.codec:this.meta.v_codec=e.codec})},this.onPrfMetaReady=e=>{this.setMetaFirst(e)},this.eventCallback=e,this.init()}init(){this.emptyCount=0,this.data=this.getInitData(),this.vid="",this.extData={tag:N,subtag:N,preSubtag:N,preTag:N,pIndex:-1,insIndex:-1,log_id:"",isMSE:!1,player_type:"",ext:{}},this.meta={a_codec:"",v_codec:"",f_time:0,f_size:0},this.state="init"}getInitData(){return{codec_type:N,v:"",vtype:N,errc:0,err_msg:"",vplt:0,vpls:0,vds:0,pvds:0,vvds:0,pvvds:0,cdn_host:"",cdn_ip:"",cost_time:0,df:N,bitrate:0,fileid:"",task_type:-1,isexpired:0}}_reInit(){this.vid="",this.startTime=0,this.data=this.getInitData(),this.state="suspend"}setMetaFirst(e){const{mediaSegList:t=[],meta:r}=e||{},n=t.length>0?t[0]:{timeRange:[],totalRange:[]},{timeRange:i=[],totalRange:o=[]}=n;this.meta.f_size=o.length>1?o[1]:0,this.meta.f_time=i.length>1?c(i[1]):0,this.meta.v_codec=(null==r?void 0:r.videoCodec)||"",this.meta.a_codec=(null==r?void 0:r.audioCodec)||""}reset(){this.init()}setExtData(e){e&&w(this.extData,e)}attach(e){this.preload!==e&&(i(He,"attach"),this.preload&&this.detach(),this.preload=e,Object.keys(Fe).forEach(e=>{this.preload.on(e,this[Fe[e]])}))}detach(){i(He,"attach "),this.preload&&Object.keys(Fe).forEach(e=>{this.preload.off(e,this[Fe[e]])}),this.reset(),this.preload=null}sendMDLEvent(e,t){var r,n;const{eventCallback:o,extData:s}=this,a={...P,...t,task_type:Ue(t.task_type),empty_c:0,tag:s.tag||N,subtag:s.subtag||N,pre_tag:s.preTag||N,pre_subtag:s.preSubtag||N,p_index:s.pIndex,ins_index:s.insIndex,is_mse:s.isMSE?1:0,meta:p(this.meta),ext:p({log_id:(null==(r=s.ext)?void 0:r.log_id)||"",is_ad:(null==(n=s.ext)?void 0:n.is_ad)||0})};i(He,"sendMDLEvent",e,D.MDL_PRELOAD,a),o&&o(D.MDL_PRELOAD,a)}}const We="MDLPlayback";class qe{constructor(e,t){this.opts=t||{openSizeLog:!0},this.suspendCallback=e,this.init()}getInitBitrate(){return{bitrate:0,aBitrate:0,cdnSize:0,cdnVSize:0,pcdnSize:0,pcdnVSize:0,definition:"",fileid:""}}init(){this.played=[],this.playedSize=0,this.cdnSize=0,this.pcdnSize=0,this.cdnVSize=0,this.pcdnVSize=0,this.lastBitrate=null,this.curBitrate=this.getInitBitrate(),this.nextBitrate=null,this.nextStart=-1,this.accDatas={cdnSize:0,cdnVSize:0,pcdnSize:0,pcdnVSize:0,playedSize:0},this.buffers=[]}reset(){this.init()}updatePlayed(e,t,r){const{played:n,curBitrate:i}=this,o=n.length,{bitrate:s,aBitrate:a}=i;if(0===t||o<1){const t=o>0?n[o-1]:null;t&&t.end<0?(t.start=e,t.bitrate=s,t.aBitrate=a):n.push({start:e,end:-1,bitrate:s,aBitrate:a})}else{const t=n[o-1];t.end=e,t.bitrate||(t.bitrate=s,t.aBitrate=a)}}calculateVideoPlaySize(){return 0}getPlayedDuration(){const{played:e}=this;return oe(e)}calculatePlaySize(){const{played:e,curBitrate:t}=this,r=oe(e),n=Math.round((t.aBitrate+t.bitrate)*r/8);return this.playedSize+=n,i(We,"calculatePlaySize",`duration: ${r} playedSize:${this.playedSize}`),this.played=[],this.playedSize}calculateCacheSize(){const{curBitrate:e,buffers:t}=this,r=function(e){let t=0;return e.forEach(e=>{e.start<e.end&&(t+=e.end-e.start)}),t}(t),n=Math.round((e.aBitrate+e.bitrate)*r/8);return this.cdnSize=n,this.cdnVSize=n,i(We,"calculateCacheSize",`duration: ${r} cdnSize:${this.cdnSize}`,e,t),this.buffers=[],this.cdnSize}updateAccData(){const{accDatas:e}=this;["cdnSize","cdnVSize","pcdnSize","pcdnVSize","playedSize"].forEach(t=>{e[t]+=this[t],this[t]=0})}updateBuffed(e){this.buffers=q(e)}breakPlaybackData(e,t){_(Z(t))||this.calculateCacheSize(),this.calculatePlaySize();const{cdnSize:r,cdnVSize:n,pcdnSize:o,pcdnVSize:s,accDatas:a}=this;if(i(We,"breakPlaybackData",e,r,n,o,s,a),[r,n,o,s].filter(e=>e>0).length>0){const t={cdnSize:r,cdnVSize:n,pcdnSize:o,pcdnVSize:s};this.sendMDLEvent(e,t),this.updateAccData()}}getFileSize(e){return function(e,t){const{bitrate:r,aBitrate:n}=t;return{audio:Math.round(e*n/8),video:Math.round(e*(r-n)/8),total:Math.round(e*r/8)}}(e,this.curBitrate)}checkNextBitrateStart(e){const{nextBitrate:t,nextStart:r}=this;r>-1&&e>=e&&t&&(this.calculatePlaySize(),i(We,"checkNextBitrate",e,e,this.cdnSize),t&&(this.curBitrate={...t}),this.updatePlayed(e,0),this.nextStart=-1,this.nextBitrate=null)}updateDefInfo(e,t){const{mediaType:r,start:n,bitrate:o,definition:s,fileid:a}=e;i(We,"updateDefInfo",t,r,e);const l=this.getInitBitrate();"audio"===r?l.aBitrate=o||0:(l.bitrate=o||0,l.definition=s,l.fileid=a,this.updateLastDefInfo(),this.nextStart=y(n)?-1:n,-1===this.nextStart&&(this.curBitrate=l))}updateLastDefInfo(){const{curBitrate:e}=this;e.bitrate>0&&(this.lastBitrate={...e})}updateDownload(e){const{cdn_size:t,pcdn_size:r,mediaType:n,bitrate:i}=e,{curBitrate:o,nextBitrate:s}=this,a=t||0,l=r||0;let c=0,u=0;"audio"!==n&&(c=a,u=l),this.cdnSize+=a,this.pcdnSize+=l,this.cdnVSize+=c,this.pcdnVSize+=u;const d=this.nextStart>0?s:o;d&&(d.bitrate=i||0,d.cdnSize+=a,d.pcdnSize+=l,d.cdnVSize+=c,d.pcdnVSize+=u)}sendMDLEvent(e,t){const{suspendCallback:r,opts:n}=this;if(!n.openSizeLog||!r)return;const{cdnSize:o,cdnVSize:s,pcdnSize:a,pcdnVSize:l,definition:c}=t,u={vds:o,pvds:a,vvds:s,pvvds:l,df:c,end_type:e};i(We,"sendMDLEvent",e,D.MDL_DATA_SIZE,u),r(D.MDL_DATA_SIZE,u)}}let Ke=0;const ze="Collector";class Ze{constructor(e,t){this.timeline=new Oe,this._onLoadstartMse=()=>{i(ze,"onLoadstartMse",this.playPerf.startLoadTime),this.playPerf.setLoadStartTime(!0),this._onLoadstart(this.player,M.LOADSTART_MSE),this.playPerf.setMeta(null)},this._onMetaReady=e=>{const{audioCodec:t,videoCodec:r,timeRange:n=[],audioDuration:i=0,videoDuration:o=0}=e;this.addTimeLinePoint(ke.META_READY),this.playPerf.setMeta({v_codec:t||"",a_codec:r||"",f_time:n.length>0?c(n[0].endTime||0):0,a_dur:i,v_dur:o})},this._onRequestVideoFrame=(e,t)=>{const{presentedFrames:r=0}=t||{};if(r>0){const e=1==r?ke.FIRST_FRAME:`frame_${r}`;this.addTimeLinePoint(e,{presentedFrames:(null==t?void 0:t.presentedFrames)||0})}if(r<5){const e=Z(this.player);e&&xe(e,this._onRequestVideoFrame)}},this._onLoadstart=(e,t="loadstart")=>{const{playPerf:r,playMDL:n,player:o,vInfo:s}=this;this.addTimeLinePoint(ke.LOAD_START,Se(this.player));const a=Y(o),l=Z(this.player);l&&xe(l,this._onRequestVideoFrame),i(ze,"onLoadstart",`renderState:${r.renderState} startStep:${r.startStep}`);const u=t!==M.LOADSTART_MSE&&function(e){return!e||window.location.href.indexOf(e)>-1}(a);r.setLoadStartTime(t===M.LOADSTART_MSE);const d=t,h=t===M.LOADSTART_MSE||_(l);if(r.isMSE=h,r.updateBuffed(o.buffered,d),n.updateBuffed(o.buffered),r.change("state",d),r.loadState=V.LOADSTART,r.playbackState=U.LOADING,r.setResolution(s.defaultDefinition),r.seeking=!1,r.updatePState(o,d),re(o)||r.setPreload(function(e){const{plugins:t}=e||{},r={vtype:N,time:0,size:0,f_size:0,bitrate:0,codec:"UNKNOWN"};if(!t||!t.mp4encryptplayer)return r;const{preLoadData:n}=t.mp4encryptplayer;if(n){const{type:e,fileSize:t,vtype:r,codecType:i,bitrate:o,preloadTime:s,byteLength:a,definition:l}=n;return{vtype:r,time:c(s),size:a,preloadSize:a,f_size:t||0,bitrate:o,definition:l,type:e,codec:i}}return r}(o)),i(ze,"onLoadstart",`startStep:${r.startStep} isSrcEmpty:${u}`),r.setInitData(o),!h){const e={url:a,definition:s.defaultDefinition};this.setInitialUrl(e),n.updateDefInfo(function(e,t){const{curDefinition:r,config:n}=e||{};return r&&r.bitrate?r:n&&n.defaultBitrate?{bitrate:n.defaultBitrate||0,definition:n.defaultDefinition||0}:t?{bitrate:t.defaultBitrate||0,definition:t.defaultDefinition||""}:{bitrate:0,definition:""}}(o,this.vInfo),0)}0===r.startStep&&!u&&r.setPT(d)},this._onDurationchange=()=>{const{player:e,playPerf:t}=this;t.duration=e.duration,i(ze,"onDurationchange",e.duration)},this._onLoadedmetadata=()=>{const{playPerf:e,player:t,vInfo:r}=this,n=_(Z(this.player));e.loadState=V.META,e.playbackState=U.LOADED_METADATA,e.setMetaDataInfo(t.currentTime),e.isMSE=n,this.addTimeLinePoint(ke.LOADED_METADATA,Se(this.player)),i(ze,"onLoadedmetadata");const o={url:Y(t),definition:r.defaultDefinition};this.setInitialUrl(o)},this._onLoadeddata=()=>{const{playPerf:e,playMDL:t,player:r}=this,n=I.LOADED_DATA,o=Z(r);i(ze,"onLoadeddata",_(o));const s=(null==o?void 0:o.videoWidth)||0,a=(null==o?void 0:o.videoHeight)||0;e.changeWidthHeight(s,a),e.playbackState=U.LOADED,e.change("state",n),this.addTimeLinePoint(ke.LOADED_DATA,Se(this.player)),e.loadState=V.PLAYABLE,e.updatePState(r,n),e.updateBuffed(r.buffered,n),t.updateBuffed(r.buffered),e.setLoadedData(),e.setVT(n,r.buffered,r.currentTime)},this._onCanplay=()=>{const{playPerf:e,playMDL:t,player:r}=this;i(ze,"onCanplay",`startStep:${e.startStep} vvTime:${e.vvTime} playTime:${e.playTime}`),e.playbackState=U.PLAYING,e.updatePState(r,I.CANPLAY),e.updateBuffed(r.buffered,I.CANPLAY),t.updateBuffed(r.buffered),e.setVT("canplay",r.buffered,r.currentTime)},this._onPause=()=>{const{operate:e,playPerf:t,player:r,playMDL:n}=this;r.error||(i(ze,"onPause",t.state.current),t.change({state:I.PAUSE}),t.paused=!1,t.updateAcc(I.PAUSE),n.updatePlayed(r.currentTime,1),e.startPause())},this._onPlaying=()=>{const{operate:e,playPerf:t,wait:r,player:n,playMDL:o}=this;i(ze,"onPlaying");const s=I.PLAYING;t.paused=!1,t.change("state",s),this.addTimeLinePoint(ke.PLAYING,Se(this.player)),t.startAccTime(s),o.updatePlayed(n.currentTime,1),r.suspendWait(s,n),e.endPause()},this._onWaiting=()=>{const{playPerf:e,wait:t,player:r}=this,{ifFirstTimeUpdate:n,vvTime:o}=e,s=I.WAITING;i(ze,"onWaiting",n,o,e.renderState),!r.seeking&&n&&o&&(t.startWait(r),e.change("state",s),e.playbackState=U.WAITING),e.updatePState(r,s),e.updateAcc(I.WAITING)},this._onSeeking=()=>{const{playPerf:e,wait:t,operate:r,player:n,playMDL:o}=this,{ifFirstTimeUpdate:s,state:a,startStep:l,vvTime:c}=e;i(ze,"onSeeking",n.currentTime,`curState:${a.current} lasteState:${a.last} vvTime:${c} ended1:${n.ended} ifFirstTimeUpdate:${s}`,n.seeking,a.current!==I.ENDED||c&&s);const u=I.SEEKING;this.addTimeLinePoint(ke.SEEKING,{},{preKey:ke.ACTIVE}),function(e){return e!==I.ENDED&&e!==I.LOAD_START}(a.current)&&c&&s&&(e.seeking=!0,t.suspendWait(u,n),r.startSeek(n,a.current),e.change("state",u),e.playbackState=U.SEEKING),e.updatePState(n,u),0===l&&e.setPT(u),e.startAccTime(u),o.updatePlayed(n.currentTime,0)},this._onSeeked=()=>{const{player:e,playPerf:t,operate:r}=this;i(ze,"onSeeked",e.seeking,e.currentTime),t.updatePState(e,I.SEEKED),t.seeking=!1;const n=e.paused?I.PAUSE:I.PLAYING;t.change("state",n),t.playbackState=U.PLAYING,r.suspendSeek(t.state.current,I.SEEKED)},this._onProgress=()=>{const{player:e,playMDL:t,playPerf:r}=this;r.updatePState(e,I.PROGRESS),r.updateBuffed(e.buffered,I.PROGRESS),t.updateBuffed(e.buffered)},this._onSuspend=()=>{const{player:e,playPerf:t}=this;i(ze,"onSuspend"),t.updatePState(e,I.SUSPEND)},this._onVolumechange=()=>{const{muted:e,volume:t}=this.player;this.playPerf.change({muted:e,volume:t})},this._onRatechange=()=>{this.playPerf.change("playbackRate",this.player.playbackRate)},this._onEmptied=()=>{const{player:e,playPerf:t}=this;t.loadState=V.INIT,t.updatePState(e,I.EMPTIED),t.updateBuffed(e.buffered,I.EMPTIED),i(ze,"onEmptied")},this._onStalled=()=>{const{player:e,playPerf:t}=this,r=I.STALLED;t.updatePState(e,r),"Safari"===A.name||(t.loadState=V.STALLED,t.change("state",r)),i(ze,"onStalled")},this._onAbort=()=>{const{player:e,playPerf:t}=this,r=I.ABORT;t.updatePState(e,r),t.change("state",r),i(ze,"onAbort")},this.options=e||{},this.player=t,Ke||(Ke=function(){try{return parseInt(window.performance.now().toFixed(0),10)}catch{return 0}}()),this.playPerf=new pe(this.timeline),this.operate=new le((e,t)=>{this._suspendStateCallback(e,t)}),this.wait=new _e((e,t)=>{this._suspendStateCallback(e,t)}),this.vInfo=new ye(this.options.videoInfo||{}),this.error=new Ce,this.extData={};const r={openSizeLog:this.options.openSizeLog},{ext:n,switchPlayerTime:o}=this.options;this.setExtData(n),this.setSwitchTime(o),this.playMDL=new qe((e,t)=>this._suspendStateCallback(e,t),r)}_suspendStateCallback(e,t){i(ze,"_suspendStateCallback",e,t)}get performanceNow(){return Ke}resetDataOnEnded(){this.reset(!0)}reset(e,t=!1){i(ze,"reset",`isEnded:${e} renderStateChange:${t}`);const{operate:r,playPerf:n,wait:o,error:s,playMDL:a}=this;r.reset(),n.reset(e,t),o.reset(),s.reset(),a.reset(),this.timeline.clear()}setSwitchTime(e){this.playPerf.switchPlayerTime=e||s()}setExtData(e={}){Object.keys(e).forEach(t=>{this.extData[t]=e[t]})}setPlayLeaveInfo(e,t){const r=e||M.RESET,n=t||j.RESET;i(ze,"setPlayLeaveInfo",e);const{playPerf:o,wait:s,operate:a,player:l}=this;o.setExit(n,l),s.suspendWait(r,l),this.addTimeLinePoint(ke.LEAVE,Se(this.player)),a.suspendSeek(o.state.current,r)}setInitialUrl(e){const{playPerf:t,vInfo:r}=this;e.definition||(e.definition=r.defaultDefinition),e.bitrate||(e.bitrate=0|r.defaultBitrate),t.updateUrl(e)}addTimeLinePoint(e,t,r){const{playPerf:n,timeline:i,player:o}=this,s=Se(o,{state:n.renderState,...t}),{preKey:a,coverable:l}=r||{};a?i.addByPre(e,a,s):i.add(e,s,l)}_onPlay(){const{playPerf:e,player:t,options:r}=this;t.error||(i(ze,"onPlay",`startStep :${e.startStep} this.ended:${e.ended}`),e.state.current===I.PAUSE&&e.playCount++,e.setPlayStartTime(),e.ended&&e.loopCount++,r.ifSendVVEnded&&e.ended&&(this.resetDataOnEnded(),e.ended=!1,e.setPT("play")),e.isActive&&e.setPT("play"))}_onEnded(){i(ze,"onEnded");const e=I.ENDED,{playPerf:t,wait:r,player:n,options:o}=this;t.ended=!0,this.addTimeLinePoint(ke.ENDED),t.change("state",e),t.updateAcc(e,!0),r.suspendWait(e,n),o.ifSendVVEnded&&t.setExit(j.ENDED,n)}_onTimeupdate(){const{playPerf:e,playMDL:t,player:r}=this;if(r.error)return;const{currentTime:n}=r;e.change({currentTime:n}),t.updatePlayed(n,1),e.firstUpdateTime||e.setFirstPlayInfo(r),!r.paused&&!r.ended&&e.startAccTime(I.TIMEUPDATE)}_onError(e){i(ze,"onError",e);const t=I.ERROR,{playPerf:r,playMDL:n,wait:o,operate:s,error:a,player:l}=this;e||(e=this.player.error),a.setFinal(e,l),r.updatePState(l,t),r.updateBuffed(l.buffered,t),n.updateBuffed(l.buffered),r.change("state",t),r.loadState=V.ERROR,r.playbackState=U.ERROR,r.setExit(j.ERROR,l),r.seeking=!1,r.updateAcc(t),o.suspendWait(t,l),n.breakPlaybackData(t,l),s.suspendSeek(r.state.current,t)}_onPlayCatch(e,t){const{playPerf:r,wait:n,operate:i,playMDL:o,player:s}=this,a=M.PLAY_CATCH;r.setVtype(e),r.updatePState(s,a),r.change("state",a),r.seeking=!1,r.updateAcc(a),r.setBreak(a,r.currentTime.current),n.suspendWait(a,s),o.breakPlaybackData(a,s),i.suspendSeek(r.state.current,a)}_onPlayerDestroy(){const{playPerf:e,playMDL:t,wait:r,operate:n,player:i}=this,o=M.DESTROY;e.setExit(j.DESTROY,i),e.updateAcc(o),r.suspendWait(o,i),t.breakPlaybackData(o,i),n.suspendSeek(e.state.current,o)}_onAutoPlayStart(){i(ze,"onAutoPlayStart");const{playPerf:e}=this;e.autoplayTime||(e.autoplayTime=s())}_onAutoPlayPrevented(){i(ze,"onAutoPlayPrevented");const{playPerf:e}=this;e.playbackState=U.AUTO_PLAY_PREVENTED,e.autoplayStart=0}sendEvent(e,t){}}const Ye="Collector";let Xe=null;const Qe={},Je=new Ge((e,t)=>{Xe&&Xe.event(e,t)});let et=null;class tt extends Ze{constructor(e,t){const r=function(e){const t={line_app_id:0,line_user_id:"",playerCoreVersion:"",playerVersion:"",app_version:"",channel:"cn",channelDomain:"",absdkVersion:"",maxQueueCount:5,ifSendVVEnded:!1,isTask:!1,vtype:"MP4",codec_type:"",tag:"普通视频",playType:0,sourceType:"vid",subtag:"",playMode:"",sendLocalCallback:(e,t)=>{},disableLocalCache:!1,closeResolutionLog:!1,closeSeekLog:!1,needXhrCheck:!1,trackerConfig:{},envInfo:{},ext:{},openSizeLog:!0,bitrateAdapter:{}};return Object.keys(e).forEach(r=>{t[r]=e[r]}),t}(e);super(r,t),this.pIndex=0,this.insIndex=0,this._onTimeupdate=()=>{const{playPerf:e}=this;e.isActive&&!this.timeline.get(ke.TIME_UPDATE)&&this.addTimeLinePoint(ke.TIME_UPDATE,{},{preKey:ke.LOADED_DATA}),super._onTimeupdate()},this._onPlay=()=>{const{ended:e,state:t,isMSE:r,isActive:n}=this.playPerf;e&&(this.isSendOnePlay=!1),n&&(this.addTimeLinePoint(ke.PLAY,{},{preKey:ke.ACTIVE}),Je.setExtData({isMSE:r,pIndex:this.pIndex,insIndex:this.insIndex})),super._onPlay(),i(Ye,"onPlay",t.current,t.last)},this._onEnded=()=>{super._onEnded();const{ifSendVVEnded:e}=this.options;this.playPerf.setSoftDecodeInfo(ne(this.player)),e&&this._trackOnePlay("ended")},this._onError=e=>{super._onError(e);const{final:t}=this.error,{playPerf:r}=this;if(i(Ye,"onError",e,t),"dash"!==this.player.type||!this.player.replayRunning){if(r.playTime||r.setPT("error"),(null==t?void 0:t.code)===ve[5])return this._trackOneError("error",t),void(this.isSendOnePlay=!0);this.playPerf.setSoftDecodeInfo(ne(this.player)),this._trackOneError("error",t),this._trackOnePlay("error",t)}},this._onSourceError=e=>{i(Ye,"onSourceError",e);const{error:t,playPerf:r}=this;t.setError(e,this.player),r.setVtype(se(this.vInfo.vtype,G.STAGE_1))},this._onPlayCatch=(e,t)=>{i(Ye,"onPlayCatch",e,t);const r=t?t.message:"";if(!t||"MP4_0"===e&&"no preload"===r)return;super._onPlayCatch(e,t);const{initialUrl:n}=this.playPerf;f(t.url)&&(t.url=n.url);const{error:o}=this;o.setError(t,this.player),this.playMDL.breakPlaybackData(j.PLAY_CATCH,this.player),this._trackOneError(j.PLAY_CATCH,o.latest)},this._onPlayerDestroy=()=>{super._onPlayerDestroy();const{playTime:e}=this.playPerf;this.playPerf.setSoftDecodeInfo(ne(this.player)),i(Ye,"onPlayerDestroy",this.sessionId,e),this._trackOnePlay("player_destroy"),this.reset(!1),this._unBindEvt()},this._onPlayNext=()=>{var e,t,r,n;i(Ye,"onPlayNext1",this.sessionId,(null==(t=null==(e=this.player)?void 0:e.getCore)?void 0:t.call(e))||A.isIOS),(null!=(n=null==(r=this.player)?void 0:r.getCore)&&n.call(r)||A.isIOS)&&(i(Ye,"onPlayNext",this.sessionId),this._onPlayerReset("next"))},this._onPlayerReset=e=>{const{playPerf:t}=this;i(Ye,"onPlayerReset",this.sessionId,`type:${e} playTime:${t.playTime}`),this.playMDL.breakPlaybackData(j.RESET,this.player),t.updateAcc("reset"),this.playPerf.setSoftDecodeInfo(ne(this.player)),t.playTime>0&&(this.setPlayLeaveInfo(M.RESET,j.RESET),this._trackOnePlay(e||M.RESET)),this.reset(!1)},this._onAutoPlayStart=()=>{super._onAutoPlayStart()},this._onAutoPlayPrevented=()=>{super._onAutoPlayPrevented()},this._onVisibilityChange=e=>{i(Ye,"onVisibilityChange",e);const{playPerf:t}=this;t.visible="visible"===e,t.updateAcc("visible",!1)},this._onInitialUrl=e=>{i(Ye,"onInitialUrl",e),this.setInitialUrl(e)},this._onRenderStateChange=e=>{const{playPerf:t,player:r}=this,n="statechange";e.state===t.renderState||e.state===F.DESTROY||(i(Ye,"_onRenderStateChange1",this.playerId,s(),t.renderState,e.state),t.renderState!==F.ACTIVE||e.state!==F.RETAIN&&e.state!==F.RELEASE?e.state===F.ACTIVE&&this.addTimeLinePoint(ke.ACTIVE):(t.setExit(n,r),t.updateAcc(n),this.setPlayLeaveInfo(n),this.playPerf.setSoftDecodeInfo(ne(this.player)),this._trackOnePlay(n),this.reset(!1,e.state!==F.RELEASE)),function(e,t){return e===F.RELEASE&&(t===F.BACKUP||t===F.ACTIVE)}(t.renderState,e.state)&&this.addTimeLinePoint(ke.INIT),t.switchPlayerTime=s(),t.changeRenderState(e.state,r))},this._onBeforeDefiChange=e=>{i(Ye,"onBeforeDefinitionChange",e)},this._onDefiChange=e=>{i(Ye,"onDefinitionChange",e)},this._onDefiChangeSuccess=()=>{i(Ye,"onDefiChangeSuccess")},this._onDefiChangeDetail=e=>{i(Ye,"onDefiChangeDetail",e);const{playMDL:t,player:r}=this;t.updateDefInfo(e,r.currentTime);const{lastBitrate:n}=t;n&&e.mediaType},this._onPrfDataSize=e=>{this.playMDL.updateDownload(e)},this._onXgLogCache=()=>{const e=function(e){return(null==e?void 0:e.logCache)||(null==e?void 0:e.getLogCache)}(this.player);e&&(this.templog={vtype:J(this.player),log:e})},this._onDegrade=e=>{"tt-video"===(null==e?void 0:e.mediaType)&&super._onPlayCatch("MP4_MSE_SOFT_1",e);const{initialUrl:t}=this.playPerf;f(e.url)&&(e.url=t.url);const{error:r}=this;r.setError(e,this.player),this.playMDL.breakPlaybackData(j.PLAY_CATCH,this.player),this.playPerf.setSoftDecodeInfo(ne(this.player,e)),i(Ye,"onDegrade",e),this._trackOneError(j.DEGRADE,r.latest)},this._onDowngrade=e=>{if(i(Ye,"_onDowngrade",re(this.player),e),!re(this.player))return;const{timeline:t,playPerf:r,error:n,player:o,playMDL:s}=this,a=t.getTime(ke.LOADED_DATA);let l="";l=se(this.vInfo.vtype,a<=0?G.MSE_1:G.MSE_2);const c="downgrade";r.setVtype(l),n.setError(e,o),r.seeking=!1,r.updateAcc(c),r.setBreak(c,r.currentTime.current),s.breakPlaybackData(c,o),this._trackOneError(j.DOWNGRADE,n.latest)},this._onException=e=>{if(i(Ye,"_onException",re(this.player),e),!re(this.player))return;const{playPerf:t,error:r,player:n}=this,o=se(this.vInfo.vtype,G.STAGE_1);t.setVtype(o),r.setError(e,n);const s="exception";t.seeking=!1,t.updateAcc(s),t.setBreak(s,t.currentTime.current),this._trackOneError(j.EXCEPTION,r.latest)},this._onAbrChange=()=>{i(Ye,"onAbrChange")},this._onMediaFormatError=e=>{i(Ye,"onMediaFormatError",e)},this._onPageUnload=()=>{const{playTime:e}=this.playPerf;if(i(Ye,"onPageUnload",this.sessionId,e),e>0){const e=j.PAGE_UNLOAD;this.setPlayLeaveInfo(e,e),this.playMDL.breakPlaybackData(e,this.player),this.playPerf.setSoftDecodeInfo(ne(this.player)),this._trackOnePlay(j.PAGE_UNLOAD)}},this._onHitcache=e=>{if(i(Ye,"_onHitcache",this.sessionId,e),!e)return;const{playPerf:t}=this;t.setPreload({vtype:e.vtype||"MP4",codec:e.codec,time:e.duration,size:e.dataSize,preloadSize:e.preloadSize,cacheSize:e.cacheSize,type:e.hitType,bitrate:e.bitrate,definition:e.definition})},e&&e.line_app_id?(this.isSendOnePlay=!1,this.sessionId="",this.init(e),this.player&&(this._bindEvt(this.player),this.timeline.playerId=this.player.uuid||this.player.playerId),je.increment(),this.insIndex=je.instanceCount,this.addTimeLinePoint(ke.INIT)):console.warn("player.config.vodLogOpts.line_app_id is necessary for plugin xgVodLogger")}static get version(){return E}static get preloadMDL(){return Je}static setCustomTracker(e){i(Ye,"setCustomTracker",e),et=e}static set Tracker(e){Xe=e}static get Tracker(){return Xe}static sendEvent(e,t){Xe&&Xe.event(e,t)}static setPlayerPool(e,t){Qe[e]=t}static set commonData(e){L(e)}static set TEA_ID(e){!function(e){x=e,R=`__tea_cache_tokens_${x}`}(e)}static get TEA_ID(){return x}static set AB_SDK_VERSION(e){P.absdkVersion=Array.isArray(e)?e.join(","):e}static get AB_SDK_VERSION(){return P.absdkVersion}static attachPreloader(e){Je.attach(e)}static detachPreloader(){Je.detach()}static get defaultConfig(){return{line_app_id:0,line_user_id:"",playerCoreVersion:"",playerVersion:"",app_version:"",channel:"cn",channelDomain:"",absdkVersion:"",maxQueueCount:5,ifSendVVEnded:!1,isTask:!1,vtype:"MP4",codec_type:"",tag:"普通视频",playType:0,sourceType:"vid",subtag:"",playMode:"",sendLocalCallback:(e,t)=>{},disableLocalCache:!1,closeResolutionLog:!1,closeSeekLog:!1,needXhrCheck:!1,trackerConfig:{},envInfo:{},ext:{},openSizeLog:!0,bitrateAdapter:{}}}get preloadMDL(){return Je}get playerId(){var e;return(null==(e=this.player)?void 0:e.playerId)||this.vInfo.vid}init(e){i(Ye,"init",e);const t=this.options||{};Object.keys(e).forEach(r=>{t[r]=e[r]});const r={...e.trackConfig};["referrer","channel","channel_domain"].forEach(t=>{void 0!==e[t]&&(r[t]=e[t])}),e.channelDomain&&(r.channel_domain=e.channelDomain),Xe&&Xe.config(r),this.initSessionId(),this.update(e,H.NONE)}update(e,t=H.NONE){L(e),je.incrementPlay(),this.pIndex=je.playCount,this.vInfo.init(e);const{ext:r={},switchPlayerTime:n}=e;this.setExtData(r),n&&this.setSwitchTime(n),Je.setExtData(e),this.addTimeLinePoint(ke.INIT),this.playPerf.updateReuseCount(t),this.playPerf.setVtype(this.vInfo.vtype)}set reuseType(e){this.playPerf.updateReuseCount(e)}initSessionId(){if(this.sessionId)return;let e="0";try{e=function(e){if(!window.localStorage)return"";const t=window.localStorage.getItem(e)||"";try{return JSON.parse(t)}catch{return t}}(R).web_id||"0"}catch{e="0"}this.sessionId=function(e){let t="0";try{const r=window.localStorage.getItem(e)||"",n=JSON.parse(r);t=(null==n?void 0:n.web_id)||"0"}catch{t="0"}return function(e){let t=(new Date).getTime(),r=0;try{r=parseInt(e)}catch{r=0}return t+=r,window.performance&&"function"==typeof window.performance.now&&(t+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?r:3&r|8).toString(16)})}(t)}(e),i(Ye,`sessionId webId:${e} ${this.sessionId}`)}attachPlayer(e){e!==this.player&&(this.detachPlayer(this.player),this.player=e,this.player.version&&(P.pv=this.player.version),this._bindEvt(e),this.timeline.playerId=this.player.uuid||this.player.playerId);const t=null==e?void 0:e.preloader;t&&Je.attach(t)}detachPlayer(e){this.player&&e===this.player&&(this._unBindEvt(),this.player=null)}resetConfig(e){i(Ye,"reset",e)}reset(e,t=!1){super.reset(e,t),this.isSendOnePlay=!1}destroy(){const{operate:e,playPerf:t,playMDL:r,wait:n,error:o,player:s}=this;i(Ye,"destroy",this.sessionId);const a="log_destroy";t.setExit(j.LOG_DESTROY,s),t.updateAcc(a),r.breakPlaybackData(a,s),this._trackOnePlay(a),e.reset(),t.reset(!1),n.reset(),o.reset(),r.reset(),this.detachPlayer(this.player)}getTokenFromTracker(){return Xe?Xe.getToken():{}}_bindEvt(e){e&&(Ie(this.sessionId,Be,this._onVisibilityChange),Ie(this.sessionId,De,this._onPageUnload),function(e,t){Re(e,t,1)}(e,this))}_unBindEvt(){const{player:e}=this;e&&(function(e,t){Re(e,t,2)}(e,this),Me(this.sessionId,Be),Me(this.sessionId,De))}_suspendStateCallback(e,t){if(e&&t)switch(i(Ye,"_suspendStateCallback",e,t),e){case D.ONE_EVENT:this._trackOneEvent("wait",t);break;case D.ONE_OPERA:this._trackOneOpera(t);break;case D.MDL_DATA_SIZE:this._trackMdlVideoSize(t)}}_trackOnePlay(e,t){const{playPerf:r}=this;if(this.isSendOnePlay||!r.playTime)return void i(Ye,this.playerId,`_trackOnePlay_${e} isSendOnePlay:${this.isSendOnePlay} renderState:${r.renderState} reuseType: ${r.reuseType} pt:${r.playTime}`);this.addTimeLinePoint(ke.LEAVE);const n=function(e,t,r){var n,i;const{vInfo:o,playPerf:s,playMDL:a,wait:u,operate:d,error:h,player:f,sessionId:_,extData:y,performanceNow:g,options:m,timeline:b,pIndex:w,insIndex:C}=e,{bitrateAdapter:E={},playerType:k="default"}=m,T=Ae(_,o,s,f,{playerType:k,pIndex:w,insIndex:C}),S=e.getPlayerPoolStats(),{url:O,host:A,ip:$,bitrate:P}=s.initialUrl,{leave:R,exit:x,playTime:L,vvTime:I,newTime:M,volume:D,muted:B,playbackRate:N,bufferFinishTime:j,preloadData:U,br:V,resolution:F,startLoadTime:H,userFvt:G,width:W,height:q,switchPt:K,meta:z,startPlayInfo:Y,autoplayStart:X,softDecodeInfo:Q}=s,{seekCount:J,sat:ee,pauseLog:re}=d,{playedSize:ne,cdnSize:ie,cdnVSize:oe,pcdnSize:se,pcdnVSize:ae}=a.accDatas,{firstWait:le}=u,{errors:ce}=h,ue=h.first,de=s.getWatchDuration(),he=function(e){if(e&&e.pcdnVVStat){const t=e.pcdnVVStat;return{try_req:t.try_req_num,req_succ:t.req_node_succ,has_ret:t.has_ret_node,conn_ret:t.conn_ret_num,conn_fail:t.conn_fail_num,conn_jump:t.conn_jump_num}}return{}}(f),pe=function(e){return e&&e.performance||{}}(f),fe=function(e){const t=Z(e),r={total:0,dropped:0,drop_rate:0};try{const e=null==t?void 0:t.getVideoPlaybackQuality();return r.dropped=(null==e?void 0:e.droppedVideoFrames)||0,r.total=(null==e?void 0:e.totalVideoFrames)||0,r.total>0&&(r.drop_rate=l(r.dropped/r.total*100)),r}catch{return r}}(f),{bitrateSet:_e,bitrateSetHevc:ye}=o,me=function(e,t){return{h1:e.length,h2:t.length,set1:ge(e),set2:ge(t)}}(_e,ye),ve=P,be=b.getDurations();return{...T,perf_time:g,prepare_start_time:0,prepare_end_time:0,initial_url:O||"",initial_host:A,initial_ip:$,isexpired:v(O),width:W,height:q,initial_resolution:s.initialUrl.resolution,nt:M,pt:L,vt:I,fvt:te(L,I),svt:te(H,I),nvt:I>0?I-M:L-M,user_fvt:G,switch_pt:K,player_created_t:M,lt:R.time,lpt:s.lpt,et:x.time,lv_method:x.method,bft:j,volume:l(D.current,2),mute:B.current?1:0,play_speed:N.current,sc:J,sat:ee,dbc:u.dbc,nbc:u.nbc,bc:u.dbc+u.nbc,bu_acu_t:u.dAcuTime+u.nAcuTime,de_bu_acu_t:u.dAcuTime,n_bu_acu_t:u.nAcuTime,pause_acu_t:re.acuTime,start_time:c(s.startPlayInfo.startPos||0),finish:s.ended||s.loopCount>0?1:0,lc:s.loopCount,watch_dur:de,is_start_play_automatically:X,first_buf_startt:le.start,first_buf_endt:le.end,play_c:s.playCount,load_state:s.loadState,playback_state:s.playbackState,pcdn:p(he),pre_info:p(U),perf:p(pe),frame_info:p(fe),br:V.count,fbrt:V.time,df:F.current,lf:F.last,bitrate:ve,errc:r?r.code:0,errt:r?r.type:0,vsc_message:r?r.message:"",fir_errc:ue?ue.code:0,fir_errt:ue?ue.type:0,accu_errc:h.count||0,merror:p(ce),end_type:t,vps:ne,vds:ie,pvds:se,vvds:oe,pvvds:ae,vplt:U.time,vpls:U.size||0,cache_s:U.cacheSize||0,cache_t:U.type,ext:p(y),bitset:p(me),meta:p(z),exit:p(x),start_info:p(Y),rstate:s.renderState,pre_rstate:s.preRenderState,prepare_before_play_t:s.prepareBeforePlayTime,user_resolution:E.userResolution||"auto",quality_type:E.qualityType||0,selector:E.selector||"default",...Y,...be,timeline:p(be),loudness:(null==(n=o.volumeInfo)?void 0:n.loudness)||0,peak:(null==(i=o.volumeInfo)?void 0:i.peak)||0,soft_info:p(Q),session_cnt:(null==S?void 0:S.totalCount)||0,crosstalk_count:(null==S?void 0:S.playCount)||0}}(this,e,t);i(Ye,this.playerId,n.v,`_trackOnePlay_${e}`,`renderState:${r.renderState} reuseType: ${r.reuseType} fvt:${n.fvt} vplt:${n.vplt} vpls: ${n.vpls} vid:${n.v}`,n.codec_type,n,this.timeline.getDurations()),this.isSendOnePlay=!0,this.sendEvent(D.ONE_PLAY,n)}_trackOneEvent(e,t){const{closeEvents:r=[]}=this.options;if(r.includes(D.ONE_EVENT))return;const n=function(e,t,r){const{vInfo:n,playPerf:i,operate:o,player:s,sessionId:a,pIndex:l,insIndex:u}=r,{playerType:d="default"}=r.options,h=Ae(a,n,i,s,{pIndex:l,insIndex:u,playerType:d}),{playbackRate:f,firstUpdateTime:_,softDecodeInfo:y}=i,{latestSeek:m,latestSwitch:v}=o,{endDiff:b=-1,startDiff:w=-1}=t,C=r.getPlayerPoolStats();return{...h,event_type:e,cost_time:t.costTime,end_type:t.endType,first_frame_interval:g(_,t.start),last_seek_interval:m?g(m.start,t.start):0,last_switch_interval:v?g(v.start,t.start):0,last_event_interval:t.interval,video_pos:c(t.pos),play_speed:f.current,st:t.start,et:t.end,e_buf:b,s_buf:w,rstate:i.renderState,pre_rstate:i.preRenderState,prepare_before_play_t:i.prepareBeforePlayTime,soft_info:p(y),session_cnt:(null==C?void 0:C.totalCount)||0,crosstalk_count:(null==C?void 0:C.playCount)||0}}(e,t,this);i(Ye,`_trackOneEvent_${e}`,t,n),this.sendEvent(D.ONE_EVENT,n)}_trackOneOpera(e){const{closeEvents:t=[]}=this.options;if(t.includes(D.ONE_OPERA))return;const r=e.op,n=function(e,t,r){const{vInfo:n,playPerf:i,player:o,sessionId:s,pIndex:a,insIndex:l}=r,{playerType:u="default"}=r.options,d=Ae(s,n,i,o,{playerType:u,pIndex:a,insIndex:l}),h=r.getPlayerPoolStats();return{...d,opera_type:e,end_type:t.endType,state_before:t.stateBefore,state_after:t.stateAfter,cost_time:t.costTime,is_seek_in_buffer:t.inBuffer?1:0,last_interval:t.interval,video_pos:c(t.pos),cdn_url:"",cdn_ip:"",rstate:i.renderState,pre_rstate:i.preRenderState,prepare_before_play_t:i.prepareBeforePlayTime,session_cnt:(null==h?void 0:h.totalCount)||0,crosstalk_count:(null==h?void 0:h.playCount)||0}}(r,e,this);i(Ye,`_trackOneOpera_${r}`,e,n),this.sendEvent(D.ONE_OPERA,n)}_trackOneError(e,t){if(!t)return;const r=function(e,t,r=""){const{error:n,vInfo:i,playPerf:o,player:s,sessionId:a,extData:l,timeline:c,pIndex:u,insIndex:d}=t,{playerType:h="default"}=t.options,f=Ae(a,i,o,s,{playerType:h,pIndex:u,insIndex:d}),{resolution:_}=o.initialUrl,y=n.errorCodes,g=c.getDurations(),m=t.getPlayerPoolStats();return{...f,errt:e.type,errc:e.code,err_msg:e.message,cdn_url:e.cdnUrl,cdn_host:e.cdnHost,cdn_ip:e.cdnIp,es:e.stage||"",isexpired:e.isExpired,resolution:b(_),end_type:r,last_errors:y,retry_count:n.retryCount,ext:p(l),rstate:o.renderState,pre_rstate:o.preRenderState,prepare_before_play_t:o.prepareBeforePlayTime,timeline:p(g),soft_info:p(o.softDecodeInfo),session_cnt:(null==m?void 0:m.totalCount)||0,crosstalk_count:(null==m?void 0:m.playCount)||0}}(t,this,e);i(Ye,`_trackOneError_${e}`,t,r),this.sendEvent(D.ONE_ERROR,r)}_trackMdlVideoSize(e){const t=function(e,t){const{vInfo:r,playPerf:n,player:i,sessionId:o,pIndex:s,insIndex:a}=e,{playerType:l="default"}=e.options;return{...Ae(o,r,n,i,{playerType:l,pIndex:s,insIndex:a}),...t,rstate:n.renderState,pre_rstate:n.preRenderState,prepare_before_play_t:n.prepareBeforePlayTime}}(this,e);i(Ye,`_trackMdlVideoSize${e.end_type}`,t),this.sendEvent(D.MDL_DATA_SIZE,t)}sendEvent(e,t){if(i(Ye,"sendEvent",`eventName:${e} extNAme:${B[e]}`),Xe&&Xe.event(e,t),et){const r=B[e];r&&et.event(r,function(e){const t={...e};try{return delete t.line_user_id,delete t.deviceScore,delete t.ua,delete t.absdkVersion,Object.keys($e).forEach(e=>{t[$e[e]]=t[e],delete t[e]}),t}catch{return t}}(t))}}getFinalInfo(){var e,t;const{error:r,playPerf:n,vInfo:i,player:o}=this;return{vt:n.vvTime,pt:n.playTime,currentTime:o.currentTime,firstframeDuration:n.fvt,errorCode:(null==(e=r.latest)?void 0:e.code)||0,errorMessage:(null==(t=r.latest)?void 0:t.message)||"",isFinish:n.loopCount>0?1:0,codecType:i.codec_type,resolution:n.resolution.current,url:n.initialUrl.url}}getPlayerPoolStats(){var e,t;const{playerType:r}=this.options;return r&&(null==(t=null==(e=Qe[r])?void 0:e.getStats)?void 0:t.call(e))||null}}const rt="XGTracker",nt="__xgplayer_vod_log__",it={appId:548444,_tt:{user_unique_id:""},_tracker:null,_options:{},init(e,t,r){var n,o,s;if((t.appId||t.app_id)&&(this.appId=t.appId||t.app_id),this._options=t,!O)return;i(rt,"init",this.appId,t);const a=window[nt];!a&&e?(this._tracker=new e("xgplayer_tracker"),window[nt]=this._tracker):this._tracker=a;const{channel:l,channel_domain:c}=t,u={app_id:this.appId,log:!1,disable_sdk_monitor:!0,enable_ab_test:!1,disable_auto_pv:!0,...t,channel:l||"cn",channel_domain:c};return null==(n=this._tracker)||n.init(u),null==(o=this._tracker)||o.getToken(e=>{this._tt=e}),this.config(r||{}),null==(s=this._tracker)||s.start(),this._tracker},config(e={}){const t={...e};A&&A.name&&!A.isChrome&&!A.isSafari&&(t.browser=A.name,A.appVersion&&(t.browser_version=A.appVersion));const r=e.user_unique_id||"";r&&(t.user_unique_id=r,t.web_id=r,t.device_id=r,t.user_id=e.user_id||r,this._tt={user_unique_id:r,user_id:e.user_id||r}),e.referrer&&(t.referrer=e.referrer,t.referrer_host=h(e.referrer)),this._tracker&&this._tracker.config(t)},getToken(){return this._tt},event(e,t){const{appId:r,_tracker:n,_tt:o}=it;i(rt,`sendEvent_${r}`,!n,e,t),n&&(t.line_user_id||(t.line_user_id=(null==o?void 0:o.user_unique_id)||""),"function"==typeof n?n(e,t):n.event(e,t))}};tt.Tracker=it;const ot=function(e){if(e&&e.player){const t=e.player.config.vodLogOpts||{};e.player.vodLogger=new tt(t,e.player),e.player.plugins.xgVodLogger=e.player.vodLogger}else this.vodLogger=new tt(this.config.vodLogOpts||{},this)};ot.initTracker=function(e,t={}){it.init(e,t)},ot.configTracker=function(e){it.config(e)},ot.pluginName="__xgVodLogger",ot.playerConfig={},ot.setABSdkVersion=e=>{tt.AB_SDK_VERSION=e}},55714:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M43.8044 6.79902C42.5841 7.62363 39.7822 8.82191 38.4004 8.82191V8.82437C36.8226 7.08554 34.6013 6 32.1377 6C27.353 6 23.4731 10.093 23.4731 15.1387C23.4731 15.8398 23.5501 16.5236 23.6925 17.1793H23.6911C17.2007 16.9996 10.1022 13.5678 5.82893 7.69403C3.2016 12.4916 5.4752 17.8272 8.45673 19.7713C7.43613 19.8526 5.55733 19.6473 4.673 18.737C4.61373 21.9212 6.06507 26.1403 11.3571 27.6709C10.3379 28.2494 8.53373 28.0834 7.74926 27.9604C8.0246 30.6484 11.5927 34.1625 15.4945 34.1625C14.1039 35.8594 8.8716 38.9374 3 37.9582C6.98767 40.5177 11.6352 42 16.5543 42C30.5333 42 41.3894 30.0482 40.8051 15.3041C40.8028 15.2879 40.8028 15.2716 40.8014 15.2539C40.8028 15.216 40.8051 15.1781 40.8051 15.1387C40.8051 15.0929 40.8014 15.0496 40.8 15.0053C42.0726 14.0871 43.7801 12.463 45 10.3254C44.2925 10.7365 42.1701 11.5596 40.1952 11.7639C41.4627 11.0422 43.3405 8.67865 43.8044 6.79902Z",fill:"#1DA1F2"}))}},56152:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.0001 13C13.0001 9.68629 15.6864 7 19.0001 7C22.3139 7 25.0001 9.68629 25.0001 13C25.0001 16.3137 22.3139 19 19.0001 19C15.6864 19 13.0001 16.3137 13.0001 13ZM19.0001 3C13.4773 3 9.00015 7.47715 9.00015 13C9.00015 18.5228 13.4773 23 19.0001 23C24.523 23 29.0001 18.5228 29.0001 13C29.0001 7.47715 24.523 3 19.0001 3ZM5.19435 40.9681C6.70152 35.5144 10.0886 32.2352 13.9162 30.738C17.7125 29.2531 22.0358 29.4832 25.6064 31.2486C26.1015 31.4934 26.7131 31.338 26.9931 30.8619L28.0072 29.1381C28.2872 28.662 28.1294 28.0465 27.6384 27.7937C23.0156 25.4139 17.4034 25.0789 12.4591 27.0129C7.37426 29.0018 3.09339 33.3505 1.2883 40.0887C1.14539 40.6222 1.48573 41.1592 2.02454 41.2805L3.97575 41.7195C4.51457 41.8408 5.04724 41.5004 5.19435 40.9681ZM44.7074 30.1212C45.0979 29.7307 45.0979 29.0975 44.7074 28.707L43.2932 27.2928C42.9026 26.9023 42.2695 26.9023 41.8789 27.2928L30.0003 39.1715L25.1216 34.2928C24.7311 33.9023 24.0979 33.9023 23.7074 34.2928L22.2932 35.707C21.9026 36.0975 21.9026 36.7307 22.2932 37.1212L28.586 43.4141C29.3671 44.1952 30.6334 44.1952 31.4145 43.4141L44.7074 30.1212Z"}))}},57481:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.4375 11.9817L36.0183 34.5625C38.4977 31.7439 40 28.0482 40 24C40 15.1634 32.8366 8 24 8C19.9518 8 16.2561 9.50231 13.4375 11.9817ZM34.6067 35.9793L12.0207 13.3933C9.51807 16.2174 8 19.9306 8 24C8 32.8366 15.1634 40 24 40C28.0694 40 31.7826 38.4819 34.6067 35.9793ZM11.2941 11.2501C14.5486 8.00674 19.0409 6 24 6C33.9411 6 42 14.0589 42 24C42 28.9591 39.9933 33.4514 36.7499 36.7059C33.4919 39.9751 28.9815 42 24 42C14.0589 42 6 33.9411 6 24C6 19.0185 8.02491 14.5081 11.2941 11.2501Z"}))}},57693:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 9.01703C19.0025 3.74266 11.4674 3.736 6.67302 8.56049C1.77566 13.4886 1.77566 21.4735 6.67302 26.4016L22.5814 42.4098C22.9568 42.7876 23.4674 43 24 43C24.5326 43 25.0432 42.7876 25.4186 42.4098L41.327 26.4016C46.2243 21.4735 46.2243 13.4886 41.327 8.56049C36.5326 3.736 28.9975 3.74266 24 9.01703ZM21.4938 12.2118C17.9849 8.07195 12.7825 8.08727 9.51028 11.3801C6.16324 14.7481 6.16324 20.214 9.51028 23.582L24 38.1627L38.4897 23.582C41.8368 20.214 41.8368 14.7481 38.4897 11.3801C35.2175 8.08727 30.0151 8.07195 26.5062 12.2118L26.455 12.2722L25.4186 13.3151C25.0432 13.6929 24.5326 13.9053 24 13.9053C23.4674 13.9053 22.9568 13.6929 22.5814 13.3151L21.545 12.2722L21.4938 12.2118Z"}))}},59061:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M22.7191 30.6487C23.359 31.5037 24.641 31.5037 25.2809 30.6487L32.0848 21.5588C32.8744 20.5038 32.1216 19 30.8038 19H17.1962C15.8784 19 15.1256 20.5038 15.9152 21.5588L22.7191 30.6487Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3 11C3 6.58172 6.58172 3 11 3H37C41.4183 3 45 6.58172 45 11V37C45 41.4183 41.4183 45 37 45H11C6.58172 45 3 41.4183 3 37V11ZM11 7H37C39.2091 7 41 8.79086 41 11V37C41 39.2091 39.2091 41 37 41H11C8.79086 41 7 39.2091 7 37V11C7 8.79086 8.79086 7 11 7Z"}))}},59426:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 24 24",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M12.5546 8.35111L13.3171 8.16468V7.37972V3.50006L21.4998 12.0001L13.3171 20.5001V16.3738V15.3664L12.3098 15.3738C8.838 15.3994 5.4275 17.0466 2.49983 19.5882C2.54612 19.2536 2.67769 18.641 2.94391 17.8329C3.3786 16.5132 4.01326 15.1988 4.88691 13.971C6.71045 11.4083 9.24414 9.16046 12.5546 8.35111Z",stroke:"#161823",strokeWidth:"2"}))}},60652:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24Z",fill:"#161823",fillOpacity:"0.75"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.313 7.96568C12.3665 7.65966 12.658 7.45498 12.964 7.50851C13.27 7.56203 13.4747 7.8535 13.4211 8.15951L12.0506 15.9952C11.997 16.3012 11.7056 16.5059 11.3996 16.4523C11.0936 16.3988 10.8889 16.1073 10.9424 15.8013L12.313 7.96568ZM16.2402 8.77448C15.96 8.48453 15.5058 8.48453 15.2256 8.77448C14.9454 9.06443 14.9454 9.53454 15.2256 9.82449L17.454 12.1307L15.2262 14.4364C14.946 14.7263 14.946 15.1964 15.2262 15.4864C15.5063 15.7763 15.9606 15.7763 16.2407 15.4864L19.4551 12.1598C19.4704 12.1439 19.4704 12.1182 19.4551 12.1023L19.2233 11.8623L19.2201 11.8586L19.2158 11.854L16.2402 8.77448ZM8.88972 15.4867C8.59977 15.7766 8.12966 15.7766 7.83971 15.4867L5.4207 13.0677L4.76017 12.4071L4.51191 12.1589C4.49603 12.143 4.49603 12.1173 4.51191 12.1014L7.83853 8.77477C8.12848 8.48482 8.59859 8.48482 8.88854 8.77477C9.17849 9.06472 9.17849 9.53482 8.88854 9.82478L6.58318 12.1301L8.88972 14.4367C9.17967 14.7266 9.17967 15.1967 8.88972 15.4867Z",fill:"white"}))}},60751:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 24C4 21.7909 5.79086 20 8 20C10.2091 20 12 21.7909 12 24C12 26.2091 10.2091 28 8 28C5.79086 28 4 26.2091 4 24ZM20 24C20 21.7909 21.7909 20 24 20C26.2091 20 28 21.7909 28 24C28 26.2091 26.2091 28 24 28C21.7909 28 20 26.2091 20 24ZM36 24C36 21.7909 37.7909 20 40 20C42.2091 20 44 21.7909 44 24C44 26.2091 42.2091 28 40 28C37.7909 28 36 26.2091 36 24Z"}))}},61112:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M32.5395 4C32.818 6.36773 31.8105 8.69873 30.3367 10.4125C28.7997 12.0988 26.3381 13.3901 23.9417 13.223C23.6296 10.9471 24.8426 8.52606 26.2018 7.04921C27.7388 5.37215 30.4058 4.08817 32.5395 4ZM40.3837 17.6472C40.1083 17.8003 35.6843 20.2608 35.7333 25.2724C35.7886 31.3304 41.4309 33.3307 41.5 33.3528C41.4664 33.4924 40.6169 36.2422 38.5011 39.0324C36.7329 41.4901 34.8798 43.8928 31.9402 43.9368C30.5423 43.9665 29.5985 43.5924 28.6151 43.2026C27.5889 42.7957 26.5195 42.3718 24.8459 42.3718C23.0723 42.3718 21.9556 42.8092 20.8786 43.2311C19.9474 43.5958 19.0459 43.9489 17.7752 43.9975C14.9739 44.0948 12.8343 41.3744 11.003 38.9387C7.34418 33.9681 4.49342 24.9289 8.31419 18.779C10.1653 15.7628 13.5436 13.8194 17.151 13.768C18.7401 13.7368 20.2645 14.3064 21.6007 14.8057C22.6216 15.1873 23.5327 15.5277 24.2789 15.5277C24.9355 15.5277 25.822 15.2004 26.8551 14.819C28.4827 14.218 30.4741 13.4828 32.5032 13.6817C33.8901 13.7184 37.8412 14.1905 40.3897 17.6438L40.3837 17.6472Z",fill:"#161823"}))}},61331:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.375 44.2391C21.375 44.6593 21.7157 45 22.1359 45H25.8641C26.2843 45 26.625 44.6593 26.625 44.2391V41.3044C29.4979 40.8723 32.1421 39.7417 34.3792 38.0912L36.4554 40.1674C36.7525 40.4646 37.2343 40.4646 37.5314 40.1674L40.1677 37.5311C40.4648 37.234 40.4648 36.7522 40.1677 36.4551L38.0915 34.3789C39.7419 32.1418 40.8723 29.4978 41.3044 26.625H44.2391C44.6593 26.625 45 26.2843 45 25.8641V22.1359C45 21.7157 44.6593 21.375 44.2391 21.375H41.3044C40.8723 18.5021 39.7418 15.858 38.0913 13.6209L40.1673 11.5449C40.4644 11.2478 40.4644 10.766 40.1673 10.4689L37.531 7.83262C37.2339 7.53548 36.7521 7.53548 36.455 7.83262L34.379 9.90863C32.1419 8.25818 29.4978 7.1277 26.625 6.69556V3.76087C26.625 3.34065 26.2843 3 25.8641 3H22.1359C21.7156 3 21.375 3.34065 21.375 3.76087V6.69556C18.5022 7.1277 15.8582 8.25815 13.6211 9.90854L11.5452 7.83265C11.2481 7.53551 10.7664 7.53551 10.4692 7.83265L7.83294 10.4689C7.5358 10.7661 7.5358 11.2478 7.83294 11.545L9.90878 13.6208C8.25826 15.8579 7.12772 18.5021 6.69556 21.375H3.76087C3.34065 21.375 3 21.7157 3 22.1359V25.8641C3 26.2843 3.34065 26.625 3.76087 26.625H6.69556C7.1277 29.4978 8.25819 32.1419 9.90863 34.379L7.83255 36.4551C7.53541 36.7522 7.53541 37.234 7.83255 37.5311L10.4688 40.1674C10.766 40.4645 11.2477 40.4645 11.5449 40.1674L13.6209 38.0913C15.858 39.7418 18.5021 40.8723 21.375 41.3044V44.2391ZM24 38C31.732 38 38 31.732 38 24C38 16.268 31.732 10 24 10C16.268 10 10 16.268 10 24C10 31.732 16.268 38 24 38Z"}))}},62289:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 16 16",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.74992 1.66699C1.96752 1.66699 1.33325 2.30125 1.33325 3.08366V14.3337C1.33325 14.6033 1.49568 14.8464 1.7448 14.9496C1.99391 15.0528 2.28066 14.9957 2.47132 14.8051L4.90106 12.3753H13.2499C14.0323 12.3753 14.6666 11.7411 14.6666 10.9587V3.08366C14.6666 2.30126 14.0323 1.66699 13.2499 1.66699H2.74992ZM8.0386 5.35482C7.75701 5.35482 7.49304 5.52578 7.31046 5.89816C7.24968 6.02213 7.11037 6.0943 6.97939 6.05064L6.18882 5.78712C6.05783 5.74346 5.98609 5.60139 6.04026 5.47438C6.35392 4.7389 7.00019 4.02148 8.0386 4.02148C9.1483 4.02148 10.0479 4.92107 10.0479 6.03076C10.0479 6.67737 9.65353 7.21121 9.24558 7.54935C8.89233 7.84214 8.42977 8.07353 7.95224 8.13552C7.81531 8.1533 7.70295 8.04 7.70295 7.90193V7.0686C7.70295 6.93053 7.81667 6.81693 7.94784 6.77384C8.09003 6.72713 8.24885 6.6437 8.39471 6.5228C8.64051 6.31907 8.71455 6.12567 8.71455 6.03076C8.71455 5.65745 8.41192 5.35482 8.0386 5.35482ZM8.83293 9.43848C8.83293 9.85269 8.49714 10.1885 8.08293 10.1885C7.66871 10.1885 7.33293 9.85269 7.33293 9.43848C7.33293 9.02426 7.66871 8.68848 8.08293 8.68848C8.49714 8.68848 8.83293 9.02426 8.83293 9.43848Z"}))}},62738:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M43.4143 16.5858L31.1214 4.29289C30.7309 3.90237 30.0977 3.90237 29.7072 4.29289L28.2929 5.70711C27.9024 6.09763 27.9024 6.7308 28.293 7.12132L37.1716 16H5.00006C4.44777 16 4.00006 16.4477 4.00006 17V19C4.00006 19.5523 4.44777 20 5.00006 20H42.0001C42.809 20 43.5383 19.5127 43.8478 18.7654C44.1574 18.018 43.9863 17.1578 43.4143 16.5858Z"}),n.createElement("path",{d:"M4.58584 31.4142L16.8787 43.7071C17.2693 44.0976 17.9024 44.0976 18.293 43.7071L19.7072 42.2929C20.0977 41.9024 20.0977 41.2692 19.7072 40.8787L10.8285 32L43.0001 32C43.5523 32 44.0001 31.5523 44.0001 31V29C44.0001 28.4477 43.5523 28 43.0001 28L6.00006 28C5.19113 28 4.46186 28.4873 4.1523 29.2346C3.84274 29.982 4.01385 30.8422 4.58584 31.4142Z"}))}},63031:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10C5.23858 10 3 12.2386 3 15V33C3 35.7614 5.23858 38 8 38H30C32.7614 38 35 35.7614 35 33V27.2763L43.2879 33.5909C43.8927 34.0516 44.7064 34.1297 45.3876 33.7922C46.0689 33.4548 46.5 32.7603 46.5 32V16C46.5 15.2397 46.0689 14.5452 45.3876 14.2078C44.7063 13.8704 43.8927 13.9484 43.2879 14.4092L35 20.7238V15C35 12.2386 32.7614 10 30 10H8ZM7 15C7 14.4477 7.44772 14 8 14H30C30.5523 14 31 14.4477 31 15V33C31 33.5523 30.5523 34 30 34H8C7.44771 34 7 33.5523 7 33V15ZM42.5 27.9619L37.3001 24.0001L42.5 20.0382V27.9619Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.7392 23.5425C24.0881 23.7891 24.0867 24.2714 23.7365 24.5164L16.0777 29.8728C15.6364 30.1814 15 29.8934 15 29.3849V18.6151C15 18.1052 15.6396 17.8175 16.0804 18.1291L23.7392 23.5425Z"}))}},65491:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M34.4142 22.5858L18.1213 6.29289C17.7308 5.90237 17.0976 5.90237 16.7071 6.29289L15.2929 7.70711C14.9024 8.09763 14.9024 8.7308 15.2929 9.12132L30.1716 24L15.2929 38.8787C14.9024 39.2692 14.9024 39.9024 15.2929 40.2929L16.7071 41.7071C17.0976 42.0976 17.7308 42.0976 18.1213 41.7071L34.4142 25.4142C35.1953 24.6332 35.1953 23.3668 34.4142 22.5858Z"}))}},66003:(e,t,r)=>{"use strict";r.d(t,{IH:()=>$p,SX:()=>mf,SN:()=>pf,mx:()=>df});var n=r(55340);const i=Object.freeze(Object.defineProperty({__proto__:null,getFilename:function(e){const t=e.split("?")[0],r=t&&t.split("/");let n;for(;r&&r.length;)if(n=r.pop(),n)return n}},Symbol.toStringTag,{value:"Module"})),o=e=>e<10?"0"+e:e,s=(e,t=!1)=>{const r=[];let n=Math.floor(e/1e3),i=Math.floor(n/60);const s=Math.floor(i/24);return n-=60*i,i-=24*s,s&&r.push(o(s)),r.push(o(i)),r.push(o(n)),t?r.join(":")+"."+(e/1e3).toFixed(3).split(".").pop():r.join(":")},a=Date.now(),l=()=>window.performance?performance.now():Date.now()-a,c=Object.freeze(Object.defineProperty({__proto__:null,format:o,getPerformanceNow:l,toHHMMSSDuration:s},Symbol.toStringTag,{value:"Module"})),u=e=>"[object Object]"===Object.prototype.toString.call(e),d=(e,t)=>{const r=Object.assign({},e);return Object.keys(t).forEach(n=>{if(void 0===e[n]){const e=t[n];u(r[n])&&u(e)?r[n]=d(r[n],e):r[n]=e}}),r},h=Object.freeze(Object.defineProperty({__proto__:null,combineDefaultOptions:d,isObject:u,isString:e=>"string"==typeof e},Symbol.toStringTag,{value:"Module"})),p=()=>!!(typeof window<"u"&&window.document),f={trace:0,debug:1,log:2,info:3,warn:4,error:5},_={0:"",1:"gray",2:"",3:"lightblue",4:"",5:""},y=[];let g=4,m=0,v=!1,b=2e3,w=[],C=0;const E=Object.keys(f);class k{constructor(e){this.__level=g,this.__mode=m,this.__styled=v,this.__name=e,this.__apply(),y.push(this)}formatArgs(e,t,r){if(!this.__styled)return r.unshift(t),r;const n=[`%c${t}`],i=[`color:${_[e]}`];return r.forEach(e=>{"number"==typeof e?(e%1==0?n.push("[35;2;200;80;244m%d[39m"):n.push("[35;2;200;80;244m%f[39m"),i.push(e)):e instanceof Node?(n.push("%o"),i.push(e)):"object"==typeof e?(n.push("%O"),i.push(e)):n.push(e)}),i.unshift(n.join(" ")),i}__apply(){1===this.__mode?E.forEach(e=>{f[e]>=this.__level&&(this[e]=(...t)=>{const r=`[${e}][${this.__name}][${s(l(),!0)}]`;w.push({id:C++,level:e,name:this.__name,prefix:r,timestamp:Date.now(),message:t.join(" ")}),w.length>b&&w.shift()})}):0===this.__mode&&E.forEach(e=>{const t=f[e];t>=this.__level&&(this[e]=(...r)=>{var n;const i=`[${s(l(),!0)}][${e}][${this.__name}]`;null==(n=console[e])||n.apply(console,this.formatArgs(t,i,r))})})}trace(...e){}debug(...e){}log(...e){}info(...e){}warn(...e){}error(...e){}setName(e){this.__name=e}setMode(e){this.__mode=e,this.__apply()}setLevel(e){this.__level=e,this.__apply()}setStyled(e){this.__styled=e}reset(){this.__level=4,this.__mode=0}}const T={createLogger:e=>new k(e),getLogs:()=>w,setSize(e){b=e},setMode(e){m=e,y.forEach(t=>t.setMode(e))},setLevel(e){g=e,y.forEach(t=>t.setLevel(e))},setStyled(e){v=e,y.forEach(t=>t.setStyled(e))},reset(){y.forEach(e=>e.reset()),w=[]}};try{const e=p(),t=e?localStorage.getItem("ttplayer_logger_level"):"",r=e?localStorage.getItem("ttplayer_logger_mode"):"",n=e?localStorage.getItem("ttplayer_logger_styled"):"";"string"==typeof t&&T.setLevel(parseInt(t,10)),"string"==typeof r&&T.setMode(parseInt(r,10)),("1"===n||"true"===n)&&T.setStyled(!0)}catch{}const S=class{constructor(){this._eventMap=new Map,this._blockMap=new Map}emit(e,...t){const r=this._eventMap.get(e);let n=!0;if(r)for(let e=0,i=r.length;e<i;e++)!1===r[e].apply(this,t)&&(n=!1);return n}once(e,t){const r=(...n)=>(this.off(e,r),t.apply(this,n));this.on(e,r)}dedup(e,t){const r=this._eventMap.get(e);r?r.every(e=>e!==t)&&r.push(t):this._eventMap.set(e,[t])}on(e,t){this._eventMap.has(e)?this._eventMap.get(e).push(t):this._eventMap.set(e,[t])}off(e,t){this._eventMap.has(e)&&(t?this._eventMap.set(e,this._eventMap.get(e).filter(e=>e!==t)):this._eventMap.delete(e))}removeAllListeners(){this._eventMap.clear()}block(...e){e.forEach(e=>{const t=this._eventMap.get(e);t&&(this._blockMap.set(e,t),this._eventMap.delete(e))})}unblock(...e){e.forEach(e=>{const t=this._blockMap.get(e);t&&(this._eventMap.set(e,t),this._blockMap.delete(e))})}};S.remap=(e,t,r)=>Object.keys(r).map(n=>{const i=(...e)=>t.emit(r[n],...e);return e.on(n,i),()=>e.off(n,i)});let O=S;class A extends O{constructor(e={}){super(),this._lastUpdateTime=0,this._cacheSpeeds=[],this._logger=T.createLogger("network-speed"),this._timeout=6e5,this._unit=1024,this._timeout=e.timeout||this._timeout}_calculateSpeed(e,t){const r=e/this._unit/t;r<=0||r===1/0?this._logger.debug(`invalid speed: ${r}`):(this._cacheSpeeds.push(r),this._cacheSpeeds.length>10&&this._cacheSpeeds.shift(),this.emit("downloaded",{byteSpeed:r,byteLength:e,duration:t,timescale:1}))}start(){this._lastUpdateTime=l()}download(e){const t=l(),r=(t-this._lastUpdateTime)/1e3;this._lastUpdateTime=t,r>this._timeout?this._logger.warn(`time diff: ${r}`):this._calculateSpeed(e,r)}getAverageSpeed(){return this._cacheSpeeds.reduce((e,t)=>e+t,0)/this._cacheSpeeds.length}getLatestSpeed(){return this._cacheSpeeds[this._cacheSpeeds.length-1]}reset(){this._cacheSpeeds=[],this._lastUpdateTime=0}}var $=r(67975),P=r(61978);const R="ttplayer-poster";class x{constructor(e){this.__timer=-1,this.__faded=!1,this.__src="",this.__objectFit="contain",this.visible=!1;const t=document.createElement("div");t.className=R,this.__el=t,this.src=e}get src(){return this.__src}set src(e){this.__src=e,this.__el.style.backgroundImage=`url(${e})`}set objectFit(e){const t="fill"===e?"100% 100%":e;this.__el.style.backgroundSize=t,this.__objectFit=e}get objectFit(){return this.__objectFit}updateStyle(e){Object.keys(e).forEach(t=>{"objectFit"===t?this.objectFit=e[t]:this.__el.style[t]=e[t]})}show(e){this.visible||(this.visible=!0,this.__el.className=P(R,"ttplayer-show"),null==e||e())}hide(e={},t){const r=!0===e.fade;if(this.visible){const n=P(R,r&&"ttplayer-fade");this.__timer>=0&&window.clearTimeout(this.__timer),e.delay?this.__timer=window.setTimeout(()=>{this.__timer=-1,this.visible=!1,this.__el.className=n,this.__faded=r,null==t||t()},e.delay):(this.visible=!1,this.__el.className=n,this.__faded=r,null==t||t())}else this.__faded&&!r&&(this.__faded=!1,this.__el.className=R)}attach(e){e.appendChild(this.__el)}detach(){var e;this.__faded=!1,window.clearTimeout(this.__timer),null==(e=this.__el.parentNode)||e.removeChild(this.__el)}}class L{static isEqual(e,t){return e===t||h.isObject(e)&&h.isObject(t)&&L.getCacheKey(e)===L.getCacheKey(t)}static isMultiple(e){return!h.isString(e)&&e&&e.urls&&e.urls.length>0}static isContainCacheKey(e,t){return h.isString(e)?e===t:!(null==e||!e.urls)&&(e.cacheKey||e.urls[0])===t}static getProps(e){return h.isString(e)?{}:null!=e&&e.urls?e:{}}static getUrl(e,t){return h.isString(e)?e:null!=e&&e.urls?e.urls[t]:""}static getCacheKey(e){return h.isString(e)?e:null!=e&&e.urls&&(e.cacheKey||e.urls[0])||""}}const I="ttplayer-videohide";var M=(e=>(e.CANPLAY="canplay",e.TIMEUPDATE="timeupdate",e))(M||{});class D extends O{constructor(e){super(),this.HideTrigger=M,this.__logger=T.createLogger("poster"),this.__updatedStyle={},this.__posters=[],this.__src="",this.__visible=!1,this.__autoPause=!1,this.__autoMute=!0,this.__hideOptions={fade:!0,delay:0,trigger:"canplay"},this.__selfCallPaused=!1,this.__handleSrcPreSetter=(e,t,r)=>{L.getProps(r).inherit||this.show()},this.__handleSeekPreSetter=()=>{this.__controller.removePreSetter("currentTime",this.__handleSeekPreSetter),this.hide()},this.__handlePausePreGetter=(e,t)=>()=>{t(),this.__selfCallPaused=!1,this.__controller.replaceGetter("pause",null)},this.__handleMutePreSetter=(e,t,r)=>{this.__reservedMuted=r},this.__handleLoadedData=()=>{const{trigger:e}=this.__tempHideOptions||this.__hideOptions;"timeupdate"===e?this.__controller.dedup("timeupdate",this.__handleTimeUpdateWithPoster):"canplay"===e&&this.__controller.dedup("canplay",this.__handleCanplay),this.__video.autoplay&&this.__togglePauseVideo(!1)},this.__handleCanplay=()=>{this.__controller.off("canplay",this.__handleCanplay),this.hide()},this.__handleTimeUpdateWithPoster=()=>{this.__controller.paused&&0===this.__controller.currentTime||(this.__controller.off("timeupdate",this.__handleTimeUpdateWithPoster),this.hide())};const{controller:t}=e;this.__controller=t,this.__video=t.getElement(),this.__container=document.createElement("div"),this.__styleContainer=document.createElement("style"),this.__styleContainer.innerHTML=".ttplayer-poster-enhance{position:static!important}.ttplayer-poster{position:absolute;top:0;left:0;width:100%;height:100%;background-position:center center;background-repeat:no-repeat;background-size:contain;pointer-events:none;z-index:1;opacity:0}.ttplayer-poster.ttplayer-fade{transition:opacity .3s ease-out 0s}.ttplayer-poster.ttplayer-hide{opacity:0}.ttplayer-poster.ttplayer-show{opacity:1}.ttplayer-videohide{visibility:hidden}",document.head.appendChild(this.__styleContainer),t.addPreSetter("src",this.__handleSrcPreSetter)}__togglePauseVideo(e){const{delay:t}=this.__hideOptions;if(!(this.__autoPause&&t>0))return;const r=this.__video;e?(r.paused||(r.pause(),this.__selfCallPaused=!0,this.__logger.info("since autoPause=true, the video is paused automatically")),this.__controller.replaceGetter("pause",this.__handlePausePreGetter)):r.paused&&this.__selfCallPaused&&(this.__controller.replaceGetter("pause",null),r.play(),this.__selfCallPaused=!1,this.__logger.info("resume playback automatically when the poster is hidden",r.paused))}__toggleMuteVideo(e){const{delay:t}=this.__hideOptions;if(!(this.__autoMute&&t>0))return;const r=this.__video;e?(void 0===this.__reservedMuted&&(this.__reservedMuted=r.muted),r.muted=!0,this.__controller.removePreSetter("muted",this.__handleMutePreSetter),this.__controller.addPreSetter("muted",this.__handleMutePreSetter),this.__logger.info("since autoMute=true, the video is muted automatically")):void 0!==this.__reservedMuted&&(this.__controller.removePreSetter("muted",this.__handleMutePreSetter),r.muted=this.__reservedMuted,this.__reservedMuted=void 0,this.__logger.info("restore the muted state of the video",r.muted))}__setVideoVisible(e){const t=this.__video;this.src&&(e?t.className=t.className.replace(new RegExp("\\s*?"+I,"g"),""):-1===t.className.indexOf(I)&&(t.className=P(t.className,I)))}__createPoster(e){const t=new x(e);return this.__updatedStyle&&t.updateStyle(this.__updatedStyle),t.attach(this.__container),t}__appendToCache(e){this.__posters.some(t=>t.src===e)||(this.__posters.length?this.__posters[0].src=e:this.__posters.push(this.__createPoster(e)))}__forceShow(e){this.__posters.forEach(t=>{t.src===this.__src?t.show(e):t.hide()});try{this.emit("show")}catch(e){console.error(e)}}set hideTrigger(e){this.__hideOptions.trigger=e}get hideTrigger(){return this.__hideOptions.trigger}set fade(e){this.__hideOptions.fade=e}get fade(){return this.__hideOptions.fade}set delay(e){this.__hideOptions.delay=e}get delay(){return this.__hideOptions.delay}set autoPause(e){this.__autoPause=e}set autoMute(e){this.__autoMute=e}get visible(){return this.__visible}set src(e){this.__src=e,this.__appendToCache(e),this.__visible&&this.__forceShow()}get src(){return this.__src}set objectFit(e){this.__updatedStyle.objectFit=e,this.__posters.forEach(t=>{t.objectFit=e})}get objectFit(){return this.__updatedStyle.objectFit}set cache(e){const t=new Set(e),r=[],n=this.__posters.filter(e=>t.has(e.src)?(t.delete(e.src),!0):!!e.visible||void r.push(e));this.__posters=n.concat(Array.from(t).map(e=>{const t=r.pop();return t?(t.src=e,t):this.__createPoster(e)})),r.forEach(e=>e.detach())}get cache(){return this.__posters.map(e=>e.src)}show(e){this.__tempHideOptions=void 0,this.__controller.removePreSetter("currentTime",this.__handleSeekPreSetter),this.__controller.addPreSetter("currentTime",this.__handleSeekPreSetter),this.__controller.off("loadeddata",this.__handleLoadedData),this.__controller.once("loadeddata",this.__handleLoadedData),this.__src&&!this.__visible&&(this.__visible=!0,this.__forceShow(e),this.__toggleMuteVideo(!0),this.__setVideoVisible(!1),this.__logger.info("poster showed, src:",this.__src))}hide(e){if(!this.__visible)return;this.__setVideoVisible(!0),this.__visible=!1,this.__togglePauseVideo(!0);const t=[];this.__posters.forEach(e=>{e.src===this.__src?t.push(e):e.hide()});const r=()=>{this.__toggleMuteVideo(!1),this.__togglePauseVideo(!1),null==e||e(),this.__logger.info("poster hided, src:",this.__src,this.__tempHideOptions);try{this.emit("hide")}catch(e){console.error(e)}};t.length?t.forEach(e=>{e.hide(this.__tempHideOptions||this.__hideOptions,r)}):r()}setTempHideOptions(e){this.__tempHideOptions=h.combineDefaultOptions(e,this.__hideOptions)}preventDefault(){this.__controller.removePreSetter("src",this.__handleSrcPreSetter)}attach(e){e.appendChild(this.__container)}destroy(){var e;document.head.removeChild(this.__styleContainer),this.__posters.forEach(e=>e.detach()),this.__controller.off("canplay",this.__handleCanplay),this.__controller.off("timeupdate",this.__handleTimeUpdateWithPoster),this.__controller.off("loadeddata",this.__handleLoadedData),this.__controller.replaceGetter("paused",null),this.__controller.removePreSetter("muted",this.__handleMutePreSetter),this.__controller.removePreSetter("src",this.__handleSrcPreSetter),this.__controller.removePreSetter("currentTime",this.__handleSeekPreSetter),null==(e=this.__container.parentNode)||e.removeChild(this.__container)}}var B=(e=>(e.POSTER="poster",e))(B||{}),N=(e=>(e[e.NETWORK=2100]="NETWORK",e[e.NETWORK_TIMEOUT=2101]="NETWORK_TIMEOUT",e[e.NETWORK_FORBIDDEN=2103]="NETWORK_FORBIDDEN",e[e.DEMUX_MP4=3300]="DEMUX_MP4",e[e.REMUX_FMP4=4100]="REMUX_FMP4",e[e.MEDIA_ABORTED=5101]="MEDIA_ABORTED",e[e.MEDIA_NETWORK=5102]="MEDIA_NETWORK",e[e.MEDIA_DECODE=5103]="MEDIA_DECODE",e[e.MEDIA_SRC_NOT_SUPPORTED=5104]="MEDIA_SRC_NOT_SUPPORTED",e[e.MEDIA_UNSUPPORT=5105]="MEDIA_UNSUPPORT",e[e.MEDIA_EMPTY_SRC=5106]="MEDIA_EMPTY_SRC",e[e.MEDIA_MSE_ADD_SB=5200]="MEDIA_MSE_ADD_SB",e[e.MEDIA_MSE_SB_APPEND=5201]="MEDIA_MSE_SB_APPEND",e[e.MEDIA_MSE_OTHER=5202]="MEDIA_MSE_OTHER",e[e.MEDIA_MSE_OVERFLOW=5203]="MEDIA_MSE_OVERFLOW",e[e.MEDIA_MSE_HIJACKED=5204]="MEDIA_MSE_HIJACKED",e[e.MEDIA_MSE_SB_CHANGE_TYPE=5205]="MEDIA_MSE_SB_CHANGE_TYPE",e[e.MEDIA_MSE_SB_REMOVE=5206]="MEDIA_MSE_SB_REMOVE",e[e.OTHER=8e3]="OTHER",e[e.OTHER_PARAMS=8100]="OTHER_PARAMS",e[e.RUNTIME_NO_CANPLAY=9001]="RUNTIME_NO_CANPLAY",e[e.RUNTIME_BUFFER_BREAK=9002]="RUNTIME_BUFFER_BREAK",e[e.RUNTIME_WAITING_TIMEOUT=9003]="RUNTIME_WAITING_TIMEOUT",e))(N||{});const j=class e extends Error{constructor(e,t,r){super(t),this.name="PlayerError",this.code=e,this.category=N[e],this.message=t||this.category,this.extra=r}static fromMediaError(t,r){switch(t.code){case 1:return new e(5101,t.message,r);case 2:return new e(5102,t.message,r);case 3:return new e(5103,t.message,r);case 4:return new e(5104,t.message,r);default:return new e(8e3,t.message,r)}}};j.Code=N;let U=j;const V=["playnext","exception"],F=["canplay","canplaythrough","durationchange","emptied","ended","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","stalled","suspend","seeked","seeking","resize","timeupdate","volumechange","waiting"];class H extends O{constructor(e){super(),this._logger=T.createLogger("controller"),this.__replacedGetterMap=new Map,this.__replacedSetterMap=new Map,this.__preSetterMap=new Map,this.__videoOffCallbackMap=new Map,this.__remapOffCallbacks=[],this.__videoEventProxyMap=new Map,this.__currUrlIndex=0,this.willEmitEventNameSet=new Set,this.__handleSrcPreSetter=(e,t,r)=>{L.isMultiple(r)?(this.__urls=r.urls,this.__currUrlIndex=0):this.__urls=void 0},this.processError=()=>{const e={url:this.__core.currentSrc},t=this.__core.error?U.fromMediaError(this.__core.error,e):new U(U.Code.OTHER,"The error event was triggered, but video.error is null",e);if(this.__urls)if(this.__currUrlIndex++,this.__currUrlIndex<this.__urls.length){this.emit("exception",t);const e=this.__core.currentTime;this.__core.src=this.__urls[this.__currUrlIndex],this.__core.load(),this.__core.currentTime=e,this.__core.play()}else this.emit("error",t);else this.emit("error",t)},this.play=async()=>new Promise(e=>{this.__core.play().then(()=>{e(null)}).catch(t=>{this._logger.warn(t),e(t)})}),this.pause=()=>this.__core.pause(),this.reset=()=>{this.__core.removeAttribute("src"),this.__core.load()};const t=$(e,{objectFit:"contain"}),{objectFit:r,attributes:n,...i}=t,o=document.createElement("video");return o instanceof HTMLVideoElement&&(n&&Object.keys(n).forEach(e=>{o.setAttribute(e,n[e])}),o.setAttribute("data-version","0.3.16"),o.style.width="100%",o.style.height="100%",o.style.verticalAlign="middle"),this.coreName="video-element",this.coreVersion="",this.__core=o,this.__bindEvents(),Object.assign(this,i),e.container.appendChild(o),this.__posterManager=new D({controller:this}),this.__posterManager.attach(t.container),this.addPreSetter("src",this.__handleSrcPreSetter),new Proxy(this,{set:(e,t,r)=>{if(0===t.indexOf("_"))return e[t]=r,!0;const n=this.__preSetterMap.get(t);if(n&&n.some(n=>!1===n(e,e[t],r)))return!0;const i=this.__replacedSetterMap.get(t);return i?i(e,e[t],r):e[t]!==r&&(e[t]=r,this.emit("update",t,e[t],r)),!0},get:(e,t)=>{if(0===t.indexOf("_"))return e[t];const r=this.__replacedGetterMap.get(t);return r?r(e,e[t]):e[t]}})}__bindVideoEvent(e,t){this.__videoOffCallbackMap.has(e)||(this.__core.addEventListener(e,t,!1),this.__videoOffCallbackMap.set(e,()=>{this.__core.removeEventListener(e,t,!1)}))}__bindEvents(){F.forEach(e=>{this.__bindVideoEvent(e,()=>this.emit(e)),this.willEmitEventNameSet.add(e)}),V.forEach(e=>{this.willEmitEventNameSet.add(e)}),[{onName:"error",emitName:"error",callback:this.processError}].forEach(e=>{this.__videoEventProxyMap.set(e.onName,e),this.__bindVideoEvent(e.onName,e.callback),this.willEmitEventNameSet.add(e.emitName)}),O.remap(this,this,{loadedmetadata:"update",play:"update",pause:"update",volumechange:"update",ratechange:"update"}).forEach(e=>{this.__remapOffCallbacks.push(e)})}getInternalModule(e){if(e===B.POSTER)return this.__posterManager;throw new U(U.Code.OTHER_PARAMS,`Module [${e}] not found, please use InternalModuleName as parameter`)}getElement(){return this.__core}getCore(){return this.__core}addPreSetter(e,t){const r=this.__preSetterMap.get(e);r?r.push(t):this.__preSetterMap.set(e,[t])}removePreSetter(e,t){const r=this.__preSetterMap.get(e);r&&r.length&&this.__preSetterMap.set(e,r.filter(e=>e!==t))}replaceSetter(e,t){t?this.__replacedSetterMap.set(e,t):this.__replacedSetterMap.delete(e)}replaceGetter(e,t){t?this.__replacedGetterMap.set(e,t):this.__replacedGetterMap.delete(e)}disableEvents(e){e.forEach(e=>{const t=this.__videoOffCallbackMap.get(e);t&&(t(),this.__videoOffCallbackMap.delete(e))})}enableEvents(e){e.forEach(e=>{const t=this.__videoEventProxyMap.get(e);t?this.__bindVideoEvent(e,t.callback):this.__bindVideoEvent(e,()=>this.emit(e))})}_switchUrl(e,t){let r=0,n=!1;t?(r=this.__core.currentTime,n=this.__core.paused):this.emit("playnext"),this.__core.src=e,t&&(this.__core.currentTime=r,n?this.__core.pause():this.__core.play())}get videoWidth(){return this.__core.videoWidth}get videoHeight(){return this.__core.videoHeight}get objectFit(){return this.__core.style.objectFit}set objectFit(e){this.__core.style.objectFit=e}get error(){return this.__core.error}get buffered(){return this.__core.buffered}get duration(){return this.__core.duration}get paused(){return this.__core.paused}get ended(){return this.__core.ended}get rawSrc(){return this.currentSrc}get currentSrc(){return this.__core.currentSrc}set src(e){if("string"==typeof e)this._switchUrl(e,!1);else if(L.isMultiple(e)){const t=e.urls[this.__currUrlIndex];this._switchUrl(t,!!e.inherit)}else this.emit("error",new U(U.Code.MEDIA_EMPTY_SRC,"src is invalid"))}get src(){return this.__core.src||""}set sources(e){this.__urls=e,this.__currUrlIndex=0}get sources(){return this.__urls}set sourceIndex(e){this.__currUrlIndex=e}get sourceIndex(){return this.__currUrlIndex}set poster(e){this.__posterManager.src=e}get poster(){return this.__posterManager.src}set autoplay(e){this.__core.autoplay=e}get autoplay(){return this.__core.autoplay}set crossOrigin(e){this.__core.crossOrigin=e}get crossOrigin(){return this.__core.crossOrigin}set currentTime(e){this.__core.currentTime=e}get currentTime(){return this.__core.currentTime}set volume(e){this.__core.volume=e}get volume(){return this.__core.volume}set muted(e){this.__core.muted=e}get muted(){return this.__core.muted}set playbackRate(e){this.__core.playbackRate=e}get playbackRate(){return this.__core.playbackRate}set loop(e){this.__core.loop=e}get loop(){return this.__core.loop}set lang(e){this.__core.lang=e}get lang(){return this.__core.lang}set preload(e){this.__core.preload=e}get preload(){return this.__core.preload}get readyState(){return this.__core.readyState}get networkState(){return this.__core.networkState}destroy(){var e;this.__remapOffCallbacks.forEach(e=>e()),this.__remapOffCallbacks=[],this.__videoOffCallbackMap.forEach(e=>e()),this.__videoOffCallbackMap.clear(),this.__videoEventProxyMap.clear(),this.removeAllListeners(),this.__posterManager.destroy(),this.__preSetterMap.clear(),this.__replacedSetterMap.clear(),this.__replacedGetterMap.clear(),this.reset(),null==(e=this.__core.parentNode)||e.removeChild(this.__core)}}class G{constructor(e){var t;this.__logger=T.createLogger("plugin-manager"),this.__map=new Map,this.__context={...e.context,pluginManager:this},null==(t=e.plugins)||t.forEach(e=>{e&&this.register(e)})}get(e){return this.__map.get(e)}register(e){this.__map.has(e.name)?this.__logger.warn(`[${e.name}] already exists`):(e.install(this.__context),this.__map.set(e.name,e),this.__logger.info(`[${e.name}] has been registered`))}unregister(e){const t="string"==typeof e?e:e.name,r=this.__map.get(t);r&&(this.__map.delete(t),r.uninstall(this.__context),this.__logger.info(`[${r.name}] has been unregistered`))}reset(){var e;const t=this.__map.values();for(const r of t)null==(e=r.reset)||e.call(r)}destroy(){this.__map.forEach(e=>{e.uninstall(this.__context),this.__logger.info(`[${e.name}] has been uninstalled`)}),this.__map.clear()}}const W=typeof window<"u"&&window.document,q=T.createLogger("ttplayer"),K=!!W&&"true"===localStorage.getItem("ttplayer_record_event"),z=class extends O{constructor(e){super(),this.getInternalModule=e=>this.__controller.getInternalModule(e);const t=[];if(e.plugins)for(const r of e.plugins)r&&r.name&&r.install&&t.push(r);const{src:r,...n}=e;this.__controller=new H(Object.assign(n)),this.__controller.willEmitEventNameSet.forEach(e=>{this.__controller.on(e,(...t)=>{this.emit(e,...t)})}),K&&this._enableDebugLog(),this.__pluginManager=new G({context:{container:e.container,controller:this.__controller},plugins:t}),r&&(this.__controller.src=r)}_enableDebugLog(){const e=["timeupdate","progress","durationchange"];let t="",r=0;this.__controller.willEmitEventNameSet.forEach(n=>{this.__controller.on(n,()=>{t!==n&&(e.includes(n)?r++:r=0,r<e.length+1&&q.log("event emitted -",n)),t=n})})}getElement(){return this.__controller.getElement()}getPlugin(e){return this.__pluginManager.get(e)}get coreName(){return this.__controller.coreName}get coreVersion(){return this.__controller.coreVersion}get error(){return this.__controller.error}get buffered(){return this.__controller.buffered}get duration(){return this.__controller.duration}get paused(){return this.__controller.paused}get ended(){return this.__controller.ended}get rawSrc(){return this.__controller.rawSrc}get currentSrc(){return this.__controller.currentSrc}set src(e){this.__controller.src=e}get src(){return this.__controller.src}set poster(e){this.__controller.poster=e}get poster(){return this.__controller.poster}set autoplay(e){this.__controller.autoplay=e}get autoplay(){return this.__controller.autoplay}set crossOrigin(e){this.__controller.crossOrigin=e}get crossOrigin(){return this.__controller.crossOrigin}set currentTime(e){this.__controller.currentTime=e}get currentTime(){return this.__controller.currentTime}set volume(e){this.__controller.volume=e}get volume(){return this.__controller.volume}set muted(e){this.__controller.muted=e}get muted(){return this.__controller.muted}set playbackRate(e){this.__controller.playbackRate=e}get playbackRate(){return this.__controller.playbackRate}set objectFit(e){this.__controller.objectFit=e}get objectFit(){return this.__controller.objectFit}get videoWidth(){return this.__controller.videoWidth}get videoHeight(){return this.__controller.videoHeight}set loop(e){this.__controller.loop=e}get loop(){return this.__controller.loop}set lang(e){this.__controller.lang=e}get lang(){return this.__controller.lang}play(){return this.__controller.play()}pause(){this.__controller.pause()}set preload(e){this.__controller.preload=e}reset(){this.__controller.reset(),this.__pluginManager.reset()}get readyState(){return this.__controller.readyState}get networkState(){return this.__controller.networkState}destroy(){this.removeAllListeners(),this.__pluginManager.destroy(),this.__controller.destroy()}};z.InternalModuleName=B;let Z=z;const Y=T.createLogger("cache"),X=new class{constructor(){this._config={maxCount:5},this.map=new Map}_checkSizeAndShift(){if(this.map.size>this._config.maxCount){const e=this.map.keys().next().value;e&&this.map.delete(e)}}setConfig(e){Object.assign(this._config,e)}extract(e){const t=this.map.get(e);return this.map.delete(e),t}getCacheKeys(){return Array.from(this.map.keys())}get(e){return this.map.get(e)}has(e){return this.map.has(e)}add(e,t){const{segment:r}=t,n=this.map.get(e);if(n){const e=n[n.length-1];e&&e.segment.pos+e.segment.data.byteLength!==r.pos?Y.warn("discontiguous data segment: expected",e.segment.pos+e.segment.data.byteLength,", got",r.pos):n.push(t)}else e&&(0===r.pos?(this.map.set(e,[t]),this._checkSizeAndShift()):Y.warn("invalid first data segment pos: expected 0, got",r.pos))}remove(e){this.map.delete(e)}clearAll(){this.map.clear()}};p()&&"1"===localStorage.getItem("ttplayer_cache_debug")&&(window.__TTPlayerGlobalCache__=X);var Q=(e=>(e[e.IDLE=0]="IDLE",e[e.LOADING=1]="LOADING",e[e.LOAD_END=2]="LOAD_END",e[e.SUSPENDED=3]="SUSPENDED",e[e.ERROR=4]="ERROR",e))(Q||{}),J=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.PRELOAD=1]="PRELOAD",e))(J||{});class ee extends O{constructor(e={}){super(),this._status=0,this._timer=-1,this.$src="",this.$srcIndex=0,this.network=new A,this.pos=0,this.loadedCacheSize=0,this.store=e=>{const t=L.getCacheKey(this.$src);e.extra=L.getProps(this.$src).extra||{url:this.currentUrl},X.add(t,e)},this.$options=h.combineDefaultOptions(e,{origin:0,timeout:6e4,recovery:!0}),this.total=e.total||1/0}get currentSrcIndex(){return this.$srcIndex}get currentUrl(){return L.getUrl(this.$src,this.$srcIndex)}$processErrorAndFallback(e,t){if("AbortError"!==e.name){if(this.abort(),!1!==this.$options.recovery&&L.isMultiple(this.$src)&&this.$srcIndex<this.$src.urls.length-1)return this.$srcIndex++,this.emit("exception",e),this.loadRange(this.pos,t.end);this.$changeStatus(4),this.$logger.error(e),this.emit("error",e)}}$loadInitSegmentCache(){this.$changeStatus(1);let e=!0;if(0===this.pos){const t=L.getCacheKey(this.$src),r=X.extract(t);if(r)for(let t=0;t<r.length;t++){const n=r[t].segment;if(this.loadedCacheSize+=n.data.byteLength,this.pos=n.pos+n.data.byteLength,this.emit("loadeddata",n),e=1===this.status,!e)break}}return{loading:e,loadedCacheSize:this.loadedCacheSize}}$waitForNextTick(e=0){return new Promise(t=>{this._timer=window.setTimeout(t,e)})}$changeStatus(e){this._status=e}async $getFinalRequestParams(e,t){const{onBeforeRequest:r}=this.$options;if(r){const n=await r(this.currentUrl,t);n&&(e=n.url||e,t=n.params||t)}return{requestURL:e,requestParams:t}}changeName(e){this.$logger.setName(e)}changeOptions(e){e&&(this.$options=h.combineDefaultOptions(e,this.$options))}getOptions(){return this.$options}get status(){return this._status}jump(e){this.pos=e}load(e,t,r){return this.reset(),this.$src=e,this.loadRange(t,r)}reset(){this.abort(),window.clearTimeout(this._timer),this.pos=0,this.total=1/0,this.$src="",this.$srcIndex=0,this.network.reset(),this.loadedCacheSize=0}destroy(){this.network.removeAllListeners(),this.removeAllListeners(),this.reset()}}class te extends ee{constructor(){super(...arguments),this.$logger=T.createLogger("fetch-loader"),this.__timer=-1,this.__handleTimeout=e=>{this.abort(),this.$processErrorAndFallback(new U(U.Code.NETWORK_TIMEOUT,"Request timed out, please try again"),e)},this.__read=async e=>{for(this.__reader=e;;){const t=await e.read();if(!this.__reader)return;if(t.done)return this.__reader=void 0,this.__abortController=void 0,this.$changeStatus(Q.LOAD_END),void this.emit("loadend");{const e=this.pos;this.pos+=t.value.byteLength,this.network.download(t.value.byteLength),this.emit("loadeddata",{origin:this.$options.origin,pos:e,data:t.value})}}}}static isSupported(){return typeof AbortController<"u"&&typeof ReadableStream<"u"}__cancel(){clearTimeout(this.__timer),this.__reader&&(this.__reader.cancel(),this.__reader=void 0),this.__abortController&&(this.__abortController.signal.aborted||this.__abortController.abort(),this.__abortController=void 0)}async loadRange(e=0,t=1/0){if(this.status===Q.LOADING)return;if(e>this.total)return void this.$logger.warn(`loadRange, start > total, start=${e} total=${this.total}`);if(e===this.total)return;const r={start:e,end:t},{timeout:n,credentials:o}=this.$options,s=this.$loadInitSegmentCache();if(!s.loading)return;s.loadedCacheSize>0&&(e=this.pos);const a={},l=e>0||t<1/0;if(l){const r=this.total-1,n=Math.min(r,t);a.Range=`bytes=${e}-${n===r?"":n}`}const{requestURL:c,requestParams:u}=await this.$getFinalRequestParams(this.currentUrl,{method:"GET",headers:a,credentials:o});return this.$logger.info(`before load, status=${Q[this.status]}, range=${a.Range||""}, credentials=${o}, cacheKey:${L.getCacheKey(this.$src)}, filename=${i.getFilename(c)}, url=${c}`),this.emit("loadstart"),this.status===Q.LOADING?(this.__abortController=new AbortController,u.signal=this.__abortController.signal,this.network.start(),void 0!==n&&(this.__timer=window.setTimeout(()=>this.__handleTimeout(r),n)),fetch(c,u).then(t=>{var r,n;window.clearTimeout(this.__timer);const i={url:c,headers:t.headers};if(403===t.status)throw new U(U.Code.NETWORK_FORBIDDEN,t.statusText,i);if(!l||416!==t.status&&200!==t.status||this.total!==1/0){if(t.status>=200&&t.status<300){if(this.pos=e,this.total=l?Number(null==(n=null==(r=t.headers.get("Content-Range"))?void 0:r.split("/"))?void 0:n[1])||this.total:Number(t.headers.get("Content-Length"))||this.total,t.body)return this.__read(t.body.getReader());throw new U(U.Code.NETWORK,"media stream data does not exist",i)}throw new U(U.Code.NETWORK,t.statusText,i)}this.$logger.warn(`loadRange, ${t.status}, pos=${this.pos}`),this.total=this.pos,this.emit("loadeddata",{origin:this.$options.origin,pos:this.pos,data:new Uint8Array})}).catch(e=>{window.clearTimeout(this.__timer);const t=e.code?e:new U(U.Code.NETWORK,e.message,{url:c});this.$processErrorAndFallback(t,r)})):void 0}resume(){return this.status===Q.SUSPENDED||this.status===Q.LOAD_END?this.loadRange(this.pos):Promise.resolve()}suspend(){this.status===Q.LOADING&&(this.$logger.info(`suspend, cacheKey=${L.getCacheKey(this.$src)}, url=${this.currentUrl}`),this.__cancel(),this.$changeStatus(Q.SUSPENDED))}abort(){this.status!==Q.IDLE&&(this.$logger.info(`abort, cacheKey=${L.getCacheKey(this.$src)}, url=${this.currentUrl}`),this.__cancel(),this.$changeStatus(Q.IDLE))}}const re=512e3;class ne extends ee{constructor(){super(...arguments),this.$logger=T.createLogger("xhr-loader"),this.__requestSeg=async(e,t)=>{const{credentials:r,timeout:n}=this.$options,i=e>0||t<1/0,o={};if(i){const r=this.total-1,n=Math.min(r,t);o.Range=`bytes=${e}-${n===r?"":n}`}const{requestURL:s,requestParams:a}=await this.$getFinalRequestParams(this.currentUrl,{credentials:r,headers:o});return new Promise((e,t)=>{if(this.status!==Q.LOADING)return;const r=this.__xhr=new XMLHttpRequest;r.open("GET",s,!0),r.withCredentials="include"===a.credentials,r.responseType="arraybuffer",r.onreadystatechange=()=>{r.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(r.status>=200&&r.status<300?this.total===1/0&&(i||(this.total=Number(r.getResponseHeader("Content-Length"))||this.total)):403===r.status?t(new U(U.Code.NETWORK_FORBIDDEN,r.statusText)):t(new U(U.Code.NETWORK,r.statusText)))},r.onload=()=>{e(new Uint8Array(r.response))},r.onerror=()=>{t(new U(U.Code.NETWORK,r.statusText))},r.ontimeout=()=>{t(new U(U.Code.NETWORK_TIMEOUT,"Request timed out, please try again"))},r.onabort=()=>{const e=new Error("Request aborted");e.name="AbortError",t(e)},r.timeout=n||0,this.network.start(),r.send()})},this.__read=async(e,t)=>{let r=e;for(;;){if(r>=t)return;const e=await this.__requestSeg(r,Math.min(t,r+re-1));if(!this.__xhr)return;if(this.network.download(e.byteLength),r+=e.byteLength,this.total===1/0&&e.byteLength<re&&(this.total=r),this.pos=r,this.emit("loadeddata",{origin:this.$options.origin,pos:r-e.byteLength,data:e}),r>=this.total||r>=t||0===e.byteLength)return this.$changeStatus(Q.LOAD_END),void this.emit("loadend");if(await this.$waitForNextTick(10),!this.__xhr)return}}}__cancel(){this.__xhr&&(window.clearTimeout(this.__timer),this.__timer=void 0,this.__xhr.abort(),this.__xhr=void 0)}async loadRange(e=0,t=1/0){if(this.status===Q.LOADING)return;if(e>this.total)return void this.$logger.warn(`loadRange, start > total, start=${e} total=${this.total}`);if(e===this.total)return;const r=this.$loadInitSegmentCache();return r.loading?(r.loadedCacheSize>0&&(e=this.pos),this.emit("loadstart"),this.$logger.info(`before load, start=${e} end=${t} url=${this.currentUrl}`),this.__read(e,t).catch(r=>this.$processErrorAndFallback(r,{start:e,end:t}))):void 0}resume(){return this.status===Q.SUSPENDED||this.status===Q.LOAD_END?this.loadRange(this.pos):Promise.resolve()}suspend(){this.status===Q.LOADING&&(this.$logger.info(`suspend, url=${this.currentUrl}`),this.__cancel(),this.$changeStatus(Q.SUSPENDED))}abort(){this.status!==Q.IDLE&&(this.$logger.info(`abort, url=${this.currentUrl}`),this.__cancel(),this.$changeStatus(Q.IDLE))}}const ie=te.isSupported()?te:ne;let oe=ie;const se=e=>{oe=e||ie},ae=T.createLogger("mutex"),le=[],ce=p()&&"1"===localStorage.getItem("ttplayer_mutex_debug");ce&&(window.__TTPlayerMutexList__=le);class ue{constructor(e){this._resolves=[],this._rejects=[],this.name=e,ce&&le.push(this)}get locked(){return this._resolves.length>0}lock(){return new Promise((e,t)=>{this._resolves.push(e),this._rejects.push(t)})}unlock(e){this._resolves.length&&(this._rejects.shift(),this._resolves.shift()(e))}unlockAll(e){for(;this._resolves.length;)this._rejects.shift(),this._resolves.shift()(e)}throw(e){this._rejects.length&&(this._resolves.shift(),this._rejects.shift()(e))}releaseLock(){this._resolves.length&&ae.log(`releaseLock, name=${this.name}`),this._resolves=[],this._rejects=[]}}var de=(e=>(e[e.EMPTY=0]="EMPTY",e[e.LOW=1]="LOW",e[e.NORMAL=2]="NORMAL",e[e.HIGH=3]="HIGH",e[e.FULL=4]="FULL",e))(de||{});class he extends O{constructor(e,t){super(),this._queue=[],this._changeLevel=e=>{if(this.level!==e){const t=this.level;this.level=e,this.emit("levelchange",e,t)}},this._estimatedMaxSize=t,this.level=0,this._algorithm=this._defaultLevelAlgorithm,this._readMutex=new ue(e+".queue.read"),this._writeMutex=new ue(e+".queue.write")}_defaultLevelAlgorithm(e,t){const r=this._queue.length;return t?r>=this._estimatedMaxSize?4:r>=.7*this._estimatedMaxSize?3:r>=.3*this._estimatedMaxSize?2:r>0?1:0:0===r?0:r<=.3*this._estimatedMaxSize?1:r<=.7*this._estimatedMaxSize?2:r<this._estimatedMaxSize?3:4}_calculateLevel(e,t){this._changeLevel(this._algorithm(e,t))}setMaxSize(e){this._estimatedMaxSize=e}setLevelAlgorithm(e){this._algorithm=e||this._defaultLevelAlgorithm}get size(){return this._queue.length}write(e){if(this._readMutex.locked)this._readMutex.unlock(e);else if(this._queue.push(e),this._calculateLevel(e,!0),4===this.level)return this._writeMutex.lock()}first(){return this._queue[0]}getAll(){return this._queue}read(){this._writeMutex.unlock();const e=this._queue.shift();return e&&this._calculateLevel(e,!1),e||this._readMutex.lock()}clear(){this._queue=[],this._changeLevel(0),this._writeMutex.unlock()}releaseRead(){this._readMutex.releaseLock()}releaseWrite(){this._writeMutex.releaseLock()}releaseLock(){this._writeMutex.releaseLock(),this._readMutex.releaseLock()}reset(){this.clear(),this.releaseLock()}}let pe=0;const fe=T.createLogger("coroutine"),_e=p()&&window.queueMicrotask?window.queueMicrotask.bind(window):e=>Promise.resolve().then(e);class ye{static microTask(e){return _e(e)}static create(e){const{type:t="macro",title:r,onLoop:n,onError:i}=e;let o=!0,s=-1;const a=pe++,l=`(${a}) ${r}`,c={title:r,id:a,get running(){return o},cancel(){fe.log(l,s,"canceled"),o=!1,window.clearTimeout(s)}},u=e=>{c.cancel(),fe.error(l,s,"onLoop error",e),i(e instanceof U?e:new U(U.Code.OTHER,e.message))};return"macro"===t?(fe.log(l,"created with macro task"),function e(){o&&(s=window.setTimeout(()=>n(c).then(e).catch(u),0))}()):(fe.log(l,"created with micro task"),function e(){o&&_e(()=>n(c).then(e).catch(u))}()),c}}class ge extends O{constructor(e){super(),this._pipeTargets=[],this.name=e}changeName(e){this.name=e}_unsetPipeCoroutine(){var e;null==(e=this._pipeCoroutine)||e.cancel(),this._pipeCoroutine=void 0}pipe(e,t){return this._pipeTargets.push(e),this._pipeCoroutine||(this._pipeCoroutine=ye.create({title:this.name+" --pipe--\x3e "+this._pipeTargets.map(e=>e.name).join("/"),onLoop:async()=>{const e=await this.read();for(const r of this._pipeTargets)await r.write(t?t(e):e)},onError:e=>this.emit("error",e)})),e}unpipe(e){return this._pipeTargets=this._pipeTargets.filter(t=>t!==e),0===this._pipeTargets.length&&this._unsetPipeCoroutine(),e}destroy(){this.removeAllListeners(),this._pipeTargets=[],this._unsetPipeCoroutine()}}let me=class extends ge{constructor(e){super(e),this.size=1,this.stdout=new he(this.name,this.size)}read(){return this.stdout.read()}flush(){this.stdout.clear()}destroy(){super.destroy(),this.stdout.removeAllListeners(),this.stdout.reset(),this.flush()}};class ve extends O{constructor(e){super(),this.size=1,this.name=e,this.stdin=new he(this.name,this.size)}write(e){return this.stdin.write(e)}flush(){this.stdin.clear()}destroy(){this.removeAllListeners(),this.stdin.removeAllListeners(),this.stdin.reset(),this.flush()}}class be extends ge{constructor(e){super(e),this.size=1,this.stdin=new he(this.name,this.size),this.stdout=new he(this.name,this.size)}_unsetCoroutine(){var e;null==(e=this._coroutine)||e.cancel(),this._coroutine=void 0}write(e){return this.stdin.write(e)}read(){return this.stdout.read()}suspend(){this.stdin.releaseRead(),this.stdout.releaseWrite(),this._unsetCoroutine()}resume(){this._unsetCoroutine(),this._coroutine=ye.create({title:this.name+".transform",onLoop:async()=>{const e=await this.stdin.read(),t=await this.$transform(e);t&&await this.stdout.write(t)},onError:e=>this.emit("error",e)})}flush(){this.stdin.clear(),this.stdout.clear()}destroy(){super.destroy(),this.stdin.removeAllListeners(),this.stdout.removeAllListeners(),this.stdin.reset(),this.stdout.reset(),this._unsetCoroutine(),this.flush()}}var we=(e=>(e.LoadedMetadata="loadedmetadata",e.LoadedPackets="loadedpacket",e))(we||{});class Ce{constructor(e,t,r){this.dv=new DataView(e),this.start=this.offset=t||this.dv.byteOffset,this.end=r?this.start+r:this.dv.byteLength}static fromUint8(e){return new Ce(e.buffer,e.byteOffset,e.byteLength)}static concatUint8s(e){const t=new Uint8Array(e.reduce((e,t)=>e+t.byteLength,0));let r=0;return e.forEach(e=>{t.set(e,r),r+=e.byteLength}),t}static concatUint8(...e){return this.concatUint8s(e)}get buffer(){return this.dv.buffer}get unreadLength(){return Math.max(this.end-this.offset,0)}get size(){return this.end-this.start}readFloat(e){let t=0;switch(e){case 4:t=this.dv.getFloat32(this.offset);break;case 8:t=this.dv.getFloat64(this.offset);break;default:throw new Error(`read ${e}-byte float is not supported`)}return this.offset+=e,t}back(e){this.offset-=e}skip(e){this.offset+=e}readInt(e){const t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getInt8(t);case 2:return this.dv.getInt16(t);case 4:return this.dv.getInt32(t);default:throw new Error(`read ${e}-byte integers is not supported`)}}read(e){const t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getUint8(t);case 2:return this.dv.getUint16(t);case 3:return(this.dv.getUint16(t)<<8)+this.dv.getUint8(t+2);case 4:return this.dv.getUint32(t);default:return this.back(e-4),this.read(e-4)+this.dv.getUint32(t)*Math.pow(256,e-4)}}write(e,t){const r=this.offset;switch(this.offset+=e,e){case 1:return this.dv.setUint8(r,t);case 2:return this.dv.setUint16(r,t);case 3:return this.dv.setUint8(r,t>>>16),this.dv.setUint16(r+1,65535&t);case 4:return this.dv.setUint32(r,t);default:throw new Error(`write ${e}-byte integers is not supported`)}}writeString(e){const t=e.length;for(let r=0;r<t;r++)this.dv.setUint8(this.offset+r,e.charCodeAt(r));this.offset+=t}readToBuffer(e){let t;return t=this.offset||e?this.dv.buffer.slice(this.offset,e?this.offset+e:this.end):this.dv.buffer,this.offset+=t.byteLength,t}readToUint8(e){const t=new Uint8Array(this.dv.buffer,this.offset,e||this.unreadLength);return this.offset+=t.byteLength,t}readString(e){let t=0,r="";for(;t<e;t++)r+=String.fromCharCode(this.dv.getUint8(this.offset)),this.offset++;return r}}class Ee extends me{constructor(e){super(e.name),this._parsers=[],this._reservedSeekTime=0,this._reservedSegs=[],this._handleError=e=>{this.emit("error",e)},this._handleFirstLoadData=e=>{var t;if(this._reservedSegs.push(e),this._reservedSegs.reduce((e,t)=>e+t.data.byteLength,0)<this._parsers.reduce((e,t)=>Math.max(e,t.maxProbeSize),0))return;this._loader.off("loadeddata",this._handleFirstLoadData);const r=1===this._reservedSegs.length?this._reservedSegs[0]:{...this._reservedSegs[0],data:Ce.concatUint8s(this._reservedSegs.map(e=>e.data))};this._reservedSegs=[];const n=this._parsers.find(e=>e.probe(r.data));if(n)this._activeParser?this._activeParser.constructor===n.constructor||(this._logger.info(`parserchange, ${(null==(t=this._activeParser)?void 0:t.name)||"N/A"} -> ${n.name}`),this._unbindParserEvents(this._activeParser),this._bindParserEvents(n)):this._bindParserEvents(n),this._activeParser=n,this._activeParser.setLoader(this._loader),this._activeParser.parse(r),this._reservedSeekTime>0&&(this._activeParser.seek(this._reservedSeekTime),this._reservedSeekTime=0);else{const e="no parser can probe the data";this._logger.error(e),this.emit("error",new U(U.Code.DEMUX_MP4,e))}},this._handleParserLoadedMetadata=e=>{this._logger.info("metadata loaded",e),this.stdout.write({done:!1,value:{type:we.LoadedMetadata,payload:e}})},this._handleParserLoadedPacket=({data:e})=>{this.stdout.write({done:!1,value:{type:we.LoadedPackets,payload:e}})},this._handleParserEos=()=>{this.stdout.write({done:!0})},this._handleParserCacheDone=()=>{this.emit("cachedone")},this._logger=T.createLogger(e.name),this._loader=new oe(e.loaderOptions),this._loader.changeName(e.name),this._parsers=e.parsers,this._resetLoaderEventListeners()}_resetLoaderEventListeners(){this._loader.removeAllListeners(),this._loader.on("error",this._handleError),this._loader.on("loadeddata",this._handleFirstLoadData)}_bindParserEvents(e){e.on("cachedone",this._handleParserCacheDone),e.on("eos",this._handleParserEos),e.on("loadedpackets",this._handleParserLoadedPacket),e.on("loadedmetadata",this._handleParserLoadedMetadata)}_unbindParserEvents(e){e.off("cachedone",this._handleParserCacheDone),e.off("eos",this._handleParserEos),e.off("loadedpackets",this._handleParserLoadedPacket),e.off("loadedmetadata",this._handleParserLoadedMetadata)}changeName(e){super.changeName(e),this._loader.changeName(e),this._logger.setName(e)}changeOptions(e){this._parsers=e.parsers||this._parsers,this._loader.changeOptions(e.loaderOptions)}getLoader(){return this._loader}getCacheStats(){var e;return null==(e=this._activeParser)?void 0:e.getCacheStats()}load(e){this._reservedSegs=[],this._reservedSeekTime=0,this._activeParser&&this._activeParser.reset(),this._resetLoaderEventListeners(),this.emit("beforeload"),this._loader.load(e)}seek(e){this._activeParser?this._activeParser.seek(e):this._reservedSeekTime=e}suspend(){this._loader.suspend()}resume(){this._loader.resume()}abort(){this._loader.abort()}reset(){super.flush(),this._reservedSegs=[],this._reservedSeekTime=0,this._loader.reset()}destroy(){super.destroy(),this.reset(),this._parsers.forEach(e=>e.destroy()),this._loader.destroy()}}var ke=(e=>(e.FLV="FLV",e.MP4="MP4",e.HLS="HLS",e.DASH="DASH",e))(ke||{}),Te=(e=>(e.VIDEO="video",e.AUDIO="audio",e.UNKNOWN="unknown",e))(Te||{});class Se{constructor(e,t){this.offset=0,this.val=e,this.size=t}static fromByte(e,t){return new Se(e.read(t),t<<3)}toUint8(){const e=this.size/8,t=new Uint8Array(e),r=this.offset;this.offset=0;for(let r=0;r<e;r++)t[r]=this.read(8);return this.offset=r,t}skip(e){this.offset+=e}read(e){const t=this.size-this.offset-e;if(t>=0){let r=0,n=0;if(this.offset+=e,this.size>31){for(;n<e;n++)r+=Math.pow(2,n);return this.val/Math.pow(2,t)&r}for(;n<e;n++)r+=1<<n;return this.val>>>t&r}throw new Error("the number of the read operation exceeds the total length limit of bits")}write(e,t){const r=this.size-this.offset-e;if(!(r>=0))throw new Error("the number of the write operation exceeds the total length limit of bits");this.offset+=e,this.size>31?this.val+=t<<r:this.val+=t*Math.pow(2,r)}}var Oe=(e=>(e[e.UNUSED=0]="UNUSED",e[e.NON_IDR_SLICE=1]="NON_IDR_SLICE",e[e.DP_A=2]="DP_A",e[e.DP_B=3]="DP_B",e[e.DP_C=4]="DP_C",e[e.IDR=5]="IDR",e[e.SEI=6]="SEI",e[e.SPS=7]="SPS",e[e.PPS=8]="PPS",e[e.DIVIDER=9]="DIVIDER",e[e.SEQUENCE_END=10]="SEQUENCE_END",e[e.STREAM_END=11]="STREAM_END",e[e.FILL=12]="FILL",e))(Oe||{});class Ae{constructor(e){const t=Se.fromByte(e,1);this.forbiddenZeroBit=t.read(1),this.refIdc=t.read(2),this.type=t.read(5)}static extractType(e,t=0){return 31&e[t]}static isSlice(e){const t=this.extractType(e);return t>=1&&t<=5}}var $e=(e=>(e[e.TRAIL_N=0]="TRAIL_N",e[e.TRAIL_R=1]="TRAIL_R",e[e.TSA_N=2]="TSA_N",e[e.TSA_R=3]="TSA_R",e[e.STSA_N=4]="STSA_N",e[e.STSA_R=5]="STSA_R",e[e.RADL_N=6]="RADL_N",e[e.RADL_R=7]="RADL_R",e[e.RASL_N=8]="RASL_N",e[e.RASL_R=9]="RASL_R",e[e.VCL_N10=10]="VCL_N10",e[e.VCL_R11=11]="VCL_R11",e[e.VCL_N12=12]="VCL_N12",e[e.VCL_R13=13]="VCL_R13",e[e.VCL_N14=14]="VCL_N14",e[e.VCL_R15=15]="VCL_R15",e[e.BLA_W_LP=16]="BLA_W_LP",e[e.BLA_W_RADL=17]="BLA_W_RADL",e[e.BLA_N_LP=18]="BLA_N_LP",e[e.IDR_W_RADL=19]="IDR_W_RADL",e[e.IDR_N_LP=20]="IDR_N_LP",e[e.CRA=21]="CRA",e[e.VPS=32]="VPS",e[e.SPS=33]="SPS",e[e.PPS=34]="PPS",e[e.ACCESS_UNIT_DELIMITER=35]="ACCESS_UNIT_DELIMITER",e[e.EOS=36]="EOS",e[e.EOB=37]="EOB",e[e.FILLER_DATA=38]="FILLER_DATA",e[e.SEI=39]="SEI",e[e.SEI_SUFFIX=40]="SEI_SUFFIX",e[e.INVALID=64]="INVALID",e))($e||{});class Pe{constructor(e){const t=Se.fromByte(e,2);this.forbiddenZeroBit=t.read(1),this.type=t.read(6),this.nuhLayerId=t.read(6),this.temporalId=t.read(3)-1}static extractType(e,t=0){return(126&e[t])>>1}static isSlice(e){const t=this.extractType(e);return t>=0&&t<=21}}class Re{create(e,...t){const r=new Uint8Array(8),n=Ce.fromUint8(r),i=[r,...t.map(e=>new Uint8Array(e))],o=i.reduce((e,t)=>e+t.byteLength,0);return n.write(4,o),n.writeString(e),Ce.concatUint8s(i)}avc1(e){const t=e.sar,r=e.naluDatas.some(e=>Pe.extractType(e)===$e.VPS),n=new ArrayBuffer(78),i=new Ce(n);i.write(4,0),i.write(2,0),i.write(2,1),i.write(4,0),i.write(4,0),i.write(4,0),i.write(4,0),i.write(2,e.width),i.write(2,e.height),i.write(4,4718592),i.write(4,4718592),i.write(4,0),i.write(2,1);i.write(1,15),i.writeString("@byted/ttplayer"),i.skip(16),i.write(2,24),i.write(2,65535);const o=2===t.length?this.pasp(t[0],t[1]):new Uint8Array;return r?this.create("hvc1",n,this.hvcC(e),o):this.create("avc1",n,this.avcC(e),o)}avcC(e){const{naluDatas:t}=e,r=[],n=[];t.forEach(e=>{const t=Ae.extractType(e);t===Oe.SPS?r.push(e):t===Oe.PPS&&n.push(e)});const i=e=>{const t=[e.length];return e.forEach(e=>{t.push(e.byteLength>>>8&255),t.push(255&e.byteLength),e.forEach(e=>t.push(e))}),t},o=i(r),s=i(n),a=r[0]||[],l=new ArrayBuffer(5),c=new Ce(l);return c.write(1,1),c.write(1,a[1]||0),c.write(1,a[2]||0),c.write(1,a[3]||0),c.write(1,255),this.create("avcC",l,o,s)}btrt(){const e=new ArrayBuffer(12),t=new Ce(e);return t.write(4,1875072),t.write(4,3e6),t.write(4,3e6),this.create("btrt",e)}pasp(e,t){const r=new ArrayBuffer(8),n=new Ce(r);return n.write(4,e),n.write(4,t),this.create("pasp",r)}dinf(){return this.create("dinf",this.dref())}dref(){const e=new ArrayBuffer(8),t=new Ce(e);return t.write(4,0),t.write(4,1),this.create("dref",e,this.url())}esds(e){const{dsiData:t=new Uint8Array}=e,r=new ArrayBuffer(29+t.byteLength),n=new Ce(r);return n.write(4,0),n.write(1,3),n.write(1,23+t.byteLength),n.write(2,1),n.write(1,0),n.write(1,4),n.write(1,15+t.byteLength),n.write(1,64),n.write(1,21),n.write(3,0),n.write(4,96e3),n.write(4,96e3),t.byteLength>0&&(n.write(1,5),n.write(1,t.byteLength),t.forEach(e=>n.write(1,e))),n.write(1,6),n.write(1,1),n.write(1,2),this.create("esds",r)}ftyp(){const e=new ArrayBuffer(16),t=new Ce(e);return t.writeString("isom"),t.write(4,1),t.writeString("isom"),t.writeString("avc1"),this.create("ftyp",e)}hdlr(e){const t=new ArrayBuffer(37),r=new Ce(t);return r.skip(8),e===Te.VIDEO?r.writeString("vide"):e===Te.AUDIO&&r.writeString("soun"),r.skip(12),e===Te.VIDEO?r.writeString("VideoHandler"):e===Te.AUDIO&&r.writeString("SoundHandler"),r.write(1,0),this.create("hdlr",t)}hvcC(e){const{naluDatas:t}=e,r=[],n=[],i=[];t.forEach(e=>{const t=Pe.extractType(e);t===$e.VPS?r.push(e):t===$e.SPS?n.push(e):t===$e.PPS&&i.push(e)});const o=(e,t)=>{const r=[128|e,t.length>>>8&255,255&t.length];return t.forEach(e=>{r.push(e.byteLength>>>8&255),r.push(255&e.byteLength),e.forEach(e=>r.push(e))}),r},s=o($e.VPS,r),a=o($e.SPS,n),l=o($e.PPS,i),c=new ArrayBuffer(23),u=new Ce(c),d=n.length?n[0]:[];u.write(1,1);for(let e=1;e<17;e++)u.write(1,d[e]||0);return u.write(1,248),u.write(1,248),u.write(2,0),u.write(1,15),u.write(1,3),this.create("hvcC",c,s,a,l)}mdat(e){return this.create("mdat",e)}mdhd(e){const t=new ArrayBuffer(24),r=new Ce(t);return r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,e.timescale),r.write(4,0),r.write(2,21956),r.write(2,0),this.create("mdhd",t)}mdia(e){return this.create("mdia",this.mdhd(e),this.hdlr(e.type),this.minf(e))}mfhd(e){const t=new ArrayBuffer(8),r=new Ce(t);return r.write(4,0),r.write(4,e),this.create("mfhd",t)}minf(e){const t=e.type===Te.VIDEO?this.vmhd():this.smhd();return this.create("minf",t,this.dinf(),this.stbl(e))}moof(e,t,r){const n=this.mfhd(t),i=new Map;let o=0;e.tracks.forEach(e=>i.set(e.type,[])),r.forEach(e=>{const t=i.get(e.type);t&&(t.push(e),o++)});const s=Array.from(i.values()).reduce((e,t)=>t.length?e+1:e,0);let a=8+n.byteLength+60*s+16*o+8;const l=e.tracks.map(e=>{const t=i.get(e.type);if(t&&t.length){const r=this.traf(e,t,a);return a+=t.reduce((e,t)=>e+t.data.byteLength,0),r}}).filter(e=>!!e);return this.create("moof",n,...l)}moov(e){const t=e.tracks.map(e=>this.trak(e));return this.create("moov",this.mvhd(e),...t,this.mvex(e))}mp4a(e){const t=new ArrayBuffer(28),r=new Ce(t);return r.write(4,0),r.write(2,0),r.write(2,1),r.write(4,0),r.write(4,0),r.write(2,e.channelCount),r.write(2,e.sampleSize),r.write(4,0),r.write(2,e.sampleRate),r.write(2,0),this.create("mp4a",t,this.esds(e))}mvex(e){return this.create("mvex",...e.tracks.map(e=>this.trex(e)))}mvhd(e){const t=new ArrayBuffer(100),r=new Ce(t);return r.write(4,0),r.write(4,0),r.write(4,0),r.write(4,e.timescale),r.write(4,e.duration),r.write(2,1),r.skip(2),r.write(1,1),r.skip(1),r.skip(10),[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0].forEach(e=>r.write(1,e)),r.skip(24),r.write(4,4294967295),this.create("mvhd",t)}sdtp(e){const t=e.length,r=new ArrayBuffer(4+t),n=new Ce(r);n.write(4,0);for(let r=0;r<t;r++)n.write(1,e[r].flag);return this.create("sdtp",r)}smhd(){const e=new ArrayBuffer(8),t=new Ce(e);return t.write(4,0),t.write(4,0),this.create("smhd",e)}stbl(e){return this.create("stbl",this.stsd(e),this.stts(),this.stsc(),this.stsz(),this.stco())}stco(){const e=new ArrayBuffer(8),t=new Ce(e);return t.write(4,0),t.write(4,0),this.create("stco",e)}stsc(){const e=new ArrayBuffer(8),t=new Ce(e);return t.write(4,0),t.write(4,0),this.create("stsc",e)}stsd(e){const t=new ArrayBuffer(8),r=new Ce(t);return r.write(4,0),r.write(4,1),e.type===Te.VIDEO?this.create("stsd",t,this.avc1(e)):e.type===Te.AUDIO?this.create("stsd",t,this.mp4a(e)):this.create("stsd",t)}stsz(){const e=new ArrayBuffer(12),t=new Ce(e);return t.write(4,0),t.write(4,0),t.write(4,0),this.create("stsz",e)}stts(){const e=new ArrayBuffer(8),t=new Ce(e);return t.write(4,0),t.write(4,0),this.create("stts",e)}tkhd(e){const{width:t=0,height:r=0}=e,n=new ArrayBuffer(84),i=new Ce(n);return i.write(4,7),i.write(4,0),i.write(4,0),i.write(4,e.id),i.write(4,0),i.write(4,0),i.write(4,0),i.write(4,0),i.write(4,0),i.write(1,0),i.write(1,0),i.write(2,0),[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0].forEach(e=>i.write(1,e)),i.write(2,t),i.write(2,0),i.write(2,r),i.write(2,0),this.create("tkhd",n)}tfdt(e){const t=new ArrayBuffer(8),r=new Ce(t);return r.write(4,0),r.write(4,e),this.create("tfdt",t)}tfhd(e){const t=new ArrayBuffer(8),r=new Ce(t);return r.write(4,0),r.write(4,e),this.create("tfhd",t)}traf(e,t,r){const n=t.length?t[0].dts:0;return this.create("traf",this.tfhd(e.id),this.tfdt(n),this.trun(t,r))}trak(e){return this.create("trak",this.tkhd(e),this.mdia(e))}trex(e){const t=new ArrayBuffer(24),r=new Ce(t);return r.write(4,0),r.write(4,e.id),r.write(4,1),r.write(4,0),r.write(4,0),r.write(4,65535),this.create("trex",t)}trun(e,t){const r=e.length,n=new ArrayBuffer(12+16*r),i=new Ce(n);i.write(4,3841),i.write(4,e.length),i.write(4,t);for(let t=0;t<r;t++){const r=e[t];i.write(4,r.duration),i.write(4,r.data.byteLength),i.write(4,r.flag),i.write(4,r.pts-r.dts)}return this.create("trun",n)}vmhd(){const e=new ArrayBuffer(12),t=new Ce(e);return t.write(4,1),t.write(2,0),t.write(2,0),t.write(2,0),t.write(2,0),this.create("vmhd",e)}url(){const e=new ArrayBuffer(4);return new Ce(e).write(4,1),this.create("url ",e)}}var xe=(e=>(e.InitSegmentCreated="init-segment-created",e.DataSegmentCreated="data-segment-created",e))(xe||{});const Le=()=>({formatType:ke.MP4,tracks:[],timescale:1e3,duration:0});class Ie extends be{constructor(e){super(e.name),this._generator=new Re,this._metadata=Le(),this._sequenceNumber=0,this._logger=T.createLogger(e.name)}_patchMetadata(e){this._metadata=Object.assign(this._metadata,e)}_getMetadataWithOneTrack(e){const t=this._metadata.tracks.find(t=>t.type===e);if(t)return Object.assign({},this._metadata,{tracks:[t]})}_createInitSegment(e){return Ce.concatUint8(this._generator.ftyp(),this._generator.moov(e))}_createDataSegment(e,t){const r=[],n=e.tracks.map(e=>t.filter(t=>t.type===e.type)),i=Array.prototype.concat.apply([],n);return r.push(this._generator.moof(e,++this._sequenceNumber,i)),r.push(this._generator.mdat(Ce.concatUint8s(i.map(e=>e.data)))),Ce.concatUint8s(r)}_getVideoRandomAccessPoints(e){const t=[];return e.forEach(e=>{e.isKeyframe&&e.type===Te.VIDEO&&t.push(e.pts/e.timescale)}),t}createDataSegmentAction(e){return{type:xe.DataSegmentCreated,payloads:this._metadata.tracks.map(t=>{const r=e.filter(e=>e.type===t.type);if(!r.length)return;const n=r[0],i=r[r.length-1],o=n?n.dts/n.timescale:0,s=i?(i.dts+i.duration)/i.timescale:n?n.dts+n.duration/n.timescale:0;return this._logger.debug("$transform, actype:",xe.DataSegmentCreated,t.type,o,"-",s),t.type===Te.VIDEO?{type:Te.VIDEO,raps:this._getVideoRandomAccessPoints(r),sdt:o,edt:s,data:this._createDataSegment(this._getMetadataWithOneTrack(t.type),r)}:{type:t.type,sdt:o,edt:s,data:this._createDataSegment(this._getMetadataWithOneTrack(t.type),r)}}).filter(e=>!!e)}}$transform(e){const{value:t,done:r}=e;let n;if(r)return{done:r};if(t)switch(t.type){case we.LoadedMetadata:{this._patchMetadata(t.payload);const e=this._metadata.tracks.filter(e=>e.type===Te.VIDEO||e.type===Te.AUDIO);n={type:xe.InitSegmentCreated,metadata:this._metadata,payloads:e.map(e=>({type:e.type,codec:e.codec,data:this._createInitSegment(this._getMetadataWithOneTrack(e.type))}))},this._logger.debug("$transform, type:",n.type);break}case we.LoadedPackets:n=this.createDataSegmentAction(t.payload)}return n?{done:r,value:n}:void 0}changeName(e){super.changeName(e),this._logger.setName(e)}flush(){super.flush()}reset(){this.flush(),this._sequenceNumber=0,this._metadata=Le()}}function Me(e,t){const r=e.length;if(0!==r)for(let n,i,o=0;o<r;o++)if(n=e.start(o),i=e.end(o),n<=t&&i>=t)return{start:n,end:i}}function De(e){const t=e.tracks.find(e=>e.type===Te.VIDEO);return t?t.codec.split(".")[0]:NaN}function Be(e){const t=e.tracks.find(e=>e.type===Te.VIDEO);return t?t.width/t.height:NaN}class Ne{constructor(){this._bufs=[],this._timer=-1,this._called=!1}append(e){this._bufs.push(e)}download(e,t){this._called||(window.clearTimeout(this._timer),this._timer=window.setTimeout(()=>{const t=new Blob(this._bufs),r=window.URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),window.URL.revokeObjectURL(r)},t),this._called=!0)}}const je=typeof SourceBuffer<"u"&&!!SourceBuffer.prototype.changeType,Ue=!!p()&&"1"===localStorage.getItem("ttplayer_download_debug")&&location.search.indexOf("debug_download")>-1;class Ve extends O{constructor(e,t){super(),this._logger=T.createLogger("sbp"),this._pendingOperates=[],this._asyncOperateMutexes=[],this._asyncOperateCallbacks=[],this._allUpdatedCallbacks=[],this._handleError=e=>{this._emitError(new U(U.Code.MEDIA_MSE_OTHER,"mse source buffer error"))},this._emitError=e=>{this._logger.error(e),ye.microTask(()=>this.emit("error",e))},this._handleUpdateEnd=()=>{try{if(!this._sb.updating){for(;this._asyncOperateMutexes.length;)this._asyncOperateMutexes.shift().unlock();for(;this._asyncOperateCallbacks.length;)this._asyncOperateCallbacks.shift()();if(!this._pendingOperates.length)for(;this._allUpdatedCallbacks.length;)this._allUpdatedCallbacks.shift()()}}catch(e){return void(e instanceof U?this._emitError(e):this._emitError(new U(U.Code.MEDIA_MSE_OTHER,e.message||"unknown error")))}this._prepareOperate(),this.emit("updateend")},this._processAsyncOpereateProperties=e=>{const{mutex:t,callback:r}=e;t&&this._asyncOperateMutexes.push(t),r&&this._asyncOperateCallbacks.push(r)},this._processSyncOpereateProperties=e=>{const{mutex:t,callback:r}=e;t&&t.unlock(),r&&r()},this._prepareOperate=()=>{var e;if(this._sb.updating||null!=(e=this._video)&&e.error)return;const t=this._pendingOperates.shift();if(t){const{mutex:e,type:r}=t;this._runningOperateType=r;try{switch(t.type){case"append":this._prepareAppend(t);break;case"flush":case"remove":this._prepareRemoveOrFlush(t);break;case"changeType":this._prepareChangeType(t);break;case"timestampOffset":this._prepareTimestampOffset(t)}}catch(t){null!=e&&e.locked?e.throw(t):this._emitError(new U(U.Code.MEDIA_MSE_OTHER,t.message))}}},this._prepareRemoveOrFlush=e=>{const{start:t,end:r}=e;try{this._processAsyncOpereateProperties(e),this._logger.debug("remove buffer:",t,"-",r),this._sb.remove(t,r)}catch(e){throw new U(U.Code.MEDIA_MSE_SB_REMOVE,e.message)}},this._prepareAppend=e=>{const{data:t}=e;try{this._processAsyncOpereateProperties(e),this._logger.debug("append buffer:",t.byteLength,this.mimeType),this._sb.appendBuffer(t.buffer),this.downloader&&(this.downloader.append(t.buffer),this.downloader.download(this.mimeType+".mp4",5e3))}catch(e){throw new U(U.Code.MEDIA_MSE_SB_APPEND,e.message)}},this._prepareChangeType=e=>{const{mimeType:t}=e;try{this._sb.changeType(t),this._logger.info(`mimeType changed, ${this._extra.mimeType} -> ${t}`),this._processSyncOpereateProperties(e),this._extra={mimeType:t}}catch(e){throw new U(U.Code.MEDIA_MSE_SB_CHANGE_TYPE,e.message)}},this._prepareTimestampOffset=e=>{const{timestampOffset:t}=e;try{this._sb.timestampOffset=t,this._processSyncOpereateProperties(e)}catch(e){throw new U(U.Code.MEDIA_MSE_OTHER,e.message)}},this._sb=e,this._extra={mimeType:t},Ue&&(this.downloader=new Ne),this._sb.addEventListener("updateend",this._handleUpdateEnd),this._sb.addEventListener("error",this._handleError)}static isSupportChangeType(){return je}get mimeType(){return this._extra.mimeType}getSourceBuffer(){return this._sb}abort(){if(this._sb.updating&&"append"===this._runningOperateType)try{this._sb.abort()}catch(e){this._logger.warn(e)}}seek(e){const t=!!Me(this._sb.buffered,e);t||(this._pendingOperates=[]);const r=this._sb.buffered;for(let t,n,i=0,o=r.length;i<o;i++)t=r.start(i),n=r.end(i),(e<t||e>n)&&this._pendingOperates.push({type:"remove",start:t,end:n});return this._prepareOperate(),t}remove(e,t,r){const n=new ue("sbp.remove"),i=n.lock();return this._pendingOperates.push({type:"remove",start:e,end:t,mutex:n,callback:r}),this._prepareOperate(),i}append(e,t){const r=new ue("sbp.append"),n=r.lock();return this._pendingOperates.push({type:"append",data:e,mutex:r,callback:t}),this._prepareOperate(),n}changeMimeType(e,t){const r=new ue("sbp.changeType"),n=r.lock();return this._pendingOperates.push({type:"changeType",mimeType:e,mutex:r,callback:t}),this._prepareOperate(),n}setTimestampOffset(e,t){this.abort();const r=new ue("sbp.setTimestampOffset"),n=r.lock();return this._pendingOperates.push({type:"timestampOffset",timestampOffset:e,mutex:r,callback:t}),this._prepareOperate(),n}async flush(){let e;this.abort();try{e=this._sb.buffered}catch{}if(e&&e.length){this._logger.info("buffered range:",0,"-",e.end(e.length-1));const t=new ue("sbp.flush"),r=t.lock();return this._pendingOperates.push({type:"flush",mutex:t,start:0,end:1/0}),this._prepareOperate(),r}}waitForAllUpdated(e){this._sb.updating||this._pendingOperates.length?this._allUpdatedCallbacks.push(e):e()}clearWaitOperates(){this._logger.info("clear wait operates",this._pendingOperates.length,this._pendingOperates.map(e=>e.type).join(",")),this._pendingOperates=this._pendingOperates.filter(e=>"flush"===e.type),this._asyncOperateCallbacks=[],this._asyncOperateMutexes=[],this._allUpdatedCallbacks=[],this._prepareOperate()}releaseLock(){this._pendingOperates.forEach(e=>{var t;return null==(t=e.mutex)?void 0:t.releaseLock()})}attach(e){this._video=e}detach(){this._video=void 0}destroy(){this.detach(),this._sb.removeEventListener("updateend",this._handleUpdateEnd),this.removeAllListeners(),this.clearWaitOperates(),this.releaseLock()}}var Fe=(e=>(e[e.LOW=0]="LOW",e[e.NORMAL=1]="NORMAL",e[e.HIGH=2]="HIGH",e))(Fe||{}),He=(e=>(e[e.LOOP=0]="LOOP",e[e.TIMEUPDATE=1]="TIMEUPDATE",e[e.UPDATEEND=2]="UPDATEEND",e[e.PROGRESS=3]="PROGRESS",e))(He||{});class Ge extends O{constructor(e,t){super(),this._startupRap=0,this._level=0,this._autoLevelCheck=!1,this._bcTimer=-1,this.startPolling=()=>{const{bufferCheckingInterval:e}=this._options;e>0&&(this.dispatch(0),window.clearTimeout(this._bcTimer),this._bcTimer=window.setTimeout(this.startPolling,e))},this.stopPolling=()=>{window.clearTimeout(this._bcTimer)},this._offTriggers=()=>{this._video.removeEventListener("timeupdate",this._handleTimeupdate),this._video.removeEventListener("progress",this._handleProgress)},this._handleProgress=()=>{this._checkBuffer(3)},this._handleLoop=()=>{this._checkBuffer(0)},this._handleTimeupdate=()=>{this._checkBuffer(1),this._checkBufferOverflow()},this._handleUpdateEnd=()=>{this._checkBuffer(2),this._checkBufferChanged()},this._video=e,this._options=h.combineDefaultOptions(t,{bufferCheckingInterval:0,maxBackwardBufferDuration:10,minBackwardBufferDuration:5,maxForwardBufferDuration:10,minForwardBufferDuration:5})}get level(){return this._level}setTriggers(e){this._offTriggers(),e.forEach(e=>{switch(e){case 3:return this._video.addEventListener("progress",this._handleProgress);case 1:return this._video.addEventListener("timeupdate",this._handleTimeupdate)}})}dispatch(e){switch(e){case 2:return this._handleUpdateEnd();case 0:return this._handleLoop()}}setAutoLevelCheck(e){this._autoLevelCheck=e}_changeWaterLevel(e){if(this._level!==e){const t=this._level;this._level=e,this.emit("levelchange",e,t)}}_checkBuffer(e){if(!this._autoLevelCheck)return;const{maxForwardBufferDuration:t,minForwardBufferDuration:r}=this._options,{currentTime:n,buffered:i}=this._video,o=Me(i,this.getRefineCurrentTime(n));o&&(o.end-n>t?this._changeWaterLevel(2):o.end-n>r?this._changeWaterLevel(1):this._changeWaterLevel(0),this.emit("bufferchecking",e,o))}_checkBufferOverflow(){const{minBackwardBufferDuration:e,maxBackwardBufferDuration:t}=this._options,{currentTime:r,buffered:n}=this._video,i=[];for(let o,s,a=0,l=n.length;a<l;a++)o=n.start(a),r-o>t&&(s=r-e,i.push({start:o,end:s}));i.length&&this.emit("bufferoverflow",i)}_checkBufferChanged(){const{buffered:e,currentTime:t}=this._video;if(!e.length)return;const r=function(e,t){const r=e.length;if(0!==r){let n,i;for(let o=0;o<r&&(n=e.start(o),i=e.end(o),!(n>t));o++);if(void 0!==n)return{start:n,end:i}}}(e,this.getRefineCurrentTime(t));!!r&&this._lastHitRange&&this._lastHitRange.end===r.end&&this._lastHitRange.start===r.start||this.emit("bufferchange"),this._lastHitRange=r}getRefineCurrentTime(e){return this._startupRap>0&&e<this._startupRap?this._startupRap:e}setStartupRandomAccessPoint(e){this._startupRap=e}forceEmpty(){this._changeWaterLevel(0)}reset(){this._offTriggers(),this._autoLevelCheck=!1,this._level=0,this._startupRap=0,this._lastHitRange=void 0}destroy(){window.clearTimeout(this._bcTimer),this.removeAllListeners(),this._offTriggers()}}var We=(e=>(e.DEFAULT="default",e.NEXT_VIDEO_READY="next-video-ready",e))(We||{}),qe=(e=>(e.DEFAULT="default",e.REUSE="reuse",e.REUSE_EXCEPT_CODEC_CHANGE="reuse-except-codec-change",e))(qe||{});class Ke extends ve{constructor(e={}){super("ms.stream"),this._logger=T.createLogger("mse"),this._rapSet=new Set,this._firstRap=-1,this._eos=!1,this._skipSeeking=!1,this._clearIsPending=!1,this._metadataAppended=!1,this._autoSeekCount=0,this._handleBufferOverflow=e=>{const t=this._activeMse.sbpMap;t.size||e.forEach(({start:e,end:r})=>{const n=this._findBackwardRandomAccessPoint(r);n-.1>e&&!this._eos&&t.forEach(t=>t.remove(e,n-.1))})},this._handleSeeking=()=>{var e;if(this._logger.info("seeking event is fired, currenTime=",null==(e=this._video)?void 0:e.currentTime,"skipSeeking=",this._skipSeeking),this._skipSeeking)return void(this._skipSeeking=!1);const t=this._activeMse.sbpMap,r=this._video;if(!t.size||!r||!this._metadataAppended)return;const n=this._detector?this._detector.getRefineCurrentTime(r.currentTime):r.currentTime;Array.from(t.values()).every(e=>e.seek(n))||this.emit("msestalled")},this._checkVideoStartup=()=>{const e=this._video;if(e&&this._options.autoSeekToFirstFrame&&0===e.currentTime&&this._autoSeekCount<3){const t=function(e){const t=e.length;if(0!==t){let r,n;for(let i=0;i<t;i++){if(r=e.start(i),n=e.end(i),r>0)return{start:r,end:n};if(n>0)return{start:r,end:n}}}}(e.buffered);t&&t.start>0?(this._autoSeekCount++,this._logger.info("seek to the first frame at",t.start,e.duration),this._internalSeek(t.start)):this._firstRap>0&&(this._autoSeekCount++,this._logger.info("seek to the first rap at",this._firstRap,e.duration),this._internalSeek(this._firstRap))}},this._handleWaiting=()=>{this._checkVideoStartup()},this._handleSbpUpdateEnd=()=>{var e;const t=this._video;if(this._checkVideoStartup(),t&&this._options.eosFallback){const e=this.metadata?this.metadata.duration/this.metadata.timescale:0;e>0&&this._activeMse.sbpMap.size&&Array.from(this._activeMse.sbpMap.values()).every(t=>{const r=t.getSourceBuffer().buffered;return r.length>0&&r.end(r.length-1)>=e})&&this._endOfStream()}null==(e=this._detector)||e.dispatch(He.UPDATEEND)},this._handleSbpError=e=>{this.emit("error",e),this.suspend()},this._processLoop=async()=>{var e,t;let r=await this.stdin.read();if(this._clearIsPending){let n;if((null==(e=r.value)?void 0:e.type)===xe.InitSegmentCreated)n=r;else do{n=await this.stdin.read()}while((null==(t=n.value)?void 0:t.type)!==xe.InitSegmentCreated);n&&(r=n,this._clearIsPending=!1,this._clearImmediately(this._options.clearStrategy))}if(r.done){if(this._eos)return void this._logger.debug("already endOfStream");const e=this._activeMse.sbpMap.size;let t=0;Array.from(this._activeMse.sbpMap.values()).map(r=>{r.waitForAllUpdated(()=>{++t<e||this._endOfStream()})})}else if(r.value){const e=r.value;switch(e.type){case xe.InitSegmentCreated:return this._processInitSegment(e);case xe.DataSegmentCreated:return this._processDataSegment(e)}}},this._options=h.combineDefaultOptions(e,{clearStrategy:"default",autoSeekToFirstFrame:!0}),this._activeMse=this._createMse(),"default"===this._options.clearStrategy&&(this._backupMse=this._createMse())}static isBlob(e){return 0===e.indexOf("blob:")}_findBackwardRandomAccessPoint(e){let t=-1;for(const r of this._rapSet){if(!(r<e))break;t=r}return t}_createMse(){const e=new MediaSource,t=URL.createObjectURL(e),r=new ue("mse.open"),n={used:!1,mediaSource:e,url:t,mutex:r,destroy:()=>{},sbpMap:new Map},i=()=>{this._logger.info("mse sourceclose")},o=()=>{this._logger.info("mse sourceopen"),r.unlockAll()};return e.addEventListener("sourceopen",o),e.addEventListener("sourceclose",i),n.destroy=()=>{r.releaseLock(),URL.revokeObjectURL(t),e.removeEventListener("sourceopen",o),e.removeEventListener("sourceclose",i)},n}_destroyMse(e){const t=this._activeMse.sbpMap;if(t.size){t.forEach(e=>e.destroy());try{t.forEach(t=>e.mediaSource.removeSourceBuffer(t.getSourceBuffer()))}catch{}}e.destroy()}_reallocMse(){const e=this._video,t=this._activeMse;return(t.sbpMap.size||e&&e.src!==t.url&&t.used)&&(this._destroyMse(t),this._backupMse?(this._activeMse=this._backupMse,this._backupMse=this._createMse()):this._activeMse=this._createMse()),e&&e.src!==this._activeMse.url&&(this._logger.info(`change to mse, ${e.src||"empty"} -> ${this._activeMse.url}`),e.src=this._activeMse.url,this._activeMse.used=!0),this._activeMse}_setMseDuration(e){try{this._activeMse.mediaSource.duration=e,this._logger.info("mse duration changed to",e,"successfully")}catch(e){this.emit("error",new U(U.Code.MEDIA_MSE_OTHER,e.message))}}_endOfStream(){this._eos||(this._activeMse.mediaSource.endOfStream(),this._eos=!0,this._logger.info("endOfStream"))}_printMetadata(e){e.tracks.forEach(e=>{e.type===Te.AUDIO?this._logger.info(`track:${e.type}(${e.id})`,"codec:",e.codec,"duration:",e.duration,"timescale:",e.timescale,"objectType:",e.audioObjectType,"channels:",e.channelCount,"sampleRate:",e.sampleRate,"sampleSize:",e.sampleSize):e.type===Te.VIDEO?this._logger.info(`track:${e.type}(${e.id})`,"codec:",e.codec,"duration:",e.duration,"timescale:",e.timescale,"width:",e.width,"height:",e.height,"rotation:",e.rotation):this._logger.info(`track: ${e.type}(${e.id})`)})}async _processInitSegment(e){this._logger.debug("mss-stdin, type:",e.type,e.payloads),this._printMetadata(e.metadata),this._metadata=e.metadata;const{clearStrategy:t}=this._options,r=e.metadata.duration/e.metadata.timescale;let n=!1;const i=()=>{if(n||"open"!==this._activeMse.mediaSource.readyState)return;const e=Array.from(this._activeMse.sbpMap.values());(!e.length||e.every(e=>!e.getSourceBuffer().updating))&&(n=!0,this._setMseDuration(r))};i();const o=[];for(const i of e.payloads){const e=`video/mp4; codecs="${i.codec}"`;if(i.type===Te.VIDEO&&"reuse-except-codec-change"===t){const t=this._activeMse.sbpMap.get(Te.VIDEO);t&&t.mimeType!==e&&(this._reallocMse(),"open"!==this._activeMse.mediaSource.readyState&&await this._activeMse.mutex.lock(),this._setMseDuration(r),n=!0,this._logger.info("realloc mse, codec changed"))}const s=this._activeMse.sbpMap.get(i.type);if(s)s.abort(),await s.flush(),Ve.isSupportChangeType()&&await s.changeMimeType(e),o.push(s.append(i.data));else{let t;"open"!==this._activeMse.mediaSource.readyState&&(await this._activeMse.mutex.lock(),this._setMseDuration(r),n=!0);try{t=this._activeMse.mediaSource.addSourceBuffer(e)}catch(e){throw new U(U.Code.MEDIA_MSE_ADD_SB,e.message)}const s=new Ve(t,e);s.attach(this._video),s.on("error",this._handleSbpError),s.on("updateend",this._handleSbpUpdateEnd),this._activeMse.sbpMap.set(i.type,s),o.push(s.append(i.data))}}return Promise.all(o).then(()=>{i(),this._metadataAppended=!0})}async _processDataSegment(e){var t;let r=!1;const n=[];for(const i of e.payloads){const o=this._activeMse.sbpMap.get(i.type);if(!o)throw new U(U.Code.MEDIA_MSE_SB_APPEND,"no sourcebuffer");if(this._logger.debug("mss-stdin, actype:",e.type,i.type,i.data.byteLength,",",i.sdt,"-",i.edt),i.type===Te.VIDEO){if(i.raps.forEach(e=>this._rapSet.add(e)),this._eos){this._logger.warn("append cannot be called after endOfStream");break}r=this._firstRap<0&&!!i.raps.length,r&&(this._firstRap=i.raps[0],null==(t=this._detector)||t.setStartupRandomAccessPoint(this._firstRap))}n.push(o.append(i.data))}return Promise.all(n)}_internalSeek(e){const t=this._video;t&&(this._skipSeeking=!0,t.currentTime=e)}_resetContinuityStates(){this._autoSeekCount=0,this._skipSeeking=!1,this._eos=!1}_resetAllStates(){this._rapSet.clear(),this._metadata=void 0,this._metadataAppended=!1,this._firstRap=-1,this._resetContinuityStates()}_clearImmediately(e){if(super.flush(),this._resetAllStates(),"reuse"===e||"reuse-except-codec-change"===e){const e=this._activeMse.sbpMap;e.size&&(e.forEach(e=>{e.abort(),e.clearWaitOperates()}),Promise.all(Array.from(e.values()).map(e=>e.flush())).then(()=>{const e=this._video;e&&e.autoplay&&e.paused&&(e.play(),this._logger.log("automatically resume the previously paused playback state due to autoplay=true"))}))}else this._reallocMse()}get metadata(){return this._metadata}get url(){return this._activeMse.url}attach(e,t){this._video!==e&&(this.detach(),t.on("bufferoverflow",this._handleBufferOverflow),e.addEventListener("seeking",this._handleSeeking),e.addEventListener("waiting",this._handleWaiting),this._detector=t,this._video=e,this._reallocMse())}detach(){this._activeMse.sbpMap.forEach(e=>e.detach()),this._video&&(this._video.removeEventListener("seeking",this._handleSeeking),this._video.removeEventListener("waiting",this._handleWaiting),this._video=void 0),this._detector&&(this._detector.off("bufferoverflow",this._handleBufferOverflow),this._detector=void 0)}suspend(){var e;this._activeMse.sbpMap.forEach(e=>e.releaseLock()),this.stdin.releaseRead(),this._activeMse.mutex.releaseLock(),null==(e=this._coroutine)||e.cancel(),this._coroutine=void 0}resume(){this._coroutine?this._logger.debug(`coroutine (${this._coroutine.id}) is running, cannot resume`):this._coroutine=ye.create({title:"mse.stream",onLoop:this._processLoop,onError:e=>this.emit("error",e)})}async flush(){super.flush(),this._resetContinuityStates();const e=this._activeMse.sbpMap;if(e.size)return e.forEach(e=>e.abort()),Promise.all(Array.from(e.values()).map(e=>e.flush()))}reset(e){var t;if(this.suspend(),null!=(t=this._video)&&t.error&&this._reallocMse(),"next-video-ready"===((null==e?void 0:e.clearTiming)||this._options.clearTiming))this._clearIsPending=!0;else{const t=(null==e?void 0:e.clearStrategy)||this._options.clearStrategy;this._clearImmediately(t)}}destroy(){super.destroy(),this.reset({clearStrategy:"default",clearTiming:"default"}),this.suspend(),this._destroyMse(this._activeMse),this._backupMse&&this._destroyMse(this._backupMse)}}const ze=class{constructor(e,t){const r=e.offset;this.pos=t,this.size=e.read(4),this.type=String.fromCharCode(e.read(1),e.read(1),e.read(1),e.read(1)).trim(),1===this.size&&(this.size=e.read(8)),this.headerSize=e.offset-r}};ze.MIN_SIZE=8;let Ze=ze;class Ye{}class Xe extends Ye{constructor(e){super(),this.version=e.read(1),this.flag=e.read(3)}}class Qe extends Ye{constructor(e){super(),this.isContainer=!1,this.data=e.readToUint8()}}var Je=(e=>(e.Video="vide",e.Audio="soun",e.Hint="hint",e))(Je||{}),et=(e=>(e[e.BASE_DATA_OFFSET=1]="BASE_DATA_OFFSET",e[e.SAMPLE_DESC=2]="SAMPLE_DESC",e[e.SAMPLE_DUR=8]="SAMPLE_DUR",e[e.SAMPLE_SIZE=16]="SAMPLE_SIZE",e[e.SAMPLE_FLAGS=32]="SAMPLE_FLAGS",e[e.DUR_EMPTY=65536]="DUR_EMPTY",e[e.DEFAULT_BASE_IS_MOOF=131072]="DEFAULT_BASE_IS_MOOF",e))(et||{}),tt=(e=>(e[e.DATA_OFFSET=1]="DATA_OFFSET",e[e.FIRST_FLAG=4]="FIRST_FLAG",e[e.DURATION=256]="DURATION",e[e.SIZE=512]="SIZE",e[e.FLAG=1024]="FLAG",e[e.CTS_OFFSET=2048]="CTS_OFFSET",e))(tt||{});class rt{constructor(e){this._logger=T.createLogger("mp4-track"),this.__samples=[],this.__nextSampleIndex=0,this.__meta=this.__createMetadata(e),(e=>{var t,r,n;const{mdia:i}=e||{},o=(null==(t=null==i?void 0:i.minf)?void 0:t.stbl)||{},{stts:s,stsc:a,stsz:l,stss:c,ctts:u}=o,d=o.stco||o.co64,h=[];if(s&&a&&l&&d){const e={};null==c||c.sampleNumbers.forEach(t=>e[t-1]=!0);const t=[];if(u)for(let e,r,n=0;n<u.sampleCounts.length;n++){e=u.sampleCounts[n],r=u.sampleOffsets[n];for(let n=0;n<e;n++)t.push(r)}const i=a.entries;let o=(null==(r=i[0])?void 0:r.samplePerChunk)||1/0,p=(null==(n=i[1])?void 0:n.firstChunk)-1||1/0,f=0,_=0,y=0,g=0,m=0,v=0;s.sampleCounts.forEach((r,n)=>{var a;for(let b=0;b<r;b++){const r={},b=s.sampleDurations[n];r.index=v,r.size=l.sampleSizes[v]||l.sampleSize,r.pos=d.chunkOffsets[_]+f,r.cts=u?t[v]:0,r.isKeyframe=!c||!!e[v],r.duration=b,r.dts=g,r.flag=r.isKeyframe?33554432:16842752,g+=b,r.isKeyframe&&m++,r.gopId=m,h.push(r),v++,v<o?f+=r.size:(_++,f=0,_>=p&&(y++,p=(null==(a=i[y+1])?void 0:a.firstChunk)-1||1/0),o+=i[y].samplePerChunk)}})}return h})(e).forEach(e=>{this.addSample(e)})}__createMetadata(e){const{mdia:t}=e,{mdhd:r,hdlr:n,minf:i}=t||{},{stbl:o}=i||{},{stsd:s}=o||{},a=r||{},l=n||{},c=e.tkhd||{},u={id:c.trackId||0,timescale:a.timescale||1e3,duration:c.duration||0};switch(l.handlerType){case Je.Video:return Object.assign(u,this.__createExtraVideoMetadata(s,e.tkhd));case Je.Audio:return Object.assign(u,this.__createExtraAudioMetadata(s));default:return Object.assign(u,this.__createUnknownTrackMetadata())}}__createUnknownTrackMetadata(){return{type:Te.UNKNOWN}}__createExtraAudioMetadata(e){var t;const{mp4a:r}=e||{},n=r||{},i=(null==r?void 0:r.esds)||(null==(t=null==r?void 0:r.wave)?void 0:t.esds)||{};return{type:Te.AUDIO,codec:i.codec||"",audioObjectType:i.audioObjectType||0,dsiData:i.dsiData,sampleRate:n.sampleRate||0,channelCount:n.channelCount||0,sampleSize:n.sampleSize||0}}__createExtraVideoMetadata(e,t){var r,n,i;const{rotation:o}=t||{},{avc1:s,hev1:a,hvc1:l}=e||{},c=(null==s?void 0:s.avcC)||(null==a?void 0:a.hvcC)||(null==l?void 0:l.hvcC),u=(null==c?void 0:c.nalus)||[],d=(null==(r=null==s?void 0:s.avcC)?void 0:r.spsList)||(null==(n=null==a?void 0:a.hvcC)?void 0:n.spsList)||(null==(i=null==l?void 0:l.hvcC)?void 0:i.spsList),{sar:h,width:p,height:f,codec:_}=(null==d?void 0:d[0])||{};return{type:Te.VIDEO,naluDatas:u.map(e=>e.data),rotation:o||0,codec:_||"",sps:d||[],sar:h||[],width:p||0,height:f||0}}getMetadata(){return this.__meta}getSamples(){return this.__samples}getNextSampleIndex(){return this.__nextSampleIndex}getNextSample(){return this.__samples[this.__nextSampleIndex]}getNextSampleSize(){return this.__nextSampleIndex<this.__samples.length?this.__samples[this.__nextSampleIndex].size:0}getNextSamplePos(){if(this.__nextSampleIndex<this.__samples.length)return this.__samples[this.__nextSampleIndex].pos;if(this.__samples.length){const e=this.__samples[this.__samples.length-1];return e.pos+e.size}return-1}addSample(e){this.__samples.push(e)}__convertSampleToPacket(e,t,r=0){const n=e.pos-r;if(n>=0&&e.pos+e.size<=t.byteLength+r)return{index:e.index,pos:e.pos,duration:e.duration,flag:e.flag,dts:e.dts,pts:e.dts+e.cts,isKeyframe:e.isKeyframe,timescale:this.__meta.timescale,type:this.__meta.type,codec:this.__meta.codec||"",data:t.subarray(n,n+e.size)}}processPackets(e,t=0){const r=[];for(let n=this.__nextSampleIndex,i=this.__samples.length;n<i;n++){const i=this.__convertSampleToPacket(this.__samples[n],e,t);if(!i)break;this.__nextSampleIndex++,r.push(i)}return r}seek(e){const t=e*this.__meta.timescale,r=this.__samples.length;let n;if(r){if(n=this.__samples[0],n.dts+n.cts>t)return this.__nextSampleIndex=0,n;{let e=-1;for(let i=0;i<r&&(n=this.__samples[i],!(n.dts+n.cts>t));i++)n.isKeyframe&&(e=i);if(e>-1)return this.__nextSampleIndex=e,this.__samples[e];this._logger.warn("seek out of range")}}else this._logger.warn("no samples")}}class nt{constructor(e){this.__tracks=[];const{trak:t,mvhd:r}=e,n=r||{},i=t||[],o=new Map;i.forEach(e=>{var t,r;const n=null==(r=null==(t=e.mdia)?void 0:t.hdlr)?void 0:r.handlerType;n&&(o.has(n)||this.__tracks.push(new rt(e)),o.set(n,!0))}),this.__tracks=this.__tracks.filter(e=>e.getMetadata().type!==Te.UNKNOWN),this.__meta={formatType:ke.MP4,duration:n.duration||0,timescale:n.timescale||0,tracks:this.__tracks.map(e=>e.getMetadata())}}getTrackById(e){return this.__tracks.find(t=>t.getMetadata().id===e)}getTracks(){return this.__tracks}getMetadata(){return this.__meta}}class it extends O{constructor(e={}){super(),this._onLoad=e=>{this.parse(e)},this.__backupLoader=new oe,this.setLoader(e.loader)}get loader(){return this.__customLoader||this.__backupLoader}load(e){this.loader.load(e)}setLoader(e){this.loader&&this.loader.off("loadeddata",this._onLoad),this.__customLoader=e,this.loader.on("loadeddata",this._onLoad)}reset(){this.setLoader()}destroy(){this.removeAllListeners(),this.reset(),this.loader.off("loadeddata",this._onLoad),this.loader.destroy()}}class ot extends Xe{constructor(e){super(e),this.isContainer=!0,e.skip(2),this.bitReferenceId=e.read(2),this.codeStreamVersion=e.read(4),e.skip(4),e.skip(8),this.width=e.read(2),this.height=e.read(2),this.horizontalResolution=e.read(4),this.verticalResolution=e.read(4),e.skip(4),this.frameCount=e.read(2);const t=Math.min(e.read(1),32);this.compressorName=e.readString(t),e.skip(32-(t+1)),this.depth=e.read(2),e.skip(2)}}function st(e,t){return+(e+"."+t)}function at(e){return e.toString(16).padStart(2,"0")}const lt=new Date("1904-01-01T00:00:00Z").getTime();function ct(e){return e&&e+1e3*lt}class ut{constructor(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}skipBits(e){let t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=8*t,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32)throw new Error("Cannot read more than 32 bits at a time");return this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t,r,n=8,i=8;for(t=0;t<e;t++)0!==i&&(r=this.readEG(),i=(n+r+256)%256),n=0===i?n:i}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}function dt(e){const t=e.byteLength,r=[];let n=1;for(;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;const i=t-r.length,o=new Uint8Array(i);let s=0;for(n=0;n<i;s++,n++)s===r[0]&&(s++,r.shift()),o[n]=e[s];return o}const ht=[100,110,122,244,44,83,86,118,128,138,144],pt=[[0,1],[1,1],[12,11],[10,11],[16,11],[40,33],[24,11],[20,11],[32,11],[80,33],[18,11],[15,11],[64,33],[160,99],[4,3],[3,2],[2,1]],ft=[1,2,2,1],_t=[1,2,1,1];class yt{constructor(){this.videoFormat=0,this.videoFullRangeFlag=0,this.colourDescriptionPresentFlag=0,this.colourPrimaries=0,this.transferCharacteristics=0,this.matrixCoeffs=0,this.sar=[]}decodeVuiParams(e){if(e.readBits(1)){const t=e.readUByte();255===t?(this.sar[0]=e.readUByte()<<8|e.readUByte(),this.sar[1]=e.readUByte()<<8|e.readUByte()):this.sar=pt[t]}e.readBits(1)&&e.skipBits(1),e.readBits(1)&&(this.videoFormat=e.readBits(3),this.videoFullRangeFlag=e.readBits(1),this.colourDescriptionPresentFlag=e.readBits(1),this.colourDescriptionPresentFlag&&(this.colourPrimaries=e.readUByte(),this.transferCharacteristics=e.readUByte(),this.matrixCoeffs=e.readUByte()))}}class gt extends yt{constructor(e){super(),this.generalProfileSpace=0,this.generalTierFlag=0,this.cropLeft=0,this.cropRight=0,this.cropTop=0,this.cropBottom=0;const t=new ut(dt(e.subarray(1)));if(this.generalProfileIdc=t.readUByte(),this.generalProfileCompatibility=t.readUByte(),this.generalLevelIdc=t.readUByte(),this.spsId=t.readUEG(),this.codec=this.__generateCodec(),ht.indexOf(this.generalProfileIdc)>-1){if(this.chromaFormatIdc=t.readUEG(),3===this.chromaFormatIdc&&t.skipBits(1),this.bitDepthLuma=t.readUEG()+8,this.bitDepthChroma=t.readUEG()+8,t.skipBits(1),t.readBits(1))for(let e=0,r=3!==this.chromaFormatIdc?8:12;e<r;e++)t.readBits(1)&&(e<6?t.skipScalingList(16):t.skipScalingList(64))}else this.chromaFormatIdc=1,this.bitDepthLuma=8,this.bitDepthChroma=8;t.skipUEG();const r=t.readUEG();if(0===r)t.skipUEG();else if(1===r){t.skipBits(1),t.skipEG(),t.skipEG();for(let e=0,r=t.readUEG();e<r;e++)t.skipEG()}t.skipUEG(),t.skipBits(1);const n=t.readUEG()+1,i=t.readUEG()+1,o=t.readBits(1);if(o||t.skipBits(1),t.skipBits(1),this.crop=t.readBits(1),this.crop){const e=1<<(1===this.chromaFormatIdc||2===this.chromaFormatIdc?1:0),r=2-o<<(1===this.chromaFormatIdc?1:0);this.cropLeft=t.readUEG()*e,this.cropRight=t.readUEG()*e,this.cropTop=t.readUEG()*r,this.cropBottom=t.readUEG()*r}this.width=16*n-(this.cropRight+this.cropLeft),this.height=16*i-(this.cropTop+this.cropBottom),t.readBits(1)&&this.decodeVuiParams(t)}__generateCodec(){return"avc1."+[this.generalProfileIdc,this.generalProfileCompatibility,this.generalLevelIdc].map(e=>at(e)).join("")}}class mt{constructor(e){let t;this.generalProfileCompatibilityFlags=[],this.generalConstraintIndicatorFlags=[],this.separateColourPlaneFlag=0,this.checkProfileIdc=0,this.maxSubLayersMinus1=0,this.sar=[],this.__generateCodec=()=>{const e=["hvc1"],t=this.generalProfileSpace;e.push((t>0&&t<4?String.fromCharCode(64+t):"")+this.generalProfileIdc.toString()),e.push(this.generalProfileCompatibilityFlags.reverse().reduce((e,t)=>e<<1|t,0).toString(16)),e.push((this.generalTierFlag?"H":"L")+this.generalLevelIdc);const r=[];for(let e=!1,t=5;t>=0;t--){const n=this.generalConstraintIndicatorFlags[t];(n||e)&&(r.unshift(n.toString(16)),e=!0)}return e.concat(r).join(".")};const r=new ut(dt(e.subarray(2)));for(this.vpsId=r.readBits(4),this.maxSubLayersMinus1=r.readBits(3),this.temporalIdNested=r.readBits(1),this.generalProfileSpace=r.readBits(2),this.generalTierFlag=r.readBits(1),this.generalProfileIdc=r.readBits(5),t=0;t<32;t++)this.generalProfileCompatibilityFlags[t]=r.readBits(1),0===this.generalProfileIdc&&t>0&&this.generalProfileCompatibilityFlags[t]&&(this.generalProfileIdc=t);for(t=0;t<6;t++)this.generalConstraintIndicatorFlags.push(r.readUByte());this.generalLevelIdc=r.readUByte();const n=[],i=[];for(t=0;t<this.maxSubLayersMinus1;t++)n[t]=r.readBits(1),i[t]=r.readBits(1);if(this.maxSubLayersMinus1>0)for(r.skipBits(2*(8-this.maxSubLayersMinus1)),t=0;t<this.maxSubLayersMinus1;t++)n[t]&&(r.skipBits(16),r.skipBits(16),r.skipBits(16),r.skipBits(16),r.skipBits(24)),i[t]&&r.skipBits(8);if(this.spsId=r.readUEG(),this.codec=this.__generateCodec(),this.chromaFormatIdc=r.readUEG(),3===this.chromaFormatIdc&&(this.separateColourPlaneFlag=r.readBits(1),this.separateColourPlaneFlag&&(this.chromaFormatIdc=0)),this.width=r.readUEG(),this.height=r.readUEG(),r.readBits(1)){const e=ft[this.chromaFormatIdc],t=_t[this.chromaFormatIdc];this.width-=r.readUEG()*e+r.readUEG()*e,this.height-=r.readUEG()*t+r.readUEG()*t}}}var vt=(e=>(e[e.OD=1]="OD",e[e.IOD=2]="IOD",e[e.ESD=3]="ESD",e[e.DCD=4]="DCD",e[e.DSI=5]="DSI",e[e.SLCD=6]="SLCD",e))(vt||{});class bt{constructor(e){this.tag=e.read(1),this.size=0;let t=e.read(1);for(;128&t;)this.size=(127&t)<<7,t=e.read(1);this.size+=127&t}static extractDescriptors(e){const t=[];let r,n,i;for(;e.unreadLength>2&&(r=new bt(e),!(r.size<=0));){switch(i=new Ce(e.buffer,e.offset,r.size),e.skip(r.size),r.tag){case 3:n=new Ct(r,i);break;case 4:n=new Et(r,i);break;case 5:n=new kt(r,i);break;case 6:n=new Tt(r,i);break;default:n=null}n&&(i.unreadLength&&(n.children=bt.extractDescriptors(i)),t.push(n))}return t}}class wt{constructor(e){this.probe=e,this.children=[]}static findDescriptor(e,t){let r;return e.some(e=>(r=e.probe.tag===t?e:wt.findDescriptor(e.children,t),!!r)),r}}class Ct extends wt{constructor(e,t){super(e),this.streamDependenceFlag=0,this.URLFlag=0,this.OCRStreamFlag=0,this.esId=t.read(2),this.esFlag=t.read(1),128&this.esFlag&&(this.streamDependenceFlag=t.read(2)),64&this.esFlag&&(this.URLFlag=t.read(1),t.skip(this.URLFlag)),32&this.esFlag&&(this.OCRStreamFlag=t.read(2))}}class Et extends wt{constructor(e,t){super(e),this.mpeg4Audio=t.read(1),this.audioStream=t.read(1),this.bufferSize=t.read(3),this.maxBitrate=t.read(4),this.avgBitrate=t.read(4)}}class kt extends wt{constructor(e,t){super(e),this.data=t.readToUint8(),t.back(this.data.byteLength);const r=Se.fromByte(t,2);this.objectType=r.read(5),31===this.objectType&&(this.objectType=32+r.read(6))}}class Tt extends wt{constructor(e,t){super(e),this.esId=t.read(2)}}const St=Object.freeze(Object.defineProperty({__proto__:null,BoxBody:Ye,BoxHeader:Ze,FullBoxBody:Xe,UnknownBoxBody:Qe,avc1:ot,avcC:class extends Ye{constructor(e){super(),this.isContainer=!1,this.spsList=[],this.nalus=[],this.configVersion=e.read(1),this.generalProfileIdc=e.read(1),this.generalProfileCompatibility=e.read(1),this.generalLevelIdc=e.read(1),this.lengthSizeMinusOne=3&e.read(1),this.numOfSequenceParameterSets=31&e.read(1);for(let t=0;t<this.numOfSequenceParameterSets;t++){const t=e.read(2),r=e.readToUint8(t);this.spsList.push(new gt(r)),this.nalus.push({type:Oe.SPS,data:r})}this.numOfPictureParameterSets=31&e.read(1);for(let t=0;t<this.numOfPictureParameterSets;t++){const t=e.read(2);this.nalus.push({type:Oe.SPS,data:e.readToUint8(t)})}}},btrt:class extends Ye{constructor(e){super(),this.isContainer=!0,this.bufferSizeDB=e.read(4),this.maxBitrate=e.read(4),this.avgBitrate=e.read(4)}},chan:Ye,co64:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.chunkOffsets=[];for(let t=e.read(4),r=0;r<t;r++)this.chunkOffsets.push(e.read(8))}},colr:class extends Ye{constructor(e){super(),this.isContainer=!1,this.colorPrimaries=0,this.transferCharacteristics=0,this.matrixCoefficients=0,this.fullRangeFlag=0,this.colorType=e.readString(4),"nclx"===this.colorType?(this.colorPrimaries=e.read(2),this.transferCharacteristics=e.read(2),this.matrixCoefficients=e.read(2),this.fullRangeFlag=e.read(1)>>7,this.iccProfile=new Uint8Array):"rICC"===this.colorType||"prof"===this.colorType?this.iccProfile=e.readToUint8():this.iccProfile=new Uint8Array}},ctts:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sampleCounts=[],this.sampleOffsets=[];for(let t=e.read(4),r=0;r<t;r++)this.sampleCounts[r]=e.read(4),this.sampleOffsets[r]=e.read(4)}},dinf:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},dref:class extends Xe{constructor(e){super(e),this.isContainer=!0,this.entryCount=e.read(4)}},edts:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},elst:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.entries=[];const t=e.read(4),r=1===this.version;for(let n=0;n<t;n++)this.entries.push({segmentDuration:e.read(r?8:4),mediaTime:e.read(r?8:4),mediaRateInteger:e.read(2),mediaRateFraction:e.read(2)})}},esds:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.codec="",this.descriptors=[],this.audioObjectType=0,this.descriptors=bt.extractDescriptors(e);const t=wt.findDescriptor(this.descriptors,vt.DCD),r=wt.findDescriptor(this.descriptors,vt.DSI);r&&(this.audioObjectType=r.objectType,this.dsiData=r.data,t&&(this.codec="mp4a."+t.mpeg4Audio.toString(16)+"."+r.objectType))}},fiel:Ye,free:Ye,frma:class extends Ye{constructor(e){super(),this.isContainer=!1,this.dataFormat=e.readString(4)}},ftyp:class extends Ye{constructor(e){for(super(),this.isContainer=!1,this.majorBrand=e.readString(4).trim(),this.minorVersion=e.read(4),this.compatibleBrands=[];e.unreadLength>3;)this.compatibleBrands.push(e.readString(4))}},hdlr:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.name="",this.preDefined="",this.handlerType="",0===this.version&&(this.preDefined=e.readString(4).trim(),this.handlerType=e.readString(4).trim(),e.skip(12),this.name=e.readString(e.unreadLength).trim())}},hvc1:class extends ot{},hvcC:class extends Ye{constructor(e){let t;super(),this.isContainer=!1,this.generalProfileCompatibilityFlags=[],this.generalConstraintIndicatorFlags=[],this.spsList=[],this.nalus=[],this.configVersion=e.read(1),t=Se.fromByte(e,1),this.generalProfileSpace=t.read(2),this.generalTierFlag=t.read(1),this.generalProfileIdc=t.read(5),t=Se.fromByte(e,4),this.generalProfileCompatibilityFlags=Array.from(Array(32)).map(()=>t.read(1)),this.generalConstraintIndicatorFlags=Array.from(Array(6)).map(()=>e.read(1)),this.generalLevelIdc=e.read(1),this.minSpatialSegmentationIdc=4095&e.read(2),this.parallelismType=3&e.read(1),this.chromaFormatIdc=3&e.read(1),this.bitDepthLumaMinus8=7&e.read(1),this.bitDepthChromaMinus8=7&e.read(1),this.avgFrameRate=e.read(2),t=Se.fromByte(e,1),this.constantFrameRate=t.read(2),this.numTemporalLayers=t.read(3),this.temporalIdNested=t.read(1),this.lengthSizeMinusOne=t.read(2);const r=e.read(1);for(let t=0;t<r;t++){const t=Se.fromByte(e,1),r=t.read(1);t.skip(1);const n=t.read(6),i=e.read(2);for(let t=0;t<i;t++){const t=new Uint8Array(e.read(2)).map(()=>e.read(1));this.nalus.push({completeness:r,type:n,data:t}),n===$e.SPS&&this.spsList.push(new mt(t))}}}},ilst:Ye,keys:Ye,mdhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,1===this.version?(this.createTime=ct(e.read(8)),this.modifyTime=ct(e.read(8)),this.timescale=e.read(4),this.duration=e.read(8)):(this.createTime=ct(e.read(4)),this.modifyTime=ct(e.read(4)),this.timescale=e.read(4),this.duration=e.read(4));const t=e.read(2),r=e=>31&e+96;this.language=String.fromCharCode(r(t>>10),r(t>>5),r(t)).trim(),this.quality=st(e.readInt(1),e.readInt(1))}},mdia:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},meta:Ye,mfhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sequenceNumber=e.read(4)}},minf:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},moof:class extends Ye{constructor(){super(...arguments),this.isContainer=!0,this.traf=[]}},moov:class extends Ye{constructor(){super(...arguments),this.isContainer=!0,this.trak=[]}},mp4a:class extends Ye{constructor(e){if(super(),this.isContainer=!0,this.dataReferenceIndex=0,this.channelCount=0,this.sampleSize=0,this.sampleRate=0,e.unreadLength<28)return;e.skip(6),this.dataReferenceIndex=e.read(2);const t=e.read(2);e.skip(6),this.channelCount=e.read(2),this.sampleSize=e.read(2),e.skip(4),this.sampleRate=e.read(4)>>>16,1===t?(e.skip(4),e.skip(4),e.skip(4),e.skip(4)):2==t&&(e.skip(4),this.sampleRate=e.read(8),this.channelCount=e.read(4),e.skip(4),this.sampleSize=e.read(4),e.skip(4),e.skip(4),e.skip(4))}},mvhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.matrix=[],this.createTime=ct(e.read(4)),this.modifyTime=ct(e.read(4)),this.timescale=e.read(4),this.duration=e.read(4),this.rate=+(e.read(2)+"."+e.read(2)),this.volume=+(e.read(1)+"."+e.read(1)),e.skip(10);for(let t=0;t<9;t++)this.matrix.push(+(e.read(2)+"."+e.read(2)));e.skip(24),this.nextTrackId=e.read(4)}},pasp:class extends Ye{constructor(e){super(),this.isContainer=!1,this.hSpacing=e.read(4),this.vSpacing=e.read(4)}},pssh:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.systemIds=[],this.keyIds=[];for(let t=0;t<16;t++)this.systemIds.push(at(e.read(1)));if(this.version>0){const t=e.read(4);for(let r=0;r<t;r++){const t=Array.from(Array(16)).map(()=>at(e.read(1))).join("");this.keyIds.push(t)}}const t=e.read(4);this.data=e.readToUint8(t)}},sbgp:class extends Xe{constructor(e){super(e),this.isContainer=!0,this.entries=[],this.groupingType=e.readString(4),1===this.version?this.groupingTypeParameter=e.read(4):this.groupingTypeParameter=0;const t=e.read(4);for(let r=0;r<t;r++)this.entries.push({sampleCount:e.readInt(4),groupDescriptionIndex:e.readInt(4)})}},schi:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},senc:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.samples=[],this.sampleCount=e.read(4),this.byte=e}caculateSamples(e=8){for(let t=0;t<this.sampleCount;t++){const t=[];for(let r=0;r<e;r++)t.push(this.byte.read(1));const r=this.byte.read(2),n=[];for(let e=0;e<r;e++)n.push({bytesOfClearData:this.byte.read(2),bytesOfProtectedData:this.byte.read(4)});this.samples.push({initializationVector:t,subsamples:n})}}},sgpd:Ye,sidx:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.references=[],this.trackId=e.read(4),this.timescale=e.read(4),0===this.version?(this.pts=e.read(4),this.offset=e.read(4)):(this.pts=e.read(8),this.offset=e.read(8)),e.skip(2);const t=e.read(2);for(let r=0;r<t;r++){const t=Se.fromByte(e,4),r=e.read(4),n=Se.fromByte(e,4);this.references.push({type:t.read(1),size:t.read(31),duration:r,startWithSap:n.read(1),sapType:n.read(3),sapDeltaTime:n.read(28)})}}},sinf:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},smhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.balance=e.read(2)}},stbl:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},stco:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.chunkOffsets=[];for(let t=e.read(4),r=0;r<t;r++)this.chunkOffsets.push(e.read(4))}},stsc:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.entries=[];for(let t=e.read(4),r=0;r<t;r++)this.entries.push({firstChunk:e.read(4),samplePerChunk:e.read(4),sampleDescriptionIndex:e.read(4)})}},stsd:class extends Xe{constructor(e){super(e),this.isContainer=!0,e.skip(4)}},stss:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sampleNumbers=[];for(let t=e.read(4),r=0;r<t;r++)this.sampleNumbers.push(e.read(4))}},stsz:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sampleSizes=[],this.sampleSize=e.read(4);for(let t=e.read(4),r=0;r<t;r++)0===this.sampleSize?this.sampleSizes.push(e.read(4)):this.sampleSizes.push(this.sampleSize)}},stts:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sampleCounts=[],this.sampleDurations=[];for(let t=e.read(4),r=0;r<t;r++)this.sampleCounts[r]=e.read(4),this.sampleDurations[r]=e.read(4)}},tenc:class extends Xe{constructor(e){if(super(e),this.isContainer=!1,e.skip(1),0===this.version)e.skip(1),this.cryptByteBlock=0,this.skipByteBlock=0;else{const t=e.read(1);this.cryptByteBlock=t>>4,this.skipByteBlock=15&t}this.isProtected=e.read(1),this.perSampleIvSize=e.read(1),this.isProtected&&!this.perSampleIvSize?this.keyId=Array.from(Array(16)).map(()=>at(e.read(1))).join(""):this.keyId=""}},tfdt:class extends Xe{constructor(e){super(e),this.isContainer=!1,1===this.version?this.baseMediaDecodeTime=e.read(8):this.baseMediaDecodeTime=e.read(4)}},tfhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.baseDataOffset=0,this.defaultSampleDescriptionIndex=0,this.defaultSampleDuration=0,this.defaultSampleSize=0,this.defaultSampleFlag=0,this.trackId=e.read(4),1&this.flag&&(this.baseDataOffset=e.read(8)),2&this.flag&&(this.defaultSampleDescriptionIndex=e.read(4)),8&this.flag&&(this.defaultSampleDuration=e.read(4)),16&this.flag&&(this.defaultSampleSize=e.read(4)),32&this.flag&&(this.defaultSampleFlag=e.read(4))}},tkhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.matrix=[],this.createTime=ct(e.read(4)),this.modifyTime=ct(e.read(4)),this.trackId=e.read(4),e.skip(4),this.duration=e.read(4),e.skip(8),this.layer=e.read(2),this.alternateGroup=e.read(2),this.volume=+(e.read(1)+"."+e.read(1)),e.skip(2),this.matrix=[];for(let t=0;t<36;t++)this.matrix.push(e.read(1));e.back(36);const t=[];for(let r,n=0;n<3;n++)t.push(st(e.readInt(2),e.readInt(2))),t.push(st(e.readInt(2),e.readInt(2))),r=e.readInt(4),t.push(st(r>>30,1073741823&r));this.rotation=function(e){if(e.length<5)return 0;const t=Math.hypot(e[0],e[3]),r=Math.hypot(e[1],e[4]);return 0===t||0===r?0:180*Math.atan2(e[1]/r,e[0]/t)/Math.PI}(t),this.width=+(e.read(2)+"."+e.read(2)),this.height=+(e.read(2)+"."+e.read(2))}},traf:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},trak:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},trex:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.trackId=e.read(4),this.defaultSampleDescriptionIndex=e.read(4),this.defaultSampleDuration=e.read(4),this.defaultSampleSize=e.read(4),this.defaultSampleFlag=e.read(4)}},trun:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.sampleDurations=[],this.sampleSizes=[],this.sampleFlags=[],this.sampleCTSs=[],this.sampleCount=e.read(4),1&this.flag?this.dataOffset=e.readInt(4):this.dataOffset=0,4&this.flag?this.firstSampleFlag=e.read(4):this.firstSampleFlag=0;for(let t=0;t<this.sampleCount;t++)256&this.flag&&(this.sampleDurations[t]=e.read(4)),512&this.flag&&(this.sampleSizes[t]=e.read(4)),1024&this.flag&&(this.sampleFlags[t]=e.read(4)),2048&this.flag&&(0===this.version?this.sampleCTSs[t]=e.read(4):this.sampleCTSs[t]=e.readInt(4))}},udta:Ye,url:Ye,vmhd:class extends Xe{constructor(e){super(e),this.isContainer=!1,this.graphicsMode=e.read(2),this.opcolor=[e.read(2),e.read(2),e.read(2)]}},wave:class extends Ye{constructor(){super(...arguments),this.isContainer=!0}},wide:Ye},Symbol.toStringTag,{value:"Module"})),Ot=T.createLogger("mp4-parser");class At extends it{constructor(e={}){super(e),this._trexs=[],this._reservedMdatHeaders=[],this._reservedSeekTime=0,this._cacheStats={done:!1,duration:0,byteSize:0},this.maxProbeSize=8,this.name="MP4Parser",this._handlebox=e=>{const{header:t,body:r}=e;switch(t.type){case"moov":return Ot.log("moov box loaded",e),this._media=new nt(r),this._reservedSeekTime>0&&this._media.getTracks().some(e=>e.getSamples().length>0)&&(this._mediaSeek(this._media,this._reservedSeekTime),this._reservedSeekTime=0),this.emit("loadedmetadata",this._media.getMetadata());case"trex":return void this._trexs.push(r);case"moof":{const e=this._media;if(!e)return;return void r.traf.forEach(r=>{if(!r.tfhd)return;const n=e.getTrackById(r.tfhd.trackId||-1),i=this._trexs.find(e=>e.trackId==e.trackId);n&&function(e,t,r){const{tfhd:n,trun:i,tfdt:o}=e,s=[];if(!(o&&i&&o&&n))return s;const{sampleCTSs:a,sampleCount:l,sampleFlags:c,sampleDurations:u,sampleSizes:d,flag:h}=i,{flag:p}=n,f=p&et.SAMPLE_DUR?n.defaultSampleDuration:(null==t?void 0:t.defaultSampleDuration)||0,_=p&et.SAMPLE_SIZE?n.defaultSampleSize:(null==t?void 0:t.defaultSampleSize)||0,y=p&et.SAMPLE_FLAGS?n.defaultSampleFlag:(null==t?void 0:t.defaultSampleFlag)||0;for(let e=0,t=0,g=p&et.BASE_DATA_OFFSET?n.baseDataOffset:p&et.DEFAULT_BASE_IS_MOOF?r:i.dataOffset+r,m=0;m<l;m++){const r={};r.index=m,r.size=h&tt.SIZE?d[m]:_,r.duration=h&tt.DURATION?u[m]:f,r.dts=e>0?e:o?o.baseMediaDecodeTime:0,r.cts=a[m]||0,e=r.dts+r.duration;let n=y;h&tt.FLAG?n=c[m]:0===m&&h&tt.FIRST_FLAG&&(n=i.firstSampleFlag),r.flag=n,r.isKeyframe=!(16842752&n),r.isKeyframe&&t++,r.gopId=t,r.pos=g,g+=r.size,s.push(r)}return s}(r,i,t.pos).forEach(e=>{n.addSample(e)})})}}},this.opts=e,this.on("loadedbox",this._handlebox)}_parseMetaBox(e,t,r){var n;const i=[];for(;e.unreadLength>=Ze.MIN_SIZE;){const o=new Ze(e,t+e.offset);if(!o.size){const e=`box ${o.type} invalid size ${o.size}`;Ot.error(e),this.emit("error",new U(U.Code.DEMUX_MP4,e));break}if("mdat"===o.type)return e.back(o.headerSize),{break:!1,boxes:i,mdatHeader:o};if("moov"===o.type&&this._media){Ot.warn("moov box has already loaded");break}const s=o.size-o.headerSize;if(e.unreadLength<s){e.back(o.headerSize);break}{const t=new Ce(e.buffer,e.offset,s);e.skip(s);const a=St[o.type];let l;a?l=new a(t):(l=new Qe(t),Ot.warn(`box ${o.type} has no handler`));const c={header:o,body:l};if(l&&l.isContainer){const e=new At;e[o.type]=l,null==(n=e._parseMetaBox(t,o.pos+o.headerSize,r).boxes)||n.forEach(e=>{const t=e.header.type;Array.isArray(l[t])?l[t].push(e.body):l[t]=e.body})}i.push(c),null==r||r(c)}}return{break:!0,boxes:i}}_parseMdatBox(e,t,r){const{media:n,mdatHeader:i}=r,o=e.offset+t,s=e.size+t,a=e.readToUint8(),l=[],c=[];n.getTracks().filter(e=>e.getMetadata().type!==Te.UNKNOWN).forEach(e=>{e.processPackets(a,o).forEach(e=>c.push(e));const t=e.getNextSamplePos();t>=0&&l.push(t),e.getNextSample()}),c.length?this.emit("loadedpackets",{data:c}):Ot.debug(`no packet found at mdat rangeStart: ${o}, byteSize: ${s-o}, nextSampleSize: ${n.getTracks().map(e=>e.getNextSampleSize())}`),e.back(a.byteLength);const u=Math.min(...l)-o;if(u<0){const e="the mdat data does not contain the start position of the next sample";throw new U(U.Code.DEMUX_MP4,e)}return e.skip(u),c.length&&i.pos+i.size<s?{break:!1,mdatHeader:void 0}:{break:!0,mdatHeader:i}}_loadTailMoovBox(e){const t=e.pos+e.size;return Ot.info("mdat is ahead of moov box, cancel the current request and load moov box first"),this.loader.abort(),this.loader.loadRange(t).then(()=>{Ot.info("load moov box success, jump to the start position of mdat box"),this.loader.jump(e.pos),this.loader.status!==Q.SUSPENDED?this.loader.loadRange(e.pos,t-1):Ot.info("because the loader is suspended, subsequent mdat data is not loaded")}),{break:!0,discard:!0}}_parseLoop(e,t){this._currMdatHeader||(this._currMdatHeader=this._reservedMdatHeaders.find(e=>e.pos+e.size>t&&e.pos<t));let r={break:!1};for(;!r.break;)this._currMdatHeader?this._media?(r=this._parseMdatBox(e,t,{mdatHeader:this._currMdatHeader,media:this._media}),this._currMdatParsed=!0,this._currMdatHeader=r.mdatHeader):(r=this._loadTailMoovBox(this._currMdatHeader),this._currMdatHeader=void 0):(r=this._parseMetaBox(e,t,this._handlebox),this._currMdatHeader=r.mdatHeader,r.mdatHeader&&this._reservedMdatHeaders.push(r.mdatHeader));return r}_mediaSeek(e,t){this.loader.suspend();const r=e.getTracks();r.map(e=>e.seek(t));const n=Math.min(...r.map(e=>e.getNextSamplePos()));this.loader.loadRange(n)}getCacheStats(){return this._cacheStats}probe(e){return"ftyp"===[...e.subarray(4,8)].map(e=>String.fromCharCode(e)).join("")}parse(e){Ot.debug("load segment, origin:",e.origin,"pos:",e.pos,"size:",e.data.byteLength);const{data:t,pos:r}=e,n=this.loader.total<=t.byteLength+r;if(t.byteLength){let e=t,n=r;this._reservedUint8&&(e=Ce.concatUint8(this._reservedUint8,t),n-=this._reservedUint8.byteLength,this._reservedUint8=void 0);const i=Ce.fromUint8(e);!this._parseLoop(i,n).discard&&i.unreadLength&&(this._reservedUint8=i.readToUint8())}n&&this._currMdatParsed&&this.emit("eos");const i=this.opts.cache;if(i&&(i.maxByteSize||i.maxDuration)){const r=this._cacheStats;if(!r.done){if(r.byteSize+=t.byteLength,this._media){const e=this._media.getTracks(),t=e.map(e=>{const t=e.getSamples(),r=e.getMetadata().timescale;let n,o=0,s=0;for(let a=0;a<e.getNextSampleIndex();a++)if(n=t[a],n){if(o+=n.duration/r,s=n.pos+n.size,i.maxDuration&&o>i.maxDuration)return{cachedDuration:o,cachedDataSize:s};if(i.maxByteSize&&s>i.maxByteSize)return{cachedDuration:o,cachedDataSize:s}}}).filter(e=>!!e);t.length===e.length&&(r.done=!0,r.byteSize=Math.max(...t.map(e=>e.cachedDataSize)),r.duration=Math.min(...t.map(e=>e.cachedDuration)))}else r.duration=0;r.done?(this.loader.store({segment:{...e,data:r.byteSize>e.pos?t.slice(0,r.byteSize-e.pos):t}}),this.emit("cachedone")):this.loader.store({segment:e})}}}seek(e){this._currMdatHeader=void 0,this._reservedUint8=void 0,this._media?this._mediaSeek(this._media,e):this._reservedSeekTime=e}reset(){super.reset(),this._trexs=[],this._media=void 0,this._currMdatParsed=void 0,this._currMdatHeader=void 0,this._reservedSeekTime=0,this._reservedUint8=void 0,this._reservedMdatHeaders=[],this._cacheStats={done:!1,duration:0,byteSize:0}}destroy(){super.destroy()}}const $t={done:!1,duration:0,byteSize:0},Pt=new class extends O{constructor(){super(...arguments),this._waitingQueue=[],this._preloadActiveMap=new Map,this._preloadedAllSourceFlatMap=new Map,this._preloadedAllSourceDedupQueue=[],this._logger=T.createLogger("preloader"),this._config={maxPreloadedCount:6,maxPreloadDuration:5,maxPreloadByteSize:0,maxConcurrency:1,preloadTriggerPlayTime:0,preloadTriggerBufferDuration:3}}get triggerPlayTime(){return this._config.preloadTriggerPlayTime}get triggerBufferDuration(){return this._config.preloadTriggerBufferDuration}_preloadWithSource(e){const t=e.onDequeue?e.onDequeue(e):e,r=t.src,n=L.getUrl(r,0),i=L.getCacheKey(r)||"";if(!n)return void this.emit("error",new U(U.Code.MEDIA_EMPTY_SRC,"no empty src"));this._logger.info("preload next,",`priority=${t.priority}, url=${n}`);const o=t.loaderOptions?h.combineDefaultOptions(t.loaderOptions,{origin:J.PRELOAD}):void 0,s=new Ee({name:"preload.demux",parsers:[new At({cache:{maxDuration:this._config.maxPreloadDuration,maxByteSize:this._config.maxPreloadByteSize}})],loaderOptions:o}),a=s.getLoader();let l=!1;const c=()=>{l=!0,this.emit("preloadstart",_)},u=e=>{this.emit("downloaded",e)},d=()=>{a.on("downloaded",u),a.once("loadstart",c)},p=e=>{_.error=e,this.emit("error",e),l&&this.emit("preloadend",_),this.remove(i),this._preloadNext()};s.on("beforeload",d),s.on("error",p);const f=()=>{s.suspend(),s.off("cachedone",f),this._preloadActiveMap.delete(i),l&&this.emit("preloadend",_),this._preloadNext()};s.on("cachedone",f);const _={config:t,demuxStream:s,getCurrentUrl:()=>a.currentUrl,getStats:()=>s.getCacheStats()||$t,finish:()=>{a.off("loadstart",c),a.off("downloaded",u),s.off("cachedone",f),s.off("beforeload",d),s.off("error",p)}};return this._preloadActiveMap.set(i,_),this.addSource(_),s.load(r),_}_preloadNext(){const{maxConcurrency:e}=this._config;if(this._preloadActiveMap.size>=e)return;const t=this._waitingQueue.shift();if(!t)return void this.emit("drain");const r=this.getSource(t.src);return r?r.getStats().done?void 0:r.demuxStream.resume():this._preloadWithSource(t)}setConfig(e){Object.assign(this._config,e)}preload(){if(!this._waitingQueue.length)return;this._preloadActiveMap.forEach(e=>e.demuxStream.resume());const{maxConcurrency:e}=this._config,t=Math.min(e,this._waitingQueue.length);for(let e=0;e<t-this._preloadActiveMap.size;e++)this._preloadNext()}suspend(){this._preloadActiveMap.forEach(e=>e.demuxStream.suspend())}cancel(){this._preloadActiveMap.forEach(e=>e.demuxStream.suspend()),this._preloadActiveMap.clear()}extract(e){this._logger.info("extract, key=",e),this._waitingQueue=this._waitingQueue.filter(t=>!L.isContainCacheKey(t.src,e));const t=this._preloadedAllSourceFlatMap.get(e);if(this._preloadActiveMap.delete(e),t){const e=L.getCacheKey(t.config.src);this._preloadedAllSourceDedupQueue=this._preloadedAllSourceDedupQueue.filter(t=>!L.isContainCacheKey(t.config.src,e)),this._preloadedAllSourceFlatMap.delete(e)}return t}addSource(e){const t=L.getCacheKey(e.config.src);this._preloadedAllSourceFlatMap.set(t,e);const r=this._preloadedAllSourceDedupQueue;if(r.some(t=>L.isEqual(t.config.src,e.config.src)))return;r.push(e),r.sort((e,t)=>e.config.priority-t.config.priority);const{maxPreloadedCount:n}=this._config;r.length>n&&r.slice(0,r.length-n).forEach(e=>this.remove(L.getCacheKey(e.config.src)))}add(e){const t=this._preloadedAllSourceDedupQueue[0];if(t&&e.priority<t.config.priority)return void this._logger.warn("add failed, sourceConfig priority cannot be lower than min value in the preloaded queue");const r=this.getSource(e.src);if(r?(this._logger.info("add, source.config already in preloaded queue, config:",r.config,"->",e),r.config=e):(this._logger.info("add, source.config=",e),this._waitingQueue=this._waitingQueue.filter(t=>!L.isEqual(t.src,e.src))),this._waitingQueue.push(e),this._waitingQueue.sort((e,t)=>t.priority-e.priority),this._preloadActiveMap.size>=this._config.maxConcurrency){const t=this._preloadActiveMap.keys().next().value,r=t&&this._preloadActiveMap.get(t);if(r&&r.config.priority<e.priority){const e=r.demuxStream.getLoader().status===Q.LOADING;r.demuxStream.suspend(),this._preloadActiveMap.delete(t),e&&this._preloadNext()}}this._waitingQueue.length&&this.emit("added",e)}remove(e){const t=this.extract(e);t&&t.demuxStream.destroy()}getWaitQueue(){return this._waitingQueue}getSource(e){return this._preloadedAllSourceFlatMap.get(L.getCacheKey(e))}getCacheKeys(){return Array.from(this._preloadedAllSourceFlatMap.keys())}pull(e){const t=L.getCacheKey(e),r=this.extract(t);if(r)return r.finish(),r}clearWaitQueue(){const e=this._waitingQueue.length;this._waitingQueue=[],e&&this.emit("drain")}clearAll(){this.clearWaitQueue(),this.cancel(),this._preloadedAllSourceFlatMap.clear(),this._preloadedAllSourceDedupQueue.forEach(e=>e.demuxStream.destroy()),this._preloadedAllSourceDedupQueue=[]}};p()&&"1"===localStorage.getItem("ttplayer_preloader_debug")&&(window.__TTPlayerGlobalPreloader__=Pt);class Rt extends O{constructor(e,t){super(),this._lastCheckedTimestamp=0,this._lastCurrentTime=0,this._playing=!1,this._handleVideoTimeupdate=()=>{const e=c.getPerformanceNow();if(this._playing&&e-this._lastCheckedTimestamp>1e3){this._lastCheckedTimestamp=e;const t=this._video.currentTime;t-this._lastCurrentTime<.1?this._startStuckTimer():this._clearStuckTimer(),this._lastCurrentTime=t}},this._handleVideoEnded=()=>{this._clearStuckTimer()},this._handleVideoWaiting=()=>{this._startStuckTimer()},this._handleVideoPause=()=>{this._playing=!1,this._clearStuckTimer()},this._handleVideoPlay=()=>{this._playing=!0,this._clearStuckTimer(),this._lastCheckedTimestamp=c.getPerformanceNow()},this._clearStuckTimer=()=>{void 0!==this._waitTimer&&(window.clearTimeout(this._waitTimer),this._waitTimer=void 0)},this._startStuckTimer=()=>{const e=this._options.stuckTimeout||0;e>0&&(this._clearStuckTimer(),this._waitTimer=window.setTimeout(()=>{this.emit("timeout")},e))},this._video=e,this._options=h.combineDefaultOptions(t,{stuckTimeout:0})}enable(){const e=this._video;this._options.stuckTimeout>0&&(e.addEventListener("timeupdate",this._handleVideoTimeupdate),e.addEventListener("waiting",this._handleVideoWaiting),e.addEventListener("play",this._handleVideoPlay),e.addEventListener("pause",this._handleVideoPause),e.addEventListener("ended",this._handleVideoEnded))}disable(){const e=this._video;e.removeEventListener("timeupdate",this._handleVideoTimeupdate),e.removeEventListener("waiting",this._handleVideoWaiting),e.removeEventListener("play",this._handleVideoPlay),e.removeEventListener("pause",this._handleVideoPause),e.removeEventListener("ended",this._handleVideoEnded)}destroy(){this.removeAllListeners(),this._clearStuckTimer(),this.disable()}}const xt=T.createLogger("multiplex"),Lt=["error"],It=["progress"],Mt="demux",Dt={delay:0};class Bt extends O{constructor(e,t){super(),this._handleVideoError=()=>{const{error:e,currentSrc:t}=this._video,r={url:t},n=e?U.fromMediaError(e,r):new U(U.Code.OTHER,"unknown video error",r);this._downgrade(n)},this._handleError=e=>{const t=e instanceof U?e:new U(U.Code.OTHER,e.message);this._downgrade(t)},this._handleStuckTimeout=()=>{this._downgrade(new U(U.Code.RUNTIME_WAITING_TIMEOUT,"video playback is stuck timeout"))},this._handleDemuxBeforeLoad=()=>{this._demuxStream.getLoader().dedup("exception",e=>{this._controller.emit("exception",e)})},this._downgrade=e=>{this._prevMeta=void 0;const t=this._demuxStream.getLoader(),r=t.currentUrl,n=this._video;if(!Ke.isBlob(n.src)||n.src===r)return void this._controller.processError();const i=n.currentTime;xt.info("downgrade to h5 caused by multiplex error:",e.message),window.clearTimeout(this._levelTimer),this._demuxStream.abort(),this._remuxStream.reset(),this._mediaSourceStream.reset({clearTiming:We.DEFAULT}),this._mediaSourceStream.detach(),this._controller.enableEvents(It),this._videoBufferDetector.setTriggers([He.PROGRESS,He.TIMEUPDATE]),0===i&&this._controller.getInternalModule(B.POSTER).show(),this.emit("downgrade",e)&&(this._videoStuckDetector.disable(),this._controller.sourceIndex=t.currentSrcIndex,n.src=t.currentUrl,n.currentTime=i,xt.info("downgrade done, currentTime",n.currentTime))},this._handleControllerLoadedMetadata=()=>{this._videoBufferDetector.setAutoLevelCheck(!0)},this._handleVideoBufferChecking=(e,t)=>{const r=this._videoBufferDetector;if(r.level===Fe.LOW){if(this._demuxStream.stdout.size>0||this._remuxStream.stdin.size>0||this._remuxStream.stdout.size>0||this._mediaSourceStream.stdin.size>0)return;window.clearTimeout(this._levelTimer),this._demuxStream.resume()}else r.level===Fe.HIGH&&(window.clearTimeout(this._levelTimer),this._demuxStream.suspend());const n=this._preloader;if(!n)return;const i=this._video;if(i.autoplay&&!i.played.length)return;const o=i.currentTime,s=Math.max(t.end-o,0),a=Math.min(n.triggerBufferDuration,i.duration),l=Math.min(n.triggerPlayTime,i.duration/2),c=s>=a&&o>=l,u=o+s>=i.duration-1&&o+a>=i.duration-1;c||u?(this.emit("canpreload"),n.preload()):n.suspend(),(e===He.UPDATEEND||e===He.PROGRESS)&&this._controller.emit("progress")},this._handlePreloaderAdded=()=>{this._videoBufferDetector.startPolling()},this._handlePreloaderDrain=()=>{this._videoBufferDetector.stopPolling()},this._handleDemuxLevelChange=e=>{e===de.FULL&&(window.clearTimeout(this._levelTimer),this._levelTimer=window.setTimeout(()=>{this._demuxStream.stdout.level===de.FULL&&(this._demuxStream.suspend(),xt.warn("demux waterlevel change to full, abort request"))},1e3))},this._handleVideoLevelChange=(e,t)=>{const r=this._mediaSourceStream;xt.info("video levelchange",t,"->",e),e===Fe.HIGH?r.suspend():e===Fe.LOW&&r.resume()},this._handleMseStalled=()=>{const e=this._video.currentTime;xt.info("video mse seek stalled, currentTime:",e),this.reset(),this._demuxStream.seek(e)},this._options=h.combineDefaultOptions(t,{loaderOptions:{origin:J.DEFAULT}}),this._context=e;const r=this._controller=e.controller;r.on("loadedmetadata",this._handleControllerLoadedMetadata),this._demuxStream=new Ee({name:Mt,parsers:this._options.parsers,loaderOptions:this._options.loaderOptions}),this._demuxStream.stdout.on("levelchange",this._handleDemuxLevelChange),this._demuxStream.on("error",this._handleError),this._demuxStream.on("beforeload",this._handleDemuxBeforeLoad),this._remuxStream=new Ie({name:"remux"}),this._remuxStream.on("error",this._handleError);const n=this._video=r.getElement();n.addEventListener("error",this._handleVideoError);const i=new Ge(n,this._options);i.on("levelchange",this._handleVideoLevelChange),i.on("bufferchecking",this._handleVideoBufferChecking),i.on("error",this._handleError),O.remap(i,this._controller,{bufferchange:"progress"}),this._videoBufferDetector=i;const o=new Rt(n,this._options);o.on("timeout",this._handleStuckTimeout),this._videoStuckDetector=o;const s=new Ke(this._options);s.on("msestalled",this._handleMseStalled),s.on("error",this._handleError),s.attach(n,i),this._mediaSourceStream=s,this._setup()}_customizePosterBehavior(e){const{clearStrategy:t,clearTiming:r}=this._options;return r===We.NEXT_VIDEO_READY?(e.preventDefault(),t===qe.REUSE?void 0:t===qe.REUSE_EXCEPT_CODEC_CHANGE?t=>{var r;if((null==(r=t.value)?void 0:r.type)===we.LoadedMetadata){const r=this._prevMeta,n=t.value.payload;(!r||De(n)!==De(r)||Be(n)!==Be(r))&&e.show(),this._prevMeta=n}return t}:t=>{var r;return(null==(r=t.value)?void 0:r.type)===we.LoadedMetadata&&e.show(),t}):t===qe.REUSE?t=>{var r;return(null==(r=t.value)?void 0:r.type)===we.LoadedMetadata&&e.setTempHideOptions(Dt),t}:t===qe.REUSE_EXCEPT_CODEC_CHANGE?t=>{var r;if((null==(r=t.value)?void 0:r.type)===we.LoadedMetadata){const r=this._prevMeta,n=t.value.payload;r&&De(n)===De(r)&&Be(n)===Be(r)&&e.setTempHideOptions(Dt),this._prevMeta=n}return t}:void 0}_setup(){const{controller:e}=this._context,t=e.getInternalModule(B.POSTER),r=this._customizePosterBehavior(t);this._remuxStream.resume(),this._mediaSourceStream.resume(),this._demuxStream.pipe(this._remuxStream,r).pipe(this._mediaSourceStream),e.disableEvents(Lt),e.replaceGetter("rawSrc",()=>this._demuxStream.getLoader().currentUrl||this._video.currentSrc||""),e.replaceSetter("src",(e,t,r)=>{r!==t&&this._load(r)})}_load(e){const{_video:t,_mediaSourceStream:r,_videoBufferDetector:n}=this,{controller:i}=this._context,o=L.getUrl(e,0);if(xt.log("------------------------------ divider ------------------------------"),xt.info("url changed to",o),!o)return i.emit("error",new U(U.Code.MEDIA_EMPTY_SRC,"no empty src"));const{inherit:s}=L.getProps(e),a=i.getInternalModule(B.POSTER),l=this._customizePosterBehavior(a);window.clearTimeout(this._levelTimer);const c=this._video.currentTime,u=s?{clearTiming:We.DEFAULT,clearStrategy:qe.REUSE}:void 0;s||i.emit("playnext"),Pt.suspend();const d=Pt.pull(e);xt.info("preloader pull, source.config=",null==d?void 0:d.config),n.reset();try{const h=null==d?void 0:d.error,p=X.get(L.getCacheKey(e))||[];if(d&&!h){xt.info("use mse with preloaded source"),this._videoStuckDetector.enable();const e=d.getStats(),o=e.duration>0,a=d.demuxStream.getLoader().loadedCacheSize;xt.info(`preload info, preloadhit:${o}, preloadCacheSize:${a}, done:${e.done}, duration:${e.duration.toFixed(2)}, dataSize:${e.byteSize}`),this._demuxStream.unpipe(this._remuxStream),this._demuxStream.destroy(),this._demuxStream=d.demuxStream,this._demuxStream.stdout.on("levelchange",this._handleDemuxLevelChange),this._demuxStream.changeName(Mt),this._demuxStream.getLoader().changeOptions(this._options.loaderOptions),this._demuxStream.on("beforeload",this._handleDemuxBeforeLoad),this._demuxStream.on("error",this._handleError),this._remuxStream.on("error",this._handleError),this._remuxStream.reset(),i.disableEvents(It),n.setTriggers([He.UPDATEEND,He.TIMEUPDATE]),r.reset(u),r.attach(t,n),r.resume(),e.done&&d.demuxStream.stdout.size>0||this._demuxStream.resume(),this.emit("loadstart"),o&&(this.emit("preloadhit",d),this.emit("cachehit",p)),a&&this.emit("localcachehit"),this._demuxStream.pipe(this._remuxStream,l),s&&c>0&&this._demuxStream.seek(c)}else if(!p.length&&this._options.fallback)h&&this.emit("downgrade",h),xt.info("use pure <video />"),this._videoStuckDetector.disable(),this._demuxStream.abort(),this._demuxStream.reset(),this._remuxStream.reset(),r.reset(),r.detach(),n.setTriggers([He.PROGRESS,He.TIMEUPDATE]),i.enableEvents(It),a.show(),d&&(this._controller.sourceIndex=d.demuxStream.getLoader().currentSrcIndex),t.src=o,this.emit("loadstart"),s&&c>0&&(t.currentTime=c);else{xt.info("use mse"),this._videoStuckDetector.enable(),this._demuxStream.abort(),this._demuxStream.reset(),this._remuxStream.reset(),i.disableEvents(It),n.setTriggers([He.UPDATEEND,He.TIMEUPDATE]),r.reset(u),r.attach(t,n),r.resume(),this._demuxStream.load(e);const o=this._demuxStream.getLoader().loadedCacheSize;xt.info(`cache info, startCacheSize:${o}`),this.emit("loadstart"),o&&(this.emit("cachehit",p),this.emit("localcachehit")),s&&c>0&&this._demuxStream.seek(c)}}catch(e){e instanceof U||xt.error(e),this._handleError(e)}}getNetworkMonitor(){return this._demuxStream.getLoader().network}setPreloader(e){this._preloader&&(this._preloader.off("added",this._handlePreloaderAdded),this._preloader.off("drain",this._handlePreloaderDrain)),e&&(e.on("added",this._handlePreloaderAdded),e.on("drain",this._handlePreloaderDrain)),this._preloader=e}changeOptions(e){this._options={...this._options,...e},this._demuxStream.changeOptions(this._options)}printDebugMessage(){xt.log("\ndemux.stdout: \n ",this._demuxStream.stdout,"\nremux.stdin: \n ",this._remuxStream.stdin,"\nremux.stdout: \n ",this._remuxStream.stdout,"\nmss.stdout: \n ",this._mediaSourceStream.stdin)}suspend(){return this._demuxStream.suspend()}resume(){return this._demuxStream.resume()}getMetadata(){return this._mediaSourceStream.metadata}reset(){window.clearTimeout(this._levelTimer),this._demuxStream.abort(),this._remuxStream.suspend(),this._mediaSourceStream.suspend(),this._demuxStream.flush(),this._remuxStream.flush(),this._mediaSourceStream.flush(),this._mediaSourceStream.resume(),this._remuxStream.resume()}destroy(){const{controller:e}=this._context;this.setPreloader(null),this._prevMeta=void 0,this._video.removeEventListener("error",this._handleVideoError),this._videoBufferDetector.destroy(),this._videoStuckDetector.destroy(),e.replaceSetter("rawSrc",null),e.replaceSetter("src",null),e.enableEvents(Lt),e.enableEvents(It),window.clearTimeout(this._levelTimer),this._demuxStream.destroy(),this._remuxStream.destroy(),this._mediaSourceStream.destroy()}}class Nt extends O{constructor(e){super(),this._logger=T.createLogger("multiplex"),this._remapOffCallbacks=[],this.name="multiplex",this._options=e}install(e){const{loaderOptions:t}=this._options;if(t)if("fetch"===t.type){if(!te.isSupported())return void this._logger.warn("The browser does not support [Fetch API], the plugin will disabled when loaderType='fetch'");se(te)}else"xhr"===t.type?se(ne):se(null);this.core=new Bt(e,this._options),this._preloader&&this.core.setPreloader(this._preloader),this._remapOffCallbacks=O.remap(this.core,this,{canpreload:"canpreload",cachehit:"cachehit",localcachehit:"localcachehit",preloadhit:"preloadhit",downgrade:"downgrade",loadstart:"loadstart"}).concat(O.remap(this.core.getNetworkMonitor(),this,{downloaded:"downloaded"}))}changeOptions(e){this.core?this.core.changeOptions(e):this._options=h.combineDefaultOptions(this._options,e)}setPreloader(e){this.core?this.core.setPreloader(e):e&&(this._preloader=e)}getMetadata(){var e;return null==(e=this.core)?void 0:e.getMetadata()}resume(){var e;return null==(e=this.core)?void 0:e.resume()}suspend(){var e;return null==(e=this.core)?void 0:e.suspend()}reset(){var e;return null==(e=this.core)?void 0:e.reset()}uninstall(){var e;null==(e=this.core)||e.destroy(),this._remapOffCallbacks.forEach(e=>e())}}var jt=r(23039),Ut=r(42780),Vt=Object.defineProperty,Ft=(e,t,r)=>((e,t,r)=>t in e?Vt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Ht{constructor(){this._events=[],this._callbacks={}}register(e){this._events.includes(e)||this._events.push(e)}on(e,t){return!!this._events.includes(e)&&(this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),!0)}off(e,t){if(!this._events.includes(e)||!this._callbacks[e])return!1;const r=this._callbacks[e].indexOf(t);return this._callbacks[e].splice(r,1),!0}bind(e,t){if(!this._events.includes(e))return!1;this._callbacks[e]=[],this._callbacks[e].push(t)}clear(e){this._callbacks[e]=[]}trigger(e,t){if(!this._callbacks[e]||!this._callbacks[e].length)return!1;let r=null;return this._callbacks[e].forEach((e,n)=>{0==n?r=e(t):e(t)}),r}set events(e){e.forEach(e=>{this.register(e)})}get events(){return this._events}}const Gt=[new RegExp("(\\?|&)expire=([^&]*)(&|$)"),new RegExp("(\\?|&)x-tos-expires=([^&]*)(&|$)"),new RegExp("(\\?|&)x-expires=([^&]*)(&|$)")];function Wt(e){if(!e||"string"!=typeof e)return 0;let t=0;try{const r=[];if(Gt.forEach(t=>{const n=e.match(t);n&&r.push(n)}),r.length>0)t=parseInt(r[0][2],10);else{const r=e.split("/");r.length>5&&8===r[4].length&&(t=parseInt(r[4],16))}if(t>0){const e=new Date;return t<=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),0)/1e3?1:2}return 0}catch{return 0}}const qt={v360:{width:640,height:360},v480:{width:800,height:480},v540:{width:960,height:540},v720:{width:1280,height:720},v864:{width:1536,height:864},v960:{width:1706,height:960},v1080:{width:1920,height:1080},v2k:{width:2560,height:1440},v4k:{width:3840,height:2160}};class Kt{constructor(){this.ladder=null,this._mvmaf="",this._vqscore=0,this.width=0,this.height=0,this.playedDuration=0}set mvmaf(e){if(e)try{this._mvmaf=e;let t=JSON.parse(e);t["v2.0"]&&(this.ladder=t["v2.0"])}catch{}}get mvmaf(){return this._mvmaf}set vqscore(e){e&&(this._vqscore=e)}get vqscore(){return this._vqscore}_findNearestPlaybackScore(){let e=0;if(!this.ladder)return 0;let t=this.width*this.height,r="v540",n=Number.MAX_VALUE;for(let e in qt){const i=qt[e];let o=t-i.width*i.height;Math.abs(o)<n&&(n=Math.abs(o),r=e)}const i=qt[r].width*qt[r].height;if(Math.abs(i-t)<=.1*i&&this.ladder&&this.ladder.ori&&this.ladder.ori[r])return this.ladder.ori[r];if(this.ladder&&this.ladder.ori){let t=this.ladder.ori,n=Object.keys(t);if(1==n.length)return t[n[0]];{n.sort();let i=qt[n[0]].width*qt[n[0]].height,o=t[n[0]],s=qt[n[n.length-1]].width*qt[n[n.length-1]].height,a=t[n[n.length-1]],l=qt[r].width*qt[r].height;e=o+((l-i)*a-(l-i)*o)/(s-i)}}return e}exportData(){if(this.playedDuration<=0)return{};const e=this._findNearestPlaybackScore();let t=100-(100-e)*Math.exp(this._vqscore/100-1);return{vqs:this._vqscore,vms:e,vods:t,mvmaf:this._mvmaf,pr:"w:"+this.width+",h:"+this.height+",srf:0,wt:"+this.playedDuration,v:2}}reset(){this._mvmaf="",this._vqscore=0,this.ladder=null,this.width=0,this.height=0,this.playedDuration=0}}class zt{constructor(e,t){this.name=e,t&&this.reset()}startTimer(){this.started=!0;const e=window.performance;this.startTime=e?e.now():Date.now()}stopTimer(){if(this.started){const e=window.performance;this.endTime=e?e.now():Date.now(),this.duration=this.endTime-this.startTime,this.started=!1}}reset(){this.started=!1,this.startTime=-1,this.endTime=-1,this.duration=0}exportData(){return{duration:this.duration,gpu:"",score:-2,vendor:""}}}class Zt extends zt{constructor(){super("VideoRequest",!0)}}class Yt extends zt{constructor(){super("VideoRequestResponse",!0)}}class Xt extends zt{constructor(){super("BlockStart",!0),this.blockType=0}setBlockType(e){if(e&&e.element){const{readyState:t,seeking:r}=e.element;this.blockType=t<1?1:r?2:0}}exportData(e){var t;const r=(null==(t=null==e?void 0:e.element)?void 0:t.currentTime)||0;return{blockType:this.blockType,currentTime:r,...super.exportData()}}}class Qt extends zt{constructor(){super("Block",!0)}exportData(e,t={blockType:0}){var r;return{...t,currentTime:(null==(r=null==e?void 0:e.element)?void 0:r.currentTime)||0,...super.exportData()}}}class Jt extends zt{constructor(){super("PlayQuality",!0),this.loadedTime=0,this.durationFromLoaded=0,this.durationWithLoaded=0}reset(){super.reset(),this.loadedTime=0,this.durationFromLoaded=0,this.durationWithLoaded=0}}class er extends zt{constructor(e){super("PlayEnded",!1),this.videoQualityHelper=new Kt,this.currentTime=0,this.status=e,this.reset()}startPauseTimer(){const e=window.performance;this.pauseStartTime=e?e.now():Date.now(),this.paused=!0}stopPauseTimer(){if(this.paused){const e=window.performance;this.pauseStopTime=e?e.now():Date.now(),this.pauseDuration+=this.pauseStopTime-this.pauseStartTime}}reset(){super.reset(),this.paused=!1,this.pauseStartTime=-1,this.pauseStopTime=-1,this.pauseDuration=0,this.currentTime=0,this.videoQualityHelper&&this.videoQualityHelper.reset()}exportData(){let e=super.exportData();this.videoQualityHelper.playedDuration=this.duration-this.pauseDuration;let t=this.videoQualityHelper.exportData();return Object.assign({},e,{pauseDuration:this.pauseDuration,currentTime:this.currentTime,vqm:t})}copy(e){this.duration=e.duration,this.currentTime=e.currentTime,this.pauseDuration=e.pauseDuration,e.videoQualityHelper&&(this.videoQualityHelper.mvmaf=e.videoQualityHelper.mvmaf,this.videoQualityHelper.vqscore=e.videoQualityHelper.vqscore,this.videoQualityHelper.width=e.videoQualityHelper.width,this.videoQualityHelper.height=e.videoQualityHelper.height,this.videoQualityHelper.playedDuration=e.videoQualityHelper.playedDuration)}set mvmaf(e){e&&(this.videoQualityHelper.mvmaf=e)}set vqscore(e){e&&(this.videoQualityHelper.vqscore=e)}set width(e){this.videoQualityHelper.width=e}set height(e){this.videoQualityHelper.height=e}}class tr extends zt{constructor(){super("PlayFailed",!0),this.loadStartRetry=[]}getRetryData(){return{retryCount:this.loadStartRetry.length,retryList:this.loadStartRetry}}exportData(e,t,r){let n=super.exportData(),i=-1,o="",s=-1,a="";return e&&e.element&&(i=e.element.currentTime,o=e.element.currentSrc,e.element.error&&(s=e.element.error.code,a=e.element.error.message)),t&&(t.url&&(o=t.url),s=t.errorCode,a=t.message),Object.assign({},n,{status:r,code:s,message:a,url:o,isExpired:Wt(o),currentTime:i,retryCount:this.loadStartRetry.length,retryList:this.loadStartRetry})}}class rr extends zt{constructor(){super("FirstFrame",!0)}}class nr extends zt{constructor(){super("VideoDataSize",!0)}}const ir="MultimediaMetrics";class or extends Ht{constructor(e,t){super(),Ft(this,"_onPlay",()=>{var e,t;const r=(null==(t=null==(e=this._player)?void 0:e.element)?void 0:t.readyState)||0;this.status<1&&r>2&&(this.trigger(this.videoRequest.name,this.videoRequest.exportData()),this.trigger(this.videoRequestResponse.name,this.videoRequestResponse.exportData()),this.status=1),this.playEnded.paused&&this.playEnded.stopPauseTimer()}),Ft(this,"_onPause",()=>{this.block.started&&this.block.reset(),this.playEnded.startPauseTimer()}),Ft(this,"_onPlaying",()=>{if(this.status>-1&&(this.status=3),this.block.started){this.block.stopTimer();const{blockType:e}=this.blockStart;this.trigger(this.block.name,this.block.exportData(this._player,{blockType:e}))}this._player.element&&(this.playEnded.width=this._player.element.videoWidth,this.playEnded.height=this._player.element.videoHeight)}),Ft(this,"_onTimeupdate",()=>{!this._player||!this._player.element||(this.playEnded.currentTime=this._player.element.currentTime)}),Ft(this,"_onEnded",()=>{this.status=2}),Ft(this,"_onWaiting",()=>{!this._player||!this._player.element||3==this._status&&(this._player.element.paused||this._player.state!==Ut.R.ACTIVE||(this.blockStart.setBlockType(this._player),this.trigger(this.blockStart.name,this.blockStart.exportData()),this.block.startTimer()))}),Ft(this,"_onError",e=>{this.trigger(this.playFailed.name,this.playFailed.exportData(this._player,e,this._status))}),Ft(this,"_onSourceError",e=>{const{host:t,errorCode:r,message:n,src:i}=e;this.playFailed.loadStartRetry.push({host:t,code:r,message:n,isExpired:Wt(i)})}),Ft(this,"_onLoadstart",()=>{this.status=1,this.trigger(this.videoRequest.name,this.videoRequest.exportData()),this.playQuality.startTimer(),this.videoRequestResponse.startTimer(),this.firstFrame.startTimer()}),Ft(this,"_onSeeking",()=>{var e,t;const r=this._player.buffered;let n=-1,i=-1;r&&r.length>0&&(n=r.start(0),i=r.end(0)),(0,Ut.l)(ir,"_onSeeking",null==(e=this._player)?void 0:e.uuid,null==(t=this._player)?void 0:t.vid,`readyState:${this._player.element.readyState} start:${n} end:${i}`)}),Ft(this,"_onLoadeddata",()=>{this.videoRequestResponse.stopTimer(),this._loadedTime=window.performance?window.performance.now():Date.now(),this.playQuality.durationWithLoaded=this._loadedTime-this.playQuality.startTime,this.trigger(this.videoRequestResponse.name,this.videoRequestResponse.exportData())}),Ft(this,"_onPlayCatch",()=>{this.xgDowngraded=!0}),Ft(this,"_onDownloaderChunkReady",e=>{this.trigger(this.videoDataSize.name,e)}),Ft(this,"_onProgress",()=>{if(!this._player||!this.xgDowngraded&&"RAW"!=this._player.type||!this.config||!this.config.bitrate)return;const e=this._player.element.buffered;let t=0;for(let r=0;r<e.length;r++)t+=e.end(r)-e.start(r);const r=t*this.config.bitrate/8;this.trigger(this.videoDataSize.name,{chunkSize:r,speed:this.config.bitrate/1024})}),Ft(this,"initEvent",e=>{const t=e||this.event;t&&(t.on("play",this._onPlay),t.on("pause",this._onPause),t.on("playing",this._onPlaying),t.on("timeupdate",this._onTimeupdate),t.on("ended",this._onEnded),t.on("waiting",this._onWaiting),t.on("error",this._onError),t.on("source_error",this._onSourceError),t.on("loadstart",this._onLoadstart),t.on("loadeddata",this._onLoadeddata),t.on("playCatch",this._onPlayCatch),t.on("downloaderChunkReady",this._onDownloaderChunkReady),t.on("progress",this._onProgress),t.on("seeking",this._onSeeking))}),Ft(this,"removeEvent",e=>{const t=e||this.event;t&&(t.off("play",this._onPlay),t.off("pause",this._onPause),t.off("playing",this._onPlaying),t.off("timeupdate",this._onTimeupdate),t.off("ended",this._onEnded),t.off("waiting",this._onWaiting),t.off("error",this._onError),t.off("source_error",this._onSourceError),t.off("loadstart",this._onLoadstart),t.off("loadeddata",this._onLoadeddata),t.off("playCatch",this._onPlayCatch),t.off("downloaderChunkReady",this._onDownloaderChunkReady),t.off("progress",this._onProgress),t.off("seeking",this._onSeeking))}),Ft(this,"stop",()=>{var e,t;-1!=this._status&&((0,Ut.l)(ir,"stop",null==(e=this._player)?void 0:e.uuid,null==(t=this._player)?void 0:t.vid),this.reset(),this.lastPlayEnded&&(this.trigger(this.lastPlayEnded.name,this.lastPlayEnded.exportData()),this.lastPlayEnded=null))}),Ft(this,"reset",()=>{var e,t;(0,Ut.l)(ir,"reset",null==(e=this._player)?void 0:e.uuid,null==(t=this._player)?void 0:t.vid),this.playEnded.started&&this.playEnded.stopTimer(),this.lastPlayEnded=new er(this._status),this.lastPlayEnded.copy(this.playEnded),this.status=-1,this.xgDowngraded=!1,this.videoRequest.reset(),this.videoRequestResponse.reset(),this.blockStart.reset(),this.block.reset(),this.playQuality.reset(),this.playEnded.reset(),this.playFailed.reset(),this.firstFrame.reset(),this._loadedTime=0}),this.event=e,this.config=t,this._status=-1,this.initEvent(),this._player=null,this.xgDowngraded=!1,this.videoRequest=new Zt,this.videoRequestResponse=new Yt,this.blockStart=new Xt,this.block=new Qt,this.playQuality=new Jt,this.lastPlayEnded=null,this.playEnded=new er(this._status),this.playFailed=new tr,this.firstFrame=new rr,this.videoDataSize=new nr,this.events=[this.videoDataSize.name,this.videoRequest.name,this.videoRequestResponse.name,this.blockStart.name,this.block.name,this.playQuality.name,this.playEnded.name,this.playFailed.name,this.firstFrame.name],this.startInitInfo={},this._loadedTime=0}static get version(){return jt.v}getCommonData(e){const{element:t,config:r,type:n,state:i}=e;return{currentTime:(null==t?void 0:t.currentTime)||0,videoDuration:(null==t?void 0:t.duration)||0,codecType:(null==r?void 0:r.codecType)||"h264",vtype:(null==r?void 0:r.vtype)||"MP4",playerType:n||"default",renderState:i||Ut.R.ACTIVE}}setConfig(e){e&&e.bitrate&&(this.config.bitrate=e.bitrate)}set player(e){this._player=e,e&&(this._player.mvmaf&&(this.playEnded.mvmaf=this._player.mvmaf),this._player.vqscore&&(this.playEnded.vqscore=this._player.vqscore))}get status(){return this._status}set status(e){if(1===this._status&&3===e){this.playQuality.stopTimer(),this.playEnded.startTimer(),this.firstFrame.stopTimer(),this.playQuality.durationFromLoaded=this.playQuality.endTime-this._loadedTime;const{durationWithLoaded:e,durationFromLoaded:t}=this.playQuality,r={...this.playQuality.exportData(),...this.playFailed.getRetryData(),durationWithLoaded:e,durationFromLoaded:t};this.trigger(this.playQuality.name,r),this.trigger(this.firstFrame.name,r)}this._status=e}setStartInitInfo(e){(0,Ut.l)(ir,"setStartInitInfo",e),this.startInitInfo=e}trigger(e,t){const r=this.getCommonData(this._player);super.trigger(e,{...r,...t,startInfo:this.startInitInfo||{}})}release(){const{_callbacks:e}=this;Object.keys(e).forEach(t=>{(e[t]||[]).forEach(e=>{this.off(t,e)})}),this.removeEvent(),this._player=null,this._events=[],this.event=null}}var sr=r(28820),ar=r(80249);function lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function cr(e,t,r){return t=_r(t),br(e,gr()?Reflect.construct(t,r||[],_r(e).constructor):t.apply(e,r))}function ur(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kr(n.key),n)}}function hr(e,t,r){return t&&dr(e.prototype,t),r&&dr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pr(e,t,r){return(t=kr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fr(){return fr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_r(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},fr.apply(null,arguments)}function _r(e){return(_r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wr(e,t)}function gr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(gr=function(){return!!e})()}function mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(r),!0).forEach(function(t){pr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function br(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function wr(e,t){return(wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Cr(e,t,r,n){var i=fr(_r(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Er(e){return function(e){if(Array.isArray(e))return lr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return lr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function Tr(e){return(Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Sr=r(42990),Or=r.n(Sr),Ar="undefined"!=typeof window&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,$r={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},Pr="%c[xgplayer]",Rr={config:{debug:Ar?3:0},logInfo:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=3&&(t=console).log.apply(t,[Pr,$r.info,e].concat(n))},logWarn:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=1&&(t=console).warn.apply(t,[Pr,$r.warn,e].concat(n))},logError:function(e){var t;if(!(this.config.debug<1)){for(var r=this.config.debug>=2?"trace":"error",n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console)[r].apply(t,[Pr,$r.error,e].concat(i))}}},xr=function(){return hr(function e(t){ur(this,e),this.bufferedList=t},[{key:"start",value:function(e){return this.bufferedList[e].start}},{key:"end",value:function(e){return this.bufferedList[e].end}},{key:"length",get:function(){return this.bufferedList.length}}])}(),Lr={};function Ir(e){var t=Tr(e);return null!==e&&("object"===t||"function"===t)}Lr.createDom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach(function(t){var n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)}),i},Lr.createDomFromHtml=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var n=document.createElement("div");n.innerHTML=e;var i=n.children;return n=null,i.length>0?(i=i[0],r&&Lr.addClass(i,r),t&&Object.keys(t).forEach(function(e){i.setAttribute(e,t[e])}),i):null}catch(e){return Rr.logError("util.createDomFromHtml",e),null}},Lr.hasClass=function(e,t){if(!e||!t)return!1;try{return Array.prototype.some.call(e.classList,function(e){return e===t})}catch(n){var r=e.className&&"object"===Tr(e.className)?e.getAttribute("class"):e.className;return r&&!!r.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}},Lr.addClass=function(e,t){if(e&&t)try{t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&e.classList.add(t)})}catch(r){Lr.hasClass(e,t)||(e.className&&"object"===Tr(e.className)?e.setAttribute("class",e.getAttribute("class")+" "+t):e.className+=" "+t)}},Lr.removeClass=function(e,t){if(e&&t)try{t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&e.classList.remove(t)})}catch(r){Lr.hasClass(e,t)&&t.split(/\s+/g).forEach(function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className&&"object"===Tr(e.className)?e.setAttribute("class",e.getAttribute("class").replace(r," ")):e.className=e.className.replace(r," ")})}},Lr.toggleClass=function(e,t){e&&t.split(/\s+/g).forEach(function(t){Lr.hasClass(e,t)?Lr.removeClass(e,t):Lr.addClass(e,t)})},Lr.classNames=function(){for(var e=arguments,t=[],r=function(r){"String"===Lr.typeOf(e[r])?t.push(e[r]):"Object"===Lr.typeOf(e[r])&&Object.keys(e[r]).map(function(n){e[r][n]&&t.push(n)})},n=0;n<arguments.length;n++)r(n);return t.join(" ")},Lr.findDom=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1?arguments[1]:void 0;try{e=t.querySelector(r)}catch(n){Rr.logError("util.findDom",n),0===r.indexOf("#")&&(e=t.getElementById(r.slice(1)))}return e},Lr.getCss=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,!1)[t]},Lr.padStart=function(e,t,r){for(var n=String(r),i=0|t,o=Math.ceil(i/n.length),s=[],a=String(e);o--;)s.push(n);return s.join("").substring(0,i-a.length)+a},Lr.format=function(e){if(window.isNaN(e))return"";e=Math.round(e);var t=Lr.padStart(Math.floor(e/3600),2,0),r=Lr.padStart(Math.floor((e-3600*t)/60),2,0),n=Lr.padStart(Math.floor(e-3600*t-60*r),2,0);return("00"===t?[r,n]:[t,r,n]).join(":")},Lr.event=function(e){if(e.touches){var t=e.touches[0]||e.changedTouches[0];e.clientX=t.clientX||0,e.clientY=t.clientY||0,e.offsetX=t.pageX-t.target.offsetLeft,e.offsetY=t.pageY-t.target.offsetTop}e._target=e.target||e.srcElement},Lr.typeOf=function(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]},Lr.deepCopy=function(e,t){if("Object"===Lr.typeOf(t)&&"Object"===Lr.typeOf(e))return Object.keys(t).forEach(function(r){"Object"!==Lr.typeOf(t[r])||t[r]instanceof Node?"Array"===Lr.typeOf(t[r])?e[r]="Array"===Lr.typeOf(e[r])?e[r].concat(t[r]):t[r]:e[r]=t[r]:void 0===e[r]||void 0===e[r]?e[r]=t[r]:Lr.deepCopy(e[r],t[r])}),e},Lr.deepMerge=function(e,t){return Object.keys(t).map(function(r){var n;"Array"===Lr.typeOf(t[r])&&"Array"===Lr.typeOf(e[r])?"Array"===Lr.typeOf(e[r])&&(n=e[r]).push.apply(n,Er(t[r])):Lr.typeOf(e[r])!==Lr.typeOf(t[r])||null===e[r]||"Object"!==Lr.typeOf(e[r])||t[r]instanceof window.Node?null!==t[r]&&(e[r]=t[r]):Lr.deepMerge(e[r],t[r])}),e},Lr.getBgImage=function(e){var t=(e.currentStyle||window.getComputedStyle(e,null)).backgroundImage;if(!t||"none"===t)return"";var r=document.createElement("a");return r.href=t.replace(/url\("|"\)/g,""),r.href},Lr.copyDom=function(e){if(e&&1===e.nodeType){var t=document.createElement(e.tagName);return Array.prototype.forEach.call(e.attributes,function(e){t.setAttribute(e.name,e.value)}),e.innerHTML&&(t.innerHTML=e.innerHTML),t}return""},Lr.setInterval=function(e,t,r,n){e._interval[t]||(e._interval[t]=window.setInterval(r.bind(e),n))},Lr.clearInterval=function(e,t){clearInterval(e._interval[t]),e._interval[t]=null},Lr.setTimeout=function(e,t,r){e._timers||(e._timers=[]);var n=setTimeout(function(){t(),Lr.clearTimeout(e,n)},r);return e._timers.push(n),n},Lr.clearTimeout=function(e,t){var r=e._timers;if("Array"===Lr.typeOf(r)){for(var n=0;n<r.length;n++)if(r[n]===t){r.splice(n,1),clearTimeout(t);break}}else clearTimeout(t)},Lr.clearAllTimers=function(e){var t=e._timers;"Array"===Lr.typeOf(t)&&(t.map(function(e){clearTimeout(e)}),e._timerIds=[])},Lr.createImgBtn=function(e,t,r,n){var i,o,s,a=Lr.createDom("xg-".concat(e),"",{},"xgplayer-".concat(e,"-img"));return a.style.backgroundImage='url("'.concat(t,'")'),r&&n&&(["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(e){return!(r.indexOf(e)>-1&&n.indexOf(e)>-1&&(i=parseFloat(r.slice(0,r.indexOf(e)).trim()),o=parseFloat(n.slice(0,n.indexOf(e)).trim()),s=e,1))}),a.style.width="".concat(i).concat(s),a.style.height="".concat(o).concat(s),a.style.backgroundSize="".concat(i).concat(s," ").concat(o).concat(s),a.style.margin="start"===e?"-".concat(o/2).concat(s," auto auto -").concat(i/2).concat(s):"auto 5px auto 5px"),a},Lr.Hex2RGBA=function(e,t){var r=[];if(/^\#[0-9A-F]{3}$/i.test(e)){var n="#";e.replace(/[0-9A-F]/gi,function(e){n+=e+e}),e=n}return/^#[0-9A-F]{6}$/i.test(e)?(e.replace(/[0-9A-F]{2}/gi,function(e){r.push(parseInt(e,16))}),"rgba(".concat(r.join(","),", ").concat(t,")")):"rgba(255, 255, 255, 0.1)"},Lr.getFullScreenEl=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Lr.checkIsFunction=function(e){return e&&"function"==typeof e},Lr.checkIsObject=function(e){return null!==e&&"object"===Tr(e)},Lr.hide=function(e){e.style.display="none"},Lr.show=function(e,t){e.style.display=t||"block"},Lr.isUndefined=function(e){if(null==e)return!0},Lr.isNotNull=function(e){return!(null==e)},Lr.setStyleFromCsstext=function(e,t){t&&("String"===Lr.typeOf(t)?t.replace(/\s+/g,"").split(";").map(function(t){if(t){var r=t.split(":");r.length>1&&(e.style[r[0]]=r[1])}}):Object.keys(t).map(function(r){e.style[r]=t[r]}))},Lr.filterStyleFromText=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],r=e.style.cssText;if(!r)return{};var n=r.replace(/\s+/g,"").split(";"),i={},o={};return n.map(function(e){if(e){var r=e.split(":");r.length>1&&(function(e,t){for(var r=0,n=t.length;r<n;r++)if(e.indexOf(t[r])>-1)return!0;return!1}(r[0],t)?i[r[0]]=r[1]:o[r[0]]=r[1])}}),e.setAttribute("style",""),Object.keys(o).map(function(t){e.style[t]=o[t]}),i},Lr.getStyleFromCsstext=function(e){var t=e.style.cssText;if(!t)return{};var r=t.replace(/\s+/g,"").split(";"),n={};return r.map(function(e){if(e){var t=e.split(":");t.length>1&&(n[t[0]]=t[1])}}),n},Lr.preloadImg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e){var n=new window.Image;n.onload=function(e){n=null,t&&t(e)},n.onerror=function(e){n=null,r&&r(e)},n.src=e}},Lr.stopPropagation=function(e){e&&e.stopPropagation()},Lr.scrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},Lr.scrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},Lr.checkTouchSupport=function(){return"ontouchstart"in window},Lr.getBuffered2=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=[],n=0;n<e.length;n++)r.push({start:e.start(n)<.5?0:e.start(n),end:e.end(n)});r.sort(function(e,t){return e.start-t.start||t.end-e.end});var i=[];if(t)for(var o=0;o<r.length;o++){var s=i.length;if(s){var a=i[s-1].end;r[o].start-a<t?r[o].end>a&&(i[s-1].end=r[o].end):i.push(r[o])}else i.push(r[o])}else i=r;return new xr(i)},Lr.getEventPos=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.touches&&e.touches.length>0&&(e=e.touches[0]),{x:e.x/t,y:e.y/t,clientX:e.clientX/t,clientY:e.clientY/t,offsetX:e.offsetX/t,offsetY:e.offsetY/t,pageX:e.pageX/t,pageY:e.pageY/t}},Lr.requestAnimationFrame=function(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(t)return t(e)},Lr.getHostFromUrl=function(e){if("String"!==Lr.typeOf(e))return"";var t=e.split("/"),r="";return t.length>3&&t[2]&&(r=t[2]),r},Lr.cancelAnimationFrame=function(e){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;t&&t(e)},Lr.isMSE=function(e){return e.media&&(e=e.media),!!(e&&e instanceof HTMLMediaElement)&&(/^blob/.test(e.currentSrc)||/^blob/.test(e.src))},Lr.isBlob=function(e){return"string"==typeof e&&/^blob/.test(e)},Lr.generateSessionId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(new Date).getTime();try{e=parseInt(e)}catch(t){e=0}t+=e,window.performance&&"function"==typeof window.performance.now&&(t+=parseInt(window.performance.now()));var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?r:3&r|8).toString(16)});return r},Lr.createEvent=function(e){var t;return"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t},Lr.adjustTimeByDuration=function(e,t,r){return t&&e&&(e>t||r&&e<t)?t:e},Lr.createPositionBar=function(e,t){var r=Lr.createDom("xg-bar","",{"data-index":-1},e);return t.appendChild(r),r},Lr.getTransformStyle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,scale:1,rotate:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r={scale:"".concat(e.scale||1),translate:"".concat(e.x||0,"%, ").concat(e.y||0,"%"),rotate:"".concat(e.rotate||0,"deg")};return Object.keys(r).forEach(function(e){var n=new RegExp("".concat(e,"\\([^\\(]+\\)"),"g"),i="".concat(e,"(").concat(r[e],")");n.test(t)?(n.lastIndex=-1,t=t.replace(n,i)):t+="".concat(i," ")}),t},Lr.convertDeg=function(e){return Math.abs(e)<=1?360*e:e%360},Lr.getCurrentTimeByOffset=function(e,t){var r=-1;if(!t||t.length<0)return e;for(var n=0;n<t.length;n++)if(e<=t[n].duration){r=n;break}if(-1!==r){var i=t[r].start;return r-1<0?i+e:i+(e-t[r-1].duration)}return e},Lr.getIndexByTime=function(e,t){var r=t.length,n=-1;if(r<1)return n;if(e<=t[0].end||r<2)n=0;else if(e>t[r-1].end)n=r-1;else for(var i=1;i<r;i++)if(e>t[i-1].end&&e<=t[i].end){n=i;break}return n},Lr.getOffsetCurrentTime=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if((r=n>=0&&n<t.length?n:Lr.getIndexByTime(e,t))<0)return-1;var i=t.length,o=t[r],s=o.start,a=o.end,l=o.cTime,c=o.offset;return e<s?l:e>=s&&e<=a?e-c:e>a&&r>=i-1?a-c:-1};var Mr=/(Android)\s([\d.]+)/,Dr=/(Version)\/([\d.]+)/,Br=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],Nr={get device(){return Nr.os.isPc?"pc":"mobile"},get browser(){if("undefined"==typeof navigator)return"";var e=navigator.userAgent.toLowerCase(),t={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(t).filter(function(r){return t[r].test(e)}))[0]},get os(){if("undefined"==typeof navigator)return{};var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,s=o||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e),a=/(?:iPhone)/.test(e)&&!s;return{isTablet:s,isPhone:a,isIpad:o,isIos:a||o,isAndroid:n,isPc:!(a||n||r||s),isSymbian:r,isWindowsPhone:t,isFireFox:i}},get osVersion(){if("undefined"==typeof navigator)return 0;var e=navigator.userAgent,t="",r=(t=/(?:iPhone)|(?:iPad|PlayBook)/.test(e)?Dr:Mr)?t.exec(e):[];if(r&&r.length>=3){var n=r[2].split(".");return n.length>0?parseInt(n[0]):0}return 0},get isWeixin(){return"undefined"!=typeof navigator&&!!/(micromessenger)\/([\d.]+)/.exec(navigator.userAgent.toLocaleLowerCase())},isSupportMP4:function(){var e={isSupport:!1,mime:""};if("undefined"==typeof document)return e;if(this.supportResult)return this.supportResult;var t=document.createElement("video");return"function"==typeof t.canPlayType&&Br.map(function(r){"probably"===t.canPlayType('video/mp4; codecs="'.concat(r,'"'))&&(e.isSupport=!0,e.mime+="||".concat(r))}),this.supportResult=e,t=null,e},isMSESupport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if("undefined"==typeof MediaSource||!MediaSource)return!1;try{return MediaSource.isTypeSupported(e)}catch(t){return this._logger.error(e,t),!1}},isHevcSupported:function(){return!("undefined"==typeof MediaSource||!MediaSource.isTypeSupported)&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))},probeConfigSupported:function(e){var t={supported:!1,smooth:!1,powerEfficient:!1};if(!e||"undefined"==typeof navigator)return Promise.resolve(t);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(e);var r=e.video||{},n=e.audio||{};try{var i=MediaSource.isTypeSupported(r.contentType),o=MediaSource.isTypeSupported(n.contentType);return Promise.resolve({supported:i&&o,smooth:!1,powerEfficient:!1})}catch(e){return Promise.resolve(t)}}},jr="3.0.30",Ur={1:"media",2:"media",3:"media",4:"media",5:"media",6:"media"},Vr={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},Fr=hr(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};ur(this,e);var n=t&&t.i18n?t.i18n.ERROR_TYPES:null;if(t.media){var i=r.mediaError?r.mediaError:t.media.error||{},o=t.duration,s=t.currentTime,a=t.ended,l=t.src,c=t.currentSrc,u=t.media,d=u.readyState,h=u.networkState,p=r.errorCode||i.code;Vr[p]&&(p=Vr[p]);var f={playerVersion:jr,currentTime:s,duration:o,ended:a,readyState:d,networkState:h,src:l||c,errorType:r.errorType,errorCode:p,message:r.errorMessage||i.message,mediaError:i,originError:r.originError?r.originError.stack:"",host:Lr.getHostFromUrl(l||c)};return r.ext&&Object.keys(r.ext).map(function(e){f[e]=r.ext[e]}),f}if(arguments.length>1){for(var _={playerVersion:jr,domain:document.domain},y=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],g=0;g<arguments.length;g++)_[y[g]]=arguments[g];return _.ex=n?(n[arguments[0]]||{}).msg:"",_}}),Hr="play",Gr="seeked",Wr="canplay",qr="loadeddata",Kr="focus",zr="blur",Zr="autoplay_started",Yr="fullscreen_change",Xr="cssFullscreen_change",Qr="after_definition_change",Jr="video_resize",en="user_action",tn=["play","playing","ended","pause","error","seeking","seeked","timeupdate","waiting","canplay","canplaythrough","durationchange","volumechange","loadeddata","loadedmetadata","ratechange","progress","loadstart","emptied","stalled","suspend","abort","lowdecode"];function rn(e,t){this&&this.emit&&("error"===e?this.errorHandler(e,t.error):this.emit(e,t))}var nn=function(e){function t(e){var r;ur(this,t),(r=cr(this,t,[e]))._hasStart=!1,r._currentTime=0,r._duration=0,r._internalOp={},r._lastMuted=!1,r.vtype="MP4",r._rate=-1,r.mediaConfig=Object.assign({},{controls:!1,autoplay:e.autoplay,playsinline:e.playsinline,"x5-playsinline":e.playsinline,"webkit-playsinline":e.playsinline,"x5-video-player-fullscreen":e["x5-video-player-fullscreen"]||e.x5VideoPlayerFullscreen,"x5-video-orientation":e["x5-video-orientation"]||e.x5VideoOrientation,airplay:e.airplay,"webkit-airplay":e.airplay,tabindex:0|e.tabindex,mediaType:e.mediaType||"video","data-index":-1},e.videoConfig,e.videoAttributes);var n=e["x5-video-player-type"]||e.x5VideoPlayerType;return Nr.isWeixin&&Nr.os.isAndroid&&n&&(r.mediaConfig["x5-video-player-type"]=n,delete r.mediaConfig.playsinline,delete r.mediaConfig["webkit-playsinline"],delete r.mediaConfig["x5-playsinline"]),e.loop&&(r.mediaConfig.loop="loop"),e.autoplayMuted&&!Object.prototype.hasOwnProperty.call(r.mediaConfig,"muted")&&(r.mediaConfig.muted=!0),r.media=Lr.createDom(r.mediaConfig.mediaType,"",r.mediaConfig,""),e.defaultPlaybackRate&&(r.media.defaultPlaybackRate=r.media.playbackRate=e.defaultPlaybackRate),"Number"===Lr.typeOf(e.volume)&&(r.volume=e.volume),e.autoplayMuted&&(r.media.muted=!0,r._lastMuted=!0),e.autoplay&&(r.media.autoplay=!0),r._interval={},r.mediaEventMiddleware={},r.attachVideoEvents(),r}return yr(t,e),hr(t,[{key:"setEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(r){t.mediaEventMiddleware[r]=e[r]})}},{key:"removeEventsMiddleware",value:function(e){var t=this;Object.keys(e).map(function(e){delete t.mediaEventMiddleware[e]})}},{key:"attachVideoEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.media;this._evHandlers||(this._evHandlers=tn.map(function(t){var r="on".concat(t.charAt(0).toUpperCase()).concat(t.slice(1));return"function"==typeof e[r]&&e.on(t,e[r]),pr({},t,function(e,t){return function(r,n){var i={player:t,eventName:e,originalEvent:r,detail:r.detail||{},timeStamp:r.timeStamp,currentTime:t.currentTime,duration:t.duration,paused:t.paused,ended:t.ended,isInternalOp:!!t._internalOp[r.type],muted:t.muted,volume:t.volume,host:Lr.getHostFromUrl(t.currentSrc),vtype:t.vtype};if(t.removeInnerOP(r.type),"timeupdate"===e&&(t._currentTime=t.media&&t.media.currentTime),"ratechange"===e){var o=t.media?t.media.playbackRate:0;if(o&&t._rate===o)return;t._rate=t.media&&t.media.playbackRate}if("durationchange"===e&&(t._duration=t.media.duration),"volumechange"===e&&(i.isMutedChange=t._lastMuted!==t.muted,t._lastMuted=t.muted),"error"===e&&(i.error=n||t.video.error),t.mediaEventMiddleware[e]){var s=rn.bind(t,e,i);try{t.mediaEventMiddleware[e].call(t,i,s)}catch(r){throw rn.call(t,e,i),r}}else rn.call(t,e,i)}}(t,e))})),this._evHandlers.forEach(function(e){var r=Object.keys(e)[0];t.addEventListener(r,e[r],!1)})}},{key:"detachVideoEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.media;this._evHandlers.forEach(function(e){var r=Object.keys(e)[0];t.removeEventListener(r,e[r],!1)}),this._evHandlers.forEach(function(t){var r=Object.keys(t)[0],n="on".concat(r.charAt(0).toUpperCase()).concat(r.slice(1));"function"==typeof e[n]&&e.off(r,e[n])}),this._evHandlers=null}},{key:"_attachSourceEvents",value:function(e,t){var r=this;e.removeAttribute("src"),e.load(),t.forEach(function(e,t){r.media.appendChild(Lr.createDom("source","",{src:"".concat(e.src),type:"".concat(e.type||""),"data-index":t+1}))});var n=e.children;if(n){this._videoSourceCount=n.length,this._videoSourceIndex=n.length,this._vLoadeddata=function(e){r.emit("source_success",{src:e.target.currentSrc,host:Lr.getHostFromUrl(e.target.currentSrc)})};for(var i=null,o=0;o<this._evHandlers.length;o++)if("error"===Object.keys(this._evHandlers[o])[0]){i=this._evHandlers[o];break}!this._sourceError&&(this._sourceError=function(e){var t=parseInt(e.target.getAttribute("data-index"),10);if(r._videoSourceIndex--,0===r._videoSourceIndex||t>=r._videoSourceCount){var n={code:4,message:"sources_load_error"};i?i.error(e,n):r.errorHandler("error",n)}var o=Ur[4];r.emit("source_error",new Fr(r,{errorType:o,errorCode:4,errorMessage:"sources_load_error",mediaError:{code:4,message:"sources_load_error"},src:e.target.src}))});for(var s=0;s<n.length;s++)n[s].addEventListener("error",this._sourceError);e.addEventListener("loadeddata",this._vLoadeddata)}}},{key:"_detachSourceEvents",value:function(e){var t=e.children;if(t&&0!==t.length&&this._sourceError){for(var r=0;r<t.length;r++)t[r].removeEventListener("error",this._sourceError);for(;t.length>0;)e.removeChild(t[0]);this._vLoadeddata&&e.removeEventListener("loadeddata",this._vLoadeddata)}}},{key:"errorHandler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.media&&(this.media.error||t)){var r=this.media.error||t,n=r.code?Ur[r.code]:"other";r.message,this.media.currentSrc||(r={code:6,message:"empty_src"}),this.emit(e,new Fr(this,{errorType:n,errorCode:r.code,errorMessage:r.message||"",mediaError:r}))}}},{key:"destroy",value:function(){for(var e in this.media&&(this.media.pause&&(this.media.pause(),this.media.muted=!0),this.media.removeAttribute("src"),this.media.load()),this._currentTime=0,this._duration=0,this.mediaConfig=null,this._interval)Object.prototype.hasOwnProperty.call(this._interval,e)&&(clearInterval(this._interval[e]),this._interval[e]=null);this.detachVideoEvents(),this.media=null,this.mediaEventMiddleware={},this.removeAllListeners()}},{key:"video",get:function(){return this.media},set:function(e){this.media=e}},{key:"play",value:function(){return this.media?this.media.play():null}},{key:"pause",value:function(){this.media&&this.media.pause()}},{key:"load",value:function(){this.media&&this.media.load()}},{key:"canPlayType",value:function(e){return!!this.media&&this.media.canPlayType(e)}},{key:"getBufferedRange",value:function(e){var t=[0,0];if(!this.media)return t;e||(e=this.media.buffered);var r=this.media.currentTime;if(e)for(var n=0,i=e.length;n<i&&(t[0]=e.start(n),t[1]=e.end(n),!(t[0]<=r&&r<=t[1]));n++);return t[0]-r<=0&&r-t[1]<=0?t:[0,0]}},{key:"autoplay",get:function(){return!!this.media&&this.media.autoplay},set:function(e){this.media&&(this.media.autoplay=e)}},{key:"buffered",get:function(){return this.media?this.media.buffered:null}},{key:"buffered2",get:function(){return this.media&&this.media.buffered?Lr.getBuffered2(this.media.buffered):null}},{key:"bufferedPoint",get:function(){var e={start:0,end:0};if(!this.media)return e;var t=this.media.buffered;if(!t||0===t.length)return e;for(var r=0;r<t.length;r++)if((t.start(r)<=this.currentTime||t.start(r)<.1)&&t.end(r)>=this.currentTime)return{start:t.start(r),end:t.end(r)};return e}},{key:"crossOrigin",get:function(){return this.media?this.media.crossOrigin:""},set:function(e){this.media&&(this.media.crossOrigin=e)}},{key:"currentSrc",get:function(){return this.media?this.media.currentSrc:""},set:function(e){this.media&&(this.media.currentSrc=e)}},{key:"currentTime",get:function(){return this.media?void 0!==this.media.currentTime?this.media.currentTime:this._currentTime:0},set:function(e){this.media&&(this.media.currentTime=e)}},{key:"defaultMuted",get:function(){return!!this.media&&this.media.defaultMuted},set:function(e){this.media&&(this.media.defaultMuted=e)}},{key:"duration",get:function(){return this._duration}},{key:"ended",get:function(){return!!this.media&&this.media.ended}},{key:"error",get:function(){return this.media.error}},{key:"errorNote",get:function(){return this.media.error?["MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED"][this.media.error.code-1]:""}},{key:"loop",get:function(){return!!this.media&&this.media.loop},set:function(e){this.media&&(this.media.loop=e)}},{key:"muted",get:function(){return!!this.media&&this.media.muted},set:function(e){this.media&&this.media.muted!==e&&(this._lastMuted=this.media.muted,this.media.muted=e)}},{key:"networkState",get:function(){return this.media.networkState}},{key:"paused",get:function(){return!this.media||this.media.paused}},{key:"playbackRate",get:function(){return this.media?this.media.playbackRate:0},set:function(e){this.media&&e!==1/0&&(this.media.defaultPlaybackRate=e,this.media.playbackRate=e)}},{key:"played",get:function(){return this.media?this.media.played:null}},{key:"preload",get:function(){return!!this.media&&this.media.preload},set:function(e){this.media&&(this.media.preload=e)}},{key:"readyState",get:function(){return this.media.readyState}},{key:"seekable",get:function(){return!!this.media&&this.media.seekable}},{key:"seeking",get:function(){return!!this.media&&this.media.seeking}},{key:"src",get:function(){return this.media?this.media.src:""},set:function(e){this.media&&(this.emit("urlchange",e),this.emit("waiting"),this._currentTime=0,this._duration=0,Lr.isMSE(this.media)?this.onWaiting():(this._detachSourceEvents(this.media),"Array"===Lr.typeOf(e)?this._attachSourceEvents(this.media,e):e?this.media.src=e:this.media.removeAttribute("src"),this.load()))}},{key:"volume",get:function(){return this.media?this.media.volume:0},set:function(e){e!==1/0&&this.media&&(this.media.volume=e)}},{key:"aspectRatio",get:function(){return this.media?this.media.videoWidth/this.media.videoHeight:0}},{key:"addInnerOP",value:function(e){this._internalOp[e]=!0}},{key:"removeInnerOP",value:function(e){delete this._internalOp[e]}},{key:"emit",value:function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];Cr(t,"emit",this,3)([e,r].concat(i))}},{key:"on",value:function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];Cr(t,"on",this,3)([e,r].concat(i))}},{key:"once",value:function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];Cr(t,"once",this,3)([e,r].concat(i))}},{key:"off",value:function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];Cr(t,"off",this,3)([e,r].concat(i))}},{key:"offAll",value:function(){Cr(t,"removeAllListeners",this,3)([])}}])}(Or()),on=function(){return hr(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"xgplayer",version:1,db:null,ojstore:{name:"xg-m4a",keypath:"vid"}};ur(this,e),this.indexedDB=window.indexedDB||window.webkitindexedDB,this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,this.myDB=t},[{key:"openDB",value:function(e){var t=this,r=this,n=this.myDB.version||1,i=r.indexedDB.open(r.myDB.name,n);i.onerror=function(e){},i.onsuccess=function(n){t.myDB.db=n.target.result,e.call(r)},i.onupgradeneeded=function(e){var t=e.target.result;e.target.transaction,t.objectStoreNames.contains(r.myDB.ojstore.name)||t.createObjectStore(r.myDB.ojstore.name,{keyPath:r.myDB.ojstore.keypath})}}},{key:"deletedb",value:function(){this.indexedDB.deleteDatabase(this.myDB.name)}},{key:"closeDB",value:function(){this.myDB.db.close()}},{key:"addData",value:function(e,t){for(var r,n=this.myDB.db.transaction(e,"readwrite").objectStore(e),i=0;i<t.length;i++)(r=n.add(t[i])).onerror=function(){},r.onsuccess=function(){}}},{key:"putData",value:function(e,t){for(var r,n=this.myDB.db.transaction(e,"readwrite").objectStore(e),i=0;i<t.length;i++)(r=n.put(t[i])).onerror=function(){},r.onsuccess=function(){}}},{key:"getDataByKey",value:function(e,t,r){var n=this,i=this.myDB.db.transaction(e,"readwrite").objectStore(e).get(t);i.onerror=function(){r.call(n,null)},i.onsuccess=function(e){var t=e.target.result;r.call(n,t)}}},{key:"deleteData",value:function(e,t){this.myDB.db.transaction(e,"readwrite").objectStore(e).delete(t)}},{key:"clearData",value:function(e){this.myDB.db.transaction(e,"readwrite").objectStore(e).clear()}}])}(),sn=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],an=["requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen"],ln=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],cn="data-xgplayerid";function un(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var s=t.call.apply(t,[e].concat(i));r&&"function"==typeof r&&(s&&s.then?s.then(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];r.call.apply(r,[e].concat(n))}):r.call.apply(r,[e].concat(i)))}function dn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[e]&&(this.__hooks[e]=null),function(){var n=arguments,i=this;if(r.pre)try{var o;(o=r.pre).call.apply(o,[this].concat(Array.prototype.slice.call(arguments)))}catch(t){throw t.message="[pluginName: ".concat(this.pluginName,":").concat(e,":pre error] >> ").concat(t.message),t}if(this.__hooks&&this.__hooks[e])try{var s,a=(s=this.__hooks[e]).call.apply(s,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(e){!1!==e&&un.apply(void 0,[i,t,r.next].concat(Er(n)))}).catch(function(e){throw e}):un.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments))):void 0===a&&un.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments)))}catch(t){throw t.message="[pluginName: ".concat(this.pluginName,":").concat(e,"] >> ").concat(t.message),t}else un.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments)))}.bind(this)}function hn(e,t){var r=this.__hooks;if(r)return r.hasOwnProperty(e)?(r&&(r[e]=t),!0):(console.warn("has no supported hook which name [".concat(e,"]")),!1)}function pn(e,t){var r=this.__hooks;r&&delete r[e]}function fn(e){if(this.plugins&&this.plugins[e.toLowerCase()]){for(var t=this.plugins[e.toLowerCase()],r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.useHooks&&t.useHooks.apply(t,n)}}function _n(e){if(this.plugins&&this.plugins[e.toLowerCase()]){var t=this.plugins[e.toLowerCase()];if(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.removeHooks&&t.removeHooks.apply(t,n)}}}function yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.__hooks={},t&&t.map(function(t){e.__hooks[t]=null}),Object.defineProperty(e,"hooks",{get:function(){return e.__hooks&&Object.keys(e.__hooks).map(function(t){if(e.__hooks[t])return t})}})}function gn(e){e.__hooks=null}function mn(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];if(!e.__hooks||!e.__hooks[t])return r.call.apply(r,[e,e].concat(i));var s,a=(s=e.__hooks[t]).call.apply(s,[e,e].concat(i));if(a&&a.then)a.then(function(t){return!1===t?null:r.call.apply(r,[e,e].concat(i))}).catch(function(e){console.warn("[runHooks]".concat(t," reject"),e.message)});else if(!1!==a)return r.call.apply(r,[e,e].concat(i))}function vn(e,t){Rr.logError("[".concat(e,"] event or callback cant be undefined or null when call ").concat(t))}var bn=function(){return hr(function e(t){ur(this,e),Lr.checkIsFunction(this.beforeCreate)&&this.beforeCreate(t),yn(this),this.__args=t,this.__events={},this.__onceEvents={},this.config=t.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(t)},[{key:"beforeCreate",value:function(e){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(e){this.player=e.player,this.playerConfig=e.player&&e.player.config,this.pluginName=e.pluginName?e.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=e.player&&e.player.logger}},{key:"updateLang",value:function(e){e||(e=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var e=Lr.checkTouchSupport()?"touch":"mouse";return!this.playerConfig||"touch"!==this.playerConfig.domEventType&&"mouse"!==this.playerConfig.domEventType||(e=this.playerConfig.domEventType),e}},{key:"on",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(this.__events[e]=t,this.player.on(e,t)):Array.isArray(e)&&e.forEach(function(e){r.__events[e]=t,r.player.on(e,t)}):vn(this.pluginName,"plugin.on(event, callback)")}},{key:"once",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(this.__onceEvents[e]=t,this.player.once(e,t)):Array.isArray(e)&&e.forEach(function(n){r.__onceEvents[n]=t,r.player.once(e,t)}):vn(this.pluginName,"plugin.once(event, callback)")}},{key:"off",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(delete this.__events[e],this.player.off(e,t)):Array.isArray(e)&&e.forEach(function(n){delete r.__events[e],r.player.off(n,t)}):vn(this.pluginName,"plugin.off(event, callback)")}},{key:"offAll",value:function(){var e=this;["__events","__onceEvents"].forEach(function(t){Object.keys(e[t]).forEach(function(r){e[t][r]&&e.off(r,e[t][r]),r&&delete e[t][r]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(e){var t;if(this.player){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this.player).emit.apply(t,[e].concat(n))}}},{key:"emitUserAction",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.player){var n=vr(vr({},r),{},{pluginName:this.pluginName});this.player.emitUserAction(e,t,n)}}},{key:"hook",value:function(e,t){return dn.call.apply(dn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return hn.call.apply(hn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return pn.call.apply(pn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(this.player)return r&&(t.pluginName=r),this.player.registerPlugin({plugin:e,options:t})}},{key:"getPlugin",value:function(e){return this.player?this.player.getPlugin(e):null}},{key:"__destroy",value:function(){var e=this,t=this.player,r=this.pluginName;this.offAll(),Lr.clearAllTimers(this),Lr.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(t){e[t]=null}),t.unRegisterPlugin(r),gn(this)}}],[{key:"defineGetterOrSetter",value:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&Object.defineProperty(e,r,t[r])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}])}(),wn=r(36922),Cn=r.n(wn),En={CONTROLS:"controls",ROOT:"root"},kn={ROOT:"root",ROOT_LEFT:"rootLeft",ROOT_RIGHT:"rootRight",ROOT_TOP:"rootTop",CONTROLS_LEFT:"controlsLeft",CONTROLS_RIGTH:"controlsRight",CONTROLS_RIGHT:"controlsRight",CONTROLS_CENTER:"controlsCenter",CONTROLS:"controls"},Tn="xg-icon-disable";function Sn(e){return!!e&&e.indexOf&&/^(?:http|data:|\/)/.test(e)}function On(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=null;if(e instanceof window.Element)return Lr.addClass(e,r),Object.keys(n).map(function(t){e.setAttribute(t,n[t])}),e;if(Sn(e)||Sn(e.url))return n.src=Sn(e)?e:e.url||"",o=Lr.createDom(e.tag||"img","",n,"xg-img ".concat(r));if("function"==typeof e)try{return(o=e())instanceof window.Element?(Lr.addClass(o,r),Object.keys(n).map(function(e){o.setAttribute(e,n[e])}),o):(Rr.logWarn("warn>>icons.".concat(t," in config of plugin named [").concat(i,"] is a function mast return an Element Object")),null)}catch(e){return Rr.logError("Plugin named [".concat(i,"]:createIcon"),e),null}return"string"==typeof e?Lr.createDomFromHtml(e,n,r):(Rr.logWarn("warn>>icons.".concat(t," in config of plugin named [").concat(i,"] is invalid")),null)}var An=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ur(this,t),(e=cr(this,t,[r])).__delegates=[],e}return yr(t,e),hr(t,[{key:"__init",value:function(e){Cr(t,"__init",this,3)([e]);var r=e.root,n=null;if(this.icons={},this.root=null,this.parent=null,e.root){(function(e,t){var r=t.config.icons||t.playerConfig.icons;Object.keys(e).map(function(n){var i=e[n],o=i&&i.class?i.class:"",s=i&&i.attr?i.attr:{},a=null;r&&r[n]&&(o=function(e,t){return"object"===Tr(e)&&e.class&&"string"==typeof e.class?"".concat(t," ").concat(e.class):t}(r[n],o),s=function(e,t){return"object"===Tr(e)&&e.attr&&"object"===Tr(e.attr)&&Object.keys(e.attr).map(function(r){t[r]=e.attr[r]}),t}(r[n],s),a=On(r[n],n,o,s,t.pluginName)),!a&&i&&(a=On(i.icon?i.icon:i,s,o,{},t.pluginName)),t.icons[n]=a})})(this.registerIcons()||{},this),this.langText={};var i,o,s=this.registerLanguageTexts()||{};i=s,o=this,Object.keys(i).map(function(e){Object.defineProperty(o.langText,e,{get:function(){var t=o.lang,r=o.i18n;return r[e]?r[e]:i[e]&&i[e][t]||""}})});var a="";try{a=this.render()}catch(e){throw Rr.logError("Plugin:".concat(this.pluginName,":render"),e),new Error("Plugin:".concat(this.pluginName,":render:").concat(e.message))}if(a)(n=t.insert(a,r,e.index)).setAttribute("data-index",e.index);else{if(!e.tag)return;(n=Lr.createDom(e.tag,"",e.attr,e.name)).setAttribute("data-index",e.index),r.appendChild(n)}this.root=n,this.parent=r;var l=this.config.attr||{},c=this.config.style||{};this.setAttr(l),this.setStyle(c),this.config.index&&this.root.setAttribute("data-index",this.config.index),this.__registerChildren()}}},{key:"__registerChildren",value:function(){var e=this;if(this.root){this._children=[];var t=this.children();t&&"object"===Tr(t)&&Object.keys(t).length>0&&Object.keys(t).map(function(r){var n,i,o=r,s=t[o],a={root:e.root};"function"==typeof s?(n=e.config[o]||{},i=s):"object"===Tr(s)&&"function"==typeof s.plugin&&(n=s.options?Lr.deepCopy(e.config[o]||{},s.options):e.config[o]||{},i=s.plugin),a.config=n,void 0!==n.index&&(a.index=n.index),n.root&&(a.root=n.root),e.registerPlugin(i,a,o)})}}},{key:"updateLang",value:function(e){e||(e=this.lang);var t=this.root,r=this.i18n,n=this.langText;t&&function e(t,r){for(var n=0;n<t.children.length;n++)t.children[n].children.length>0?e(t.children[n],r):r(t.children[n])}(t,function(t){var i=t.getAttribute&&t.getAttribute("lang-key");if(i){var o=r[i.toUpperCase()]||n[i];o&&(t.innerHTML="function"==typeof o?o(e):o)}})}},{key:"lang",get:function(){return this.player.lang}},{key:"changeLangTextKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=this.i18n||{},n=this.langText;e.setAttribute&&e.setAttribute("lang-key",t);var i=r[t]||n[t]||"";i&&(e.innerHTML=i)}},{key:"plugins",value:function(){return this._children}},{key:"disable",value:function(){this.config.disable=!0,Lr.addClass(this.find(".xgplayer-icon"),Tn)}},{key:"enable",value:function(){this.config.disable=!1,Lr.removeClass(this.find(".xgplayer-icon"),Tn)}},{key:"children",value:function(){return{}}},{key:"registerPlugin",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";r.root=r.root||this.root;var i=Cr(t,"registerPlugin",this,3)([e,r,n]);return this._children.push(i),i}},{key:"registerIcons",value:function(){return{}}},{key:"registerLanguageTexts",value:function(){return{}}},{key:"find",value:function(e){if(this.root)return this.root.querySelector(e)}},{key:"bind",value:function(e,r,n){var i=this;if(arguments.length<3&&"function"==typeof r)Array.isArray(e)?e.forEach(function(e){i.bindEL(e,r)}):this.bindEL(e,r);else{var o=t.delegate.call(this,this.root,e,r,n);this.__delegates=this.__delegates.concat(o)}}},{key:"unbind",value:function(e,t){var r=this;if(arguments.length<3&&"function"==typeof t)Array.isArray(e)?e.forEach(function(e){r.unbindEL(e,t)}):this.unbindEL(e,t);else for(var n="".concat(e,"_").concat(t),i=0;i<this.__delegates.length;i++)if(this.__delegates[i].key===n){this.__delegates[i].destroy(),this.__delegates.splice(i,1);break}}},{key:"setStyle",value:function(e,t){var r=this;if(this.root)return"String"===Lr.typeOf(e)?this.root.style[e]=t:void("Object"===Lr.typeOf(e)&&Object.keys(e).map(function(t){r.root.style[t]=e[t]}))}},{key:"setAttr",value:function(e,t){var r=this;if(this.root)return"String"===Lr.typeOf(e)?this.root.setAttribute(e,t):void("Object"===Lr.typeOf(e)&&Object.keys(e).map(function(t){r.root.setAttribute(t,e[t])}))}},{key:"setHtml",value:function(e,t){this.root&&(this.root.innerHTML=e,"function"==typeof t&&t())}},{key:"bindEL",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.root&&"on".concat(e)in this.root&&"function"==typeof t&&this.root.addEventListener(e,t,r)}},{key:"unbindEL",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.root&&"on".concat(e)in this.root&&"function"==typeof t&&this.root.removeEventListener(e,t,r)}},{key:"show",value:function(e){if(this.root)return this.root.style.display=void 0!==e?e:"block","none"===window.getComputedStyle(this.root,null).getPropertyValue("display")?this.root.style.display="block":void 0}},{key:"hide",value:function(){this.root&&(this.root.style.display="none")}},{key:"appendChild",value:function(e,t){if(!this.root)return null;if(arguments.length<2&&arguments[0]instanceof window.Element)return this.root.appendChild(arguments[0]);if(!(t&&t instanceof window.Element))return null;try{return"string"==typeof e?this.find(e).appendChild(t):e.appendChild(t)}catch(e){return Rr.logError("Plugin:appendChild",e),null}}},{key:"render",value:function(){return""}},{key:"destroy",value:function(){}},{key:"__destroy",value:function(){var e=this,r=this.player;this.__delegates.map(function(e){e.destroy()}),this.__delegates=[],this._children instanceof Array&&(this._children.map(function(e){r.unRegisterPlugin(e.pluginName)}),this._children=null),this.root&&(this.root.hasOwnProperty("remove")?this.root.remove():this.root.parentNode&&this.root.parentNode.removeChild(this.root)),Cr(t,"__destroy",this,3)([]),this.icons={},["root","parent"].map(function(t){e[t]=null})}}],[{key:"insert",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.children.length,i=Number(r),o=e instanceof window.Node;if(n){for(var s=0,a=null,l="";s<n;s++){a=t.children[s];var c=Number(a.getAttribute("data-index"));if(c>=i){l="beforebegin";break}c<i&&(l="afterend")}return o?"afterend"===l?t.appendChild(e):t.insertBefore(e,a):a.insertAdjacentHTML(l,e),"afterend"===l?t.children[t.children.length-1]:t.children[s]}return o?t.appendChild(e):t.insertAdjacentHTML("beforeend",e),t.children[t.children.length-1]}},{key:"defaultConfig",get:function(){return{}}},{key:"delegate",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=[];if(e instanceof window.Node&&"function"==typeof n)if(Array.isArray(r))r.forEach(function(r){var s=Cn()(e,t,r,n,i);s.key="".concat(t,"_").concat(r),o.push(s)});else{var s=Cn()(e,t,r,n,i);s.key="".concat(t,"_").concat(r),o.push(s)}return o}},{key:"ROOT_TYPES",get:function(){return En}},{key:"POSITIONS",get:function(){return kn}}])}(bn),$n=function(){return hr(function e(){var t=this;if(ur(this,e),pr(this,"__trigger",function(e){var r=(new Date).getTime();t.timeStamp=r;for(var n=0;n<e.length;n++)t.__runHandler(e[n].target)}),this.__handlers=[],this.timeStamp=0,this.observer=null,window.ResizeObserver)try{this.observer=new window.ResizeObserver(function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Ir(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),function(e,t,r){var n,i,o,s,a,l,c=0,u=!1,d=!1,h=!0,p=!t&&0!==t&&"function"==typeof window.requestAnimationFrame;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,o=i;return n=i=void 0,c=t,s=e.apply(o,r)}function _(e,t){return p?(window.cancelAnimationFrame(a),window.requestAnimationFrame(e)):setTimeout(e,t)}function y(e){var r=e-l;return void 0===l||r>=t||r<0||d&&e-c>=o}function g(){var e=Date.now();if(y(e))return m(e);a=_(g,function(e){var r=e-c,n=t-(e-l);return d?Math.min(n,o-r):n}(e))}function m(e){return a=void 0,h&&n?f(e):(n=i=void 0,s)}function v(){for(var e=Date.now(),r=y(e),o=arguments.length,h=new Array(o),p=0;p<o;p++)h[p]=arguments[p];if(n=h,i=this,l=e,r){if(void 0===a)return function(e){return c=e,a=_(g,t),u?f(e):s}(l);if(d)return a=_(g,t),f(l)}return void 0===a&&(a=_(g,t)),s}return t=+t||0,Ir(r)&&(u=!!r.leading,o=(d="maxWait"in r)?Math.max(+r.maxWait||0,t):o,h="trailing"in r?!!r.trailing:h),v.cancel=function(){void 0!==a&&function(e){if(p)return window.cancelAnimationFrame(e);clearTimeout(e)}(a),c=0,n=l=i=a=void 0},v.flush=function(){return void 0===a?s:m(Date.now())},v.pending=function(){return void 0!==a},v}(e,100,{leading:n,trailing:i,maxWait:100})}(this.__trigger,0,{trailing:!0})),this.timeStamp=(new Date).getTime()}catch(e){console.error(e)}},[{key:"addObserver",value:function(e,t){if(this.observer){this.observer&&this.observer.observe(e);for(var r=e.getAttribute(cn),n=this.__handlers,i=-1,o=0;o<n.length;o++)n[o]&&e===n[o].target&&(i=o);i>-1?this.__handlers[i].handler=t:this.__handlers.push({target:e,handler:t,playerId:r})}}},{key:"unObserver",value:function(e){var t=-1;this.__handlers.map(function(r,n){e===r.target&&(t=n)});try{this.observer&&this.observer.unobserve(e)}catch(e){}this.observer&&this.observer.unobserve(e),t>-1&&this.__handlers.splice(t,1)}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=null}},{key:"__runHandler",value:function(e){for(var t=this.__handlers,r=0;r<t.length;r++)if(t[r]&&e===t[r].target){try{t[r].handler(e)}catch(e){console.error(e)}return!0}return!1}}])}(),Pn=null,Rn={pluginGroup:{},init:function(e){var t,r,n=e._pluginInfoId;n||(n=Lr.generateSessionId(),e._pluginInfoId=n),!e.config.closeResizeObserver&&e.root&&(t=e.root,r=function(){e.resize()},Pn||(Pn=new $n),Pn.addObserver(t,r)),this.pluginGroup[n]={_originalOptions:e.config||{},_plugins:{}}},formatPluginInfo:function(e,t){var r=null,n=null;return e.plugin&&"function"==typeof e.plugin?(r=e.plugin,n=e.options):(r=e,n={}),t&&(n.config=t||{}),{PLUFGIN:r,options:n}},checkPluginIfExits:function(e,t){for(var r=0;r<t.length;r++)if(e.toLowerCase()===t[r].pluginName.toLowerCase())return!0;return!1},getRootByConfig:function(e,t){for(var r=Object.keys(t),n=null,i=0;i<r.length;i++)if(e.toLowerCase()===r[i].toLowerCase()){n=t[r[i]];break}return"Object"===Lr.typeOf(n)?{root:n.root,position:n.position}:{}},lazyRegister:function(e,t){var r=this,n=t.timeout||1500;return Promise.race([t.loader().then(function(t){var n;n=t&&t.__esModule?t.default:t,r.register(e,n,t.options)}),new Promise(function(e,t){setTimeout(function(){t(new Error("timeout"))},n)})])},register:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e&&t&&"function"==typeof t&&void 0!==t.prototype){var n=e._pluginInfoId;if(n&&this.pluginGroup[n]){this.pluginGroup[n]._plugins||(this.pluginGroup[n]._plugins={});var i=this.pluginGroup[n]._plugins,o=this.pluginGroup[n]._originalOptions;r.player=e;var s=r.pluginName||t.pluginName;if(!s)throw new Error("The property pluginName is necessary");if(!t.isSupported||t.isSupported(e.config.mediaType,e.config.codecType)){r.config||(r.config={});for(var a=Object.keys(o),l=0;l<a.length;l++)if(s.toLowerCase()===a[l].toLowerCase()){var c=o[a[l]];"Object"===Lr.typeOf(c)?r.config=Object.assign({},r.config,o[a[l]]):"Boolean"===Lr.typeOf(c)&&(r.config.disable=!c);break}t.defaultConfig&&Object.keys(t.defaultConfig).forEach(function(e){void 0===r.config[e]&&(r.config[e]=t.defaultConfig[e])}),r.root?"string"==typeof r.root&&(r.root=e[r.root]):r.root=e.root,r.index=r.config.index||0;try{i[s.toLowerCase()]&&(this.unRegister(n,s.toLowerCase()),console.warn("the is one plugin with same pluginName [".concat(s,"] exist, destroy the old instance")));var u=new t(r);return i[s.toLowerCase()]=u,i[s.toLowerCase()].func=t,u&&"function"==typeof u.afterCreate&&u.afterCreate(),u}catch(e){throw console.error(e),e}}else console.warn("not supported plugin [".concat(s,"]"))}}},unRegister:function(e,t){e._pluginInfoId&&(e=e._pluginInfoId),t=t.toLowerCase();try{var r=this.pluginGroup[e]._plugins[t];r&&(r.pluginName&&r.__destroy(),delete this.pluginGroup[e]._plugins[t])}catch(r){console.error("[unRegister:".concat(t,"] cgid:[").concat(e,"] error"),r)}},deletePlugin:function(e,t){var r=e._pluginInfoId;r&&this.pluginGroup[r]&&this.pluginGroup[r]._plugins&&delete this.pluginGroup[r]._plugins[t]},getPlugins:function(e){var t=e._pluginInfoId;return t&&this.pluginGroup[t]?this.pluginGroup[t]._plugins:{}},findPlugin:function(e,t){var r=e._pluginInfoId;if(!r||!this.pluginGroup[r])return null;var n=t.toLowerCase();return this.pluginGroup[r]._plugins[n]},beforeInit:function(e){var t=this;function r(e){return e&&e.then?e:new Promise(function(e){e()})}return new Promise(function(n){if(t.pluginGroup)return(e._loadingPlugins&&e._loadingPlugins.length?Promise.all(e._loadingPlugins):Promise.resolve()).then(function(){var i=e._pluginInfoId;if(t.pluginGroup[i]){var o=t.pluginGroup[i]._plugins,s=[];Object.keys(o).forEach(function(e){if(o[e]&&o[e].beforePlayerInit)try{var t=o[e].beforePlayerInit();s.push(r(t))}catch(e){throw s.push(r(null)),e}}),Promise.all([].concat(s)).then(function(){n()}).catch(function(e){console.error(e),n()})}else n()})})},afterInit:function(e){var t=e._pluginInfoId;if(t&&this.pluginGroup[t]){var r=this.pluginGroup[t]._plugins;Object.keys(r).forEach(function(e){r[e]&&r[e].afterPlayerInit&&r[e].afterPlayerInit()})}},setLang:function(e,t){var r=t._pluginInfoId;if(r&&this.pluginGroup[r]){var n=this.pluginGroup[r]._plugins;Object.keys(n).forEach(function(t){if(n[t].updateLang)n[t].updateLang(e);else try{n[t].lang=e}catch(e){console.warn("".concat(t," setLang"))}})}},reRender:function(e){var t=this,r=e._pluginInfoId;if(r&&this.pluginGroup[r]){var n=[],i=this.pluginGroup[r]._plugins;Object.keys(i).forEach(function(e){"controls"!==e&&i[e]&&(n.push({plugin:i[e].func,options:i[e].__args}),t.unRegister(r,e))}),n.forEach(function(r){t.register(e,r.plugin,r.options)})}},onPluginsReady:function(e){var t=e._pluginInfoId;if(t&&this.pluginGroup[t]){var r=this.pluginGroup[t]._plugins||{};Object.keys(r).forEach(function(e){r[e].onPluginsReady&&"function"==typeof r[e].onPluginsReady&&r[e].onPluginsReady()})}},destroy:function(e){var t=e._pluginInfoId;if(this.pluginGroup[t]){var r;e.root&&(r=e.root,Pn.unObserver(r,undefined));for(var n=this.pluginGroup[t]._plugins,i=0,o=Object.keys(n);i<o.length;i++){var s=o[i];this.unRegister(t,s)}delete this.pluginGroup[t],delete e._pluginInfoId}}},xn="xgplayer-is-enter",Ln="xgplayer-pause",In="xgplayer-playing",Mn="xgplayer-ended",Dn="xgplayer-isloading",Bn="xgplayer-is-error",Nn="xgplayer-replay",jn="xgplayer-nostart",Un="xgplayer-inactive",Vn="xgplayer-is-fullscreen",Fn="xgplayer-is-cssfullscreen",Hn="xgplayer-rotate-fullscreen",Gn="xgplayer-rotate-parent",Wn="xgplayer-fullscreen-parent",qn="xgplayer-fullscreen-inner",Kn="controls-autohide",zn="not-allow-autoplay",Zn="seeking",Yn="xgplayer-built-in";function Xn(){return{id:"",el:null,isNoRoot:!1,isCustomRoot:!0,url:"",domEventType:"default",nullUrlStart:!1,width:600,height:337.5,fluid:!1,fitVideoSize:"fixed",videoFillMode:"auto",volume:.6,autoplay:!1,autoplayMuted:!1,loop:!1,isLive:!1,zoom:1,videoInit:!0,poster:"",isMobileSimulateMode:!1,defaultPlaybackRate:1,execBeforePluginsCall:null,allowSeekAfterEnded:!0,enableContextmenu:!0,closeVideoClick:!1,closeVideoDblclick:!1,closePlayerBlur:!1,closeDelayBlur:!1,leavePlayerTime:3e3,closePlayVideoFocus:!1,closePauseVideoFocus:!1,closeFocusVideoFocus:!0,closeControlsBlur:!0,topBarAutoHide:!0,videoAttributes:{},startTime:0,seekedStatus:"play",miniprogress:!1,disableSwipeHandler:function(){},enableSwipeHandler:function(){},preProcessUrl:null,ignores:[],whitelist:[],inactive:3e3,lang:(e=(document.documentElement.getAttribute("lang")||navigator.language||"zh-cn").toLocaleLowerCase(),"zh-cn"===e&&(e="zh"),e),controls:!0,marginControls:!1,fullscreenTarget:null,screenShot:!1,rotate:!1,pip:!1,download:!1,mini:!1,cssFullscreen:!0,keyShortcut:!0,presets:[],plugins:[],playbackRate:1,definition:{list:[]},playsinline:!0,customDuration:0,timeOffset:0,icons:{},i18n:[],tabindex:0,thumbnail:null,videoConfig:{},isHideTips:!1,minWaitDelay:200,commonStyle:{progressColor:"",playedColor:"",cachedColor:"",sliderBtnStyle:{},volumeColor:""}};var e}var Qn=function(e){function t(){var e;ur(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pr(e=cr(this,t,[].concat(n)),"onMouseEnter",function(t){var r=e,n=r.player;r.playerConfig.closeControlsBlur&&n.focus({autoHide:!1})}),pr(e,"onMouseLeave",function(t){e.player.focus()}),e}return yr(t,e),hr(t,[{key:"beforeCreate",value:function(e){e.config.mode||"mobile"!==Nr.device||(e.config.mode="flex"),e.player.config.marginControls&&(e.config.autoHide=!1)}},{key:"afterCreate",value:function(){var e=this,t=this.config,r=t.disable,n=t.height,i=t.mode;if(!r){"flex"===i&&this.player.addClass("flex-controls");var o={height:"".concat(n,"px")};Object.keys(o).map(function(t){e.root.style[t]=o[t]}),this.left=this.find("xg-left-grid"),this.center=this.find("xg-center-grid"),this.right=this.find("xg-right-grid"),this.innerRoot=this.find("xg-inner-controls"),this.on("mini_state_change",function(t){t?Lr.addClass(e.root,"mini-controls"):Lr.removeClass(e.root,"mini-controls")});var s=this.playerConfig.isMobileSimulateMode;"mobile"!==Nr.device&&"mobile"!==s&&(this.bind("mouseenter",this.onMouseEnter),this.bind("mouseleave",this.onMouseLeave))}}},{key:"focus",value:function(){this.player.focus({autoHide:!1})}},{key:"focusAwhile",value:function(){this.player.focus({autoHide:!0})}},{key:"blur",value:function(){this.player.blur({ignorePaused:!0})}},{key:"recoverAutoHide",value:function(){this.config.autoHide&&Lr.addClass(this.root,Kn)}},{key:"pauseAutoHide",value:function(){Lr.removeClass(this.root,Kn)}},{key:"show",value:function(e){this.root.style.display="",this.player.focus()}},{key:"hide",value:function(){this.root.style.display="none"}},{key:"mode",get:function(){return this.config.mode}},{key:"registerPlugin",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(this.root){var i=e.defaultConfig||{};if(!r.root){switch(r.position?r.position:r.config&&r.config.position?r.config.position:i.position){case kn.CONTROLS_LEFT:r.root=this.left;break;case kn.CONTROLS_RIGHT:r.root=this.right;break;case kn.CONTROLS_CENTER:r.root=this.center;break;case kn.CONTROLS:r.root=this.root;break;default:r.root=this.left}return Cr(t,"registerPlugin",this,3)([e,r,n])}}}},{key:"destroy",value:function(){"mobile"!==Nr.device&&(this.unbind("mouseenter",this.onMouseEnter),this.unbind("mouseleave",this.onMouseLeave))}},{key:"render",value:function(){var e=this.config,t=e.mode,r=e.autoHide,n=e.initShow;if(!e.disable){var i=Lr.classNames({"xgplayer-controls":!0},{"flex-controls":"flex"===t},{"bottom-controls":"bottom"===t},pr({},Kn,r),{"xgplayer-controls-initshow":n||!r});return'<xg-controls class="'.concat(i,'" unselectable="on">\n    <xg-inner-controls class="xg-inner-controls xg-pos">\n      <xg-left-grid class="xg-left-grid">\n      </xg-left-grid>\n      <xg-center-grid class="xg-center-grid"></xg-center-grid>\n      <xg-right-grid class="xg-right-grid">\n      </xg-right-grid>\n    </xg-inner-controls>\n    </xg-controls>')}}}],[{key:"pluginName",get:function(){return"controls"}},{key:"defaultConfig",get:function(){return{disable:!1,autoHide:!0,mode:"",initShow:!1}}}])}(An),Jn={lang:{},langKeys:[],textKeys:[]};function ei(e,t){return Object.keys(t).forEach(function(r){var n,i=Lr.typeOf(t[r]),o=Lr.typeOf(e[r]);"Array"===i?("Array"!==o&&(e[r]=[]),(n=e[r]).push.apply(n,Er(t[r]))):"Object"===i?("Object"!==o&&(e[r]={}),ei(e[r],t[r])):e[r]=t[r]}),e}function ti(){Object.keys(Jn.lang.en).map(function(e){Jn.textKeys[e]=e})}function ri(e,t){var r=e.LANG;if(t||(t=Jn),t.lang){var n=e.TEXT||{};"zh"===r&&(r="zh-cn"),t.lang[r]?ei(t.lang[r],n):(t.langKeys.push(r),t.lang[r]=n),ti()}}ri({LANG:"en",TEXT:{ERROR_TYPES:{network:{code:1,msg:"video download error"},mse:{code:2,msg:"stream append error"},parse:{code:3,msg:"parsing error"},format:{code:4,msg:"wrong format"},decoder:{code:5,msg:"decoding error"},runtime:{code:6,msg:"grammatical errors"},timeout:{code:7,msg:"play timeout"},other:{code:8,msg:"other errors"}},HAVE_NOTHING:"There is no information on whether audio/video is ready",HAVE_METADATA:"Audio/video metadata is ready ",HAVE_CURRENT_DATA:"Data about the current play location is available, but there is not enough data to play the next frame/millisecond",HAVE_FUTURE_DATA:"Current and at least one frame of data is available",HAVE_ENOUGH_DATA:"The available data is sufficient to start playing",NETWORK_EMPTY:"Audio/video has not been initialized",NETWORK_IDLE:"Audio/video is active and has been selected for resources, but no network is used",NETWORK_LOADING:"The browser is downloading the data",NETWORK_NO_SOURCE:"No audio/video source was found",MEDIA_ERR_ABORTED:"The fetch process is aborted by the user",MEDIA_ERR_NETWORK:"An error occurred while downloading",MEDIA_ERR_DECODE:"An error occurred while decoding",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video is not supported",REPLAY:"Replay",ERROR:"Network is offline",PLAY_TIPS:"Play",PAUSE_TIPS:"Pause",PLAYNEXT_TIPS:"Play next",DOWNLOAD_TIPS:"Download",ROTATE_TIPS:"Rotate",RELOAD_TIPS:"Reload",FULLSCREEN_TIPS:"Fullscreen",EXITFULLSCREEN_TIPS:"Exit fullscreen",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Exit cssfullscreen",TEXTTRACK:"Caption",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Off",OPEN:"Open",MINI_DRAG:"Click and hold to drag",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Please Try",REFRESH:"Refresh",FORWARD:"forward",LIVE_TIP:"Live"}});var ni={get textKeys(){return Jn.textKeys},get langKeys(){return Jn.langKeys},get lang(){var e={};return Jn.langKeys.map(function(t){e[t]=Jn.lang[t]}),Jn.lang["zh-cn"]&&(e.zh=Jn.lang["zh-cn"]||{}),e},extend:function(e,t){var r=[];if(t||(t=Jn),t.lang){r="Array"!==Lr.typeOf(e)?Object.keys(e).map(function(t){return{LANG:"zh"===t?"zh-cn":t,TEXT:e[t]}}):e;var n=t.lang;r.map(function(e){"zh"===e.LANG&&(e.LANG="zh-cn"),n[e.LANG]?ei(n[e.LANG]||{},e.TEXT||{}):ri(e,t)}),ti()}},use:ri,init:function(e){var t,r={lang:{},langKeys:[],textKeys:{},pId:e};return ei(r.lang,Jn.lang),(t=r.langKeys).push.apply(t,Er(Jn.langKeys)),ei(r.textKeys,Jn.textKeys),r}},ii=["ERROR","INITIAL","READY","ATTACHING","ATTACHED","NOTALLOW","RUNNING","ENDED","DESTROYED"],oi={},si=null,ai=function(e){function t(){return ur(this,t),cr(this,t,arguments)}return yr(t,e),hr(t,[{key:"add",value:function(e){e&&(oi[e.playerId]=e,1===Object.keys(oi).length&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete oi[e.playerId])}},{key:"_iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var r in oi)if(Object.prototype.hasOwnProperty.call(oi,r)){var n=oi[r];if(t){if(e(n))break}else e(n)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var t=null;return this._iterate(function(r){var n=e(r);return n&&(t=r),n},!0),t}},{key:"findAll",value:function(e){var t=[];return this._iterate(function(r){e(r)&&t.push(r)}),t}},{key:"setActive",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(oi[e])return t?this.forEach(function(t){e===t.playerId?(t.isUserActive=!0,t.isInstNext=!1):t.isUserActive=!1}):oi[e].isUserActive=t,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(oi),t=0;t<e.length;t++){var r=oi[e[t]];if(r&&r.isUserActive)return e[t]}return null}},{key:"setNext",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(oi[e])return t?this.forEach(function(t){e===t.playerId?(t.isUserActive=!1,t.isInstNext=!0):t.isInstNext=!1}):oi[e].isInstNext=t,e}}],[{key:"getInstance",value:function(){return si||(si=new t),si}}])}(Sr.EventEmitter),li=["play","pause","replay","retry"],ci=0,ui=0,di=null,hi=function(e){function t(e){var r;ur(this,t);var n,i=Lr.deepMerge(Xn(),e);pr(r=cr(this,t,[i]),"canPlayFunc",function(){if(r.config){var e=r.config,t=e.autoplay,n=e.defaultPlaybackRate;Rr.logInfo("player","canPlayFunc, startTime",r.__startTime),r._seekToStartTime(),r.playbackRate=n,(t||r._useAutoplay)&&r.mediaPlay(),r.off(Wr,r.canPlayFunc),r.removeClass(xn)}}),pr(r,"onFullscreenChange",function(e,t){var n=function(){Lr.setTimeout(r,function(){r.resize()},100)},i=Lr.getFullScreenEl();r._fullActionFrom?r._fullActionFrom="":r.emit(en,{eventType:"system",action:"switch_fullscreen",pluginName:"player",currentTime:r.currentTime,duration:r.duration,props:[{prop:"fullscreen",from:!0,to:!1}]});var o,s=function(e,t,r){if(e){var n=e.getAttribute(r);return!(!n||n!==t||"VIDEO"!==e.tagName&&"AUDIO"!==e.tagName)}}(i,r.playerId,cn),a=!!(o=i)&&!!o.shadowRoot;if(t||i&&(i===r._fullscreenEl||s)||a&&r._fullscreenEl)n(),!r.config.closeFocusVideoFocus&&r.media.focus(),r.fullscreen=!0,r.changeFullStyle(r.root,i,Vn),r.emit(Yr,!0,r._fullScreenOffset),r.cssfullscreen&&r.exitCssFullscreen();else if(r.fullscreen){n();var l=r,c=l._fullScreenOffset;if(l.config.needFullscreenScroll?(window.scrollTo(c.left,c.top),Lr.setTimeout(r,function(){r.fullscreen=!1,r._fullScreenOffset=null},100)):(!r.config.closeFocusVideoFocus&&r.media.focus(),r.fullscreen=!1,r._fullScreenOffset=null),r.cssfullscreen)r.removeClass(Vn);else{var u=r._fullscreenEl;u||!r.root.contains(e.target)&&e.target!==r.root||(u=e.target),r.recoverFullStyle(r.root,u,Vn)}r._fullscreenEl=null,r.emit(Yr,!1)}}),pr(r,"_onWebkitbeginfullscreen",function(e){r._fullscreenEl=r.media,r.onFullscreenChange(e,!0)}),pr(r,"_onWebkitendfullscreen",function(e){r.onFullscreenChange(e,!1)}),yn(r,li),r.config=i,r._pluginInfoId=Lr.generateSessionId(),(n=r).logInfo=Rr.logInfo.bind(n),n.logWarn=Rr.logWarn.bind(n),n.logError=Rr.logError.bind(n);var o=r.constructor.defaultPreset,s=r.config.presets;if(s.length){var a=s.indexOf("default");a>=0&&o&&(s[a]=o)}else o&&s.push(o);r.userTimer=null,r.waitTimer=null,r.handleSource=!0,r._state=1,r.isError=!1,r._hasStart=!1,r.isSeeking=!1,r.isCanplay=!1,r._useAutoplay=!1,r.__startTime=-1,r.rotateDeg=0,r.isActive=!1,r.fullscreen=!1,r.cssfullscreen=!1,r.isRotateFullscreen=!1,r._fullscreenEl=null,r.timeSegments=[],r._cssfullscreenEl=null,r.curDefinition=null,r._orgCss="",r._fullScreenOffset=null,r._videoHeight=0,r._videoWidth=0,r.videoPos={pi:1,scale:0,rotate:-1,x:0,y:0,h:-1,w:-1,vy:0,vx:0},r.sizeInfo={width:0,height:0,left:0,top:0},r._accPlayed={t:0,acc:0,loopAcc:0},r._offsetInfo={currentTime:-1,duration:-1},r.innerContainer=null,r.controls=null,r.topBar=null,r.root=null,r.__i18n=ni.init(r._pluginInfoId),Nr.os.isAndroid&&Nr.osVersion>0&&Nr.osVersion<6&&(r.config.autoplay=!1),r.database=new on,r.isUserActive=!1,r._onceSeekCanplay=null,r._isPauseBeforeSeek=0,r.innerStates={isActiveLocked:!1},r.instManager=di,r._initMedia();var l=r.config.isNoRoot,c=!l&&r._initDOM();if(!l&&!c)return console.error(new Error("can't find the dom which id is ".concat(r.config.id," or this.config.el does not exist"))),br(r);Rn.init(r);var u=r.config,d=u.definition,h=void 0===d?{}:d;if(!u.url&&h.list&&h.list.length>0){var p=h.list.find(function(e){return e.definition&&e.definition===h.defaultDefinition});p||(h.defaultDefinition=h.list[0].definition,p=h.list[0]),r.config.url=p.url,r.curDefinition=p}return r._bindEvents(),r._registerPresets(),r._registerPlugins(),Rn.onPluginsReady(r),r.getInitDefinition(),r.setState(2),Lr.setTimeout(r,function(){r.emit("ready")},0),r.onReady&&r.onReady(),(r.config.videoInit||r.config.autoplay)&&(!r.hasStart||r.state<4)&&r.start(),r}return yr(t,e),hr(t,[{key:"_initMedia",value:function(){var e=this.constructor.XgVideoProxy;if(e&&this.mediaConfig.mediaType===e.mediaType){var t=this.innerContainer||this.root;this.detachVideoEvents(this.media);var r=new e(t,this.config,this.mediaConfig);this.attachVideoEvents(r),this.media=r}this.media.setAttribute(cn,this.playerId)}},{key:"_initDOM",value:function(){var e,t=this,r=this.config,n=r.id,i=r.el,o=r.isCustomRoot,s=r.controls,a=r.autoplay,l=r.isMobileSimulateMode;if(this.root=n?document.getElementById(n):null,!this.root)if(i&&1===i.nodeType)this.root=i;else{if(o)return this.emit("error",new Fr("use",this.config.vid,{line:32,handle:"Constructor",msg:"container id can't be empty"})),console.error("this.confg.id or this.config.el can't be empty"),!1;this.root=Lr.createDom("div","",{id:n,class:Yn})}var c=function(e){for(var t=Object.keys(oi),r=0;r<t.length;r++){var n=oi[t[r]];if(n.root===e)return n}return null}(this.root);c&&(Rr.logWarn("The is an Player instance already exists in this.root, destroy it and reinitialize"),c.destroy()),this.root.setAttribute(cn,this.playerId),null===(e=di)||void 0===e||e.add(this),Rn.init(this),this._initBaseDoms();var u=this.constructor.XgVideoProxy;if(u&&this.mediaConfig.mediaType===u.mediaType){var d=this.innerContainer||this.root;this.detachVideoEvents(this.media);var h=new u(d,this.config,this.mediaConfig);this.attachVideoEvents(h),this.media=h}if(this.media.setAttribute(cn,this.playerId),s){var p=s.root||null,f=Rn.register(this,Qn,{root:p});this.controls=f}var _="mobile"===l?"mobile":Nr.device;if(this.addClass("".concat("xgplayer"," ").concat(Un," xgplayer-").concat(_," ").concat(s?"":"no-controls")),a?this.addClass(xn):this.addClass(jn),this.config.fluid){var y=this.config,g=y.width,m=y.height;"number"==typeof g&&"number"==typeof m||(g=600,m=337.5);var v={width:"100%",height:"0","max-width":"100%","padding-top":"".concat(100*m/g,"%")};Object.keys(v).forEach(function(e){t.root.style[e]=v[e]})}else["width","height"].forEach(function(e){t.config[e]&&("number"!=typeof t.config[e]?t.root.style[e]=t.config[e]:t.root.style[e]="".concat(t.config[e],"px"))});var b=this.root.getBoundingClientRect(),w=b.width,C=b.height,E=b.left,k=b.top;return this.sizeInfo.width=w,this.sizeInfo.height=C,this.sizeInfo.left=E,this.sizeInfo.top=k,!0}},{key:"_initBaseDoms",value:function(){this.topBar=null,this.leftBar=null,this.rightBar=null,this.config.marginControls&&(this.innerContainer=Lr.createDom("xg-video-container","",{"data-index":-1},"xg-video-container"),this.root.appendChild(this.innerContainer))}},{key:"_bindEvents",value:function(){var e=this;["focus","blur"].forEach(function(t){e.on(t,e["on"+t.charAt(0).toUpperCase()+t.slice(1)])}),sn.forEach(function(t){document&&document.addEventListener(t,e.onFullscreenChange)}),Nr.os.isIos&&(this.media.addEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.addEventListener("webkitendfullscreen",this._onWebkitendfullscreen)),this.once(qr,this.resize),this.playFunc=function(){e.config.closeFocusVideoFocus||e.media.focus()},this.once(Hr,this.playFunc)}},{key:"_unbindEvents",value:function(){var e=this;this.root&&this.root.removeEventListener("mousemove",this.mousemoveFunc),sn.forEach(function(t){document.removeEventListener(t,e.onFullscreenChange)}),this.playFunc&&this.off(Hr,this.playFunc),this.off(Wr,this.canPlayFunc),this.media.removeEventListener("webkitbeginfullscreen",this._onWebkitbeginfullscreen),this.media.removeEventListener("webkitendfullscreen",this._onWebkitendfullscreen)}},{key:"_clearUserTimer",value:function(){this.userTimer&&(Lr.clearTimeout(this,this.userTimer),this.userTimer=null)}},{key:"_startInit",value:function(e){var t=this;if(this.media&&(e&&""!==e&&("Array"!==Lr.typeOf(e)||0!==e.length)||(e="",this.emit("urlNull"),Rr.logWarn("config.url is null, please get url and run player._startInit(url)"),!this.config.nullUrlStart))){this.handleSource&&(this._detachSourceEvents(this.media),"Array"===Lr.typeOf(e)&&e.length>0?this._attachSourceEvents(this.media,e):this.media.src&&this.media.src===e?e||this.media.removeAttribute("src"):this.media.src=e),"Number"===Lr.typeOf(this.config.volume)&&(this.volume=this.config.volume);var r=this.innerContainer?this.innerContainer:this.root;r&&this.media instanceof window.Element&&!r.contains(this.media)&&r.insertBefore(this.media,r.firstChild);var n=this.media.readyState;Rr.logInfo("_startInit readyState",n),this.config.autoplay&&(!Lr.isMSE(this.media)&&this.load(),(Nr.os.isIpad||Nr.os.isPhone)&&this.mediaPlay());var i=this.config.startTime;this.__startTime=i>0?i:-1,this.config.startTime=0,n>=2&&this.duration>0?this.canPlayFunc():this.on(Wr,this.canPlayFunc),(!this.hasStart||this.state<4)&&Rn.afterInit(this),this.hasStart=!0,this.setState(4),Lr.setTimeout(this,function(){t.emit("complete")},0)}}},{key:"_registerPlugins",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._loadingPlugins=[];var r=this.config.ignores||[],n=this.config.plugins||[],i=this.config.i18n||[];t&&ni.extend(i,this.__i18n);var o=r.join("||").toLowerCase().split("||"),s=this.plugins;n.forEach(function(r){try{var n=r.plugin?r.plugin.pluginName:r.pluginName;if(n&&o.indexOf(n.toLowerCase())>-1)return null;if(!t&&s[n.toLowerCase()])return;if(r.lazy&&r.loader){var i=Rn.lazyRegister(e,r);return void(r.forceBeforeInit&&(i.then(function(){e._loadingPlugins.splice(e._loadingPlugins.indexOf(i),1)}).catch(function(t){Rr.logError("_registerPlugins:loadingPlugin",t),e._loadingPlugins.splice(e._loadingPlugins.indexOf(i),1)}),e._loadingPlugins.push(i)))}return e.registerPlugin(r)}catch(e){Rr.logError("_registerPlugins:",e)}})}},{key:"_registerPresets",value:function(){var e=this;this.config.presets.forEach(function(t){!function(e,t){var r,n,i=t.preset&&t.options?new t.preset(t.options,e.config):new t({},e.config),o=i.plugins,s=void 0===o?[]:o,a=i.ignores,l=void 0===a?[]:a,c=i.icons,u=void 0===c?{}:c,d=i.i18n,h=void 0===d?[]:d;e.config.plugins||(e.config.plugins=[]),e.config.ignores||(e.config.ignores=[]),(r=e.config.plugins).push.apply(r,Er(s)),(n=e.config.ignores).push.apply(n,Er(l)),Object.keys(u).map(function(t){e.config.icons[t]||(e.config.icons[t]=u[t])});var p=e.config.i18n||[];h.push.apply(h,Er(p)),e.config.i18n=h}(e,t)})}},{key:"_getRootByPosition",value:function(e){var t=null;switch(e){case kn.ROOT_RIGHT:this.rightBar||(this.rightBar=Lr.createPositionBar("xg-right-bar",this.root)),t=this.rightBar;break;case kn.ROOT_LEFT:this.leftBar||(this.leftBar=Lr.createPositionBar("xg-left-bar",this.root)),t=this.leftBar;break;case kn.ROOT_TOP:this.topBar||(this.topBar=Lr.createPositionBar("xg-top-bar",this.root),this.config.topBarAutoHide&&Lr.addClass(this.topBar,"top-bar-autohide")),t=this.topBar;break;default:t=this.innerContainer||this.root}return t}},{key:"registerPlugin",value:function(e,t){var r=Rn.formatPluginInfo(e,t),n=r.PLUFGIN,i=r.options,o=this.config.plugins;!Rn.checkPluginIfExits(n.pluginName,o)&&o.push(n);var s=Rn.getRootByConfig(n.pluginName,this.config);s.root&&(i.root=s.root),s.position&&(i.position=s.position);var a=i.position?i.position:i.config&&i.config.position||n.defaultConfig&&n.defaultConfig.position;return!i.root&&"string"==typeof a&&a.indexOf("controls")>-1?this.controls&&this.controls.registerPlugin(n,i,n.pluginName):(i.root||(i.root="controls"===n.pluginName?this.root:this._getRootByPosition(a)),Rn.register(this,n,i))}},{key:"deregister",value:function(e){"string"==typeof e?Rn.unRegister(this,e):e instanceof bn&&Rn.unRegister(this,e.pluginName)}},{key:"unRegisterPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.deregister(e),t&&this.removePluginFromConfig(e)}},{key:"removePluginFromConfig",value:function(e){var t;if("string"==typeof e?t=e:e instanceof bn&&(t=e.pluginName),t)for(var r=this.config.plugins.length-1;r>-1;r--)if(this.config.plugins[r].pluginName.toLowerCase()===t.toLowerCase()){this.config.plugins.splice(r,1);break}}},{key:"plugins",get:function(){return Rn.getPlugins(this)}},{key:"getPlugin",value:function(e){var t=Rn.findPlugin(this,e);return t&&t.pluginName?t:null}},{key:"addClass",value:function(e){this.root&&(Lr.hasClass(this.root,e)||Lr.addClass(this.root,e))}},{key:"removeClass",value:function(e){this.root&&Lr.removeClass(this.root,e)}},{key:"hasClass",value:function(e){if(this.root)return Lr.hasClass(this.root,e)}},{key:"setAttribute",value:function(e,t){this.root&&this.root.setAttribute(e,t)}},{key:"removeAttribute",value:function(e,t){this.root&&this.root.removeAttribute(e,t)}},{key:"start",value:function(e){var t=this;if(!(this.state>3))return e||this.config.url||this.getInitDefinition(),this.hasStart=!0,this.setState(3),this._registerPlugins(!1),Rn.beforeInit(this).then(function(){if(t.config){e||(e=t.url||t.config.url);var r=t._preProcessUrl(e);return t._startInit(r.url)}}).catch(function(e){throw e.fileName="player",e.lineNumber="236",Rr.logError("start:beforeInit:",e),e})}},{key:"switchURL",value:function(e,t){var r=this,n=e;"Object"===Lr.typeOf(e)&&(n=e.url),n=this._preProcessUrl(n).url;var i=this.currentTime;this.__startTime=i;var o=this.paused&&!this.isError;return this.src=n,new Promise(function(e,t){var i=function(e){r.off("timeupdate",s),r.off("canplay",s),t(e)},s=function(){r._seekToStartTime(),o&&r.pause(),r.off("error",i),e(!0)};r.once("error",i),n?(Nr.os.isAndroid?r.once("timeupdate",s):r.once("canplay",s),r.play()):r.errorHandler("error",{code:6,message:"empty_src"})})}},{key:"videoPlay",value:function(){this.mediaPlay()}},{key:"mediaPlay",value:function(){var e=this;if(!this.hasStart&&this.state<4)return this.removeClass(jn),this.addClass(xn),this.start(),void(this._useAutoplay=!0);this.state<6&&(this.removeClass(jn),!this.isCanplay&&this.addClass(xn));var r=Cr(t,"play",this,3)([]);return void 0!==r&&r&&r.then?r.then(function(){e.removeClass(zn),e.addClass(In),e.state<6&&(Rr.logInfo(">>>>playPromise.then"),e.setState(6),e.emit(Zr))}).catch(function(t){if(Rr.logWarn(">>>>playPromise.catch",t.name),e.media&&e.media.error)return e.onError(),void e.removeClass(xn);"NotAllowedError"===t.name&&(e._errorTimer=Lr.setTimeout(e,function(){e._errorTimer=null,e.emit("autoplay_was_prevented"),e.addClass(zn),e.removeClass(xn),e.pause(),e.setState(5)},0))}):(Rr.logWarn("video.play not return promise"),this.state<6&&(this.setState(6),this.removeClass(zn),this.removeClass(jn),this.removeClass(xn),this.addClass(In),this.emit(Zr))),r}},{key:"mediaPause",value:function(){Cr(t,"pause",this,3)([])}},{key:"videoPause",value:function(){Cr(t,"pause",this,3)([])}},{key:"play",value:function(){var e=this;return this.removeClass(Ln),mn(this,"play",function(){return e.mediaPlay()})}},{key:"pause",value:function(){var e=this;mn(this,"pause",function(){Cr(t,"pause",e,3)([])})}},{key:"seek",value:function(e,t){var r=this;if(this.media&&!Number.isNaN(Number(e))&&this.hasStart){var n=this.config,i=n.isSeekedPlay,o=n.seekedStatus,s=t||(i?"play":o);e=e<0?0:e>this.duration?parseInt(this.duration,10):e,!this._isPauseBeforeSeek&&(this._isPauseBeforeSeek=this.paused?2:1),this._onceSeekCanplay&&this.off(Gr,this._onceSeekCanplay),this._onceSeekCanplay=function(){switch(r.removeClass(xn),r.isSeeking=!1,s){case"play":r.play();break;case"pause":r.pause();break;default:r._isPauseBeforeSeek>1||r.paused?r.pause():r.play()}r._isPauseBeforeSeek=0,r._onceSeekCanplay=null},this.once(Gr,this._onceSeekCanplay),this.state<6?(this.removeClass(jn),this.currentTime=e,this.play()):this.currentTime=e}}},{key:"getInitDefinition",value:function(){var e=this,t=this.config,r=t.definition;!t.url&&r&&r.list&&r.list.length>0&&r.defaultDefinition&&r.list.map(function(t){t.definition===r.defaultDefinition&&(e.config.url=t.url,e.curDefinition=t)})}},{key:"changeDefinition",value:function(e,t){var r=this,n=this.config.definition;if(Array.isArray(null==n?void 0:n.list)&&n.list.forEach(function(t){(null==e?void 0:e.definition)===t.definition&&(r.curDefinition=t)}),null!=e&&e.bitrate&&"number"!=typeof e.bitrate&&(e.bitrate=parseInt(e.bitrate,10)||0),this.emit("definition_change",{from:t,to:e}),this.hasStart){var i=this.switchURL(e.url,vr({seamless:!1!==n.seamless&&"undefined"!=typeof MediaSource&&"function"==typeof MediaSource.isTypeSupported},e));i&&i.then?i.then(function(){r.emit(Qr,{from:t,to:e})}):this.emit(Qr,{from:t,to:e})}else this.config.url=e.url}},{key:"reload",value:function(){this.load(),this.reloadFunc=function(){this.play()},this.once(qr,this.reloadFunc)}},{key:"resetState",value:function(){var e=this,t=[zn,In,jn,Ln,Nn,xn,Mn,Bn,Dn];this.hasStart=!1,this.isError=!1,this._useAutoplay=!1,this.mediaPause(),this._accPlayed.acc=0,this._accPlayed.t=0,this._accPlayed.loopAcc=0,t.forEach(function(t){e.removeClass(t)}),this.addClass(jn),this.emit("reset")}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;if(this.resetState(),this.plugins&&(t.map(function(t){e.deregister(t)}),r)){var n=Xn();Object.keys(this.config).keys(function(t){"undefined"===e.config[t]||"plugins"!==t&&"presets"!==t&&"el"!==t&&"id"!==t||(e.config[t]=n[t])})}}},{key:"destroy",value:function(){var e,r=this,n=this.innerContainer,i=this.root,o=this.media;if(o){if(this.hasStart=!1,this._useAutoplay=!1,i&&i.removeAttribute(cn),this.updateAcc("destroy"),this._unbindEvents(),this._detachSourceEvents(this.media),Lr.clearAllTimers(this),this.emit("destroy"),null===(e=di)||void 0===e||e.remove(this),Rn.destroy(this),gn(this),Cr(t,"destroy",this,3)([]),this.fullscreen&&this._fullscreenEl===i&&this.exitFullscreen(),n)for(var s=n.children,a=0;a<s.length;a++)n.removeChild(s[a]);i&&!n&&o instanceof window.Node&&i.contains(o)&&i.removeChild(o),["topBar","leftBar","rightBar","innerContainer"].map(function(e){r[e]&&i.removeChild(r[e]),r[e]=null});var l=i?i.className.split(" "):[],c=i&&Lr.hasClass(i,Yn);l.length>0?i.className=l.filter(function(e){return e.indexOf("xgplayer")<0}).join(" "):i&&(i.className=""),this.removeAttribute("data-xgfill"),["isSeeking","isCanplay","isActive","cssfullscreen","fullscreen"].forEach(function(e){r[e]=!1}),c&&this.root.parentNode&&this.root.parentNode.removeChild(this.root)}}},{key:"replay",value:function(){var e=this;this.removeClass(Mn),this.currentTime=0,this.isSeeking=!1,mn(this,"replay",function(){e.once(Gr,function(){var t=e.mediaPlay();t&&t.catch&&t.catch(function(e){console.log(e)})}),e.emit("replay"),e.onPlay()})}},{key:"retry",value:function(){var e=this;this.removeClass(Bn),this.addClass(Dn),mn(this,"retry",function(){var t=e.currentTime,r=e.config.url,n=Lr.isMSE(e.media)?{url:r}:e._preProcessUrl(r);e.src=n.url,!e.config.isLive&&(e.currentTime=t),e.once(Wr,function(){e.mediaPlay()})})}},{key:"changeFullStyle",value:function(e,t,r,n){e&&(n||(n=Wn),this._orgCss||(this._orgCss=Lr.filterStyleFromText(e)),Lr.addClass(e,r),t&&t!==e&&!this._orgPCss&&(this._orgPCss=Lr.filterStyleFromText(t),Lr.addClass(t,n),t.setAttribute(cn,this.playerId)))}},{key:"recoverFullStyle",value:function(e,t,r,n){n||(n=Wn),this._orgCss&&(Lr.setStyleFromCsstext(e,this._orgCss),this._orgCss=""),Lr.removeClass(e,r),t&&t!==e&&this._orgPCss&&(Lr.setStyleFromCsstext(t,this._orgPCss),this._orgPCss="",Lr.removeClass(t,n),t.removeAttribute(cn))}},{key:"getFullscreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget,t=this.root,r=this.media;if("video"!==e&&"media"!==e||(e=this[e]),e||(e=t),this._fullScreenOffset={top:Lr.scrollTop(),left:Lr.scrollLeft()},this._fullscreenEl=e,this._fullActionFrom="get",Lr.getFullScreenEl()===this._fullscreenEl)return this.onFullscreenChange(),Promise.resolve();try{for(var n=0;n<an.length;n++){var i=an[n];if(e[i]){var o="webkitRequestFullscreen"===i?e.webkitRequestFullscreen(window.Element.ALLOW_KEYBOARD_INPUT):e[i]();return o&&o.then?o:Promise.resolve()}}return r.fullscreenEnabled||r.webkitSupportsFullscreen?(r.webkitEnterFullscreen(),Promise.resolve()):Promise.reject(new Error("call getFullscreen fail"))}catch(e){return Promise.reject(new Error("call getFullscreen fail"))}}},{key:"exitFullscreen",value:function(e){if(this.isRotateFullscreen&&this.exitRotateFullscreen(),this._fullscreenEl||Lr.getFullScreenEl()){this.root;var t=this.media;this._fullActionFrom="exit";try{for(var r=0;r<ln.length;r++){var n=ln[r];if(document[n]){var i=document[n]();return i&&i.then?i:Promise.resolve()}}return t&&t.webkitSupportsFullscreen?(t.webkitExitFullScreen(),Promise.resolve()):Promise.reject(new Error("call exitFullscreen fail"))}catch(e){return Promise.reject(new Error("call exitFullscreen fail"))}}}},{key:"getCssFullscreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget;this.isRotateFullscreen?this.exitRotateFullscreen():this.fullscreen&&this.exitFullscreen();var t=e?"".concat(qn," ").concat(Fn):Fn;this.changeFullStyle(this.root,e,t);var r=this.config.fullscreen,n=void 0===r?{}:r;(!0===n.useCssFullscreen||"function"==typeof n.useCssFullscreen&&n.useCssFullscreen())&&(this.fullscreen=!0,this.emit(Yr,!0)),this._cssfullscreenEl=e,this.cssfullscreen=!0,this.emit(Xr,!0)}},{key:"exitCssFullscreen",value:function(){var e=this._cssfullscreenEl?"".concat(qn," ").concat(Fn):Fn;if(this.fullscreen){var t=this.config.fullscreen,r=void 0===t?{}:t;!0===r.useCssFullscreen||"function"==typeof r.useCssFullscreen&&r.useCssFullscreen()?(this.recoverFullStyle(this.root,this._cssfullscreenEl,e),this.fullscreen=!1,this.emit(Yr,!1)):this.removeClass(e)}else this.recoverFullStyle(this.root,this._cssfullscreenEl,e);this._cssfullscreenEl=null,this.cssfullscreen=!1,this.emit(Xr,!1)}},{key:"getRotateFullscreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.fullscreenTarget;this.cssfullscreen&&this.exitCssFullscreen(e);var t=e?"".concat(qn," ").concat(Hn):Hn;this._fullscreenEl=e||this.root,this.changeFullStyle(this.root,e,t,Gn),this.isRotateFullscreen=!0,this.fullscreen=!0,this.setRotateDeg(90),this._rootStyle=this.root.getAttribute("style"),this.root.style.width="".concat(window.innerHeight,"px"),this.emit(Yr,!0)}},{key:"exitRotateFullscreen",value:function(e){var t=this._fullscreenEl!==this.root?"".concat(qn," ").concat(Hn):Hn;this.recoverFullStyle(this.root,this._fullscreenEl,t,Gn),this.isRotateFullscreen=!1,this.fullscreen=!1,this.setRotateDeg(0),this.emit(Yr,!1),this._rootStyle&&(this.root.style.style=this._rootStyle,this._rootStyle=!1)}},{key:"setRotateDeg",value:function(e){90===window.orientation||-90===window.orientation?this.rotateDeg=0:this.rotateDeg=e}},{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoHide:!this.config.closeDelayBlur,delay:this.config.inactive};this.isActive?this.onFocus(e):this.emit(Kr,vr({paused:this.paused,ended:this.ended},e))}},{key:"blur",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ignorePaused:!1};this.isActive?(this._clearUserTimer(),this.emit(zr,vr({paused:this.paused,ended:this.ended},e))):this.onBlur(e)}},{key:"onFocus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{autoHide:!0,delay:3e3},r=this.innerStates;if(this.isActive=!0,this.removeClass(Un),this._clearUserTimer(),void 0!==t.isLock&&(r.isActiveLocked=t.isLock),!1===t.autoHide||!0===t.isLock||r.isActiveLocked)this._clearUserTimer();else{var n=t&&t.delay?t.delay:this.config.inactive;this.userTimer=Lr.setTimeout(this,function(){e.userTimer=null,e.blur()},n)}}},{key:"onBlur",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ignorePaused,t=void 0!==e&&e;if(!this.innerStates.isActiveLocked){var r=this.config.closePauseVideoFocus;this.isActive=!1,(t||r||!this.paused&&!this.ended)&&this.addClass(Un)}}},{key:"onEmptied",value:function(){this.updateAcc("emptied")}},{key:"onCanplay",value:function(){this.removeClass(xn),this.removeClass(Bn),this.removeClass(Dn),this.isCanplay=!0,this.waitTimer&&Lr.clearTimeout(this,this.waitTimer)}},{key:"onLoadeddata",value:function(){var e=this;this.isError=!1,this.isSeeking=!1,this.__startTime>0&&(this.duration>0?this._seekToStartTime():this.once("durationchange",function(){e._seekToStartTime()}))}},{key:"onLoadstart",value:function(){this.removeClass(Bn),this.isCanplay=!1}},{key:"onPlay",value:function(){7===this.state&&this.setState(6),this.removeClass(Ln),this.ended&&this.removeClass(Mn),!this.config.closePlayVideoFocus&&this.focus()}},{key:"onPause",value:function(){this.addClass(Ln),this.updateAcc("pause"),this.config.closePauseVideoFocus||(this._clearUserTimer(),this.focus())}},{key:"onEnded",value:function(){this.updateAcc("ended"),this.addClass(Mn),this.setState(7)}},{key:"onError",value:function(){this.isError=!0,this.updateAcc("error"),this.removeClass(zn),this.removeClass(jn),this.removeClass(xn),this.removeClass(Dn),this.addClass(Bn)}},{key:"onSeeking",value:function(){this.isSeeking||this.updateAcc("seeking"),this.isSeeking=!0,this.addClass(Zn)}},{key:"onSeeked",value:function(){this.isSeeking=!1,this.waitTimer&&Lr.clearTimeout(this,this.waitTimer),this.removeClass(Dn),this.removeClass(Zn)}},{key:"onWaiting",value:function(){var e=this;this.waitTimer&&Lr.clearTimeout(this,this.waitTimer),this.updateAcc("waiting"),this.waitTimer=Lr.setTimeout(this,function(){e.addClass(Dn),e.emit("loading"),Lr.clearTimeout(e,e.waitTimer),e.waitTimer=null},this.config.minWaitDelay)}},{key:"onPlaying",value:function(){var e=this;this.isError=!1,[jn,Ln,Mn,Bn,Nn,Dn].forEach(function(t){e.removeClass(t)}),this._accPlayed.t||this.paused||this.ended||(this._accPlayed.t=(new Date).getTime())}},{key:"onTimeupdate",value:function(){!this._videoHeight&&this.media.videoHeight&&this.resize(),(this.waitTimer||this.hasClass(Dn))&&this.media.readyState>2&&(this.removeClass(Dn),Lr.clearTimeout(this,this.waitTimer),this.waitTimer=null),!this.paused&&5===this.state&&this.duration&&(this.setState(6),this.emit(Zr)),this._accPlayed.t||this.paused||this.ended||(this._accPlayed.t=(new Date).getTime())}},{key:"onVolumechange",value:function(){"Number"===Lr.typeOf(this.config.volume)&&(this.config.volume=this.volume)}},{key:"onRatechange",value:function(){this.config.defaultPlaybackRate=this.playbackRate}},{key:"emitUserAction",value:function(e,t,r){if(this.media&&t&&e){var n="String"===Lr.typeOf(e)?e:e.type||"";r.props&&"Array"!==Lr.typeOf(r.props)&&(r.props=[r.props]),this.emit(en,vr({eventType:n,action:t,currentTime:this.currentTime,duration:this.duration,ended:this.ended,event:e},r))}}},{key:"updateAcc",value:function(e){if(this._accPlayed.t){var t=(new Date).getTime()-this._accPlayed.t;this._accPlayed.acc+=t,this._accPlayed.t=0,("ended"===e||this.ended)&&(this._accPlayed.loopAcc=this._accPlayed.acc)}}},{key:"checkBuffer",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{startDiff:0,endDiff:0})||{},r=t.startDiff,n=void 0===r?0:r,i=t.endDiff,o=void 0===i?0:i,s=this.media.buffered;if(!s||0===s.length||!this.duration)return!0;for(var a=e||this.media.currentTime||.2,l=s.length,c=0;c<l;c++)if(s.start(c)+n<=a&&s.end(c)-o>a)return!0;return!1}},{key:"resizePosition",value:function(){var e=this.videoPos,t=e.vy,r=e.vx,n=e.h,i=e.w,o=this.videoPos.rotate;if(!(o<0&&n<0&&i<0)){var s=this.videoPos._pi;if(!s&&this.media.videoHeight&&(s=this.media.videoWidth/this.media.videoHeight*100),s){this.videoPos.pi=s;var a={rotate:o=o<0?0:o},l=0,c=0,u=1,d=Math.abs(o/90),h=this.root,p=this.innerContainer,f=h.offsetWidth,_=p?p.offsetHeight:h.offsetHeight,y=_,g=f;if(d%2==0)u=n>0?100/n:i>0?100/i:1,a.scale=u,l=t>0?(100-n)/2-t:0,a.y=2===d?0-l:l,c=r>0?(100-i)/2-r:0,a.x=2===d?0-c:c,this.media.style.width="".concat(g,"px"),this.media.style.height="".concat(y,"px");else if(d%2==1){y=f;var m=_-f;c=-m/2/(g=_)*100,a.x=3===d?c+t/2:c-t/2,l=m/2/y*100,a.y=3===d?l+r/2:l-r/2,a.scale=u,this.media.style.width="".concat(g,"px"),this.media.style.height="".concat(y,"px")}var v=Lr.getTransformStyle(a,this.media.style.transform||this.media.style.webkitTransform);this.media.style.transform=v,this.media.style.webkitTransform=v}}}},{key:"position",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{h:0,y:0,x:0,w:0};if(this.media&&e&&e.h){var t=this.videoPos;t.h=100*e.h||0,t.w=100*e.w||0,t.vx=100*e.x||0,t.vy=100*e.y||0,this.resizePosition()}}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map(function(r){if("plugins"!==r){t.config[r]=e[r];var n=t.plugins[r.toLowerCase()];n&&"Function"===Lr.typeOf(n.setConfig)&&n.setConfig(e[r])}})}},{key:"playNext",value:function(e){var t=this;this.resetState(),this.setConfig(e),this._currentTime=0,this._duration=0,mn(this,"playnext",function(){t.start(),t.emit("playnext",e)})}},{key:"resize",value:function(){var e=this;if(this.media&&this.root){var t=this.root.getBoundingClientRect();this.sizeInfo.width=t.width,this.sizeInfo.height=t.height,this.sizeInfo.left=t.left,this.sizeInfo.top=t.top;var r=this.media,n=r.videoWidth,i=r.videoHeight,o=this.config,s=o.fitVideoSize,a=o.videoFillMode;if("fill"!==a&&"cover"!==a&&"contain"!==a||this.setAttribute("data-xgfill",a),i&&n){this._videoHeight=i,this._videoWidth=n;var l=this.controls&&this.innerContainer?this.controls.root.getBoundingClientRect().height:0,c=t.width,u=t.height-l,d=parseInt(n/i*1e3,10),h=parseInt(c/u*1e3,10),p=c,f=u,_={};"auto"===s&&h>d||"fixWidth"===s?(f=c/d*1e3,this.config.fluid?_.paddingTop="".concat(100*f/p,"%"):_.height="".concat(f+l,"px")):("auto"===s&&h<d||"fixHeight"===s)&&(p=d*u/1e3,_.width="".concat(p,"px")),this.fullscreen||this.cssfullscreen||Object.keys(_).forEach(function(t){e.root.style[t]=_[t]}),("fillHeight"===a&&h<d||"fillWidth"===a&&h>d)&&this.setAttribute("data-xgfill","cover");var y={videoScale:d,vWidth:p,vHeight:f,cWidth:p,cHeight:f+l};this.resizePosition(),this.emit(Jr,y)}}}},{key:"updateObjectPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.media.updateObjectPosition?this.media.updateObjectPosition(e,t):this.media.style.objectPosition="".concat(100*e,"% ").concat(100*t,"%")}},{key:"setState",value:function(e){Rr.logInfo("setState","state from:".concat(ii[this.state]," to:").concat(ii[e])),this._state=e}},{key:"_preProcessUrl",value:function(e,t){var r=this.config,n=r.preProcessUrl,i=r.preProcessUrlOptions,o=Object.assign({},i,t);return Lr.isBlob(e)||"function"!=typeof n?{url:e}:n(e,o)}},{key:"_seekToStartTime",value:function(){this.__startTime>0&&this.duration>0&&(this.currentTime=this.__startTime>this.duration?this.duration:this.__startTime,this.__startTime=-1)}},{key:"state",get:function(){return this._state}},{key:"isFullscreen",get:function(){return this.fullscreen}},{key:"isCssfullScreen",get:function(){return this.cssfullscreen}},{key:"hasStart",get:function(){return this._hasStart},set:function(e){"boolean"==typeof e&&(this._hasStart=e,!1===e&&this.setState(2),this.emit("hasstart"))}},{key:"isPlaying",get:function(){return 6===this._state||7===this._state},set:function(e){e?this.setState(6):this._state>=6&&this.setState(4)}},{key:"definitionList",get:function(){return this.config&&this.config.definition&&this.config.definition.list||[]},set:function(e){var t=this,r=this.config.definition,n=null,i=null;r.list=e,this.emit("resourceReady",e),e.forEach(function(e){var o;(null===(o=t.curDefinition)||void 0===o?void 0:o.definition)===e.definition&&(n=e),r.defaultDefinition===e.definition&&(i=e)}),!i&&e.length>0&&(i=e[0]),n?this.changeDefinition(n):i&&this.changeDefinition(i)}},{key:"videoFrameInfo",get:function(){var e={total:0,dropped:0,corrupted:0,droppedRate:0,droppedDuration:0};if(!this.media||!this.media.getVideoPlaybackQuality)return e;var t=this.media.getVideoPlaybackQuality();return e.dropped=t.droppedVideoFrames||0,e.total=t.totalVideoFrames||0,e.corrupted=t.corruptedVideoFrames||0,e.total>0&&(e.droppedRate=e.dropped/e.total*100,e.droppedDuration=parseInt(this.cumulateTime/e.total*e.dropped,0)),e}},{key:"lang",get:function(){return this.config.lang},set:function(e){0!==ni.langKeys.filter(function(t){return t===e}).length||"zh"===e?(this.config.lang=e,Rn.setLang(e,this)):console.error("Sorry, set lang fail, because the language [".concat(e,"] is not supported now, list of all supported languages is [").concat(ni.langKeys.join(),"] "))}},{key:"i18n",get:function(){var e=this.config.lang;return"zh"===e&&(e="zh-cn"),this.__i18n.lang[e]||this.__i18n.lang.en}},{key:"i18nKeys",get:function(){return this.__i18n.textKeys||{}}},{key:"version",get:function(){return jr}},{key:"playerId",get:function(){return this._pluginInfoId}},{key:"url",get:function(){return this.__url||this.config.url},set:function(e){this.__url=e}},{key:"poster",get:function(){return this.plugins.poster?this.plugins.poster.config.poster:this.config.poster},set:function(e){this.plugins.poster&&this.plugins.poster.update(e)}},{key:"readyState",get:function(){return Cr(t,"readyState",this,1)}},{key:"error",get:function(){var e=Cr(t,"error",this,1);return this.i18n[e]||e}},{key:"networkState",get:function(){return Cr(t,"networkState",this,1)}},{key:"fullscreenChanging",get:function(){return!(null===this._fullScreenOffset)}},{key:"cumulateTime",get:function(){var e=this._accPlayed,t=e.acc,r=e.t;return r?(new Date).getTime()-r+t:t}},{key:"zoom",get:function(){return this.config.zoom},set:function(e){this.config.zoom=e}},{key:"videoRotateDeg",get:function(){return this.videoPos.rotate},set:function(e){(e=Lr.convertDeg(e))%90==0&&e!==this.videoPos.rotate&&(this.videoPos.rotate=e,this.resizePosition())}},{key:"avgSpeed",get:function(){return ui},set:function(e){ui=e}},{key:"realTimeSpeed",get:function(){return ci},set:function(e){ci=e}},{key:"offsetCurrentTime",get:function(){return this._offsetInfo.currentTime>-1?this._offsetInfo.currentTime:this.currentTime},set:function(e){this._offsetInfo.currentTime=e}},{key:"offsetDuration",get:function(){return this._offsetInfo.duration>-1?this._offsetInfo.duration:this.duration},set:function(e){this._offsetInfo.duration=e||0}},{key:"hook",value:function(e,t){return dn.call.apply(dn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){return hn.call.apply(hn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,t){return pn.call.apply(pn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"usePluginHooks",value:function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return fn.call.apply(fn,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removePluginHooks",value:function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return _n.call.apply(_n,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"setUserActive",value:function(e,t){var r;"boolean"==typeof t&&t!==this.muted&&(this.addInnerOP("volumechange"),Lr.typeOf(t)===Boolean&&(this.muted=t)),null===(r=di)||void 0===r||r.setActive(this.playerId,e)}}],[{key:"version",get:function(){return jr}},{key:"debugger",get:function(){return Rr.config.debug},set:function(e){Rr.config.debug=e}},{key:"instManager",get:function(){return di},set:function(e){di=e}},{key:"getCurrentUserActivePlayerId",value:function(){var e;return null===(e=di)||void 0===e?void 0:e.getActiveId()}},{key:"setCurrentUserActive",value:function(e,t){var r;null===(r=di)||void 0===r||r.setActive(e,t)}},{key:"isHevcSupported",value:function(){return Nr.isHevcSupported()}},{key:"probeConfigSupported",value:function(e){return Nr.probeConfigSupported(e)}},{key:"install",value:function(e,r){t.plugins||(t.plugins={}),t.plugins[e]||(t.plugins[e]=r)}},{key:"use",value:function(e,r){t.plugins||(t.plugins={}),t.plugins[e]=r}}])}(nn);pr(hi,"defaultPreset",null),pr(hi,"XgVideoProxy",null),hi.instManager=ai.getInstance();var pi=Object.defineProperty,fi=(e,t,r)=>((e,t,r)=>t in e?pi(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class _i{constructor(){this.__handlers=[],window.ResizeObserver&&(this.observer=new window.ResizeObserver(e=>{this.__trigger(e)}))}addObserver(e,t){if(!this.observer)return;this.observer&&this.observer.observe(e);const{__handlers:r}=this;let n=-1;for(let t=0;t<r.length;t++)r[t]&&e===r[t].target&&(n=t);n>-1?this.__handlers[n].handler.push(t):this.__handlers.push({target:e,handler:[t]})}unObserver(e){let t=-1;this.__handlers.map((r,n)=>{e===r.target&&(t=n)}),this.observer&&this.observer.unobserve(e),t>-1&&this.__handlers.splice(t,1)}destroyObserver(){this.observer&&this.observer.disconnect(),this.observer=null,this.__handlers=[]}__runHandler(e,t){const{__handlers:r}=this;for(let n=0;n<r.length;n++)if(r[n]&&e===r[n].target){r[n].handler&&r[n].handler.forEach(r=>{try{r(e,t)}catch(e){console.error(e)}});break}}__trigger(e){e.map(e=>{const t=e.contentRect;this.__runHandler(e.target,t)})}}let yi=null;const gi="change",mi="update",vi="error",bi=[{code:0,msg:"SUCCESS"},{code:1,msg:"LOAD_ERROR",type:"LOAD_ERROR"},{code:2,msg:"PARSER_ERROR",type:"PARSER_ERROR"},{code:3,msg:"FORMAT_NOT_SUPPORTED",type:"FORMAT_NOT_SUPPORTED"},{code:4,msg:"ID_OR_LANGUAGE_NOT_EXIST",type:"ID_OR_LANGUAGE_NOT_EXIST"},{code:5,msg:"PARAMETERS_ERROR",type:"PARAMETERS_ERROR"},{code:6,msg:"ABORT",type:"ABORT"},{code:7,msg:"UNKNOWN",type:"UNKNOWN"},{code:8,msg:"DATA_ERROR:subtitle.url is null",type:"DATA_ERROR"},{code:9,msg:"DATA_ERROR:subtitle.url length is 0",type:"DATA_ERROR"}];class wi extends Error{constructor(e,t,r,n){e||(e=bi[t||7].msg),super(e),this.message="",this.code=t||7,this.message=e,this.type=bi[t||7].msg,this.orgError=r||null,this.data=n||null}}function Ci(e,t={},r){const n={code:bi[e].code,message:bi[e].msg,id:"",language:""};return Object.keys(t).map(e=>{n[e]=t[e]}),n}class Ei{constructor(){let e,t;const r=new Promise((r,n)=>{e=r,t=n});return r.resolve=function(t){e(t),r.state="fulfilled"},r.reject=function(e){t(e),r.state="rejected",r.isBreak="DESTROYED"===e},r.state="pending",r}resolve(e){}reject(e){}}function ki(e,t){if(!e)return!1;if(e.classList)return Array.prototype.some.call(e.classList,e=>e===t);{const r=e.className&&"object"==typeof e.className?e.getAttribute("class"):e.className;return r&&!!r.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}}function Ti(e,t){e&&(e.classList?t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(t=>{t&&e.classList.add(t)}):ki(e,t)||(e.className&&"object"==typeof e.className?e.setAttribute("class",e.getAttribute("class")+" "+t):e.className+=" "+t))}function Si(e){const t=Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g);return t?t[0]:""}function Oi(e="div",t="",r={},n=""){const i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach(t=>{const n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)}),i}function Ai(e){return e&&e instanceof window.HTMLMediaElement}function $i(e){const t=[];if(e&&"String"===Si(e))t.push({url:[e],index:0,start:-1,end:-1});else if("Array"===Si(e)){const r=e;if(0===r.length)return t;"String"===Si(r[0])?t.push({url:e,index:0,start:-1,end:-1}):r.forEach((e,r)=>{const n=e;t.push({url:n.url||n.src||"",index:r,start:n.start||-1,end:n.end||-1})})}return t}function Pi(e,t,r){const n=t.length;if(n<1)return-1;if(t[r=r<0?0:r>=n?n-1:r].start<=e&&e<t[r].end)return r;{let i=t[r].end<=e?r+1:0;for(;i<n;i++){if(t[i].start<=e&&e<t[i].end)return i;if(e>t[i].end&&i+1<n&&e<t[i+1].start)return-1;if(e>t[i].end&&i+1>=n)return-1}return-1}}function Ri(e,t,r){const n=t.length;if(n<1)return[];const i=[];if((r=r<0?0:r>=n?n-1:r)<n){let o=t[r].end<=e?r:0;for(;o<n&&(t[o].start<=e&&e<t[o].end&&i.push(o),!(e<t[o].start));o++);}return i}function xi(e,t){return!!(e.id&&t.id&&e.id===t.id||e.language&&t.language&&e.language===t.language)}function Li(e){return null!==e&&""!==e.trim()&&/^[a-zA-Z]+$/.test(e)}function Ii(e){return!!/[\x21-\x2f\x3a-\x40\x5b-\x60\x7B-\x7F]/.test(e)}function Mi(e){return!!/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/.test(e)}const Di=/^WEBVTT/,Bi=/^STYLE+$/,Ni=/^\:\:cue/,ji=/^}+$/,Ui=/^\[Script Info\].*/,Vi=[/[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,3}:[0-9]{2}\.[0-9]{1,3}-->[0-9]{1,3}:[0-9]{2}\.[0-9]{1,3}/,/[0-9]{1,2}\.[0-9]{1,3}-->[0-9]{1,2}\.[0-9]{1,3}/],Fi=/^Format:\s/,Hi=/^Style:\s/,Gi=/^Dialogue:\s/;function Wi(e){const t=e.length;return 3===t?(60*(60*Number(e[0])+Number(e[1]))*1e3+1e3*Number(e[2]))/1e3:2===t?(60*Number(e[0])*1e3+1e3*Number(e[1]))/1e3:Number(e[0])}function qi(e){return/^(\-|\+)?\d+(\.\d+)?$/.test(e)}function Ki(e,t){return e>=0&&e<t.length?t[e]:""}class zi{static parseJson(e){const t=[];let r=0;for(let n=0;n<e.length;n++){if(r>=50&&(r=0),0===r){const r={start:e[n].start,list:[e[n]],end:e[n].end};t.push(r)}else t[t.length-1].list.push(e[n]),t[t.length-1].end=e[n].end;r++}return t}static parse(e,t){const r=zi.checkFormat(e);if(r)try{let n={list:[],styles:[]};"ass"===r?n=zi.parseASS(e):"vtt"===r&&(n=zi.parseVTT(e)),t({format:r,list:n.list,styles:n.styles})}catch(e){console.error(e),t({format:r},new wi(`parse_error_${e.message}`,2,e))}else t({format:"unknown"},new wi("unknown_format",3))}static parseASSItem(e="",t=[]){const r=e.split(","),n={};let i="";try{const e=r.length-t.length;return i=e>0?r.splice(t.length-1,e+1).join(",")+"":r[r.length-1]+"",i=i.replace(/\\n+/g,""),r[t.length-1]=i,t.map((e,t)=>{"end"===e||"start"===e?n[e]=Wi(r[t].split(":")):"text"===e?n[e]=[r[t]]:"layer"===e?(n[e]=[r[t]],n.textTag=[r[t]]):n[e]="style"===e?[r[t]]:Number(r[t])?Number(r[t]):r[t]}),n}catch(e){return console.error(e),{}}}static parseASS(e){const t=e.split("\n"),r=[];let n=0,i=0;const o=[];let s=[],a=null;for(;n<t.length;){if(Fi.test(t[n]))s=t[n].replace(Fi,"").replace(/\s+/g,"").split(","),s=s.map(e=>e.toLocaleLowerCase());else if(Hi.test(t[n]))o.push(t[n].replace(Hi,"").replace(/\s+/g,""));else if(Gi.test(t[n])){const e=zi.parseASSItem(t[n].replace(Gi,""),s);if(a&&e.start===a.start&&e.end===a.end)try{const{text:t=[],textTag:r=[],style:n}=a;e.text.length>0&&t.push(e.text[0]),e.textTag.length>0&&r.push(e.textTag[0]),n&&n.push(e.style[0])}catch(e){console.error(e)}else{a=e;let t=null;i%50==0?(t={start:a.start,end:a.end,list:[]},t.list.push(a),r.push(t)):(t=r[r.length-1],t.end=a.end,t.list.push(a)),i++}}n++}return{list:r,styles:[]}}static parseVTTStyle(e,t){const r=e.split(":");if(r.length>1){const e=r[0].trim().split("-");let n="";e.length>1?e.map((e,t)=>{n+=0===t?e:e.charAt(0).toUpperCase()+e.slice(1)}):n=e[0],t[n]=r[1].trim().replace(/;$/,"")}return t}static parseVTT(e){const t=(e=e.replace(Di,"")).split("\n"),r=[];let n=0,i=0,o=null,s=!1,a=!1,l=null,c=null;const u=[];for(;n<t.length;){const e=Ki(n,t).trim();if(!e||s&&qi(e))s=!e;else if(Ni.test(e)&&Bi.test(Ki(n-1,t).trim())){a=!0;const t=/\((.+?)\)/g.exec(e);c=t?t[1]:"",l=""}else if(a)ji.test(e)?(u.push({key:c||"",style:l||""}),l=null,c=null,a=!1):l+=e;else if(e){s=!1;const e=this.checkIsTime(t[n]);if(e){const t=this.parseVttTime(e);if(!o||t.start!==o.start||t.end!==o.end){o={...t,text:[],textTag:[]},o.text=[],o.textTag=[];let e=null;i%50==0?(e={start:o.start,end:o.end,list:[]},e.list.push(o),r.push(e)):(e=r[r.length-1],e.end=o.end,e.list.push(o)),i++}}else if(o){const{text:e,textTag:r}=o,i=this.parseVttText(t[n]);e.push(i.text),r.push(i.tag)}s=!1}n++}return{list:r,styles:u}}static checkIsTime(e){e=e.replace(/\s+/g,"");let t=0,r=null;for(;t<Vi.length&&(r=Vi[t].exec(e),!r);)t++;return r?r[0]:null}static parseVttText(e){const t=/^(<?.+?>)/g.exec(e);let r="",n="default";if(t){n=t[0].replace(/\<|\>|\&/g,"");const i=RegExp(`^<${n}>(([\\s\\S])*?)</${n}>$`).exec(e);i?r=i[1]:(r=e,n="")}else r=e;const i=/<(\w+).(\w+)>/g;let o=i.exec(r);for(;o&&o.length>2;)r=r.replace(o[0],`<${o[1]} class="${o[2]}">`),o=i.exec(r);return{tag:n,text:r.replace(/\\n+/g,"<br/>")}}static parseVttTime(e){const t=e.split("--\x3e");let r=0,n=0;if(2===t.length){const e=t[0].split(":"),i=t[1].split(":");r=Wi(e),n=Wi(i)}return{start:r,end:n,time:e}}static isVTT(e){return Di.test(e)}static isASS(e){return Ui.test(e)}static checkFormat(e){return e?Di.test(e)?"vtt":Ui.test(e)?"ass":"":""}}function Zi(e,t){const{status:r="",statusText:n=""}=e;return`${t}_${r}_${n}`}function Yi(e,t,r){const{url:n="",method:i="GET",type:o="arraybuffer",timeout:s=1e4,data:a={}}=e,l=new window.XMLHttpRequest,c=i.toUpperCase(),u=[];if(o&&(l.responseType=o),s&&(l.timeout=s),Object.keys(a).forEach(e=>{u.push(`k=${a[e]}`)}),l.onload=()=>{200===l.status||206===l.status?r({context:t,res:l,type:"success"}):r({context:t,res:l,type:"error",error:new wi(Zi(l,"response_error"),1)})},l.onerror=e=>{r({context:t,res:l,type:"error",error:new wi("loaderror",1)})},l.ontimeout=e=>{r({context:t,res:l,type:"error",error:new wi("timeout",1)})},l.onabort=()=>{r({context:t,res:l,type:"error",error:new wi("abort",1)})},"GET"===c)l.open(c,`${n}`),l.send();else{if("post"!==c)throw r({context:t,res:l,type:"error",error:new wi(`xhr ${c} is not supported`,1)}),new wi(`xhr ${c} is not supported`,1);l.open(c,n),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(u.join("&"))}}function Xi(e,t,r){"json"===t?r({styles:[],list:zi.parseJson(e),format:"json"}):"string"===t&&zi.parse(e,r)}function Qi(e,t,r){let n=[];r||(r=new Ei),n="String"===Si(e)?[e]:[...e];const i=n.shift()||"",o=e=>{const{res:i,error:s}=e;if(s)n.length>0?Yi({url:n.shift()||"",type:"text"},t,o):r.reject(s);else if(i){const{response:e}=i;Xi(e,"string",(e,t)=>{t?r.reject(t):r.resolve(e)})}};return Yi({url:i,type:"text"},t,o),r}let Ji=!1;class eo extends Sr{constructor(e){super(),fi(this,"_onPause",()=>{this.stopRender()}),fi(this,"_onPlay",()=>{this._curRenderTask.length>0&&this.startRender(-1)}),fi(this,"_onTimeupdate",()=>{if(!this._isOpen)return;if(this.config.domRender){const e=this.player.video?this.player.video:this.player,{videoWidth:t,videoHeight:r}=e;!this._videoMeta.scale&&t&&r&&this._onResize(this.player.root)}const e=this._getPlayerCurrentTime();Math.round(Math.abs(1e3*e-this._ctime))<200||(this._ctime=1e3*e,this.currentText&&this.currentText.list&&("live"===this.config.updateMode?this._liveUpdate(e):this._update(e)))}),fi(this,"_onResize",e=>{const{_videoMeta:t,config:r}=this;if(r.domRender){if((!e||!(e instanceof window.Element))&&(e=this.player.root),this._iId&&(window.clearTimeout(this._iId),this._iId=null),!t.scale){if(!this.player.video)return;const{videoWidth:e,videoHeight:r}=this.player.video;if(!e||!r)return;t.videoWidth=e,t.videoHeight=r,t.scale=parseInt(r/e*100,10)}this.__startResize(e)}}),fi(this,"_onCoreEvents",e=>{try{switch(e.eventName){case"core.subtitlesegments":this._onSubtitleSegment(e.list||[]);break;case"core.subtitleplaylist":this._onSubtitlePlaylist(e.list||[]);break;case"core.seipayloadtime":this._onCoreSeiintime(e)}}catch(e){console.error(e)}}),fi(this,"startRender",e=>{if(e>0&&this._renderIntervalId&&(window.cancelAnimationFrame(this._renderIntervalId),this._renderIntervalId=-1),!this.textTrack)return;const{_curRenderTask:t}=this;this._lastTimeStamp=(new Date).getTime();const r=[];t.forEach((t,n)=>{const{lastTime:i,wordList:o,interval:s,dom:a,ids:l}=t;if(e<0||this._lastTimeStamp<0||this._lastTimeStamp-i>=s){const e=o.shift();e&&a.appendData(e),t.lastTime=this._lastTimeStamp}o.length<1&&r.push({index:n,ids:l})}),this._log(">>>>_renderByWords emptyArr",r.length,t.length),r.forEach(e=>{t.splice(e.index,1),this._log(">>>_renderByWords remove emptyArr",e.index,t.length)}),t.length>0&&(this._renderIntervalId=window.requestAnimationFrame(this.startRender))}),fi(this,"destroy",()=>{this.detachPlayer(),this.removeAllListeners(),this.player=null,this.textTrack=null,this._curRenderTask=[],this.stopRender()}),Ji=function(){const e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e);return/(?:iPhone)/.test(e)&&!o||n||r||o}(),this.currentText=null,this.currentExtText=null,this.textTrack=[],this._cid=-1,this._gid=-1,this._cids=[],this._iId=null,this._iC=0,this.player=null,this.root=null,this.config={line:"double",bottom:0,mode:"stroke",defaultOpen:!1,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,fitVideo:!0,offsetBottom:2,fontColor:"#fff",domRender:!1,updateMode:"vod",renderMode:"",debugger:!1},this._ctime=0,this._loadingTrack={},this.seiTime=0,this.lastSeiTime=0,this._curTexts=[],this._curRenderTask=[],this._renderIntervalId=-1,this._lastTimeStamp=-1,Object.keys(this.config).map(t=>{void 0!==e[t]&&null!==e[t]&&(this.config[t]=e[t])}),this._isOpen=this.config.defaultOpen||!1,this._videoMeta={scale:0,videoHeight:0,videoWidth:0,lwidth:0,lheight:0,vWidth:0,vHeight:0,vBottom:0,vLeft:0,marginBottom:0},e.subTitles&&"Array"===Si(e.subTitles)&&(e.player&&this.attachPlayer(e.player),this.setSubTitles(e.subTitles,this.config.defaultOpen))}get version(){return"0.2.18"}setSubTitles(e=[],t=!1,r=!0){const n=this._isOpen||t;r&&this.innerRoot&&this.switchOff(),!e||e.length<1?this.switchOff():(this.currentText=null,this.textTrack=[],e.forEach(e=>{const t={};Object.keys(e).map(r=>{t[r]=e[r]}),t.url=$i(t.url),t.isDefault&&(this.currentText=t),this.textTrack.push(t)}),this._log("setSubTitles",n,this.textTrack),n&&(this.currentText||(this.currentText=this.textTrack[0]),this.switch().catch(e=>{this.emitError(e),this._log("[switch]",e)})),this._log(">>>this.currentText",n,this.currentText),this.currentText&&this._loadTrack(this.currentText).then(e=>{this.addStyles(e)}).catch(e=>{this.emitError(e),this._log("[_loadTrack] errorsss",e)}),this.emit("reset",{type:"reset",list:this.textTrack,isOpen:n}))}updateSubTitle(e){let t=-1;for(let r=0;r<this.textTrack.length;r++)if(xi(e,this.textTrack[r])){t=r;break}if(this._log("updateSubTitle",t,e),t>-1){const r=xi(this.currentText,this.textTrack[t]);if(this._log("updateSubTitle","_isCurrent",r,"this.isOpen",this.isOpen,this.currentText),!r)return;const n=$i(e.url);this.isOpen?(n.forEach(e=>{this.textTrack[t].url.push(e)}),this._log("updateSubTitle _loadTrackUrls",this.textTrack[t]),this._loadTrackUrls(this.currentText,2)):this.textTrack[t].url=n}}addStyles(e){const{styles:t,format:r}=e;t&&"vtt"===r&&(t.map(e=>{e.key||(e.key="xg-text-track-span")}),function(e,t=""){let r="";e.map(e=>{r+=` ${t} ${e.key} {${e.style}}`});const n=document.createElement("style"),i=document.head||document.getElementsByTagName("head")[0];if(n.type="text/css",n.id="ssss",n.styleSheet){const e=function(){try{n.styleSheet.cssText=r}catch{}};n.styleSheet.disabled?setTimeout(e,10):e()}else{const e=document.createTextNode(r);n.appendChild(e)}i.appendChild(n)}(t,"xg-text-track"))}attachPlayer(e){if(this._log("attachPlayer"),!e||e===this.player)return;this.player&&this.detachPlayer();const{fontColor:t,mode:r,fitVideo:n,domRender:i}=this.config;var o,s;this.player=e,i&&(this.root=document.createElement("xg-text-track"),this.root.className="xg-text-track",!this._isOpen&&Ti(this.root,"text-track-hide"),!n&&Ti(this.root,"text-track-no-fitvideo"),r&&Ti(this.root,`text-track-${r}`),this.innerRoot=document.createElement("xg-text-track-inner"),this.root.appendChild(this.innerRoot),t&&(this.root.style.color=t),this.currentText&&["language","id","label"].map(e=>{this.root.setAttribute(`data-${e}`,this.currentText[e]||"")}),this.player.root.appendChild(this.root),o=e.root,s=this._onResize,yi||(yi=new _i),yi.addObserver(o,s)),Ai(e)?(e.addEventListener("timeupdate",this._onTimeupdate),e.addEventListener("pause",this._onPause),e.addEventListener("play",this._onPlay)):(this.player.on("destroy",this.destroy),this.player.on("timeupdate",this._onTimeupdate),this.player.on("pause",this._onPause),this.player.on("play",this._onPlay),this.player.on("core_event",this._onCoreEvents)),this._isOpen&&this.switch().catch(e=>{this._log("[switch]",e)})}detachPlayer(){const{player:e,config:t}=this;var r;e&&(Ai(e)?(e.removeEventListener("timeupdate",this._onTimeupdate),e.removeEventListener("pause",this._onPause),e.removeEventListener("play",this._onPlay)):(this.player.off("destroy",this.destroy),this.player.off("timeupdate",this._onTimeupdate),this.player.off("pause",this._onPause),this.player.off("play",this._onPlay),this.player.off("core_event",this._onCoreEvents)),t.domRender&&(e.root&&(r=e.root,this._onResize,yi&&yi.unObserver(r),e.root.removeChild(this.root)),this.innerRoot=null,this.root=null),this.player=null)}switch(e={id:"",language:""}){return this._log("switch",e),this._loadingTrack=e,new Promise((t,r)=>{if(!e.id&&!e.language){if(this.currentText)return this._loadingTrack={},this._updateCurrent(this.currentText),this.switchOn(),void t({message:"switch default subtitle success",code:0});{const e=new wi("no default subtitle",5);return this.emitError(e),void r(e)}}if(this.currentText&&xi(e,this.currentText))this._loadingTrack={},this._updateCurrent(this.currentText),this.switchOn(),t(Ci(0));else{let n=null;this.__removeByTime(this._curTexts,0);for(let t=0;t<this.textTrack.length;t++)if(xi(e,this.textTrack[t])){n=this.textTrack[t];break}if(this._log("nextSubtitle",n),n)this._emitPlayerSwitch(this.currentText,n),n.list?(this._loadingTrack={},this._updateCurrent(n),this.switchOn(),t(Ci(0))):(this._log("this._loadTrack",n),this._updateCurrent(n),this._loadTrack(n).then(i=>{if(this.addStyles(i),this._loadingTrack.id===n.id||this._loadingTrack.language===i.language)this._loadingTrack={},this._updateCurrent(i),this.switchOn(),t(Ci(0));else{const t=new wi(`check _loadingTrack fail id: ${this._loadingTrack.id}  nextSubtitle:${i.id}`,6,null,e);this.emitError(t),r(t)}}).catch(e=>{this.emitError(e),r(e)}));else{const t=new wi(`The is no subtitle with id:[{${e.id}}] or language:[${e.language}]`,4,null,e);this.emitError(t),r(t)}}})}switchExt(e={id:"",language:""}){return new Promise((t,r)=>{if(e.id||e.language){let r=null;for(let t=0;t<this.textTrack.length;t++)if(xi(e,this.textTrack[t])){r=this.textTrack[t];break}r&&!xi(r,this.currentText)&&this._loadTrack(r).then(e=>{this.currentExtText=e,t(Ci(0))}).catch(e=>{this.emitError(e)})}else this.currentExtText=null,t(Ci(0))})}emitError(e){this.emit(vi,{type:vi,error:e})}switchOn(){this._log("switchOn"),this._isOpen=!0,this.show();const{id:e,language:t}=this.currentText;this.emit(gi,{type:gi,isOpen:!0,id:e,language:t,texts:[]})}switchOff(){if(this._isOpen=!1,this.hide(),!this.currentText)return;const{id:e,language:t}=this.currentText;this.emit("off",{type:"off",id:e,language:t,texts:[],isOpen:!1})}get isOpen(){return this._isOpen}_log(...e){this.config.debugger&&console.log("[xgSubtitle]",...e)}_loadTrack(e){this._log("_loadTrack",e.language,e);const t=new Ei;let r="",n="";if(e.json?(r="json",n=e.json):e.stringContent&&(!e.url||0===e.url.length)&&(r="string",n=e.stringContent),n)return Xi(n,r,(r,n)=>{n?(this.emitError(n),t.reject(n)):(e.format=r.format,e.styles=r.styles,e.list=r.list,t.resolve(e))}),t;const i=[...e.url];return 0===i.length?(t.resolve(e),t):(Qi(i.splice(0,1)[0].url,e).then(r=>{e.format=r.format,e.styles=r.styles,e.list||(e.list=[]),this._pushList(e.list,r.list),i.length>1&&this._loadTrackUrls(e,2),t.resolve(e)}).catch(e=>{t.reject(e)}),t)}_emitPlayerSwitch(e,t){e&&"live"===this.config.updateMode&&(e.list=[],e.url=[]);const r={lang:t.language,...t};this._log("emit subtile_switch ",t,r),this.emit(gi,{type:gi,error:null})}_loadTrackUrls(e,t,r){const n=e.url.length,i=n>t?e.url.splice(0,t):e.url.splice(0,n);let o=i.length;this._log("_loadTrackUrls",e.language,n,i.length,o),i.forEach((t,n)=>{Qi({...t,index:n}.url,t).then(t=>{e.format=t.format,e.styles=t.format,e.list||(e.list=[]),this._pushList(e.list,t.list),o--}).catch(e=>{o--}).finally(t=>{0===o&&(r&&r.resolve(e),this._loadTrackUrls(e,2))})})}_freshUrl(e,t={url:""}){let r=-1;e.url.forEach((e,n)=>{e.url===t.url&&(r=n)}),r>-1&&e.url.splice(r,1)}_pushList(e,t){const r=t[0].start,n=t[t.length-1].end;if(0===e.length||r>=e[e.length-1].end)t.forEach(t=>{e.push(t)});else{let r=-1;for(let t=0;t<e.length;t++)if(e[t].start>n){r=t;break}r>-1&&t.forEach((t,n)=>{e.splice(r+n,0,t)})}return e}_updateCurrent(e){this.currentText=e,this.config.domRender&&this.root&&(["language","id","label"].map(e=>{this.root.setAttribute(`data-${e}`,this.currentText[e]||"")}),this.__remove(this._cids)),this._cids=[],this._gid=-1,this._cid=-1,this._curTexts=[];const t=this._getPlayerCurrentTime();t&&("live"===this.config.updateMode?this._liveUpdate(t):this._update(t))}__loadAll(){this.textTrack.forEach(e=>{this._loadTrack(e)})}getDelCid(e,t){const r=[];for(let n=0;n<e.length;n++)t.includes(e[n])||r.push(e[n]);return r}getNewCid(e,t){const r=[];for(let n=0;n<t.length;n++)e.includes(t[n])||r.push(t[n]);return r}_liveUpdate(e){if(!this.currentText||!this.currentText.list||!this.currentText.list.length)return;let t=[];const r=Pi(e,this.currentText.list,this._gid);if(r>-1&&(t=Ri(e,this.currentText.list[r].list,this._cid)),this.__removeByTime(this._curTexts,e),this._log("_liveUpdate",e,r,t,this.currentText.list[0].list[0].start,this.currentText.list[0].list[0].end),t.length>0){const e=function(e,t,r){if(0===e.length||t<0||t>e.length-1)return[];const n=e[t].list;if(0===r.length)return[];const i=n.splice(r[0],r.length);return t>0&&e.splice(0,t),0===n.length&&e.splice(0,1),i}(this.currentText.list,r,t),n=this._curTexts.length,i=n>0?this._curTexts[n-1].index:0;e.forEach((e,t)=>{e.index=t+i,this._curTexts.push(e)}),this.__render(e)}this.emit(mi,this.getUpdateData(this._curTexts,0,this.currentText))}_update(e){if(!this.currentText||!this.currentText.list||!this.currentText.list.length)return;const t=Pi(e,this.currentText.list,this._gid);let r=[];if(t>-1&&(r=Ri(e,this.currentText.list[t].list,this._cid)),this._log("update1",`currentTime:${e}`,t,this._gid,r,this._cids,this._cids.join(",")===r.join(","),t===this._gid),r.length<1)return this._cids.length>0&&this.config.domRender&&this.__remove(this._cids),this._cids=[],this._curTexts.length>0&&this.emit(mi,this.getUpdateData([],e,this.currentText)),void(this._curTexts=[]);if(this._cids.join("")===r.join("")&&t===this._gid)return;this._gid=t,this._cid=r[0];const n=this.getDelCid(this._cids,r),i=this.getNewCid(this._cids,r);this._cids=r,this.config.domRender&&this.__remove(n);const o=[];i.map(e=>{const r=this.currentText.list[t].list[e];r.index=e,o.push(r)}),this.currentExtText&&i.map(e=>{const r=this.currentText.list[t].list[e];r.index=e,o.push(r)}),this._log("update",`currentTime:${e}`,o.length>0?`start:${o[0].start} end:${o[0].end}`:"",`delCids:${n.length} newCids:${i.length}`),this._curTexts=o,this.emit(mi,this.getUpdateData(o,e,this.currentText)),this.__render(o,e)}getUpdateData(e,t,r){const{id:n,language:i}=r;return{type:mi,currentTime:0|t,id:n,language:i,texts:e,isOpen:this._isOpen}}_getPlayerCurrentTime(){if(!this.player)return 0;const{currentTime:e}=this.player;return parseInt(1e3*e+1e3*this.seiTime-1e3*this.lastSeiTime,10)/1e3}_onSubtitlePlaylist(e){this._log("_onSubtitlePlaylist",e);const t=e.map(e=>({label:e.name,language:e.lang,id:e.id,isDefault:e.default,url:[],mUrl:e.url}));this.setSubTitles(t)}_onSubtitleSegment(e){if(this._log("_onSubtitleSegment",e.length,e[0].lang,e[0].sn,e[e.length-1].sn,e[0].start,e[e.length-1].end),!e||0===e.length)return;const t={language:e[0].lang,url:e.map(e=>({id:e.sn,url:e.url,duration:e.duration,start:e.start,end:e.end}))};xi(t,this.currentText)&&this.updateSubTitle(t)}_onCoreSeiintime(e){try{const t=e.time/1e3;this._log("_onCoreSeiintime sei",t,this.seiTime,this.lastSeiTime),this.seiTime=t,this.lastSeiTime=this.player?this.player.currentTime:0}catch{}}resize(e,t){const{baseSizeX:r,baseSizeY:n,minMobileSize:i,minSize:o,fitVideo:s,offsetBottom:a}=this.config,{scale:l}=this._videoMeta;this._videoMeta.lwidth=e,this._videoMeta.lheight=t;let c,u=0;t/e*100>=l?(u=parseInt(l*e,10)/100,c=e):(u=t,c=parseInt(t/l*100,10)),this._videoMeta.vWidth=c,this._videoMeta.vHeight=u;let d=0,h=0;l>120?(d=n,h=parseInt(d*u/1080,10)):(d=r,h=parseInt(d*c/1920,10));const p=Ji?i:o;h=h<p?p:h>d?d:h;const f={fontSize:h},_=parseInt((t-u)/2,10),y=parseInt((e-c)/2,10),g=parseInt(u*a,10)/100;this._videoMeta.vBottom=_,this._videoMeta.vLeft=y,this._videoMeta.marginBottom=g,s&&(f.bottom=_+g,f.left=f.right=y),Object.keys(f).map(e=>{this.root.style[e]=`${f[e]}px`}),this.emit("resize",{vLeft:y,vBottom:_,marginBottom:g,vWidth:c,vHeight:u,fontSize:h,scale:l})}__startResize(e){const t=e.getBoundingClientRect(),{_videoMeta:r}=this,{width:n,height:i}=t;if(this._iId&&(clearTimeout(this._iId),this._iId=null),n>0&&i>0&&(n!==r.lwidth||i!==r.lheight))this._iC=0,this.resize(n,i);else{if(this._iC>=5)return void(this._iC=0);this._iC++,this._iId=setTimeout(()=>{this.__startResize(e)},50)}}__removeByTime(e,t){const r=[];for(let n=0;n<e.length;n++)(!t||e[n].end<t)&&r.push(n);0!==r.length&&(e.splice(r[0],r.length),this.config.domRender&&this.__remove(r))}__remove(e){if(!e||e.length<1)return;this._log(">>>>_renderByWords__remove",e);const t=this.innerRoot.children,r=[];for(let n=0;n<t.length;n++){const i=Number(t[n].getAttribute("data-index"));e.includes(i)&&r.push(t[n])}r.map(e=>{this.innerRoot.removeChild(e)})}__render(e=[]){const{renderMode:t,domRender:r}=this.config;e.length>0&&r&&e.forEach(e=>{let r=`text-track-${this.config.line}`;e.text.forEach((n,i)=>{i>0&&(r+=" text-track-deputy");const o={"data-start":e.start,"data-end":e.end,"data-index":e.index},s=Oi("xg-text-track-span","",o,r);if(this.innerRoot.appendChild(s),"step"===t){const t=Oi("xg-text-track-span","",o,`${r} text-track-space`);this.innerRoot.appendChild(t),t.innerHTML=n,window.setTimeout(()=>{this._renderByWords(s,i,e.start,e.end,n)},600)}else s.innerHTML=n})})}_renderByWords(e,t,r,n,i){const o=document.createTextNode("");e.appendChild(o);const s=function(e){const t=e.split(""),r=[];let n=!1;for(let e=0;e<t.length;e++){const i=t[e];if(Li(i))if(n){const e=r.length-1;r[e]=`${r[e]}${i}`}else r.push(i),n=!0;else if(i.match(/^[ ]*$/)||Ii(i)||Mi(i)){n=!1;const e=r.length-1;r[e]=`${r[e]}${i}`}else n=!1,r.push(i)}return r}(i);let a=this._getPlayerCurrentTime(),l=parseInt(1e3*(n-a),10);if(a>=n)return;r>=a&&(a=r),l>300&&(l-=50);const c={dom:o,ids:t,wordList:s,interval:l/s.length,start:a,end:n,duration:l,lastTime:0};this._log(">>>>_renderByWords",l,c);const{_curRenderTask:u}=this;let d=-1;for(let e=0;e<u.length;e++)if(u[e].ids===t){d=e;break}d>-1&&u.slice(d,1),u.push(c),this.startRender(-1)}stopRender(){this._renderIntervalId&&window.cancelAnimationFrame(this._renderIntervalId)}show(){var e,t;this.config.domRender&&(t="text-track-hide",(e=this.root)&&(e.classList?t.split(/\s+/g).forEach(t=>{e.classList.remove(t)}):ki(e,t)&&t.split(/\s+/g).forEach(t=>{const r=new RegExp("(\\s|^)"+t+"(\\s|$)");if(e.className&&"object"==typeof e.className){const t=e.getAttribute("class")||"";e.setAttribute("class",t.replace(r," "))}else e.className=e.className.replace(r," ")})))}hide(){this.config.domRender&&(Ti(this.root,"text-track-hide"),this.innerRoot.innerHTML="")}emit(e,t,...r){super.emit(e,t,...r)}on(e,t,...r){super.on(e,t,...r)}once(e,t,...r){super.once(e,t,...r)}off(e,t,...r){super.off(e,t,...r)}offAll(){super.removeAllListeners()}get marginBottom(){const{bottom:e,marginBottom:t}=this._videoMeta;return this.config.fitVideo?e+t:t}}var to=function(){return hr(function e(t){ur(this,e),this.config=t.config,this.parent=t.root,this.root=Lr.createDom("ul","",{},"xg-options-list xg-list-slide-scroll ".concat(this.config.className)),t.root.appendChild(this.root);var r=this.config.maxHeight;r&&this.setStyle({maxHeight:r}),this.onItemClick=this.onItemClick.bind(this),this.renderItemList();var n="touch"===this.config.domEventType?"touchend":"click";this._delegates=An.delegate.call(this,this.root,"li",n,this.onItemClick)},[{key:"renderItemList",value:function(e){var t=this,r=this.config,n=this.root;e?r.data=e:e=r.data,r.style&&Object.keys(r.style).map(function(e){n.style[e]=r[e]}),e.length>0&&(this.attrKeys=Object.keys(e[0])),this.root.innerHTML="",e.map(function(e,r){var n=e.selected?"option-item selected":"option-item";e["data-index"]=r,t.root.appendChild(Lr.createDom("li","<span>".concat(e.showText,"</span>"),e,n))})}},{key:"onItemClick",value:function(e){e.delegateTarget||(e.delegateTarget=e.target);var t=e.delegateTarget;if(t&&Lr.hasClass(t,"selected"))return!1;var r="function"==typeof this.config.onItemClick?this.config.onItemClick:null,n=this.root.querySelector(".selected");Lr.addClass(t,"selected"),n&&Lr.removeClass(n,"selected"),r(e,{from:n?this.getAttrObj(n,this.attrKeys):null,to:this.getAttrObj(t,this.attrKeys)})}},{key:"getAttrObj",value:function(e,t){if(!e||!t)return{};var r={};t.map(function(t){r[t]=e.getAttribute(t)});var n=e.getAttribute("data-index");return n&&(r.index=Number(n)),r}},{key:"show",value:function(){Lr.removeClass(this.root,"hide"),Lr.addClass(this.root,"active")}},{key:"hide",value:function(){Lr.removeClass(this.root,"active"),Lr.addClass(this.root,"hide")}},{key:"setStyle",value:function(e){var t=this;Object.keys(e).forEach(function(r){t.root.style[r]=e[r]})}},{key:"destroy",value:function(){this._delegates&&(this._delegates.map(function(e){e.destroy&&e.destroy()}),this._delegates=null),this.root.innerHTML=null,this.parent.removeChild(this.root),this.root=null}}])}(),ro="side",no="middle",io="click",oo="mobile"===Nr.device,so=function(e){function t(e){var r;return ur(this,t),pr(r=cr(this,t,[e]),"onEnter",function(e){e.stopPropagation(),r.emit("icon_mouseenter",{pluginName:r.pluginName}),r.switchActiveState(e)}),pr(r,"switchActiveState",function(e){e.stopPropagation(),r.config.toggleMode===io?r.toggle(!r.isActive):r.toggle(!0)}),pr(r,"onLeave",function(e){e.stopPropagation(),r.emit("icon_mouseleave",{pluginName:r.pluginName}),r.config.listType!==ro&&r.isActive&&r.toggle(!1)}),pr(r,"onListEnter",function(e){r.enterType=2}),pr(r,"onListLeave",function(e){r.enterType=0,r.isActive&&r.toggle(!1)}),r.isIcons=!1,r.isActive=!1,r.curValue=null,r.curIndex=0,r}return yr(t,e),hr(t,[{key:"updateLang",value:function(e){this.renderItemList(this.config.list,this.curIndex)}},{key:"afterCreate",value:function(){var e=this,t=this.config;this.initIcons(),(oo=oo||"touch"===this.domEventType)&&"mobile"===Nr.device&&"default"===t.listType&&(t.listType=ro),t.hidePortrait&&Lr.addClass(this.root,"portrait"),this.on([Jr,Yr],function(){e._resizeList()}),this.once(Wr,function(){t.list&&t.list.length>0&&(e.renderItemList(t.list),e.show())}),oo&&this.on(Kr,function(){e.isActive&&(e.optionsList&&e.optionsList.hide(),e.isActive=!1)}),oo?(t.toggleMode=io,this.activeEvent="touchend"):this.activeEvent=t.toggleMode===io?"click":"mouseenter",t.toggleMode===io?this.bind(this.activeEvent,this.switchActiveState):(this.bind(this.activeEvent,this.onEnter),this.bind("mouseleave",this.onLeave)),this.isIcons&&this.bind("click",this.onIconClick)}},{key:"initIcons",value:function(){var e=this,t=this.icons,r=Object.keys(t),n=!1;r.length>0&&(r.forEach(function(r){e.appendChild(".xgplayer-icon",t[r]),!n&&(n=t[r])}),this.isIcons=n),n||(this.appendChild(".xgplayer-icon",Lr.createDom("span","",{},"icon-text")),Lr.addClass(this.find(".xgplayer-icon"),"btn-text"))}},{key:"show",value:function(e){!this.config.list||this.config.list.length<2||Lr.addClass(this.root,"show")}},{key:"hide",value:function(){Lr.removeClass(this.root,"show")}},{key:"getTextByLang",value:function(e,t,r){if(void 0===e)return"";var n=this.config.list;!r&&(r=this.player.lang),t=!t||Lr.isUndefined(e[t])?"text":t,"number"==typeof e&&(e=n[e]);try{return"object"===Tr(e[t])?e[t][r]||e[t].en:e[t]}catch(e){return console.warn(e),""}}},{key:"toggle",value:function(e){if(e!==this.isActive&&!this.config.disable){var t=this.player.controls,r=this.config.listType;e?(r===ro?t.blur():t.focus(),this.optionsList&&this.optionsList.show()):(r===ro?t.focus():t.focusAwhile(),this.optionsList&&this.optionsList.hide()),this.isActive=e}}},{key:"onItemClick",value:function(e,t){e.stopPropagation();var r=this.config,n=r.listType,i=r.list;this.curIndex=t.to.index,this.curItem=i[this.curIndex],this.changeCurrentText(),(this.config.isItemClickHide||oo||n===ro)&&this.toggle(!1)}},{key:"onIconClick",value:function(e){}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config.list,t=e[this.curIndex<e.length?this.curIndex:0];t&&(this.find(".icon-text").innerHTML=this.getTextByLang(t,"iconText"))}}},{key:"renderItemList",value:function(e,t){var r=this,n=this.config,i=this.optionsList,o=this.player;if("number"==typeof t&&(this.curIndex=t,this.curItem=n.list[t]),i)return i.renderItemList(e),void this.changeCurrentText();var s,a,l={config:{data:e||[],className:(s=n.listType,a=n.position,s===ro?a===kn.CONTROLS_LEFT?"xg-side-list xg-left-side":"xg-side-list xg-right-side":""),onItemClick:function(e,t){r.onItemClick(e,t)},domEventType:oo?"touch":"mouse"},root:n.listType===ro?o.innerContainer||o.root:this.root};if(this.config.isShowIcon){var c=this.player.root.getBoundingClientRect().height,u=n.listType===no?c-50:c;u&&n.heightLimit&&(l.config.maxHeight="".concat(u,"px")),this.optionsList=new to(l),this.changeCurrentText(),this.show()}this._resizeList()}},{key:"_resizeList",value:function(){if(this.config.heightLimit){var e=this.player.root.getBoundingClientRect().height,t=this.config.listType===no?e-50:e;this.optionsList&&this.optionsList.setStyle({maxHeight:"".concat(t,"px")})}}},{key:"destroy",value:function(){this.config.toggleMode===io?this.unbind(this.activeEvent,this.switchActiveState):(this.unbind(this.activeEvent,this.onEnter),this.unbind("mouseleave",this.onLeave)),this.isIcons&&this.unbind("click",this.onIconClick),this.optionsList&&(this.optionsList.destroy(),this.optionsList=null)}},{key:"render",value:function(){if(this.config.isShowIcon)return'<xg-icon class="xg-options-icon '.concat(this.config.className||"",'">\n    <div class="xgplayer-icon">\n    </div>\n   </xg-icon>')}}],[{key:"pluginName",get:function(){return"optionsIcon"}},{key:"defaultConfig",get:function(){return{position:kn.CONTROLS_RIGHT,index:100,list:[],listType:"default",listStyle:{},hidePortrait:!0,isShowIcon:!1,isItemClickHide:!0,toggleMode:"hover",heightLimit:!0}}}])}(An),ao=function(e){function t(e){var r;return ur(this,t),pr(r=cr(this,t),"_onChange",function(e){var t=r._media.textTracks;if(t&&0!==t.length){for(var n=[],i=[],o=-1,s=0;s<t.length;s++){var a=t[s];"subtitles"===a.kind&&(n.push({id:a.id||a.language,language:a.language,text:a.label,isDefault:"showing"===a.mode}),-1===o&&"showing"===a.mode&&(o=s),i.push(a.language))}i.join("|")!==r._languages?(r._languages=i.join("|"),r.emit("reset",{list:n,isOpen:o>-1})):-1===o?r.emit("off"):r.curIndex!==o&&r.emit("change",n[o]),r.curIndex=o}}),r._media=e,r._list=[],r._languages="",r.curIndex=-1,r._init(),r}return yr(t,e),hr(t,[{key:"_init",value:function(){this._media.textTracks.addEventListener("change",this._onChange)}},{key:"switch",value:function(e){for(var t=this._media.textTracks,r=0;r<t.length;r++){var n=t[r];n.language===e.language?n.mode="showing":"showing"===n.mode&&(n.mode="disabled")}}},{key:"switchOff",value:function(){for(var e=this._media.textTracks,t=0;t<e.length;t++)e[t].mode="disabled";this.curIndex=-1}},{key:"destroy",value:function(){this._media.textTracks.removeEventListener("change",this._onChange),this._media=null,this._list=[],this._languages="",this.curIndex=-1}}])}(Or()),lo="text-close";function co(e){var t=-1;return e.forEach(function(e,r){e.id||e.language||(e.id=r),e.id=String(e.id),!e.url&&(e.url=e.src),!e.text&&(e.text=e.label),!e.language&&(e.language=e.srclang),void 0===e.isDefault&&(e.isDefault=e.default||!1),(e.isDefault||e.default)&&(t<0?t=r:e.isDefault=e.default=!1)}),t}var uo=function(e){function t(){var e;ur(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return pr(e=cr(this,t,[].concat(n)),"_onOff",function(){e.switchOffSubtitle()}),pr(e,"_onChange",function(t){var r=e.getSubTitleIndex(e.config.list,t);r<0||e.updateCurItem(r,t)}),pr(e,"_onListReset",function(t){e.updateList(t)}),pr(e,"clickSwitch",function(t,r){var n="close"===r.type||r.type===lo;e.subTitles&&(n?e.subTitles.switchOff():e.switchSubTitle({language:r.language,id:r.id}))}),pr(e,"onIconClick",function(t){e.curItem?e.subTitles.switchOff():e.switchOnSubtitle(t)}),pr(e,"onPlayerFocus",function(t){e.subTitles&&e.config.style.follow&&e.rePosition()}),pr(e,"onPlayerBlur",function(t){e.subTitles&&e.config.style.follow&&!e.playerConfig.marginControls&&e.subTitles.root&&(e.subTitles.root.style.transform="translate(0, 0)")}),e}return yr(t,e),hr(t,[{key:"beforeCreate",value:function(e){var t=e.player.config.texttrack||e.player.config.textTrack;"Array"===Lr.typeOf(t)&&(e.config.list=t)}},{key:"afterCreate",value:function(){var e=this.config,r=e.list,n=e.mode,i=co(r);Cr(t,"afterCreate",this,3)([]),this.curIndex=-1,this.lastIndex=-1,this.curItem=null,this._nativeTracks=null,this.handlerClickSwitch=this.hook("subtitle_change",this.clickSwitch),"native"===n?this._initNativeSubtitle():i>=0&&this._initExtSubTitle(i)}},{key:"_initNativeSubtitle",value:function(){var e=this.player;e._subTitles||(e._subTitles=new ao(e.media)),this.subTitles=e._subTitles,this.subTitles.on("off",this._onOff),this.subTitles.on("change",this._onChange),this.subTitles.on("reset",this._onListReset)}},{key:"_initExtSubTitle",value:function(e){var t=this.config,r=t.list,n=t.style,i=t.isDefaultOpen,o=t.updateMode,s=t.renderMode;i&&e<0&&r.length>0&&(e=0,r[0].isDefault=!0);var a={subTitles:r,defaultOpen:i,updateMode:o,renderMode:s,debugger:this.config.debugger,domRender:!0};Object.keys(n).map(function(e){a[e]=n[e]}),!this.playerConfig.marginControls&&this.player.controls.root&&(this.on(Kr,this.onPlayerFocus),this.on(zr,this.onPlayerBlur));var l=this.player;l._subTitles?l._subTitles._isOpen&&(e=this.getSubTitleIndex(this.config.list,l._subTitles.currentText)):(l._subTitles=new eo(a),l._subTitles.attachPlayer(this.player)),this.subTitles=l._subTitles,this.subTitles.on("off",this._onOff),this.subTitles.on("change",this._onChange),this.subTitles.on("reset",this._onListReset),n.follow&&this.subTitles.root&&Lr.addClass(this.subTitles.root,"follow-control"),this._renderList(r,i,e)}},{key:"_renderList",value:function(e,t,r){e&&0!==e.length&&(t?(e[r=r<0?0:r].isDefault=!0,this.curIndex=r,this.curItem=e[r],this.switchIconState(!0)):this.switchIconState(!1),this.player.isCanplay&&e.length>0&&(this.renderItemList(e),this.show()))}},{key:"registerIcons",value:function(){return{textTrackOpen:{icon:"",class:"xg-texttrak-open"},textTrackClose:{icon:"",class:"xg-texttrak-close"}}}},{key:"show",value:function(e){!this.config.list||this.config.list.length<1||Lr.addClass(this.root,"show")}},{key:"getSubTitleIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"",language:""},r=-1;return t&&(t.id||t.language)?(e.forEach(function(e,n){var i,o,s,a;i=e,o=t,s=Lr.isNotNull(i.id)&&Lr.isNotNull(o.id)&&i.id===o.id,a=Lr.isNotNull(i.language)&&Lr.isNotNull(o.language)&&i.language===o.language,(s||a)&&(r=n)}),r):r}},{key:"updateSubtitles",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&(this.updateList({list:e}),this.subTitles&&this.subTitles.setSubTitles(this.config.list,this.curIndex>-1,t))}},{key:"updateList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.list){var t=[];e.list.forEach(function(e){t.push(e)});var r=co(t);e.isOpen?(this.curIndex=r,this.curItem=r>-1?t[r]:null):(this.curIndex=-1,this.curItem=null),this.config.list=t,t.length>0?this.show():(this.switchOffSubtitle(),this.hide()),this.renderItemList()}}},{key:"switchSubTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"",language:""};this.switchIconState(!0),this.getSubTitleIndex(this.config.list,e)<0||this.subTitles.switch(e).catch(function(e){})}},{key:"switchOffSubtitle",value:function(e){this.emit("subtitle_change",{off:!0,isListUpdate:!1,list:[]}),this.lastIndex=this.curIndex,this.curIndex=-1,this.curItem=null,this.switchIconState(!1),this.renderItemList()}},{key:"switchOnSubtitle",value:function(){var e=this.config.list[this.lastIndex>-1?this.lastIndex:0];this.switchIconState(!0),this.switchSubTitle(e)}},{key:"switchIconState",value:function(e){this.setAttr("data-state",e?"open":"close")}},{key:"onItemClick",value:function(e,r){var n=e.delegateTarget,i=n.getAttribute("language"),o=n.getAttribute("data-id"),s=n.getAttribute("data-type");Cr(t,"onItemClick",this,3)(arguments),this.handlerClickSwitch(e,{language:i,id:o,type:s})}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config,t=e.list,r=e.closeText,n=this.curIndex;if(n-1<0)this.find(".icon-text").innerHTML=this.getTextByLang(r,"iconText");else if(n-1<t.length){var i=t[n-1];if(!i)return;this.find(".icon-text").innerHTML=this.getTextByLang(i,"iconText")}}}},{key:"updateCurItem",value:function(e,t){this.curIndex=e,this.curItem=this.config.list[e-1],this.renderItemList(),this.emit("subtitle_change",vr({off:!1,isListUpdate:!1,list:[]},t))}},{key:"renderItemList",value:function(){var e=this,r=this.config,n=r.list,i=r.closeText,o=r.needCloseText,s=[],a=this.curIndex,l=this.curIndex;o&&(s.push({showText:this.getTextByLang(i),"data-type":lo,selected:-1===this.curIndex}),a++),n.map(function(t,r){var n={language:t.language||t.srclang||"","data-id":t.id||""};n.selected=e.curIndex===r,n.showText=e.getTextByLang(t),s.push(n)}),Cr(t,"renderItemList",this,3)([s,a]),this.curIndex=l,this.curItem=n[l]}},{key:"rePosition",value:function(){var e=this.config.style.fitVideo,t=0-this.player.controls.root.getBoundingClientRect().height;if(e){var r=this.player,n=r.video,i=r.root.getBoundingClientRect(),o=i.height,s=i.width,a=n.videoHeight,l=n.videoWidth,c=parseInt(a/l*100,10)*s/100;c>o&&(c=o);var u=(o-c)/2-t;u<0&&(this.subTitles.root.style.transform="translate(0, ".concat(u,"px)"))}else this.subTitles.root.style.transform="translate(0, ".concat(t,"px)")}},{key:"destroy",value:function(){this.subTitles&&(this.subTitles.destroy(),this.subTitles=null),Cr(t,"destroy",this,3)([])}}],[{key:"pluginName",get:function(){return"texttrack"}},{key:"defaultConfig",get:function(){return vr(vr({},so.defaultConfig),{},{position:kn.CONTROLS_RIGHT,index:6,list:[],isDefaultOpen:!0,style:{follow:!0,mode:"stroke",followBottom:50,fitVideo:!0,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},closeText:{text:"不开启",iconText:"字幕"},needCloseText:!0,className:"xgplayer-texttrack",hidePortrait:!1,isShowIcon:!0,renderMode:"normal",mode:"external",debugger:!1})}}])}(so),ho=Object.defineProperty,po=(e,t,r)=>((e,t,r)=>t in e?ho(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class fo{static getDefaultConfig(){return{rangeMaxDuration:15,rangeMinDuration:5,rangeMinSize:409600,safeFactor:.1,cacheSafeFactor:3,minDangerThreshold:5,estPlayTime:12,minBandwidth:1e6,estPTcontrol:!1,minTargetCacheDur:30,maxTargetCacheDur:60,targetCacheControl:!1,rangeControl:!1}}constructor(e,t,r,n){this.config=fo.getDefaultConfig(),Object.keys(n).map(e=>{void 0!==n[e]&&null!==n[e]&&(this.config[e]=n[e])}),this.duration=r,this.player=e,this.updateBitrate(t)}updateBitrate(e){this.bitrate=e,this.bitrate||(this.bitrate=this.config.minBandwidth)}getAdaptLoadDuration(){const{player:e,config:t}=this;if(!t.rangeControl)return-1;const r=(null==e?void 0:e.bufferedPoint)||null,n=r&&r.end?r.end-e.currentTime:0;return Math.max(t.rangeMaxDuration-n,t.rangeMinDuration)}getAdaptCacheBuffer(){const{player:e,config:t,bitrate:r}=this;if(!t.targetCacheControl)return-1;const{estPlayTime:n}=t;let i=n;t.estPTcontrol&&(i=Math.min(n,this.duration-((null==e?void 0:e.currentTime)||0)));const o=1024*(null==e?void 0:e.avgSpeed)||0;let s=Math.max(t.safeFactor*o,t.minBandwidth);e&&e.avgSpeed&&(s=t.safeFactor*o);let a=r>0?Math.floor((1-s/r)*i):0;return a=t.minDangerThreshold+Math.max(a,0),Math.min(Math.max(t.cacheSafeFactor*a,t.minTargetCacheDur),t.maxTargetCacheDur)}}class _o{static getDefaultConfig(){return{rangeControl:!1,rangeMaxDuration:20,rangeMinDuration:5,rangeMinSize:409600,rangeFloatSize:10240,safeFactor:.1,cacheSafeFactor:3,minDangerThreshold:5,estPlayTime:12,minBandwidth:1e6,estPTcontrol:!1,minTargetCacheDur:30,maxTargetCacheDur:60,targetCacheControl:!1}}constructor(e,t,r,n){this.config=_o.getDefaultConfig(),Object.keys(n).map(e=>{void 0!==n[e]&&null!==n[e]&&(this.config[e]=n[e])}),this.duration=r,this.player=e,this.updateBitrate(t)}updateBitrate(e){this.bitrate=e,this.bitrate||(this.bitrate=this.config.minBandwidth)}getBuffer(){const{player:e}=this,t=(null==e?void 0:e.bufferedPoint)||null;return t&&t.end?t.end-e.currentTime:0}getAdaptLoadDuration(){const{config:e,duration:t}=this;if(!e.rangeControl)return-1;const r=this.getBuffer(),n=t-r,i=Math.min(n,e.rangeMaxDuration-r);return Math.max(i,e.rangeMinDuration)}getAdaptRangeSize(e){const{config:t,bitrate:r,duration:n}=this;if(!t.rangeControl)return-1;e||(e=this.getAdaptLoadDuration());const i=n-this.getBuffer();let o=Math.max(t.rangeMinSize,e*r/8);const s=i*r/8;return o+t.rangeFloatSize>=s&&(o=s),Math.ceil(o)}getAdaptCacheBuffer(){const{player:e,config:t,bitrate:r}=this;if(!t.targetCacheControl)return-1;const{estPlayTime:n}=t;let i=n;t.estPTcontrol&&(i=Math.min(n,this.duration-((null==e?void 0:e.currentTime)||0)));const o=1024*(null==e?void 0:e.avgSpeed)||0;let s=Math.max(t.safeFactor*o,t.minBandwidth);e&&e.avgSpeed&&(s=t.safeFactor*o);let a=r>0?Math.floor((1-s/r)*i):0;a=t.minDangerThreshold+Math.max(a,0);const l=Math.max(t.cacheSafeFactor*a,t.minTargetCacheDur);return Math.min(l,t.maxTargetCacheDur)}}var yo=(e=>(e.CHANGE_FLYING_PLUGIN_CONFIG="CHANGE_FLYING_PLUGIN_CONFIG",e))(yo||{});function go(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wo(n.key),n)}}function mo(e){return(mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vo=function(){return!!e})()}function bo(e,t){return(bo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function wo(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function Co(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Eo={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn===t&&(!i||a.once)&&(!n||a.context===n)&&s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a}(Eo);var ko=Eo.exports;const To=Co(ko);var So={},Oo=null,Ao=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=mo(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,vo()?Reflect.construct(t,r||[],mo(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bo(e,t)}(t,e),function(e,t,r){return t&&go(e.prototype,t),r&&go(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(t,[{key:"add",value:function(e){e&&(So[e.playerId]=e,1===Object.keys(So).length&&this.setActive(e.playerId,!0))}},{key:"remove",value:function(e){e&&(e.isUserActive,delete So[e.playerId])}},{key:"_iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var r in So)if(Object.prototype.hasOwnProperty.call(So,r)){var n=So[r];if(t){if(e(n))break}else e(n)}}},{key:"forEach",value:function(e){this._iterate(e)}},{key:"find",value:function(e){var t=null;return this._iterate(function(r){var n=e(r);return n&&(t=r),n},!0),t}},{key:"findAll",value:function(e){var t=[];return this._iterate(function(r){e(r)&&t.push(r)}),t}},{key:"setActive",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(So[e])return t?this.forEach(function(t){e===t.playerId?(t.isUserActive=!0,t.isInstNext=!1):t.isUserActive=!1}):So[e].isUserActive=t,e}},{key:"getActiveId",value:function(){for(var e=Object.keys(So),t=0;t<e.length;t++){var r=So[e[t]];if(r&&r.isUserActive)return e[t]}return null}},{key:"setNext",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(So[e])return t?this.forEach(function(t){e===t.playerId?(t.isUserActive=!1,t.isInstNext=!0):t.isInstNext=!1}):So[e].isInstNext=t,e}}],[{key:"getInstance",value:function(){return Oo||(Oo=new t),Oo}}])}(ko.EventEmitter);function $o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Po(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(r),!0).forEach(function(t){No(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ro(){Ro=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch{l=function(e,t,r){return e[t]=r}}function c(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=Object.create(o.prototype),a=new T(i||[]);return n(s,"_invoke",{value:w(e,r,a)}),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function p(){}function f(){}var _={};l(_,o,function(){return this});var y=Object.getPrototypeOf,g=y&&y(y(S([])));g&&g!==t&&r.call(g,o)&&(_=g);var m=f.prototype=h.prototype=Object.create(_);function v(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function b(e,t){function i(n,o,s,a){var l=u(e[n],e,o);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then(function(e){i("next",e,s,a)},function(e){i("throw",e,s,a)}):t.resolve(d).then(function(e){c.value=e,s(c)},function(e){return i("throw",e,s,a)})}a(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t(function(t,n){i(e,r,t,n)})}return o=o?o.then(n,n):n()}})}function w(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=C(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var l=u(e,t,r);if("normal"===l.type){if(n=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n="completed",r.method="throw",r.arg=l.arg)}}}function C(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=u(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=f,n(m,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=l(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},v(b.prototype),l(b.prototype,s,function(){return this}),e.AsyncIterator=b,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new b(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then(function(e){return e.done?e.value:s.next()})},v(m),l(m,a,"Generator"),l(m,o,function(){return this}),l(m,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(a&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;k(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function xo(e){return(xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lo(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function Io(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){Lo(o,n,i,s,a,"next",e)}function a(e){Lo(o,n,i,s,a,"throw",e)}s(void 0)})}}function Mo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Do(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zo(n.key),n)}}function Bo(e,t,r){return t&&Do(e.prototype,t),r&&Do(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function No(e,t,r){return(t=Zo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vo(e,t)}function Uo(e){return(Uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vo(e,t){return(Vo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Fo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ho(e,t,r){return Ho=Fo()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&Vo(i,r.prototype),i},Ho.apply(null,arguments)}function Go(e){var t="function"==typeof Map?new Map:void 0;return Go=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ho(e,arguments,Uo(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Vo(r,e)},Go(e)}function Wo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qo(e){var t=Fo();return function(){var r,n=Uo(e);if(t){var i=Uo(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Wo(e)}(this,r)}}function Ko(){return Ko=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uo(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ko.apply(this,arguments)}function zo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Zo(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Yo(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.used=!1,r.resolve=function(){return r.used=!0,e.apply(void 0,arguments)},r.reject=function(){return r.used=!0,t.apply(void 0,arguments)},r}Ao||Object.prototype.constructor;var Xo={DEBUG:1,LOG:2,WARN:3,ERROR:4},Qo=["Boolean","Number","String","Undefined","Null","Date","Object"],Jo=function(){function e(t,r){Mo(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(null==r?void 0:r.logCacheLevel)||3,this.logMaxSize=(null==r?void 0:r.logMaxSize)||204800,this.logSize=0,this.logTextArray=[]}return Bo(e,[{key:"debug",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Xo.DEBUG].concat(n)),!e.disabled&&(t=console).debug.apply(t,[this._prefix,es()].concat(n))}},{key:"log",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Xo.LOG].concat(n)),!e.disabled&&(t=console).log.apply(t,[this._prefix,es()].concat(n))}},{key:"warn",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Xo.WARN].concat(n)),!e.disabled&&(t=console).warn.apply(t,[this._prefix,es()].concat(n))}},{key:"error",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[Xo.ERROR].concat(n)),!e.disabled&&(t=console).error.apply(t,[this._prefix,es()].concat(n))}},{key:"logCache",value:function(e){if(!(e<this.logCacheLevel)){var t="";try{for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=n.map(function(e){return rs(e)});t=this._prefix+es()+JSON.stringify(o)}catch{return}if(e>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var s=this.logTextArray.shift();this.logSize-=s.length}}}},{key:"getLogCache",value:function(){var e=this.logTextArray.join("\n");return this.reset(),e}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(e){this.logCacheLevel=e}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();function es(){return(new Date).toLocaleString()}function ts(e){if("object"!==xo(e))return e;var t=Object.prototype.toString.call(e).slice(8,-1);switch(t){case"Array":case"Uint8Array":case"ArrayBuffer":return t+"["+e.length+"]";case"Object":return"{}";default:return t}}function rs(e,t,r){r||(r=1),t||(t=2);var n={};if(!e||"object"!==xo(e))return e;var i=Object.prototype.toString.call(e).slice(8,-1);if(!Qo.includes(i))return i;if(!(r>t)){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r===t?n[o]=ts(e[o]):"object"===xo(e[o])?n[o]=rs(e[o],t,r+1):n[o]=e[o]);return n}}No(Jo,"disabled",!0);var ns="fetch",is="arraybuffer",os="text",ss="json",as=function(e){jo(r,e);var t=qo(r);function r(e,n,i,o){var s;return Mo(this,r),No(Wo(s=t.call(this,o)),"retryCount",0),No(Wo(s),"isTimeout",!1),No(Wo(s),"loaderType",ns),No(Wo(s),"startTime",0),No(Wo(s),"endTime",0),No(Wo(s),"options",{}),s.url=e,s.request=n,s.response=i,s}return Bo(r)}(Go(Error)),ls=Object.prototype.toString;function cs(e){if("[object Object]"!==ls.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function us(e){if(e&&null!==e[0]&&void 0!==e[0]&&(0!==e[0]||null!==e[1]&&void 0!==e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function ds(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function hs(e,t){if(e){if(!t)return e;var r,n=Object.keys(t).map(function(e){if(null!=(r=t[e]))return Array.isArray(r)?e+="[]":r=[r],r.map(function(t){return function(e){return"[object Date]"===ls.call(e)}(t)?t=t.toISOString():function(e){return null!==e&&"object"===xo(e)}(t)&&(t=JSON.stringify(t)),"".concat(ds(e),"=").concat(ds(t))}).join("&")}).filter(Boolean).join("&");if(n){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}}function ps(e,t,r,n,i,o,s,a,l,c,u){return i=null!=i?parseFloat(i):null,n=parseInt(n||"0",10),Number.isNaN(n)&&(n=0),{data:e,done:t,options:{range:l,vid:c,index:a,contentLength:n,age:i,startTime:o,firstByteTime:s,endTime:Date.now(),priOptions:u},response:r}}function fs(e,t){return Math.round(8*e*1e3/t/1024)}var _s="real_time_speed",ys=2097152,gs=function(e){jo(n,e);var t,r=qo(n);function n(){var e;return Mo(this,n),No(Wo(e=r.call(this)),"_abortController",null),No(Wo(e),"_timeoutTimer",null),No(Wo(e),"_reader",null),No(Wo(e),"_response",null),No(Wo(e),"_aborted",!1),No(Wo(e),"_index",-1),No(Wo(e),"_range",null),No(Wo(e),"_receivedLength",0),No(Wo(e),"_running",!1),No(Wo(e),"_logger",null),No(Wo(e),"_vid",""),No(Wo(e),"_onProcessMinLen",0),No(Wo(e),"_onCancel",null),No(Wo(e),"_priOptions",null),e}return Bo(n,[{key:"load",value:function(e){var t,r=this,n=e.url,i=e.vid,o=e.timeout,s=e.responseType,a=e.onProgress,l=e.index,c=e.onTimeout,u=e.onCancel,d=e.range,h=e.transformResponse,p=e.request,f=e.params,_=e.logger,y=e.method,g=e.headers,m=e.body,v=e.mode,b=e.credentials,w=e.cache,C=e.redirect,E=e.referrer,k=e.referrerPolicy,T=e.onProcessMinLen,S=e.priOptions;this._logger=_,this._aborted=!1,this._onProcessMinLen=T,this._onCancel=u,this._abortController=typeof AbortController<"u"&&new AbortController,this._running=!0,this._index=l,this._range=d||[0,0],this._vid=i||n,this._priOptions=S||{};var O={method:y,headers:g,body:m,mode:v,credentials:b,cache:w,redirect:C,referrer:E,referrerPolicy:k,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal},A=!1;clearTimeout(this._timeoutTimer),n=hs(n,f);var $=us(d);$&&(g=p?p.headers:O.headers=O.headers||(Headers?new Headers:{}),Headers&&g instanceof Headers?g.append("Range",$):g.Range=$),o&&(this._timeoutTimer=setTimeout(function(){if(A=!0,r.cancel(),c){var e=new as(n,O,null,"timeout");e.isTimeout=!0,c(e,{index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions})}},o));var P=Date.now();return this._logger.debug("[fetch load start], index,",l,",range,",d),new Promise(function(e,t){fetch(p||n,p?void 0:O).then(function(){var i=Io(Ro().mark(function i(o){var c,u,p,f;return Ro().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(clearTimeout(r._timeoutTimer),r._response=o,!r._aborted&&r._running){i.next=4;break}return i.abrupt("return");case 4:if(h&&(o=h(o,n)||o),o.ok){i.next=7;break}throw new as(n,O,o,"bad network response");case 7:if(c=Date.now(),s!==os){i.next=15;break}return i.next=11,o.text();case 11:u=i.sent,r._running=!1,i.next=37;break;case 15:if(s!==ss){i.next=22;break}return i.next=18,o.json();case 18:u=i.sent,r._running=!1,i.next=37;break;case 22:if(!a){i.next=29;break}return r.resolve=e,r.reject=t,r._loadChunk(o,a,P,c),i.abrupt("return");case 29:return i.next=31,o.arrayBuffer();case 31:u=i.sent,u=new Uint8Array(u),r._running=!1,p=Date.now()-P,f=fs(u.byteLength,p),r.emit(_s,{speed:f,len:u.byteLength,time:p,vid:r._vid,index:r._index,range:r._range,priOptions:r._priOptions});case 37:r._logger.debug("[fetch load end], index,",l,",range,",d),e(ps(u,!0,o,o.headers.get("Content-Length"),o.headers.get("age"),P,c,l,d,r._vid,r._priOptions));case 39:case"end":return i.stop()}},i)}));return function(e){return i.apply(this,arguments)}}()).catch(function(e){var i;clearTimeout(r._timeoutTimer),r._running=!1,(!r._aborted||A)&&((e=e instanceof as?e:new as(n,O,null,null===(i=e)||void 0===i?void 0:i.message)).startTime=P,e.endTime=Date.now(),e.isTimeout=A,e.options={index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions},t(e))})})}},{key:"cancel",value:(t=Io(Ro().mark(function e(){return Ro().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._aborted){e.next=2;break}return e.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){e.next=14;break}if(e.prev=5,!this._reader){e.next=9;break}return e.next=9,this._reader.cancel();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch{}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return e.stop()}},e,this,[[5,11]])})),function(){return t.apply(this,arguments)})},{key:"_loadChunk",value:function(e,t,r,n){var i=this;if(!e.body||!e.body.getReader){this._running=!1;var o=new as(e.url,"",e,"onProgress of bad response.body.getReader");return o.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},void this.reject(o)}this._onProcessMinLen>0&&(this._cache=new Uint8Array(ys),this._writeIdx=0);var s,a,l,c=this._reader=e.body.getReader(),u=function(){var o=Io(Ro().mark(function o(){var d,h,p,f,_,y,g,m;return Ro().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return a=Date.now(),o.prev=1,o.next=4,c.read();case 4:s=o.sent,l=Date.now(),o.next=13;break;case 8:return o.prev=8,o.t0=o.catch(1),l=Date.now(),i._aborted||(i._running=!1,o.t0.options={index:i._index,range:i._range,vid:i._vid,priOptions:i._priOptions},i.reject(o.t0)),o.abrupt("return");case 13:if(h=(null===(d=i._range)||void 0===d?void 0:d.length)>0?i._range[0]:0,p=h+i._receivedLength,!i._aborted){o.next=19;break}return i._running=!1,t(void 0,!1,{range:[p,p],vid:i._vid,index:i._index,startTime:a,endTime:l,st:r,firstByteTime:n,priOptions:i._priOptions},e),o.abrupt("return");case 19:f=s.value?s.value.byteLength:0,i._receivedLength+=f,i._logger.debug("【fetchLoader,onProgress call】,task,",i._range,", start,",p,", end,",h+i._receivedLength,", done,",s.done),i._onProcessMinLen>0?i._writeIdx+f>=i._onProcessMinLen||s.done?((_=new Uint8Array(i._writeIdx+f)).set(i._cache.slice(0,i._writeIdx),0),f>0&&_.set(s.value,i._writeIdx),i._writeIdx=0,i._logger.debug("【fetchLoader,onProgress enough】,done,",s.done,",len,",_.byteLength,", writeIdx,",i._writeIdx)):f>0&&i._writeIdx+f<ys?(i._cache.set(s.value,i._writeIdx),i._writeIdx+=f,i._logger.debug("【fetchLoader,onProgress cache】,len,",f,", writeIdx,",i._writeIdx)):f>0&&(y=new Uint8Array(i._writeIdx+f+2048),i._logger.debug("【fetchLoader,onProgress extra start】,size,",i._writeIdx+f+2048,", datalen,",f,", writeIdx,",i._writeIdx),y.set(i._cache.slice(0,i._writeIdx),0),f>0&&y.set(s.value,i._writeIdx),i._writeIdx+=f,delete i._cache,i._cache=y,i._logger.debug("【fetchLoader,onProgress extra end】,len,",f,", writeIdx,",i._writeIdx)):_=s.value,(_&&_.byteLength>0||s.done)&&t(_,s.done,{range:[i._range[0]+i._receivedLength-(_?_.byteLength:0),i._range[0]+i._receivedLength],vid:i._vid,index:i._index,startTime:a,endTime:l,st:r,firstByteTime:n,priOptions:i._priOptions},e),s.done?(g=Date.now()-r,m=fs(i._receivedLength,g),i.emit(_s,{speed:m,len:i._receivedLength,time:g,vid:i._vid,index:i._index,range:i._range,priOptions:i._priOptions}),i._running=!1,i._logger.debug("[fetchLoader onProgress end],task,",i._range,",done,",s.done),i.resolve(ps(s,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),r,n,i._index,i._range,i._vid,i._priOptions))):u();case 25:case"end":return o.stop()}},o,null,[[1,8]])}));return function(){return o.apply(this,arguments)}}();u()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return typeof fetch<"u"}}]),n}(To),ms=function(e){jo(r,e);var t=qo(r);function r(){var e;return Mo(this,r),No(Wo(e=t.call(this)),"_xhr",null),No(Wo(e),"_aborted",!1),No(Wo(e),"_timeoutTimer",null),No(Wo(e),"_range",null),No(Wo(e),"_receivedLength",0),No(Wo(e),"_url",null),No(Wo(e),"_onProgress",null),No(Wo(e),"_index",-1),No(Wo(e),"_headers",null),No(Wo(e),"_currentChunkSizeKB",384),No(Wo(e),"_timeout",null),No(Wo(e),"_xhr",null),No(Wo(e),"_withCredentials",null),No(Wo(e),"_startTime",-1),No(Wo(e),"_loadCompleteResolve",null),No(Wo(e),"_loadCompleteReject",null),No(Wo(e),"_runing",!1),No(Wo(e),"_logger",!1),No(Wo(e),"_vid",""),No(Wo(e),"_responseType",void 0),No(Wo(e),"_credentials",void 0),No(Wo(e),"_method",void 0),No(Wo(e),"_transformResponse",void 0),No(Wo(e),"_firstRtt",void 0),No(Wo(e),"_onCancel",null),No(Wo(e),"_priOptions",null),e}return Bo(r,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials="include"===e.credentials||"same-origin"===e.credentials,this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=hs(e.url,e.params);var r=Date.now();return new Promise(function(e,r){t._loadCompleteResolve=e,t._loadCompleteReject=r,t._startLoad()}).catch(function(e){if(clearTimeout(t._timeoutTimer),t._runing=!1,!t._aborted)throw(e=e instanceof as?e:new as(t._url,t._request)).startTime=r,e.endTime=Date.now(),e.options={index:t._index,vid:t._vid,priOptions:t._priOptions},e})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===is&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var t=1024*this._currentChunkSizeKB,r=this._range[0]+this._receivedLength,n=this._range[1];t<this._range[1]-r&&(n=r+t),e=[r,n],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var t=this;try{this._startTime=Date.now();var r=this._xhr=new XMLHttpRequest;r.open(this._method||"GET",this._url,!0),r.responseType=this._responseType,this._timeout&&(r.timeout=this._timeout),r.withCredentials=this._withCredentials,r.onload=this._onLoad.bind(this),r.onreadystatechange=this._onReadyStatechange.bind(this),r.onerror=function(e){var r,n,i;t._running=!1;var o=new as(t._url,t._request,null==e||null===(r=e.currentTarget)||void 0===r?void 0:r.response,"xhr.onerror.status:"+(null==e||null===(n=e.currentTarget)||void 0===n?void 0:n.status)+",statusText,"+(null==e||null===(i=e.currentTarget)||void 0===i?void 0:i.statusText));o.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(o)},r.ontimeout=function(e){t.cancel();var r=new as(t._url,t._request,{status:408},"timeout");t._onTimeout&&(r.isTimeout=!0,t._onTimeout(r,{index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions})),r.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(r)};var n=this._headers||{},i=us(e);i&&(n.Range=i),n&&Object.keys(n).forEach(function(e){r.setRequestHeader(e,n[e])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),r.send(this._body)}catch(t){t.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(t)}}},{key:"_onReadyStatechange",value:function(e){2===e.target.readyState&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var t,r=e.target.status;if(r<200||r>299){var n=new as(this._url,null,Po(Po({},e.target.response),{},{status:r}),"bad response,status:"+r);return n.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(n)}var i,o=null,s=!1,a=(null===(t=this._range)||void 0===t?void 0:t.length)>0?this._range[0]:0;if(this._responseType===is){var l,c=new Uint8Array(e.target.response);if(i=a+this._receivedLength,c&&c.byteLength>0){this._receivedLength+=c.byteLength;var u=Date.now()-this._startTime,d=fs(this._receivedLength,u);this.emit(_s,{speed:d,len:this._receivedLength,time:u,vid:this._vid,index:this._index,range:[i,a+this._receivedLength],priOptions:this._priOptions})}o=c,s=!((null===(l=this._range)||void 0===l?void 0:l.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]),this._logger.debug("[xhr load done->], tast :",this._range,", start",i,"end ",a+this._receivedLength,",dataLen,",c?c.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",s)}else s=!0,o=e.target.response;var h={ok:r>=200&&r<300,status:r,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(h=this._transformResponse(h,this._url)||h),this._onProgress&&this._onProgress(o,s,{index:this._index,vid:this._vid,range:[i,a+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},h),s?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(ps(this._onProgress?null:o,s,h,h.headers["content-length"],h.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted&&(this._aborted=!0,this._runing=!1,Ko(Uo(r.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr))return this._xhr.abort()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var t,r={},n=function(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return zo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zo(e,t)}}(e))||t){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{!s&&null!=r.return&&r.return()}finally{if(a)throw o}}}}(e.getAllResponseHeaders().trim().split("\r\n"));try{for(n.s();!(t=n.n()).done;){var i=t.value.split(": ");r[i[0].toLowerCase()]=i.slice(1).join(": ")}}catch(e){n.e(e)}finally{n.f()}return r}}],[{key:"isSupported",value:function(){return typeof XMLHttpRequest<"u"}}]),r}(To),vs=["retry","retryDelay","onRetryError","transformError"],bs=function(){function e(t,r){Mo(this,e),this.promise=Yo(),this.alive=!!r.onProgress,!r.logger&&(r.logger=new Jo("Loader")),this._loaderType=t,this._loader=t===ns&&window.fetch?new gs:new ms,this._config=r,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=r.retryCheckFunc,this._logger=r.logger}return Bo(e,[{key:"exec",value:function(){var e=this,t=this._config,r=t.retry,n=t.retryDelay,i=t.onRetryError,o=t.transformError,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(t,vs),a=function(){var t=Io(Ro().mark(function t(){var l,c,u;return Ro().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._loader.load(s);case 3:l=t.sent,e.promise.resolve(l),t.next=27;break;case 7:if(t.prev=7,t.t0=t.catch(0),e._loader.running=!1,e._logger.debug("[task request catch err]",t.t0),!e._canceled){t.next=13;break}return t.abrupt("return");case 13:if(t.t0.loaderType=e._loaderType,t.t0.retryCount=e._retryCount,c=t.t0,o&&(c=o(c)||c),i&&e._retryCount>0&&i(c,e._retryCount,{index:s.index,vid:s.vid,range:s.range,priOptions:s.priOptions}),e._retryCount++,u=!0,e._retryCheckFunc&&(u=e._retryCheckFunc(t.t0)),!(u&&e._retryCount<=r)){t.next=26;break}return clearTimeout(e._retryTimer),e._logger.debug("[task request setTimeout],retry",e._retryCount,",retry range,",s.range),e._retryTimer=setTimeout(a,n),t.abrupt("return");case 26:e.promise.reject(c);case 27:case"end":return t.stop()}},t,null,[[0,7]])}));return function(){return t.apply(this,arguments)}}();return a(),this.promise}},{key:"cancel",value:(t=Io(Ro().mark(function e(){return Ro().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,e.abrupt("return",this._loader.cancel());case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),e;var t}();function ws(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){return setTimeout(t,e)})}var Cs=function(e){jo(n,e);var t,r=qo(n);function n(e){var t;return Mo(this,n),No(Wo(t=r.call(this,e)),"type",ns),No(Wo(t),"_queue",[]),No(Wo(t),"_alive",[]),No(Wo(t),"_currentTask",null),No(Wo(t),"_config",void 0),t._config=function(e){return Po({loaderType:ns,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:os,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},e)}(e),("xhr"===t._config.loaderType||!gs.isSupported())&&(t.type="xhr"),t.log=e.logger,t}return Bo(n,[{key:"isFetch",value:function(){return this.type===ns}},{key:"load",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?r=e:r.url=e||r.url||this._config.url,(r=Object.assign({},this._config,r)).params&&(r.params=Object.assign({},r.params)),r.headers&&cs(r.headers)&&(r.headers=Object.assign({},r.headers)),r.body&&cs(r.body)&&(r.body=Object.assign({},r.body)),r.transformRequest&&(r=r.transformRequest(r)||r),r.logger=this.log;var n=new bs(this.type,r);return n.loader.on(_s,function(e){t.emit(_s,e)}),this._queue.push(n),1===this._queue.length&&(!this._currentTask||!this._currentTask.running)&&this._processTask(),n.promise}},{key:"cancel",value:(t=Io(Ro().mark(function e(){var t;return Ro().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map(function(e){return e.cancel()}).concat(this._alive.map(function(e){return e.cancel()})),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,ws();case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var t=this._currentTask.exec().catch(function(e){});t&&"function"==typeof t.finally&&t.finally(function(){var t,r;null!==(t=e._currentTask)&&void 0!==t&&t.alive&&(null===(r=e._alive)||void 0===r?void 0:r.length)>0&&(e._alive=e._alive.filter(function(t){return t&&t!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return gs.isSupported()}}]),n}(To);class Es{static getDefaultConfig(){return{PCDNBufferControl:!1,PCDNCntControl:!1,estPTcontrol:!1,minPCDNInBuffer:8,maxPCDNInBuffer:12,minPCDNOutBuffer:3,maxPCDNOutBuffer:6,safePCDNInFactor:.1,safePCDNOutFactor:.4,alpha:.5,estPlayTime:12,minBandwidth:1e6}}constructor(e,t,r,n){this.config=Es.getDefaultConfig(),Object.keys(n).map(e=>{void 0!==n[e]&&null!==n[e]&&(this.config[e]=n[e])}),this.duration=r,this.player=e,this.updateBitrate(t),this.curPCDNInBuffer=this.config.maxPCDNInBuffer,this.curPCDNOutBuffer=this.config.maxPCDNOutBuffer,this.PCDNChangeCnt=0}updateBitrate(e){this.bitrate=e,this.bitrate||(this.bitrate=this.config.minBandwidth)}getPCDNInBuffer(){const{config:e,player:t,bitrate:r}=this;if(!e.PCDNBufferControl)return null;const{estPlayTime:n}=e;let i=n;e.estPTcontrol&&(i=Math.min(n,Math.max(0,this.duration-((null==t?void 0:t.currentTime)||0))));const{safePCDNInFactor:o,minBandwidth:s,maxPCDNInBuffer:a,minPCDNInBuffer:l}=e,c=o*Math.max(1024*(null==t?void 0:t.avgSpeedPCDN)||0,s),u=r>0?(1-c/r)*i:0;return this.curPCDNInBuffer=Math.min(a,Math.max(l,u)),this.curPCDNInBuffer}getPCDNOutBuffer(){const{config:e,player:t,bitrate:r}=this;if(!e.PCDNBufferControl)return null;const{estPlayTime:n}=e;let i=n;e.estPTcontrol&&(i=Math.min(n,Math.max(0,this.duration-((null==t?void 0:t.currentTime)||0))));const{safePCDNOutFactor:o,minBandwidth:s,maxPCDNOutBuffer:a,minPCDNOutBuffer:l}=e,c=o*Math.max(1024*(null==t?void 0:t.avgSpeedPCDN)||0,s),u=r>0?(1-c/r)*i:0;return this.curPCDNOutBuffer=Math.min(a,Math.max(l,u)),this.curPCDNOutBuffer}getPCDNChangeCnt(){const{PCDNCntControl:e,alpha:t}=this.config,{curPCDNInBuffer:r,player:n}=this,i=(null==n?void 0:n.bufferedPoint)||null,o=i&&i.end?i.end-n.currentTime:0;return e?o>r+(this.PCDNChangeCnt-1)*t&&this.PCDNChangeCnt++:o>=r&&this.PCDNChangeCnt<2&&this.PCDNChangeCnt++,this.PCDNChangeCnt}}const ks=new Map,Ts=class e{static get pluginName(){return"PCDN"}static get pcdnReqCnt(){const{pcdn_tracker_request_cnt:t,pcdn_tracker_success_cnt:r}=e;return e.pcdn_tracker_request_cnt=0,e.pcdn_tracker_success_cnt=0,{pcdn_tracker_request_cnt:t,pcdn_tracker_failed_cnt:t-r}}static getDefaultConfig(){return{trackerUrl:"",loaderType:ns,responseType:ss,mode:"cors",method:"POST",retry:0,retryDelay:3e3,timeout:5e3,node_num:5,client_info:null,maxCnt:30,withReferer:0,NULLNodeTimeStep:6e4,ErrorTimeStep:15e3}}constructor(t,r,n,i){var o,s;this.options=e.getDefaultConfig(),Object.keys(t).map(e=>{void 0!==t[e]&&null!==t[e]&&(this.options[e]=t[e])}),(!this.options.productConfig||!this.options.productConfig.app_id)&&console.error("productConfig must has"),this.loader=new Cs(this.options),this.resetTrackeArgs(),this._lastFileInfo=null,this.lastfetchNodeTime=-1,this._lastRetFileKey=null,this._minUpdateNodeStep=this.options.ErrorTimeStep,null!=(s=null==(o=this.options)?void 0:o.adaptPCDNConfig)&&s.PCDNBufferControl&&(this.pcdnAdapt=new Es(r,n,i,this.options.adaptPCDNConfig))}get isOpenAdaptPCDN(){return!!this.pcdnAdapt}get curPCDNInBuffer(){return this.pcdnAdapt.curPCDNInBuffer}getPCDNInBuffer(){var e;return null==(e=this.pcdnAdapt)?void 0:e.getPCDNInBuffer()}get curPCDNOutBuffer(){return this.pcdnAdapt.curPCDNOutBuffer}getPCDNOutBuffer(){var e;return null==(e=this.pcdnAdapt)?void 0:e.getPCDNOutBuffer()}get curPCDNChangeCnt(){return this.pcdnAdapt.PCDNChangeCnt}getPCDNChangeCnt(){var e;return null==(e=this.pcdnAdapt)?void 0:e.getPCDNChangeCnt()}resetTrackeArgs(e){this.trackeArgs={fid:null,trace_id:null,req_times:(null==e?void 0:e.req_times)||0,resp_times:(null==e?void 0:e.resp_times)||0,token:null,node_num:this.options.node_num,client_info:this.options.client_info}}static async gainPCDNNode(t,r,n,i){var o,s,a;const l=e.getDefaultConfig();Object.keys(r).map(e=>{void 0!==r[e]&&null!==r[e]&&(l[e]=r[e])}),(!i||!i.app_id)&&console.error("productConfig must has");const c=new Yo;n?(n.byterate=Os(n.bitrate),delete n.bitrate):c.reject("video fileInfo need set");const u=Object.assign(i,{file_info:n},{node_num:(null==r?void 0:r.node_num)||3}),d=JSON.stringify(u),h=new Cs(l);try{e.pcdn_tracker_request_cnt++;const r=await h.load(t,{body:d});r.done&&(null==(a=null==(s=null==(o=r.data)?void 0:o.Result)?void 0:s.nodes)?void 0:a.length)>0&&e.pcdn_tracker_success_cnt++,c.resolve(r)}catch(e){c.reject((null==e?void 0:e.message)||"get pcdnNode error")}return c}getPCDNNode(e,t,r){var n;const i=Os(t),o=ks.get(Ss(e,i)),s=new Yo;return null==o||!o.nodes||(null==(n=null==o?void 0:o.nodes)?void 0:n.length)<1?this.fetchPCDNNode(null,null,r).then(e=>{s.resolve(e)}).catch(e=>{s.reject(e)}):(o.fromCache=!0,s.resolve(o)),s}removePCDNNode(e,t,r){const n=Os(t),i=ks.get(Ss(e,n)),o=null==i?void 0:i.nodes;o&&(r?i.nodes=o.filter(e=>e&&r.indexOf(e.url)<0):o.shift(),ks.set(Ss(e,n),i)),(!o||!o.length)&&this.fetchPCDNNode().then().catch(()=>{})}async fetchPCDNNode(t,r,n){var i,o;const s=new Yo;if(r){r.byterate=Os(r.bitrate);const e=ks.get(Ss(r.vid,r.byterate));if((null==(i=null==e?void 0:e.nodes)?void 0:i.length)>0)return e.fromCache=!0,s.resolve(e),s;delete r.bitrate,this._lastFileInfo=r}else r=this._lastFileInfo;if(!r)return s.resolve(null),s;let a=!1;const l=Ss(r.vid,r.byterate);if(this._lastRetFileKey!==l&&(this.resetTrackeArgs(),a=!0),Date.now()-this.lastfetchNodeTime<this._minUpdateNodeStep&&!a)return s.resolve(null),s;this.lastfetchNodeTime=Date.now(),this._lastRetFileKey=l,r.sfid?r.version=1:r.vid&&(r.version=2),this.options.withReferer&&(r.with_referer=this.options.withReferer);const c=Object.assign(this.options.productConfig,{file_info:r},this.trackeArgs,{req_id:n}),u=JSON.stringify(c);if(this.trackeArgs.req_times>=this.options.maxCnt)return s.resolve(null),s;this.loader||(this.loader=new Cs(this.options)),this.trackeArgs.req_times+=1;try{e.pcdn_tracker_request_cnt++;const n=await this.loader.load(t||this.options.trackerUrl,{body:u});let i=null;if(n){this.trackeArgs.resp_times+=1;const t=8*r.byterate;if(n.done&&null!=(o=n.data)&&o.Result){const o=n.data.Result;i=o.nodes,i&&i.length>0?e.pcdn_tracker_success_cnt++:this._minUpdateNodeStep=this.options.NULLNodeTimeStep,i.map(e=>{e.vid=r.vid,e.bitrate=t});const{fid:a,trace_id:l,req_id:c}=o,u={nodes:i,fid:a,vid:r.vid,trace_id:l,req_id:c,bitrate:t},d=Ss(r.vid,r.byterate);ks.set(d,u),this.trackeArgs.fid=o.fid,this.trackeArgs.trace_id=o.trace_id,this.trackeArgs.token=o.token,s.resolve(u)}else this._minUpdateNodeStep=this.options.ErrorTimeStep,s.reject(n)}}catch(e){this._minUpdateNodeStep=this.options.ErrorTimeStep,console.warn("tracker catch ERR,",e),s.reject(e)}return s}};function Ss(e,t){return`${e}-${t}`}function Os(e){return Math.floor(e/8)}function As(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function $s(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function Ps(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){$s(o,n,i,s,a,"next",e)}function a(e){$s(o,n,i,s,a,"throw",e)}s(void 0)})}}function Rs(e,t,r){return t=Bs(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,js()?Reflect.construct(t,r||[],Bs(e).constructor):t.apply(e,r))}function xs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ls(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ws(n.key),n)}}function Is(e,t,r){return t&&Ls(e.prototype,t),r&&Ls(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ms(e,t,r){return(t=Ws(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ds(){return Ds="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Bs(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ds.apply(null,arguments)}function Bs(e){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ns(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gs(e,t)}function js(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(js=function(){return!!e})()}function Us(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Vs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(r),!0).forEach(function(t){Ms(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Us(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Fs(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return Hs(c,"_invoke",function(r,n,i){var o,a,l,c=0,u=i||[],d=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,a=0,l=e,h.n=r,s}};function p(r,n){for(a=r,l=n,t=0;!d&&c&&!i&&t<u.length;t++){var i,o=u[t],p=h.p,f=o[2];r>3?(i=f===n)&&(l=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=r<2&&p<o[1])?(a=0,h.v=n,h.n=o[1]):p<f&&(i=r<3||o[0]>n||n>f)&&(o[4]=r,o[5]=n,h.n=f,a=0))}if(i||r>1)return s;throw d=!0,n}return function(i,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,f),a=u,l=f;(t=a<2?e:l)||!d;){o||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(d=h.n<0)?l:r.call(n,h))!==s)break}catch(t){o=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,i,o),!0),c}var s={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Hs(t={},n,function(){return this}),t),d=c.prototype=a.prototype=Object.create(u);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Hs(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Hs(d,"constructor",c),Hs(c,"constructor",l),l.displayName="GeneratorFunction",Hs(c,i,"GeneratorFunction"),Hs(d),Hs(d,i,"Generator"),Hs(d,n,function(){return this}),Hs(d,"toString",function(){return"[object Generator]"}),(Fs=function(){return{w:o,m:h}})()}function Hs(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(Hs=function(e,t,r,n){if(t)i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{let t=function(t,r){Hs(e,t,function(e){return this._invoke(t,r,e)})};t("next",0),t("throw",1),t("return",2)}})(e,t,r,n)}function Gs(e,t){return(Gs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ws(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function qs(e){return(qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ks(e){var t="function"==typeof Map?new Map:void 0;return Ks=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return function(e,t,r){if(js())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var i=new(e.bind.apply(e,n));return r&&Gs(i,r.prototype),i}(e,arguments,Bs(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Gs(r,e)},Ks(e)}po(Ts,"pcdn_tracker_request_cnt",0),po(Ts,"pcdn_tracker_success_cnt",0);var zs={DEBUG:1,LOG:2,WARN:3,ERROR:4},Zs=["Boolean","Number","String","Undefined","Null","Date","Object"],Ys=function(){function e(t,r){xs(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(null==r?void 0:r.logCacheLevel)||3,this.logMaxSize=(null==r?void 0:r.logMaxSize)||204800,this.logSize=0,this.logTextArray=[]}return Is(e,[{key:"debug",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[zs.DEBUG].concat(n)),e.disabled||(t=console).debug.apply(t,[this._prefix,Xs()].concat(n))}},{key:"log",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[zs.LOG].concat(n)),e.disabled||(t=console).log.apply(t,[this._prefix,Xs()].concat(n))}},{key:"warn",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[zs.WARN].concat(n)),e.disabled||(t=console).warn.apply(t,[this._prefix,Xs()].concat(n))}},{key:"error",value:function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];this.logCache.apply(this,[zs.ERROR].concat(n)),e.disabled||(t=console).error.apply(t,[this._prefix,Xs()].concat(n))}},{key:"logCache",value:function(e){if(!(e<this.logCacheLevel)){var t="";try{for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var o=n.map(function(e){return Js(e)});t=this._prefix+Xs()+JSON.stringify(o)}catch(e){return}if(e>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var s=this.logTextArray.shift();this.logSize-=s.length}}}},{key:"getLogCache",value:function(){var e=this.logTextArray.join("\n");return this.reset(),e}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(e){this.logCacheLevel=e}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}])}();function Xs(){return(new Date).toLocaleString()}function Qs(e){if("object"!==qs(e))return e;var t=Object.prototype.toString.call(e).slice(8,-1);switch(t){case"Array":case"Uint8Array":case"ArrayBuffer":return t+"["+e.length+"]";case"Object":return"{}";default:return t}}function Js(e,t,r){r||(r=1),t||(t=2);var n={};if(!e||"object"!==qs(e))return e;var i=Object.prototype.toString.call(e).slice(8,-1);if(!Zs.includes(i))return i;if(!(r>t)){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r===t?n[o]=Qs(e[o]):"object"===qs(e[o])?n[o]=Js(e[o],t,r+1):n[o]=e[o]);return n}}Ms(Ys,"disabled",!0);var ea,ta=function(){function e(){xs(this,e)}return Is(e,null,[{key:"start",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&e.start(0)<0?0:e.start(0):0}},{key:"end",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1):0}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(e){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var r=[],n=0,i=e.length;n<i;n++){var o=r.length;if(o&&t){var s=r[o-1],a=s[1];if(e.start(n)-a<=t){var l=e.end(n);l>a&&(s[1]=l)}else r.push([e.start(n),e.end(n)])}else r.push([e.start(n),e.end(n)])}return r}},{key:"totalLength",value:function(e){return e&&e.length?e.reduce(function(e,t){return e+(t[1]-t[0])},0):0}},{key:"info",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var i=0,o=0,s=0,a=0,l=0,c=0,u=0,d=e.buffers(t,n),h=0,p=d.length;h<p;h++){var f=d[h];if(r+n>=f[0]&&r<=f[1])i=f[0],o=f[1],s=h;else{if(r+n<f[0]){a=f[0],l=f[1];break}r+n>f[1]&&(c=f[0],u=f[1])}}return{start:i,end:o,index:s,buffers:d,nextStart:a,nextEnd:l,prevStart:c,prevEnd:u,currentTime:r,behind:r-i,remaining:o?o-r:0,length:e.totalLength&&e.totalLength(d)}}},{key:"isBuffered",value:function(t,r){if(t){var n=e.get(t);if(null!=n&&n.length)for(var i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return!0}return!1}}])}(),ra={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",MSE_CHANGE_TYPE:"MSE_CHANGE_TYPE",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},na=(Ms(Ms(Ms(Ms(Ms(Ms(Ms(Ms(Ms(Ms(ea={},ra.MANIFEST,{HLS:1100,DASH:1200}),ra.NETWORK,2100),ra.NETWORK_TIMEOUT,2101),ra.NETWORK_FORBIDDEN,2103),ra.NETWORK_NOTFOUND,2104),ra.NETWROK_RANGE_NOT_SATISFIABLE,2116),ra.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),ra.REMUX,{FMP4:4100,MP4:4200}),ra.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),ra.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),Ms(Ms(ea,ra.OTHER,8e3),ra.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003})),ia=function(e){function t(e,r,n,i,o){var s;return xs(this,t),(s=Rs(this,t,[o||(null==n?void 0:n.message)])).errorType=e===ra.NETWORK_TIMEOUT?ra.NETWORK:e,s.originError=n,s.ext=i,s.errorCode=na[e][r]||na[e],s.errorMessage=s.message,s.errorCode||(s.errorType=ra.OTHER,s.errorCode=na[s.errorType]),s}return Ns(t,e),Is(t,null,[{key:"create",value:function(e,r,n,i,o){return e instanceof t?e:(e instanceof Error&&(n=e,e=""),e||(e=ra.OTHER),new t(e,r,n,i,o))}},{key:"network",value:function(e){var r;return new t(null!=e&&e.isTimeout?ra.NETWORK_TIMEOUT:ra.NETWORK,null,e instanceof Error?e:null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e||null===(r=e.response)||void 0===r?void 0:r.status})}}])}(Ks(Error));function oa(){var e,t,r=new Promise(function(r,n){e=r,t=n});return r.used=!1,r.resolve=function(){return r.used=!0,e.apply(void 0,arguments)},r.reject=function(){return r.used=!0,t.apply(void 0,arguments)},r}function sa(){try{return parseInt(performance.now(),10)}catch(e){return(new Date).getTime()}}function aa(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{if(e&&"undefined"!=typeof ManagedMediaSource)return ManagedMediaSource;if("undefined"!=typeof MediaSource)return MediaSource;throw new Error("MediaSource no defined")}catch(e){}}function la(e){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(e))}var ca="updateDuration",ua=function(){function e(t,r){var n=this;xs(this,e),Ms(this,"media",null),Ms(this,"mediaSource",null),Ms(this,"_openPromise",oa()),Ms(this,"_queue",Object.create(null)),Ms(this,"_sourceBuffer",Object.create(null)),Ms(this,"_mseFullFlag",{}),Ms(this,"_st",0),Ms(this,"_opst",0),Ms(this,"_logger",null),Ms(this,"_config",null),Ms(this,"_url",null),Ms(this,"_onStartStreaming",function(){n._logger.debug("startstreaming")}),Ms(this,"_onEndStreaming",function(){n._logger.debug("endstreaming")}),Ms(this,"_onSBUpdateEnd",function(e){var t=n._queue[e];if(t){var r=t[0];if((null==r?void 0:r.opName)!==ca&&t.shift(),r){var i,o,s=sa()-n._opst;n.media&&n._logger.debug("UpdateEnd(".concat(e,"/").concat(r.opName,")"),function(e){try{return JSON.stringify(e)}catch(e){return""}}(function(e){var t=[];if(e instanceof TimeRanges)for(var r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}(null===(o=n._sourceBuffer[e])||void 0===o?void 0:o.buffered)),s,r.context),r.promise.resolve({name:r.opName,context:r.context,costtime:s});var a=null===(i=r.context)||void 0===i?void 0:i.callback;a&&"function"==typeof a&&a(r.context),n._startQueue(e)}}}),Ms(this,"_onSBUpdateError",function(e,t){var r=n._queue[e];if(r){var i=r[0];i&&(n._logger.error("UpdateError",e,i.opName,i.context),i.promise.reject(new ia(ra.MEDIA,ra.SUB_TYPES.MSE_APPEND_BUFFER,t)))}}),this._config=Object.assign(e.getDefaultConfig(),r),t&&this.bindMedia(t),this._logger=new Ys("MSE"),this._config.openLog&&Ys.enable()}return Is(e,[{key:"version",get:function(){return"3.0.30"}},{key:"isOpened",get:function(){var e;return"open"===(null===(e=this.mediaSource)||void 0===e?void 0:e.readyState)}},{key:"hasOpTasks",get:function(){var e=this,t=!1;return Object.keys(this._queue).forEach(function(r){var n=e._queue[r];Array.isArray(n)&&(t||(t=n.length>0))}),t}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var e;return(null===(e=this.mediaSource)||void 0===e?void 0:e.duration)||-1}},{key:"isEnded",get:function(){return!!this.mediaSource&&"ended"===this.mediaSource.readyState}},{key:"streaming",get:function(){return!la(this.mediaSource)||this.mediaSource.streaming}},{key:"handle",get:function(){var e;return null===(e=this.mediaSource)||void 0===e?void 0:e.handle}},{key:"liveEdge",get:function(){var e=this.bufferEnd("video"),t=this.bufferEnd("audio");return e&&t?Math.min(e,t):0}},{key:"videoMimeType",get:function(){var e;return null===(e=this._sourceBuffer.video)||void 0===e?void 0:e.mimeType}},{key:"isFull",value:function(t){return t?this._mseFullFlag[t]:this._mseFullFlag[e.VIDEO]}},{key:"getBlobUrl",value:function(){return this._url||(this._url=URL.createObjectURL(this.mediaSource)),this._url}},{key:"updateDuration",value:function(e){var t=this,r=this.mediaSource&&this.mediaSource.duration>e;if(this.mediaSource&&this.mediaSource.duration>e){var n=0;if(Object.keys(this._sourceBuffer).forEach(function(e){try{n=Math.max(t.bufferEnd(e)||0,n)}catch(e){}}),e<n)return Promise.resolve()}return this._enqueueBlockingOp(function(){t.isEnded?t._logger.debug("setDuration but ended"):t.mediaSource&&(t.mediaSource.duration=e,t._logger.debug("setDuration",e))},ca,{isReduceDuration:r})}},{key:"init",value:function(){var e=this,t=aa(this._config.preferMMS),r=this.mediaSource=new t;this._st=sa();var n=function(){var t=sa()-e._st;e._logger.debug("sourceopen"),r.removeEventListener("sourceopen",n),e._openPromise.resolve({costtime:t})};return r.addEventListener("sourceopen",n),la(r)&&(r.addEventListener("startstreaming",this._onStartStreaming),r.addEventListener("endstreaming",this._onEndStreaming)),this._openPromise}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource,r=function(){var n=sa()-e._st;e._logger.debug("sourceopen",n),t.removeEventListener("sourceopen",r),e._openPromise.resolve({costtime:n})};t.addEventListener("sourceopen",r),this._openPromise=oa()}return this._openPromise}},{key:"bindMedia",value:(i=Ps(Fs().m(function e(t){var r,n,i,o,s=this;return Fs().w(function(e){for(;;)switch(e.n){case 0:if(!this.mediaSource&&!this.media){e.n=1;break}return e.n=1,this.unbindMedia();case 1:if(r=aa(this._config.preferMMS),t&&r){e.n=2;break}throw new Error("Param media or MediaSource does not exist");case 2:return this.media=t,n=this.mediaSource=new r,i=la(n),this._st=sa(),o=function(){var e=sa()-s._st;s._logger.debug("sourceopen"),n.removeEventListener("sourceopen",o),URL.revokeObjectURL(t.src),s._openPromise.resolve({costtime:e})},n.addEventListener("sourceopen",o),i&&(n.addEventListener("startstreaming",this._onStartStreaming),n.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(n),t.src=this._url,t.disableRemotePlayback=i,e.a(2,this._openPromise)}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"unbindMedia",value:(n=Ps(Fs().m(function e(){var t,r,n,i=this;return Fs().w(function(e){for(;;)switch(e.n){case 0:if(this._openPromise.used||this._openPromise.resolve(),t=this.mediaSource){if(Object.keys(this._queue).forEach(function(e){var t=i._queue[e];t&&t.forEach(function(e){var t,r;return null===(t=e.promise)||void 0===t||null===(r=t.resolve)||void 0===r?void 0:r.call(t)})}),r=!!this.media&&this.media.readyState>=1,n="open"===t.readyState,r&&n)try{t.endOfStream()}catch(e){}Object.keys(this._sourceBuffer).forEach(function(e){try{t.removeSourceBuffer(i._sourceBuffer[e])}catch(e){}}),la(t)&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch(e){}this.media=null}this.mediaSource=null,this._openPromise=oa(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 1:return e.a(2)}},e,this)})),function(){return n.apply(this,arguments)})},{key:"unbind",value:(r=Ps(Fs().m(function e(t){var r,n=this;return Fs().w(function(e){for(;;)switch(e.n){case 0:if(this._openPromise.used||this._openPromise.resolve(),r=this.mediaSource){if(Object.keys(this._queue).forEach(function(e){var t=n._queue[e];t&&t.forEach(function(e){var t,r;return null===(t=e.promise)||void 0===t||null===(r=t.resolve)||void 0===r?void 0:r.call(t)})}),t&&this.isOpened)try{r.endOfStream()}catch(e){}Object.keys(this._sourceBuffer).forEach(function(e){try{r.removeSourceBuffer(n._sourceBuffer[e])}catch(e){}})}la(r)&&(r.removeEventListener("startstreaming",this._onStartStreaming),r.removeEventListener("endstreaming",this._onEndStreaming)),this._url&&(URL.revokeObjectURL(this._url),this._url=""),this.mediaSource=null,this._openPromise=oa(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 1:return e.a(2)}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"createSource",value:function(e,t){if(!this._sourceBuffer[e]&&this.mediaSource){var r;try{r=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(e){throw new ia(ra.MEDIA,ra.SUB_TYPES.MSE_ADD_SB,e)}r.mimeType=t,r.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),r.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var r=this,n=this._sourceBuffer[e];return this.mediaSource&&n&&n.mimeType!==t?"function"!=typeof n.changeType?Promise.reject(new ia(ra.MEDIA,ra.SUB_TYPES.MSE_CHANGE_TYPE,new Error("changeType is not a function"))):this._enqueueOp(e,function(){try{n.changeType(t)}catch(e){throw new ia(ra.MEDIA,ra.SUB_TYPES.MSE_CHANGE_TYPE,e)}n.mimeType=t,r._onSBUpdateEnd(e)},"changeType",{mimeType:t}):Promise.resolve()}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t,r){var n=this;return t&&t.byteLength&&this._sourceBuffer[e]?this._enqueueOp(e,function(){var i,o,s;!n.mediaSource||null!==(i=n.media)&&void 0!==i&&i.error||(n._logger.debug("MSE APPEND START",r),n._opst=sa(),(!n.mediaSource.sourceBuffers||null!==(o=n.mediaSource.sourceBuffers)&&void 0!==o&&o.length)&&(null===(s=n._sourceBuffer[e])||void 0===s||s.appendBuffer(t)))},"appendBuffer",r):Promise.resolve()}},{key:"remove",value:function(e,t,r,n){var i=this,o=!1;return this._mseFullFlag[e]&&(o=!0),this._enqueueOp(e,function(){var o;if(i.mediaSource&&(null===(o=i.media)||void 0===o||!o.error)){var s=i._sourceBuffer[e];t>=r||!s?i._onSBUpdateEnd(e):(i._opst=sa(),i._logger.debug("MSE REMOVE START",e,t,r,n),s.remove(t,r))}},"removeBuffer",n,o)}},{key:"clearBuffer",value:function(e,t){var r,n=this;return Object.keys(this._sourceBuffer).forEach(function(i){r=n.remove(i,e,t)}),r||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var e,t=this;return Object.keys(this._sourceBuffer).forEach(function(r){var n=t._sourceBuffer[r];e=t.remove(r,0,ta.end(ta.get(n)))}),e}},{key:"clearOpQueues",value:function(e,t){var r;this._logger.debug("MSE clearOpQueue START");var n=this._queue[e];if(t&&n)this._queue[e]=[];else if(n&&n[e]&&!(n.length<5)){var i=[];n.forEach(function(e){e.context&&e.context.isinit&&i.push(e)}),this._queue[e]=n.slice(0,2),i.length>0&&(r=this._queue[e]).push.apply(r,i)}}},{key:"endOfStream",value:function(e){var t=this;return this.mediaSource&&"open"===this.mediaSource.readyState?this._enqueueBlockingOp(function(){var r=t.mediaSource;r&&"open"===r.readyState&&(t._logger.debug("MSE endOfStream START"),e?r.endOfStream(e):r.endOfStream())},"endOfStream"):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(e,t){var r=this.mediaSource;e<0||t<e||null==r||!r.setLiveSeekableRange||"open"!==r.readyState||r.setLiveSeekableRange(e,t)}},{key:"getSourceBuffer",value:function(e){return this._sourceBuffer[e]}},{key:"buffered",value:function(e){return ta.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return ta.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return ta.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t,r,n,i){var o=this;if(!this.mediaSource)return Promise.resolve();var s=this._queue[e]=this._queue[e]||[],a={exec:t,promise:oa(),opName:r,context:n};return i?(s.splice(0,0,a),this._mseFullFlag[e]=!1,this._startQueue(e)):s.push(a),this.isOpened||this.isEnded?1===s.length&&this._startQueue(e):this._openPromise.then(function(){1===s.length&&o._startQueue(e)}),a.promise}},{key:"_enqueueBlockingOp",value:(t=Ps(Fs().m(function e(t,r,n){var i,o,s=this;return Fs().w(function(e){for(;;)switch(e.n){case 0:if(this.mediaSource){e.n=1;break}return e.a(2,Promise.resolve());case 1:if((i=Object.keys(this._sourceBuffer)).length){e.n=2;break}return e.a(2,t());case 2:return o=[],i.forEach(function(e){var t=s._queue[e],i=oa();o.push(i),t.push({exec:function(){i.resolve()},promise:i,opName:r,context:n}),1===t.length&&s._startQueue(e)}),e.a(2,Promise.all(o).then(function(){try{return t()}finally{i.forEach(function(e){var t=s._queue[e],r=s._sourceBuffer[e];null==t||t.shift(),r&&r.updating||s._startQueue(e)})}}))}},e,this)})),function(e,r,n){return t.apply(this,arguments)})},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var r=t[0];if(r&&!this._mseFullFlag[e])try{r.exec()}catch(n){n&&n.message&&n.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[e]=!0,r.context&&"object"===qs(r.context)&&(r.context.isFull=!0),this._logger.error("[MSE error],  context,",r.context," ,name,",r.opName,",err,SourceBuffer is full"),r.promise.reject(new ia(ra.MEDIA,ra.SUB_TYPES.MSE_FULL,n))):(this._logger.error(n),r.promise.reject(n.constructor===ia?n:new ia(ra.MEDIA,ra.SUB_TYPES.MSE_OTHER,n)),t.shift(),this._startQueue(e))}}}},{key:"setTimeoffset",value:function(e,t,r){var n=this;return this._enqueueOp(e,function(){t<0&&(t+=.001),n._sourceBuffer[e].timestampOffset=t,n._onSBUpdateEnd(e)},"setTimeoffset",r)}},{key:"abort",value:function(e,t){var r=this;return this.isOpened?this._enqueueOp(e,function(){r._sourceBuffer[e].abort(),r._onSBUpdateEnd(e)},"abort",t):Promise.resolve()}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',t=aa();if(!t)return!1;try{return t.isTypeSupported(e)}catch(t){return this._logger.error(e,t),!1}}},{key:"isMMSOnly",value:function(){return"undefined"!=typeof ManagedMediaSource&&"undefined"==typeof MediaSource}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]);var t,r,n,i}();Ms(ua,"VIDEO","video"),Ms(ua,"AUDIO","audio");const da=function(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}&&!function(){const e="_localstorage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}();da&&localStorage.length;class ha{constructor(){let e,t;const r=new Promise((r,n)=>{e=r,t=n});return r.resolve=e,r.reject=t,r}resolve(e){}reject(e){}}const pa="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IHQ9e30se2hhc093blByb3BlcnR5OmN9PU9iamVjdC5wcm90b3R5cGU7cG9zdE1lc3NhZ2Uoe2V2ZW50OiJyZWFkeSJ9KTtmdW5jdGlvbiBvKHMsYSl7dFtzXT1zZXRUaW1lb3V0KCgpPT57cG9zdE1lc3NhZ2Uoe2RhdGE6e2Zha2VJZDpzfX0pLG8ocyxhKX0sYSl9YWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsZnVuY3Rpb24ocyl7dHJ5e2NvbnN0e2RhdGE6YT17fX09cyx7YWN0aW9uOm4sZmFrZUlkOmUsdGltZTpyfT1hO3N3aXRjaChuKXtjYXNlInNldEludGVydmFsIjpvKGUscik7YnJlYWs7Y2FzZSJjbGVhckludGVydmFsIjpjLmNhbGwodCxlKSYmKGNsZWFyVGltZW91dCh0W2VdKSxkZWxldGUgdFtlXSk7YnJlYWs7Y2FzZSJzZXRUaW1lb3V0Ijp0W2VdPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtwb3N0TWVzc2FnZSh7ZGF0YTp7ZmFrZUlkOmV9fSksYy5jYWxsKHQsZSkmJmRlbGV0ZSB0W2VdfSxyKTticmVhaztjYXNlImNsZWFyVGltZW91dCI6Yy5jYWxsKHQsZSkmJihjbGVhclRpbWVvdXQodFtlXSksZGVsZXRlIHRbZV0pO2JyZWFrO2RlZmF1bHQ6YnJlYWt9fWNhdGNoKGEpe3Bvc3RNZXNzYWdlKHtldmVudDoiZXJyb3IiLGRhdGE6e2Vycm9yOmF9fSl9fSl9KSgpOwo=",fa=typeof self<"u"&&self.Blob&&new Blob([(_a=pa,Uint8Array.from(atob(_a),e=>e.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});var _a;function ya(e){let t;try{if(t=fa&&(self.URL||self.webkitURL).createObjectURL(fa),!t)throw"";const r=new Worker(t,{name:null==e?void 0:e.name});return r.addEventListener("error",()=>{(self.URL||self.webkitURL).revokeObjectURL(t)}),r}catch{return new Worker("data:text/javascript;base64,"+pa,{name:null==e?void 0:e.name})}finally{t&&(self.URL||self.webkitURL).revokeObjectURL(t)}}let ga,ma,va,ba,wa,Ca={},Ea=0;function ka(){do{2147483647===Ea?Ea=0:Ea++}while(Ea in Ca);return Ea}if(typeof Worker<"u"){let e,t=!1,r=!1;const n=()=>{if(!e){const{promise:n,resolve:i,reject:o}=Promise.withResolvers();e=n;try{ga=new ya,ga.addEventListener("message",e=>{const{event:n,data:s}=e.data;switch(n){case"error":r=!0,o(s.error);break;case"ready":t=!0,i();break;default:{const{fakeId:e}=s;if(e in Ca){const{cb:t,param:r,keepAlive:n,type:i}=Ca[e]||{};if("setInterval"!==i&&delete Ca[e],!n&&document.hidden)return;if("function"==typeof t)try{t.apply(window,r)}catch(e){console.error("Error when parse callback function, code %s",e)}}}}}),ga.addEventListener("error",function(e){console.error(e),r=!0,o(e)})}catch(e){r=!0,o(e)}}return e},i=(e,i)=>{r?i&&i():t?e():n().then(e,i)};ma=function(e,t,r=!1,...n){if("function"!=typeof e)throw new Error("cb must be a function");const o=ka();return Ca[o]={cb:e,param:n,keepAlive:!!r,type:"setInterval"},i(()=>{ga.postMessage({action:"setInterval",fakeId:o,time:t})},()=>{o in Ca&&(Ca[o].degradeId=setInterval(e,t))}),o},ba=function(e){if("number"==typeof e&&e in Ca){const{degradeId:t}=Ca[e];delete Ca[e],i(()=>{ga.postMessage({action:"clearInterval",fakeId:e})},()=>{t&&clearInterval(t)})}},va=function(e,t,r=!0,...n){if("function"!=typeof e)throw new Error("cb must be a function");const o=ka();return Ca[o]={cb:e,param:n,keepAlive:!!r,type:"setTimeout"},i(()=>{ga.postMessage({action:"setTimeout",fakeId:o,time:t})},()=>{o in Ca&&(Ca[o].degradeId=setTimeout(e,t))}),o},wa=function(e){if("number"==typeof e&&e in Ca){const{degradeId:t}=Ca[e];delete Ca[e],i(()=>{ga.postMessage({action:"clearTimeout",fakeId:e})},()=>{t&&clearTimeout(t)})}}}else ma=setInterval,va=setTimeout,ba=clearInterval,wa=clearTimeout,console.error("the browser not support web worker, fallback to unWarp function!");Promise.withResolvers||(Promise.withResolvers=function(){const e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e});const Ta="PRELOAD_NEXT",Sa="PRELOAD_SEG_DONE",Oa={PREPARE:"PREPARE",IDLE:"IDLE",PRELOADING:"PRELOADING",FINISH:"FINISH"},Aa="ONE_STEP_DONE",$a={INDEXDB:0,MEMORY:1},Pa={FAIL:-1,SUCCESS:0,DOWNLOADING:1},Ra={MP4:"MP4",DASH:"DASH",HLS:"HLS"},xa=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TYPES:$a,DOWN_STATES:Pa,MEDIA_FORMAT:{DASH:0,MP4:1},MEDIA_TYPES:{VIDEO:0,AUDIO:1,MIXED:2},ONE_STEP_DONE:Aa,PRELOAD_NEXT:Ta,PRELOAD_SEG_DONE:Sa,PRELOAD_TYPES:{DURATION:0,SIZE:1},STATES:Oa,VTYPES:Ra},Symbol.toStringTag,{value:"Module"}));class La extends Sr{constructor(e,t,r,n,i){super(),this.state=Oa.PREPARE,this.options=e||{},this.logger=e.logger||function(){},this._preloadManager=t,this.player=t.player;const{handlers:o,predictInst:s,readyPromise:a}=r;this._predictInst=s,this._handlers=o,this._predictInstReadyPromise=a,this._toLoadList=[],this.retryCount=0,this._cachedHandler=n,this._cachedDataHandler=i,this.cnt=0}start(){const e=new ha;return this._handlers.start(this.options).then(t=>{t.onObtain().then(r=>{this._predictInstReadyPromise.then(()=>{this._predictInst.updateMediaInfos(r);const n=this._predictInst.preloadPredict(this.options),{cachedData:i}=this._predictInst;this._cachedDataHandler(Object.assign({vid:this.options.vid},{data:i}));const o=Object.assign(n,this.options);t.onTransform(o).then(t=>{this._toLoadList=t,e.resolve(t)})})})}).catch(()=>{e.reject(new Error("preload unit start error"))}),e}preloadSeg(){if(0===this._toLoadList.length)return this.state=Oa.FINISH,void this.emit(Sa,!0);this.state="PRELOADING";const e=this._toLoadList.shift();this._handlers.onRequest(e,t=>{const r=Object.assign({},e.extData,t);this._cachedHandler(r)}).then(()=>{this.state=Oa.IDLE,this.emit(Sa)}).catch(()=>{this.requestError(),this.emit(Sa,!1)})}requestError(){this.retryCount++,this.state=Oa.IDLE,this.retryCount>=10&&(this.state=Oa.FINISH),this.emit(Aa),this.logger("preload request error")}cancelLoading(){this._toLoadList=[]}destroy(){this.removeAllListeners()}}const Ia=function(){try{if(typeof indexedDB<"u")return indexedDB}catch{}}();function Ma(e,t){t||(t=()=>{}),t&&e.then(function(e){t(null,e)},function(e){t(e)})}function Da(e){return"string"!=typeof e&&(console.warn(`${e} used as a key, but it is not a string.`),e=String(e)),e}const Ba={},Na="readonly",ja="readwrite";function Ua(e){const t=Ba[e.name],r={};r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function Va(e,t){return new Promise(function(r,n){if(Ba[e.name]=Ba[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);Ua(e),e.db.close()}const i=[e.name];t&&i.push(e.version);const o=null==Ia?void 0:Ia.open.apply(Ia,i);t&&(o.onupgradeneeded=function(t){const r=o.result;try{r.createObjectStore(e.storeName)}catch(t){const r=t;if("ConstraintError"!==r.name)throw t;{const{oldVersion:t,newVersion:n}=r;console.warn(`The database "${e.name}" has been upgraded from version ${t} to\n            version ${n}, but the storage "${e.storeName}" already exists.`)}}}),o.onerror=function(e){e.preventDefault(),n(o.error)},o.onsuccess=function(){r(o.result),function(e){const t=Ba[e.name].deferredOperations.pop();t&&(t.resolve(),t.promise)}(e)}})}function Fa(e){return Va(e,!1)}function Ha(e){return Va(e,!0)}function Ga(e,t){if(!e.db)return!0;const r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,i=e.version>e.db.version;if(n&&(e.version!==t&&console.warn(`The database "${e.name}" can't be downgraded from version ${e.db.version} to\n      version ${e.version}.`),e.version=e.db.version),i||r){if(r){const t=e.db.version+1;t>e.version&&(e.version=t)}return!0}return!1}function Wa(e,t,r,n){var i;void 0===n&&(n=1);try{const n=null==(i=e.db)?void 0:i.transaction(e.storeName,t);r(null,n)}catch(i){const o=i;if(n>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return Promise.resolve().then(()=>{if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),Ha(e)}).then(()=>function(e){Ua(e);const t=Ba[e.name],{forages:r}=t;for(let e=0;e<r.length;e++){const t=r[e];t._dbInfo.db&&(t._dbInfo.db.close(),t._dbInfo.db=null)}return e.db=null,Fa(e).then(t=>(e.db=t,Ga(e)?Ha(e):t)).then(n=>{e.db=t.db=n;for(let e=0;e<r.length;e++)r[e]._dbInfo.db=n}).catch(t=>{throw function(e,t){const r=Ba[e.name].deferredOperations.pop();r&&(r.reject(t),r.promise)}(e,t),t})}(e).then(()=>{Wa(e,t,r,n-1)})).catch(r);r(o)}}class qa{ready(){return this._ready}_initStorage(e){const t=this;t._defaultConfig=e;const r={db:null,name:"",version:"",storeName:""};if(e)for(const t in e)r[t]=e[t];let n=Ba[r.name];n||(n={forages:[],db:null,dbReady:null,deferredOperations:[]},Ba[r.name]=n),n.forages.push(t),t._initReady||(t._initReady=t.ready,t._ready=t._fullyReady);const i=[];function o(){return Promise.resolve()}for(let e=0;e<n.forages.length;e++){const r=n.forages[e];r!==t&&i.push(r._initReady().catch(o))}const s=n.forages.slice(0);return t._ready=Promise.all(i).then(function(){return r.db=n.db,Fa(r)}).then(function(e){return r.db=e,Ga(r,t._defaultConfig.version)?Ha(r):e}).then(function(e){r.db=n.db=e,t._dbInfo=r;for(let e=0;e<s.length;e++){const n=s[e];n!==t&&(n._dbInfo.db=r.db,n._dbInfo.version=r.version)}}),t._ready}get probeSupport(){return function(){try{if(null==Ia||!Ia.open)return!1;const e=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}()}getItem(e,t){const r=this;e=Da(e);const n=new Promise(function(t,n){r.ready().then(function(){Wa(r._dbInfo,Na,function(i,o){if(i)return n(i);const s=o;try{const i=s.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){let e=i.result;void 0===e&&(e=null),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return Ma(n,t),n}setItem(e,t,r){const n=this;e=Da(e);const i=new Promise(function(r,i){n.ready().then(function(){return n._dbInfo,t}).then(function(t){Wa(n._dbInfo,ja,function(o,s){if(o)return i(o);const a=s;try{const o=a.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);const s=o.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),r(t)},a.onabort=a.onerror=function(){var e;const t=s.error?s.error:null==(e=s.transaction)?void 0:e.error;i(t)}}catch(e){i(e)}})}).catch(i)});return Ma(i,r),i}removeItem(e,t){const r=this;e=Da(e);const n=new Promise(function(t,n){r.ready().then(function(){Wa(r._dbInfo,ja,function(i,o){if(i)return n(i);const s=o;try{const i=s.objectStore(r._dbInfo.storeName).delete(e);s.oncomplete=function(){t()},s.onerror=function(){n(i.error)},s.onabort=function(){var e;const t=i.error?i.error:null==(e=i.transaction)?void 0:e.error;n(t)}}catch(e){n(e)}})}).catch(n)});return Ma(n,t),n}clear(e){const t=this,r=new Promise(function(e,r){t.ready().then(function(){Wa(t._dbInfo,ja,function(n,i){if(n)return r(n);const o=i;try{const n=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e;const t=n.error?n.error:null==(e=n.transaction)?void 0:e.error;r(t)}}catch(e){r(e)}})}).catch(r)});return Ma(r,e),r}length(e){const t=this,r=new Promise(function(e,r){t.ready().then(function(){Wa(t._dbInfo,Na,function(n,i){if(n)return r(n);const o=i;try{const n=o.objectStore(t._dbInfo.storeName).count();n.onsuccess=function(){e(n.result)},n.onerror=function(){r(n.error)}}catch(e){r(e)}})}).catch(r)});return Ma(r,e),r}all(e){const t=this,r=new Promise(function(e,r){t.ready().then(function(){Wa(t._dbInfo,Na,function(n,i){if(n)return r(n);const o=i;try{const n=o.objectStore(t._dbInfo.storeName).openCursor(),i=[];n.onsuccess=function(){const t=n.result;t?(i.push({key:t.key,value:t.value}),t.continue()):e(i)},n.onerror=function(){r(n.error)}}catch(e){r(e)}})}).catch(r)});return Ma(r,e),r}_fullyReady(e){const t=this,r=t._initReady().then(function(){const e=Ba[t._dbInfo.name];if(null!=e&&e.dbReady)return e.dbReady});return function(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}(r,e,e),r}}class Ka{constructor(){this.key="",this.store={}}_initStorage(e){const{name:t}=e,{storeName:r}=e,n=`${t}_${r}`;return this.key=n,(!window[n]||"object"!=typeof window[n])&&(window[n]={}),this.store=window[n],Promise.resolve()}getItem(e,t){let r=this.store[e];return void 0===r&&(r=null),this._internalPromise(t,r)}setItem(e,t,r){return this.store[e]=t,this._internalPromise(r)}removeItem(e,t){return delete this.store[e],this._internalPromise(t)}clear(e){return this.store={},window[this.key]={},this._internalPromise(e)}length(e){const t=Object.keys(this.store).length;return this._internalPromise(e,t)}_internalPromise(e,t){const r=t?Promise.resolve(t):Promise.resolve();return Ma(r,e),r}all(e){const t=[],r=Object.keys(this.store);for(let e=0;e<r.length;e++){const n=r[e];t.push({key:n,value:this.store[n]})}return this._internalPromise(e,t)}probeSupport(){return!0}}const za={description:"",name:"__PRE_CACHE__",storeName:"keyvaluepairs",version:1},Za="__PRE_CACHE__KEYS";class Ya{constructor(e,t){const r=t===$a.MEMORY?Ka:qa;this._driver=new r,this._driver._initStorage(za).catch(()=>{}),this._hasIdbForbidden=!1,this._maxCache=!e||e<=0?200:e,this.setMaxCache(this._maxCache),this._allCachedKeys={},this._allCachedTimeKeys={},this.getCachedKeysFromLocal(),this._readyPromise=new ha,this.init()}getCachedKeysFromLocal(){const e=(e=>{try{return localStorage.getItem(e)}catch{return null}})(Za);if(e){const t=e.split("|");for(let e=0;e<t.length;e++){const r=t[e],{time:n,cachedKey:i}=this._getCacheKeyInfos(r);this._allCachedKeys[i]=1,this._allCachedTimeKeys[i]=n}}}_getCacheKeyInfos(e){const t=e.split("$");let r;return 2===t.length&&(r=t[0],e=t[1]),{time:r,cachedKey:e}}writeCachedKeysToLocal(e){const t=[];this._allCachedKeys={},this._allCachedTimeKeys={};for(let r=0;r<e.length;r++){const n=e[r].key,{time:i,cachedKey:o}=this._getCacheKeyInfos(n);this._allCachedKeys[o]=1,this._allCachedTimeKeys[o]=i,t.push(n)}const r=t.join("|");((e,t)=>{try{localStorage.setItem(e,t)}catch{}})(Za,r)}init(){this._driver.setItem("test","test").then(()=>{}).catch(()=>{this._hasIdbForbidden=!0}).finally(()=>{this._driver.removeItem("test").catch(()=>{}),this._hasIdbForbidden&&(this._driver=new Ka,this._driver._initStorage(za)),this._getAll(),this._readyPromise.resolve()})}_getAll(){this._driver.all().then(e=>{const t=e.length-this._maxCache;let r=e;if(t>0){const n=e.slice(0,t);r=e.slice(t);for(let e=0;e<n.length;e++)this.removeItem(n[e].key).then(()=>{})}this.writeCachedKeysToLocal(r)}).catch(()=>{})}getItem(e,t){if(!this.hasItem(e))return Promise.resolve(!1);const{timeKey:r}=this._getTimeKey(e);return this._driver.getItem(r,t)}setItem(e,t,r){const{timeKey:n}=this._getTimeKey(e);n&&this.removeItem(e);const i=(new Date).getTime();this._allCachedKeys[e]=1,this._allCachedTimeKeys[e]=i;const o=this._genTimeKey(e,i);return r=r?()=>{this._getAll(),r()}:()=>{this._getAll()},this._driver.setItem(o,t,r)}_getTimeKey(e){const t=this._allCachedTimeKeys[e];let r=e;return t&&(r=this._genTimeKey(e,t)),{timeKey:r,time:t}}_genTimeKey(e,t){return`${t}$${e}`}removeItem(e,t){const{timeKey:r}=this._getTimeKey(e),n=this._driver.removeItem(r,t);return delete this._allCachedKeys[e],delete this._allCachedTimeKeys[e],n}hasItem(e){return!!this._allCachedKeys[e]}clear(e){return this._driver.clear(e)}length(e){return this._driver.length(e)}setMaxCache(e){"number"==typeof e&&e>0&&(this._maxCache=e)}}const Xa=class e extends Sr{constructor(e,t,r=null){super(),this._preloadDataList=[],this._currentPreloadInst=null,this.autoPreload=e.autoPreload||!1,this._autoCheck=e.autoCheck||{enable:!1,interval:1e3},this._onPreloadNext=this.onPreloadNextReady.bind(this),this.on(Ta,this._onPreloadNext),this._preloaderConfigs={},this.update(e,t,r),this._cacheInst=new Ya(e.preloadMaxCacheCount,e.preloadCacheType||0),this._preloadCacheProgress={},this._ptag_=!0,this._cachedDatas={},this._taskIntervalId=null}setMaxCache(e){var t;null==(t=this._cacheInst)||t.setMaxCache(e)}startCheckTask(){const{_autoCheck:e,_preloadDataList:t}=this;this._taskIntervalId&&(window.clearTimeout(this._taskIntervalId),this._taskIntervalId=null),0!==t.length&&(this._checkIfCanPreload()&&this.onPreloadNext(),this._taskIntervalId=window.setTimeout(()=>{this.startCheckTask()},e.interval||1e3))}stopCheckTask(){this._taskIntervalId&&(window.clearTimeout(this._taskIntervalId),this._taskIntervalId=null)}_checkIfCanPreload(){if(null==this._currentPreloadInst&&this._preloadDataList.length>0){const e=this._preloadDataList[0].data;if(e.payload){const t=this._getPreloaderKey(e),r=this._preloaderConfigs[t];if(null!=r&&r.handlers){const{checkIfCanPreload:t}=r.handlers;return t?t(e):(this.stopCheckTask(),!1)}return console.warn("need to set vtype, no preloader",e),this.stopCheckTask(),!1}}return!1}_getPreloaderKey(e){return e.vtype?e.vtype:"DEFAULT"}update(e,t,r){if(!r)throw new Error("PreloaderManager predictInst is null");const n=this._getPreloaderKey(e);this._preloaderConfigs[n]={predictInst:r,readyPromise:r.init(e),handlers:t}}get cachedDatas(){return this._cachedDatas}onCacheSegment(e){const{vid:t,format:r,cacheKey:n,total:i,loaded:o,isInitSegment:s,mediaType:a}=e,l=this.getProgressCacheKey(t,r,a);let c=this._preloadCacheProgress[l];c||(c=this._preloadCacheProgress[l]={}),c[n]={total:i,loaded:o,isInitSegment:s}}onCachePredict(e){const{vid:t,data:r}=e;t&&r&&(this._cachedDatas[t]=r)}getProgressCacheKey(e,t,r){return`${e}-${t}-${r}`}onPreloadNextReady(){this.onPreloadNext()}onPreloadSegDone(){this.autoPreload&&this.emit(Ta)}onPreloadNext(){if(null==this._currentPreloadInst&&this._preloadDataList.length>0){if(this._preloadDataList.length>0){const e=this._preloadDataList.shift(),t=null==e?void 0:e.data;if(null!=t&&t.payload){const e=this._getPreloaderKey(t),r=this._preloaderConfigs[e];if(!r)return void console.warn("need to set vtype, no preloader",t);this._currentPreloadInst=new La(t,this,r,e=>{this.onCacheSegment(e)},e=>{this.onCachePredict(e)}),this._currentPreloadInst.on(Sa,this.onPreloadSegDone.bind(this)),this._currentPreloadInst.start().then(()=>{this._currentPreloadInst.preloadSeg()}).catch(()=>{this._currentPreloadInst=null})}}}else null!=this._currentPreloadInst&&(this._currentPreloadInst.state===Oa.IDLE?this._currentPreloadInst.preloadSeg():this._currentPreloadInst.state===Oa.FINISH?(this._currentPreloadInst.destroy(),this._currentPreloadInst=null):this._currentPreloadInst.state===Oa.PREPARE&&(this._currentPreloadInst.cnt++,this._currentPreloadInst.cnt>2&&(this._currentPreloadInst.destroy(),this._currentPreloadInst=null)))}addDashPreloader(e){e.data&&(this._preloadDataList.push(e),this.sort(this._preloadDataList),this.autoPreload&&this.emit(Ta),this._autoCheck.enable&&!this._taskIntervalId&&this.startCheckTask())}_addDashPreloader(e){e.data&&this._preloadDataList.push(e)}addDashPreloaderList(e=[]){this.sort(e);for(let t=0;t<e.length;t++)this._addDashPreloader(e[t]);this._autoCheck.enable&&!this._taskIntervalId&&this.startCheckTask()}sort(e){e.sort((e,t)=>void 0===e.order&&void 0===e.order||"number"==typeof e.order&&"number"==typeof t.order&&e.order<t.order?-1:1)}destroy(){this.off(Ta,this._onPreloadNext)}cancelLoading(){this._currentPreloadInst&&(this._currentPreloadInst.cancelLoading(),this._currentPreloadInst=null),this._preloadDataList=[]}static getInstance(t,r,n=null){const i=e.GLOBAL_KEY+(t.globalKey?t.globalKey:""),o=window[i];if(null!=o&&o._ptag_)return o.update(t,r,n),o;const s=new e(t,r,n);return window[i]=s,s}preloadCacheProgress(e){const{vid:t,format:r,mediaType:n,prelaodType:i,bitrate:o,set_duration:s,set_size:a,media_type:l,start_time:c}=e,u=this.getProgressCacheKey(t,r,n),d=this._preloadCacheProgress[u];if(d){const e=Object.values(d);let t=0,r=0,n=0,u=0,h=0;for(let i=0;i<e.length;i++){const o=e[i];o.isInitSegment&&(t=o.total,n=o.loaded,u=o.loaded===o.total?Pa.SUCCESS:Pa.DOWNLOADING),r+=o.total,h+=o.loaded}return{media_type:l,preload_type:i,stream_bitrate:o,header_size:t,content_total_size:r,start_time:c||-1,state_info:{set_duration:s,set_size:a,current_header_download_size:n,current_content_download_size:h,header_download_state:u,content_download_state:h===r?Pa.SUCCESS:Pa.DOWNLOADING}}}return null}getPreloadTaskInfos(){}getItem(e,t){return this._cacheInst.getItem(e,t)}setItem(e,t,r){return this._cacheInst.setItem(e,t,r)}removeItem(e,t){return this._cacheInst.removeItem(e,t)}};Xa.GLOBAL_KEY="__preloadcontext__";let Qa=Xa;class Ja extends Sr{constructor(e){super(),this.options=e,this.promisePolyfill(),this.before(),this.check(),this._preloadManager=Qa.getInstance(e,this.handlers,this.predictInst),this.loadingTasks=[]}promisePolyfill(){Promise.prototype.finally||(Promise.prototype.finally={finally(e){const t=t=>Promise.resolve(e()).then(t);return this.then(e=>t(()=>e),e=>t(()=>Promise.reject(e)))}}.finally)}before(){throw new Error("need")}check(){if(!this.handlers)throw new Error("handlers null");if(!this.handlers.start||!this.handlers.onRequest)throw new Error("handlers callback null");if(!this.predictInst)throw new Error("predictInst null");if(!this.predictInst.__p__)throw new Error("predictInst need extends predictbase")}preloadNext(){this._preloadManager.emit(Ta)}get preloadManager(){return this._preloadManager}start(){throw new Error("start need implment, return Promise")}cancelLoading(){for(let e=0;e<this.loadingTasks.length;e++)try{const t=this.loadingTasks[e];"function"==typeof t.cancel&&t.cancel()}catch{}this.loadingTasks=[],this._preloadManager.cancelLoading()}addTasker(e){this.loadingTasks.push(e)}removeTasker(e){setTimeout(()=>{for(let t=this.loadingTasks.length-1;t>-1;t--)if(this.loadingTasks[t]===e){this.loadingTasks.splice(t,1);break}})}addDashPreloader(e){this._preloadManager.addDashPreloader(e)}addDashPreloaderList(e=[]){this._preloadManager.addDashPreloaderList(e)}}class el{constructor(){this.bandwidth2item={},this._mediaInfos=void 0,this.__p__=!0}init(){throw new Error("init func not implement, return promise")}preloadPredict(e){throw new Error(`preloadPredict error: ${e}`)}updateMediaInfos(e){if(this._mediaInfos=e,this.bandwidth2item={},this.dynamic_video=e.dynamic_video_list,this.dynamic_video.length>0)for(let e=0;e<this.dynamic_video.length;e++){const t=this.dynamic_video[e],r=(null==t?void 0:t.bitrate)||(null==t?void 0:t.bandwidth);this.bandwidth2item[r]=t}}getIdx(e,t){let r=0;return e.forEach((e,n)=>{e.definition===t&&(r=n)}),r}get cachedData(){return null}}const tl=Ra;var rl=r(23722);function nl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function il(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function ol(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){il(o,n,i,s,a,"next",e)}function a(e){il(o,n,i,s,a,"throw",e)}s(void 0)})}}function sl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function al(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bl(n.key),n)}}function ll(e,t,r){return t&&al(e.prototype,t),r&&al(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cl(e,t,r){return(t=bl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ul(e){return(ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(dl=function(){return!!e})()}function hl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function pl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hl(Object(r),!0).forEach(function(t){cl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function fl(e){throw new TypeError('"'+e+'" is read-only')}function _l(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function o(r,n,i,o){var l=n&&n.prototype instanceof a?n:a,c=Object.create(l.prototype);return yl(c,"_invoke",function(r,n,i){var o,a,l,c=0,u=i||[],d=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return o=t,a=0,l=e,h.n=r,s}};function p(r,n){for(a=r,l=n,t=0;!d&&c&&!i&&t<u.length;t++){var i,o=u[t],p=h.p,f=o[2];r>3?(i=f===n)&&(l=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=e):o[0]<=p&&((i=r<2&&p<o[1])?(a=0,h.v=n,h.n=o[1]):p<f&&(i=r<3||o[0]>n||n>f)&&(o[4]=r,o[5]=n,h.n=f,a=0))}if(i||r>1)return s;throw d=!0,n}return function(i,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,f),a=u,l=f;(t=a<2?e:l)||!d;){o||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,o){if(a||(i="next"),t=o[i]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=o.return)&&t.call(o),a<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),a=1);o=e}else if((t=(d=h.n<0)?l:r.call(n,h))!==s)break}catch(t){o=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(r,i,o),!0),c}var s={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(yl(t={},n,function(){return this}),t),d=c.prototype=a.prototype=Object.create(u);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,yl(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,yl(d,"constructor",c),yl(c,"constructor",l),l.displayName="GeneratorFunction",yl(c,i,"GeneratorFunction"),yl(d),yl(d,i,"Generator"),yl(d,n,function(){return this}),yl(d,"toString",function(){return"[object Generator]"}),(_l=function(){return{w:o,m:h}})()}function yl(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}(yl=function(e,t,r,n){if(t)i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r;else{let t=function(t,r){yl(e,t,function(e){return this._invoke(t,r,e)})};t("next",0),t("throw",1),t("return",2)}})(e,t,r,n)}function gl(e,t){return(gl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ml(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||wl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vl(e){return function(e){if(Array.isArray(e))return nl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||wl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bl(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function wl(e,t){if(e){if("string"==typeof e)return nl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nl(e,t):void 0}}var Cl="fetch",El="arraybuffer",kl="text",Tl=function(e){function t(e,r,n,i){var o;return xs(this,t),Ms(o=Rs(this,t,[i]),"retryCount",0),Ms(o,"isTimeout",!1),Ms(o,"loaderType",Cl),Ms(o,"startTime",0),Ms(o,"endTime",0),Ms(o,"options",{}),o.url=e,o.request=r,o.response=n,o}return Ns(t,e),Is(t)}(Ks(Error)),Sl=Object.prototype.toString;function Ol(e){if("[object Object]"!==Sl.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function Al(e){if(e&&null!==e[0]&&void 0!==e[0]&&(0!==e[0]||null!==e[1]&&void 0!==e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function $l(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Pl(e,t){if(e){if(!t)return e;var r,n=Object.keys(t).map(function(e){if(null!=(r=t[e]))return Array.isArray(r)?e+="[]":r=[r],r.map(function(t){return function(e){return"[object Date]"===Sl.call(e)}(t)?t=t.toISOString():function(e){return null!==e&&"object"===qs(e)}(t)&&(t=JSON.stringify(t)),"".concat($l(e),"=").concat($l(t))}).join("&")}).filter(Boolean).join("&");if(n){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}}function Rl(e,t,r,n,i,o,s,a,l,c,u){return i=null!=i?parseFloat(i):null,n=parseInt(n||"0",10),Number.isNaN(n)&&(n=0),{data:e,done:t,options:{range:l,vid:c,index:a,contentLength:n,age:i,startTime:o,firstByteTime:s,endTime:Date.now(),priOptions:u},response:r}}function xl(e,t){return Math.round(8*e*1e3/t/1024)}var Ll="real_time_speed",Il=2097152,Ml=function(e){function t(){var e;return xs(this,t),Ms(e=Rs(this,t),"_abortController",null),Ms(e,"_timeoutTimer",null),Ms(e,"_reader",null),Ms(e,"_response",null),Ms(e,"_aborted",!1),Ms(e,"_index",-1),Ms(e,"_range",null),Ms(e,"_receivedLength",0),Ms(e,"_running",!1),Ms(e,"_logger",null),Ms(e,"_vid",""),Ms(e,"_onProcessMinLen",0),Ms(e,"_onCancel",null),Ms(e,"_priOptions",null),Ms(e,"_processMaxGapTime",1/0),e}return Ns(t,e),Is(t,[{key:"load",value:function(e){var t,r=this,n=e.url,i=e.vid,o=e.timeout,s=e.responseType,a=e.onProgress,l=e.index,c=e.onTimeout,u=e.onCancel,d=e.range,h=e.transformResponse,p=e.request,f=e.params,_=e.logger,y=e.method,g=e.headers,m=e.body,v=e.mode,b=e.credentials,w=e.cache,C=e.redirect,E=e.referrer,k=e.referrerPolicy,T=e.onProcessMinLen,S=e.processMaxGapTime,O=e.priOptions;this._logger=_,this._aborted=!1,this._onProcessMinLen=T,this._onCancel=u,this._abortController="undefined"!=typeof AbortController&&new AbortController,this._running=!0,this._receivedLength=0,this._index=l,this._range=d||[0,0],this._vid=i||n,this._priOptions=O||{},this._processMaxGapTime=S;var A={method:y,headers:g,body:m,mode:v,credentials:b,cache:w,redirect:C,referrer:E,referrerPolicy:k,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal},$=!1;clearTimeout(this._timeoutTimer),n=Pl(n,f);var P=Al(d);P&&(g=p?p.headers:A.headers=A.headers||(Headers?new Headers:{}),Headers&&g instanceof Headers?g.append("Range",P):g.Range=P),o&&(this._timeoutTimer=setTimeout(Ps(Fs().m(function e(){var t;return Fs().w(function(e){for(;;)switch(e.n){case 0:return $=!0,e.n=1,r.cancel();case 1:c&&((t=new Tl(n,A,null,"timeout")).isTimeout=!0,c(t,{index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions}));case 2:return e.a(2)}},e)})),o));var R=Date.now();return this._logger.debug("[fetch load start], index,",l,",range,",d),new Promise(function(e,t){fetch(p||n,p?void 0:A).then(function(){var i=Ps(Fs().m(function i(o){var c,u,p,f;return Fs().w(function(i){for(;;)switch(i.n){case 0:if(clearTimeout(r._timeoutTimer),r._response=o,!r._aborted&&r._running){i.n=1;break}return i.a(2);case 1:if(h&&(o=h(o,n)||o),o.ok){i.n=2;break}throw new Tl(n,A,o,"bad network response");case 2:if(c=Date.now(),s!==kl){i.n=4;break}return i.n=3,o.text();case 3:u=i.v,r._running=!1,i.n=9;break;case 4:if("json"!==s){i.n=6;break}return i.n=5,o.json();case 5:u=i.v,r._running=!1,i.n=9;break;case 6:if(!a){i.n=7;break}return r.resolve=e,r.reject=t,r._loadChunk(o,a,R,c),i.a(2);case 7:return i.n=8,o.arrayBuffer();case 8:u=i.v,u=new Uint8Array(u),r._running=!1,p=Date.now()-R,f=xl(u.byteLength,p),r.emit(Ll,{speed:f,len:u.byteLength,time:p,vid:r._vid,index:r._index,range:r._range,priOptions:r._priOptions});case 9:r._logger.debug("[fetch load end], index,",l,",range,",d),e(Rl(u,!0,o,o.headers.get("Content-Length"),o.headers.get("age"),R,c,l,d,r._vid,r._priOptions));case 10:return i.a(2)}},i)}));return function(e){return i.apply(this,arguments)}}()).catch(function(e){var i;clearTimeout(r._timeoutTimer),r._running=!1,r._aborted&&!$||((e=e instanceof Tl?e:new Tl(n,A,null,null===(i=e)||void 0===i?void 0:i.message)).startTime=R,e.endTime=Date.now(),e.isTimeout=$,e.options={index:r._index,range:r._range,vid:r._vid,priOptions:r._priOptions},t(e))})})}},{key:"cancel",value:(r=Ps(Fs().m(function e(){return Fs().w(function(e){for(;;)switch(e.n){case 0:if(!this._aborted){e.n=1;break}return e.a(2);case 1:if(this._aborted=!0,this._running=!1,!this._response){e.n=6;break}if(e.p=2,!this._reader){e.n=3;break}return e.n=3,this._reader.cancel();case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:this._response=this._reader=null;case 6:if(this._abortController){try{this._abortController.abort()}catch(e){}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 7:return e.a(2)}},e,this,[[2,4]])})),function(){return r.apply(this,arguments)})},{key:"_loadChunk",value:function(e,t,r,n){var i=this;if(!e.body||!e.body.getReader){this._running=!1;var o=new Tl(e.url,"",e,"onProgress of bad response.body.getReader");return o.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},void this.reject(o)}this._onProcessMinLen>0&&(this._cache=new Uint8Array(Il),this._writeIdx=0);var s,a,l,c=this._reader=e.body.getReader(),u=Date.now(),d=function(){var o=Ps(Fs().m(function o(){var h,p,f,_,y,g,m,v,b,w;return Fs().w(function(o){for(;;)switch(o.n){case 0:return a=Date.now(),o.p=1,o.n=2,c.read();case 2:s=o.v,l=Date.now(),o.n=4;break;case 3:return o.p=3,w=o.v,l=Date.now(),i._aborted||(i._running=!1,w.options={index:i._index,range:i._range,vid:i._vid,priOptions:i._priOptions},i.reject(w)),o.a(2);case 4:if(p=(null===(h=i._range)||void 0===h?void 0:h.length)>0?i._range[0]:0,f=p+i._receivedLength,!i._aborted){o.n=5;break}return i._running=!1,t(void 0,!1,{range:[f,f],vid:i._vid,index:i._index,startTime:a,endTime:l,st:r,firstByteTime:n,priOptions:i._priOptions},e),o.a(2);case 5:if(_=s.value?s.value.byteLength:0,i._receivedLength+=_,i._onProcessMinLen>0?i._writeIdx+_>=i._onProcessMinLen||s.done?((y=new Uint8Array(i._writeIdx+_)).set(i._cache.subarray(0,i._writeIdx),0),_>0&&y.set(s.value,i._writeIdx),i._writeIdx=0,i._logger.debug("【fetchLoader,onProgress enough】,done,",s.done,",len,",y.byteLength,", writeIdx,",i._writeIdx)):_>0&&i._writeIdx+_<Il?(i._cache.set(s.value,i._writeIdx),i._writeIdx+=_,i._logger.debug("【fetchLoader,onProgress cache】,len,",_,", writeIdx,",i._writeIdx)):_>0&&(g=new Uint8Array(i._writeIdx+_+2048),i._logger.debug("【fetchLoader,onProgress extra start】,size,",i._writeIdx+_+2048,", datalen,",_,", writeIdx,",i._writeIdx),g.set(i._cache.subarray(0,i._writeIdx),0),_>0&&g.set(s.value,i._writeIdx),i._writeIdx+=_,delete i._cache,i._cache=g,i._logger.debug("【fetchLoader,onProgress extra end】,len,",_,", writeIdx,",i._writeIdx)):y=s.value,!(y&&y.byteLength>0||s.done)){o.n=6;break}i._logger.debug("【fetchLoader,onProgress call】,task,",i._range,", start,",f,", end,",p+i._receivedLength,", done,",s.done,r),t(y,s.done,{range:[i._range[0]+i._receivedLength-(y?y.byteLength:0),i._range[0]+i._receivedLength],vid:i._vid,index:i._index,startTime:a,endTime:l,st:r,firstByteTime:n,priOptions:i._priOptions},e),u=Date.now(),o.n=8;break;case 6:if(!(Date.now()-u>=i._processMaxGapTime)){o.n=8;break}return i._logger.debug("[onProgress timeout],task: ".concat(JSON.stringify(i._range)," done: ").concat(s.done," processMaxGapTime: ").concat(i._processMaxGapTime)),(m=new Tl(e.url,null,e,"process timeout")).options={index:i._index,range:i._range,vid:i._vid,priOptions:i._priOptions},i.running=!1,o.n=7,i.cancel();case 7:return i.reject(m),o.a(2);case 8:s.done?(v=Date.now()-r,b=xl(i._receivedLength,v),i.emit(Ll,{speed:b,len:i._receivedLength,time:v,vid:i._vid,index:i._index,range:i._range,priOptions:i._priOptions}),i._running=!1,i._logger.debug("[fetchLoader onProgress end],task,",i._range,",done,",s.done),i.resolve(Rl(s,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),r,n,i._index,i._range,i._vid,i._priOptions))):d();case 9:return o.a(2)}},o,null,[[1,3]])}));return function(){return o.apply(this,arguments)}}();d()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return!("undefined"==typeof fetch)}}]);var r}(Or()),Dl=function(e){function t(){var e;return xs(this,t),Ms(e=Rs(this,t),"_xhr",null),Ms(e,"_aborted",!1),Ms(e,"_timeoutTimer",null),Ms(e,"_range",null),Ms(e,"_receivedLength",0),Ms(e,"_url",null),Ms(e,"_onProgress",null),Ms(e,"_index",-1),Ms(e,"_headers",null),Ms(e,"_currentChunkSizeKB",384),Ms(e,"_timeout",null),Ms(e,"_xhr",null),Ms(e,"_withCredentials",null),Ms(e,"_startTime",-1),Ms(e,"_loadCompleteResolve",null),Ms(e,"_loadCompleteReject",null),Ms(e,"_runing",!1),Ms(e,"_logger",!1),Ms(e,"_vid",""),Ms(e,"_responseType",void 0),Ms(e,"_credentials",void 0),Ms(e,"_method",void 0),Ms(e,"_transformResponse",void 0),Ms(e,"_firstRtt",void 0),Ms(e,"_onCancel",null),Ms(e,"_priOptions",null),e}return Ns(t,e),Is(t,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials="include"===e.credentials||"same-origin"===e.credentials,this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=Pl(e.url,e.params);var r=Date.now();return new Promise(function(e,r){t._loadCompleteResolve=e,t._loadCompleteReject=r,t._startLoad()}).catch(function(e){if(clearTimeout(t._timeoutTimer),t._runing=!1,!t._aborted)throw(e=e instanceof Tl?e:new Tl(t._url,t._request)).startTime=r,e.endTime=Date.now(),e.options={index:t._index,vid:t._vid,priOptions:t._priOptions},e})}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===El&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var t=1024*this._currentChunkSizeKB,r=this._range[0]+this._receivedLength,n=this._range[1];t<this._range[1]-r&&(n=r+t),e=[r,n],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var t=this;try{this._startTime=Date.now();var r=this._xhr=new XMLHttpRequest;r.open(this._method||"GET",this._url,!0),r.responseType=this._responseType,this._timeout&&(r.timeout=this._timeout),r.withCredentials=this._withCredentials,r.onload=this._onLoad.bind(this),r.onreadystatechange=this._onReadyStatechange.bind(this),r.onerror=function(e){var r,n,i;t._running=!1;var o=new Tl(t._url,t._request,null==e||null===(r=e.currentTarget)||void 0===r?void 0:r.response,"xhr.onerror.status:"+(null==e||null===(n=e.currentTarget)||void 0===n?void 0:n.status)+",statusText,"+(null==e||null===(i=e.currentTarget)||void 0===i?void 0:i.statusText));o.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(o)},r.ontimeout=function(e){t.cancel();var r=new Tl(t._url,t._request,{status:408},"timeout");t._onTimeout&&(r.isTimeout=!0,t._onTimeout(r,{index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions})),r.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(r)};var n=this._headers||{},i=Al(e);i&&(n.Range=i),n&&Object.keys(n).forEach(function(e){r.setRequestHeader(e,n[e])}),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),r.send(this._body)}catch(t){t.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(t)}}},{key:"_onReadyStatechange",value:function(e){2===e.target.readyState&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var t,r=e.target.status;if(r<200||r>299){var n=new Tl(this._url,null,Vs(Vs({},e.target.response),{},{status:r}),"bad response,status:"+r);return n.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(n)}var i,o=null,s=!1,a=(null===(t=this._range)||void 0===t?void 0:t.length)>0?this._range[0]:0;if(this._responseType===El){var l,c=new Uint8Array(e.target.response);if(i=a+this._receivedLength,c&&c.byteLength>0){this._receivedLength+=c.byteLength;var u=Date.now()-this._startTime,d=xl(this._receivedLength,u);this.emit(Ll,{speed:d,len:this._receivedLength,time:u,vid:this._vid,index:this._index,range:[i,a+this._receivedLength],priOptions:this._priOptions})}o=c,s=!((null===(l=this._range)||void 0===l?void 0:l.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]),this._logger.debug("[xhr load done->], tast :",this._range,", start",i,"end ",a+this._receivedLength,",dataLen,",c?c.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",s)}else s=!0,o=e.target.response;var h={ok:r>=200&&r<300,status:r,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(h=this._transformResponse(h,this._url)||h),this._onProgress&&this._onProgress(o,s,{index:this._index,vid:this._vid,range:[i,a+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},h),s?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(Rl(this._onProgress?null:o,s,h,h.headers["content-length"],h.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted)return this._aborted=!0,this._runing=!1,function(e,t,r){var n=Ds(Bs(e.prototype),"removeAllListeners",r);return"function"==typeof n?function(e){return n.apply(r,e)}:n}(t,0,this)([]),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr?this._xhr.abort():void 0}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var t,r={},n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return As(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?As(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(e.getAllResponseHeaders().trim().split("\r\n"));try{for(n.s();!(t=n.n()).done;){var i=t.value.split(": ");r[i[0].toLowerCase()]=i.slice(1).join(": ")}}catch(e){n.e(e)}finally{n.f()}return r}}],[{key:"isSupported",value:function(){return"undefined"!=typeof XMLHttpRequest}}])}(Or()),Bl=["retry","retryDelay","onRetryError","transformError"],Nl=function(){return Is(function e(t,r){xs(this,e),this.promise=oa(),this.alive=!!r.onProgress,!r.logger&&(r.logger=new Ys("Loader")),this._loaderType=t,this._loader=t===Cl&&"undefined"!=typeof fetch?new Ml:new Dl,this._config=r,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=r.retryCheckFunc,this._logger=r.logger},[{key:"exec",value:function(){var e=this,t=this._config,r=t.retry,n=t.retryDelay,i=t.onRetryError,o=t.transformError,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(t,Bl),a=function(){var t=Ps(Fs().m(function t(){var l,c,u,d;return Fs().w(function(t){for(;;)switch(t.n){case 0:return t.p=0,t.n=1,e._loader.load(s);case 1:l=t.v,e.promise.resolve(l),t.n=5;break;case 2:if(t.p=2,d=t.v,e._loader.running=!1,e._logger.debug("[task request catch err]",d),!e._canceled){t.n=3;break}return t.a(2);case 3:if(d.loaderType=e._loaderType,d.retryCount=e._retryCount,c=d,o&&(c=o(c)||c),i&&e._retryCount>0&&i(c,e._retryCount,{index:s.index,vid:s.vid,range:s.range,priOptions:s.priOptions}),e._retryCount++,u=!0,e._retryCheckFunc&&(u=e._retryCheckFunc(d)),!(u&&e._retryCount<=r)){t.n=4;break}return clearTimeout(e._retryTimer),e._logger.debug("[task request setTimeout],retry",e._retryCount,",retry range,",s.range),e._retryTimer=setTimeout(a,n),t.a(2);case 4:e.promise.reject(c);case 5:return t.a(2)}},t,null,[[0,2]])}));return function(){return t.apply(this,arguments)}}();return a(),this.promise}},{key:"cancel",value:(e=Ps(Fs().m(function e(){return Fs().w(function(e){for(;;)if(0===e.n)return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,e.a(2,this._loader.cancel())},e,this)})),function(){return e.apply(this,arguments)})},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]);var e}();function jl(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if((t=t.filter(Boolean)).length<2)return t[0];var n=t.reduce(function(e,t){return e+t.byteLength},0),i=Ul(n),o=0;return t.forEach(function(e){i.set(e,o),o+=e.byteLength}),i}function Ul(e){for(var t,r=0;r<10;)try{if((t=new Uint8Array(e))&&t.byteLength>0)break;r++}catch(e){if(!(r<10))throw new Error("new array failed final,".concat(null==e?void 0:e.message));r++}return t}function Vl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){return setTimeout(t,e)})}var Fl=function(e){function t(e){var r;return xs(this,t),Ms(r=Rs(this,t,[e]),"type",Cl),Ms(r,"_queue",[]),Ms(r,"_alive",[]),Ms(r,"_currentTask",null),Ms(r,"_finnalUrl",""),Ms(r,"_config",void 0),r._config=function(e){return Vs({loaderType:Cl,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:kl,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0,processMaxGapTime:1/0},e)}(e),"xhr"!==r._config.loaderType&&Ml.isSupported()||(r.type="xhr"),r.log=e.logger,r}return Ns(t,e),Is(t,[{key:"isFetch",value:function(){return this.type===Cl}},{key:"load",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?r=e:r.url=e||r.url||this._config.url,(r=Object.assign({},this._config,r)).params&&(r.params=Object.assign({},r.params)),r.headers&&Ol(r.headers)&&(r.headers=Object.assign({},r.headers)),r.body&&Ol(r.body)&&(r.body=Object.assign({},r.body)),r.transformRequest&&(r=r.transformRequest(r)||r),r.logger=this.log;var n=new Nl(this.type,r);return n.loader.on(Ll,function(e){t.emit(Ll,e)}),this._queue.push(n),1!==this._queue.length||this._currentTask&&this._currentTask.running||this._processTask(),n.promise}},{key:"cancel",value:(r=Ps(Fs().m(function e(){var t;return Fs().w(function(e){for(;;)switch(e.n){case 0:return t=this._queue.map(function(e){return e.cancel()}).concat(this._alive.map(function(e){return e.cancel()})),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.n=1,Promise.all(t);case 1:return e.n=2,Vl();case 2:return e.a(2)}},e,this)})),function(){return r.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var t=this._currentTask.exec().catch(function(e){});t&&"function"==typeof t.finally&&t.finally(function(){var t,r;null!==(t=e._currentTask)&&void 0!==t&&t.alive&&(null===(r=e._alive)||void 0===r?void 0:r.length)>0&&(e._alive=e._alive.filter(function(t){return t&&t!==e._currentTask})),e._processTask()})}}}],[{key:"isFetchSupport",value:function(){return Ml.isSupported()}}]);var r}(Or());function Hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Gl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zl(n.key),n)}}function ql(e,t,r){return t&&Wl(e.prototype,t),r&&Wl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kl(e,t,r){return(t=Zl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zl(e){return function(e){if(Array.isArray(e))return Hl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Yl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zl(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function Yl(e,t){if(e){if("string"==typeof e)return Hl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hl(e,t):void 0}}function Xl(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t=t.filter(Boolean);var n=new Uint8Array(t.reduce(function(e,t){return e+t.byteLength},0)),i=0;return t.forEach(function(e){n.set(e,i),i+=e.byteLength}),n}var Ql=Math.pow(2,32);function Jl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<8)+(e[t+1]||0)}function ec(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]||0)}function tc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt32(t)}function rc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ec(e,t)*Ql+ec(e,t+4)}function nc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getUint32(t)<<32|r.getUint32(t+4)}function ic(e){if(!Array.isArray(e)){for(var t=[],r="",n=0;n<e.length;n++)n%2&&(r=e[n-1]+e[n],t.push(parseInt(r,16)),r="");return t}return e.map(function(e){return parseInt(e,16)})}function oc(e,t){return Number(e+"."+t)}var sc="undefined"!=typeof window,ac=sc&&"undefined"!=typeof navigator&&navigator.userAgent.toLocaleLowerCase(),lc=(sc&&/^((?!chrome|android).)*safari/.test(ac),sc&&ac.includes("firefox")),cc=sc&&ac.includes("android"),uc=function(){function e(){Gl(this,e)}return ql(e,null,[{key:"getRateIndexByRate",value:function(t){return e.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,r){for(var n=t.length,i=0;i+2<n&&(255!==t[i]||240!=(246&t[i+1]));)i++;if(!(i>=n)){var o=i,s=[],a=(60&t[i+2])>>>2,l=e.FREQ[a];if(!l)throw new Error("Invalid sampling index: ".concat(a));for(var c,u,d=((192&t[i+2])>>>6)+1,h=(1&t[i+2])<<2|(192&t[i+3])>>>6,p=e._getConfig(a,h,d),f=p.config,_=p.codec,y=0,g=e.getFrameDuration(l);i+7<n;)if(255===t[i]&&240==(246&t[i+1])){if(!(u=(3&t[i+3])<<11|t[i+4]<<3|(224&t[i+5])>>5)||n-i<u)break;c=2*(1&~t[i+1]),s.push({pts:r+y*g,data:t.subarray(i+7+c,i+u)}),y++,i+=u}else i++;return{skip:o,remaining:i>=n?void 0:t.subarray(i),frames:s,samplingFrequencyIndex:a,sampleRate:l,objectType:d,channelCount:h,codec:_,config:f,originCodec:"mp4a.40.".concat(d)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var r=t[0]>>>3,n=(7&t[0])<<1|t[1]>>>7,i=(120&t[1])>>>3,o=e.FREQ[n];if(o){var s=e._getConfig(n,i,r),a=s.config,l=s.codec;return t.length>=4&&695==(t[2]<<3|(224&t[3])>>5)&&(128&t[4])>>7&&(r=31&t[3]),{samplingFrequencyIndex:n,sampleRate:o,objectType:r,channelCount:i,config:a,codec:l,originCodec:"mp4a.40.".concat(r)}}}}},{key:"getFrameDuration",value:function(e){return 1024*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4)/e}},{key:"_getConfig",value:function(e,t,r){var n,i,o=[];return lc?e>=6?(n=5,i=e-3):(n=2,i=e):cc?(n=2,i=e):(n=2===r||5===r?r:5,i=e,e>=6?i=e-3:1===t&&(n=2,i=e)),o[0]=n<<3,o[0]|=(14&e)>>1,o[1]=(1&e)<<7,o[1]|=t<<3,5===n&&(o[1]|=(14&i)>>1,o[2]=(1&i)<<7,o[2]|=8,o[3]=0),{config:o,codec:"mp4a.40.".concat(n)}}},{key:"getSilentFrame",value:function(e,t,r){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if("mp4a.40.5"===e&&2===t&&22050===r)return new Uint8Array([33,17,69,0,20,80,1,70,173,200,65,117,0,0,0,28,96,24,13,230,66,20,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,188]);if("mp40.40.5"===e&&2===t&&24e3===r)return new Uint8Array([33,17,69,0,20,80,1,70,173,200,65,117,0,0,0,28,96,24,13,229,98,20,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,188]);if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}])}();Kl(uc,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var dc=function(){return ql(function e(t){if(Gl(this,e),Kl(this,"_bytesAvailable",void 0),Kl(this,"_bitsAvailable",0),Kl(this,"_word",0),!t)throw new Error("ExpGolomb data params is required");this._data=t,this._bytesAvailable=t.byteLength,this._bytesAvailable&&this._loadWord()},[{key:"_loadWord",value:function(){var e=this._data.byteLength-this._bytesAvailable,t=Math.min(4,this._bytesAvailable);if(0===t)throw new Error("No bytes available");var r=new Uint8Array(4);r.set(this._data.subarray(e,e+t)),this._word=new DataView(r.buffer).getUint32(0),this._bitsAvailable=8*t,this._bytesAvailable-=t}},{key:"bitsPos",value:function(){return 8*this._bytesAvailable-this._bitsAvailable}},{key:"bitsLeft",value:function(){return 8*this._data.length-this.bitsPos()}},{key:"byteAligned",value:function(){return 0===this.bitsPos()||this.bitsPos()%8==0}},{key:"skipBits",value:function(e){if(this._bitsAvailable>e)this._word<<=e,this._bitsAvailable-=e;else{e-=this._bitsAvailable;var t=Math.floor(e/8);e-=8*t,this._bytesAvailable-=t,this._loadWord(),this._word<<=e,this._bitsAvailable-=e}}},{key:"readBits",value:function(e){if(e>32)throw new Error("Cannot read more than 32 bits");var t=Math.min(this._bitsAvailable,e),r=this._word>>>32-t;return this._bitsAvailable-=t,this._bitsAvailable>0?this._word<<=t:this._bytesAvailable>0&&this._loadWord(),(t=e-t)>0&&this._bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this._bitsAvailable;++e)if(this._word&2147483648>>>e)return this._word<<=e,this._bitsAvailable-=e,e;return this._loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r}}])}(),hc=function(){return ql(function e(t){Gl(this,e),this._buffer=t,this._offset=0,this._heldBits=0,this._numHeldBits=0},[{key:"readUint8",value:function(){return this._buffer[this._offset++]}},{key:"readUint16",value:function(){return this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint32",value:function(){return this._buffer[this._offset++]<<24|this._buffer[this._offset++]<<16|this._buffer[this._offset++]<<8|this._buffer[this._offset++]}},{key:"readUint8Array",value:function(e){var t=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,t}},{key:"streamRead1Bytes",value:function(){this._heldBits=this.readUint8(),this._numHeldBits=8}},{key:"streamRead2Bytes",value:function(){this._heldBits=this.readUint16(),this._numHeldBits=16}},{key:"extractBits",value:function(e){var t=this._heldBits>>this._numHeldBits-e&(1<<e)-1;return this._numHeldBits-=e,t}}])}(),pc=function(){function e(){Gl(this,e)}return ql(e,null,[{key:"parseVVCDecoderConfigurationRecord",value:function(t){var r=new hc(t),n=r.readUint8();r.streamRead1Bytes(),r.extractBits(5);var i,o,s,a,l,c,u,d,h=r.extractBits(2)+1,p=r.extractBits(1),f={};p&&(r.streamRead2Bytes(),a=r.extractBits(2),l=r.extractBits(3),o=r.extractBits(3),s=r.extractBits(2),r.extractBits(6),f=e.parseVVCPTLRecord(r,o),i=r.readUint16(),c=r.readUint16(),u=r.readUint16(),d=r.readUint16());for(var _=r.readUint8(),y=[],g=[],m=[],v=null,b=0;b<_;b++){r.streamRead1Bytes(),r.extractBits(1),r.extractBits(2);var w=r.extractBits(5),C=1;13!==w&&12!==w&&(C=r.readUint16());for(var E=0;E<C;E++){var k=r.readUint16();switch(w){case 14:y.push(r.readUint8Array(k));break;case 15:var T=r.readUint8Array(k);v||(v=e.parseSPS(e.removeEPB(T))),g.push(T);break;case 16:m.push(r.readUint8Array(k))}}}return{data:t,configurationVersion:n,codec:"bvc2.1.6.L93.B0",nalUnitSize:h,ptlPresentFlag:p,olsIdx:i,numSublayers:o,constantFrameRate:s,chromaFormatIdc:a,bitDepthLumaMinus8:l,ptlRecord:f,width:c,height:u,sampleRate:d,numOfArrays:_,vps:y,sps:g,pps:m,spsParsed:v}}},{key:"parseVVCPTLRecord",value:function(e,t){e.streamRead2Bytes(),e.extractBits(2);var r=e.extractBits(6),n=e.extractBits(7),i=e.extractBits(1),o=e.readUint8();e.streamRead1Bytes();var s=e.extractBits(1),a=e.extractBits(1),l=new Uint8Array(r);if(r){for(var c=0;c<r-1;c++){var u=e.extractBits(6);e.streamRead1Bytes();var d=e.extractBits(2);l[c]=u<<2|d}l[r-1]=e.extractBits(6)}else e.extractBits(6);var h=[];if(t>1){e.streamRead1Bytes();for(var p=0,f=t-2;f>=0;--f)p|=e.extractBits(1)<<f;for(var _=t;_<=8&&t>1;++_)e.extractBits(1);for(var y=t-2;y>=0;--y)p&1<<y&&(h[y]=e.readUint8())}var g=e.readUint8(),m=[];if(g)for(var v=0;v<g;v++)m.push(e.readUint32());return{generalProfileIdc:n,generalTierFlag:i,generalLevelIdc:o,ptlFrameOnlyConstraintFlag:s,ptlMultilayerEnabledFlag:a,generalConstraintInfo:l,subLayerLevelIdc:h,generalSubProfileIdc:m,ptlNumSubProfiles:g,numBytesConstraintInfo:r}}},{key:"getAvccNals",value:function(e){for(var t=[];e.position<e.length-4;){var r=e.dataview.getInt32(e.dataview.position);if(!(e.length-e.position>=r))break;var n=e.buffer.slice(e.position,e.position+4);e.skip(4);var i=new Uint8Array(e.buffer.slice(e.position,e.position+r));e.skip(r),t.push({header:n,body:i})}return t}},{key:"analyseNal",value:function(e){var t=(248&e.body[1])>>3;switch(e.type=t,t){case 23:case 24:break;case 7:case 8:e.key=!0;break;case 14:e.vps=!0;break;case 15:e.sps=!0;break;case 16:e.pps=!0;break;case 17:e.aps=!0}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(!r.length)return e;var i=t-r.length,o=new Uint8Array(i),s=0;for(n=0;n<i;s++,n++)s===r[0]&&(s++,r.shift()),o[n]=e[s];return o}},{key:"parseVps",value:function(){}},{key:"parseSPS",value:function(t){var r=new dc(t);r.readUByte(),r.readUByte(),r.skipBits(4);var n=r.readBits(4),i=r.readBits(3),o=r.readBits(2),s=420;o<=3&&(s=[0,420,422,444][o]),r.readBits(2),r.readBits(1);var a=e._parseProfileTierLevel(r,1,i);return r.readBits(1),r.readBits(1)&&r.readBits(1),{width:r.readUEG(),height:r.readUEG(),spsMaxSubLayerMinus1:i,spsVideoParameterSetId:n,chromaFormatIdc:o,chromaFormat:s,ptlInfo:a}}},{key:"_parseProfileTierLevel",value:function(t,r,n){var i,o=t.readBits(7),s=t.readBits(1),a=t.readBits(8),l=t.readBits(1),c=t.readBits(1);r&&(i=e._parseGeneralConstraintsInfo(t));for(var u=n-1,d=[],h=[],p=[],f=u;f>=0;--f)d[f]=t.readBits(1);for(;!t.byteAligned();)t.readBits(1);for(var _=u;_>=0;--_)d[_]&&(h[_]=t.readUByte());if(r)for(var y=t.readUByte(),g=0;g<y;g++)p[g]=t.readBits(32);return{generalProfileIdc:o,generalTierFlag:s,generalLevelIdc:a,ptlFrameOnlyConstraintFlag:l,ptlMultilayerEnabledFlag:c,ptlSublayerLevelPresentFlags:d,ptlSublayerLevelIdcs:h,ptlSubProfileIdcs:p,gciInfo:i}}},{key:"_parseGeneralConstraintsInfo",value:function(e){var t=e.readBits(1);if(t){e.skipBits(71);var r=e.readBits(8);r&&e.skipBits(r)}var n=8-e.bitsPos()%8;return e.skipBits(n),{gciPresentFlag:t}}}])}(),fc="video",_c="hevc",yc="vvcC",gc=function(){function e(t,r,n){Gl(this,e),this.dv=new DataView(t),this.start=this.offset=r||this.dv.byteOffset,this.end=n?this.start+n:this.start+this.dv.byteLength}return ql(e,[{key:"buffer",get:function(){return this.dv.buffer}},{key:"unreadLength",get:function(){return Math.max(this.end-this.offset,0)}},{key:"size",get:function(){return this.end-this.start}},{key:"readFloat",value:function(e){var t=0;switch(e){case 4:t=this.dv.getFloat32(this.offset);break;case 8:t=this.dv.getFloat64(this.offset);break;default:throw new Error("read ".concat(e,"-byte float is not supported"))}return this.offset+=e,t}},{key:"back",value:function(e){this.offset-=e}},{key:"skip",value:function(e){this.offset+=e}},{key:"readInt",value:function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getInt8(t);case 2:return this.dv.getInt16(t);case 4:return this.dv.getInt32(t);default:throw new Error("read ".concat(e,"-byte integers is not supported"))}}},{key:"read",value:function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getUint8(t);case 2:return this.dv.getUint16(t);case 3:return(this.dv.getUint16(t)<<8)+this.dv.getUint8(t+2);case 4:return this.dv.getUint32(t);default:return this.back(e-4),this.read(e-4)+this.dv.getUint32(t)*Math.pow(256,e-4)}}},{key:"write",value:function(e,t){var r=this.offset;switch(this.offset+=e,e){case 1:return this.dv.setUint8(r,t);case 2:return this.dv.setUint16(r,t);case 3:return this.dv.setUint8(r,t>>>16),this.dv.setUint16(r+1,65535&t);case 4:return this.dv.setUint32(r,t);default:throw new Error("write ".concat(e,"-byte integers is not supported"))}}},{key:"readToBuffer",value:function(e){var t;return t=this.offset||e?this.dv.buffer.slice(this.offset,e?this.offset+e:this.end):this.dv.buffer,this.offset+=t.byteLength,t}},{key:"readToUint8",value:function(e){var t=new Uint8Array(this.dv.buffer,this.offset,e||this.unreadLength);return this.offset+=t.byteLength,t}},{key:"readString",value:function(e){for(var t=0,r="";t<e;t++)r+=String.fromCharCode(this.dv.getUint8(this.offset)),this.offset++;return r}}],[{key:"fromUint8",value:function(t){return new e(t.buffer,t.byteOffset,t.byteLength)}},{key:"concatUint8s",value:function(e){var t=new Uint8Array(e.reduce(function(e,t){return e+t.byteLength},0)),r=0;return e.forEach(function(e){t.set(e,r),r+=e.byteLength}),t}},{key:"concatUint8",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.concatUint8s(t)}}])}(),mc=function(){function e(t,r){Gl(this,e),this.offset=0,this.val=t,this.size=r}return ql(e,[{key:"skip",value:function(e){this.offset+=e}},{key:"read",value:function(e){var t=this.size-this.offset-e;if(t>=0){var r=0,n=0;if(this.offset+=e,this.size>31){for(;n<e;n++)r+=Math.pow(2,n);return this.val/Math.pow(2,t)&r}for(;n<e;n++)r+=1<<n;return this.val>>>t&r}throw new Error("the number of the read operation exceeds the total length limit of bits")}}],[{key:"fromByte",value:function(t,r){return new e(t.read(r),r<<3)}}])}(),vc=function(){function e(){Gl(this,e)}return ql(e,null,[{key:"findBox",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[];if(!t)return i;for(var o=0,s="",a=0;t.length>7;){if(o=ec(t),s=String.fromCharCode.apply(null,t.subarray(4,8)),a=8,1===o?(o=rc(t,8),a+=8):o||(o=t.length),!r[0]||s===r[0]){var l=t.subarray(0,o);if(!(r.length<2))return e.findBox(l.subarray(a),r.slice(1),n+a);i.push({start:n,size:o,headerSize:a,type:s,data:l})}n+=o,t=t.subarray(o)}return i}},{key:"tfhd",value:function(e){return Ec(e,!0,function(e,t){e.trackId=ec(t);var r=4,n=1&e.flags,i=2&e.flags,o=8&e.flags,s=16&e.flags,a=32&e.flags;n&&(r+=4,e.baseDataOffset=ec(t,r),r+=4),i&&(e.sampleDescriptionIndex=ec(t,r),r+=4),o&&(e.defaultSampleDuration=ec(t,r),r+=4),s&&(e.defaultSampleSize=ec(t,r),r+=4),a&&(e.defaultSampleFlags=ec(t,r))})}},{key:"sidx",value:function(e){return Ec(e,!0,function(e,t){var r=0;e.reference_ID=ec(t,r),r+=4,e.timescale=ec(t,r),r+=4,0===e.version?(e.earliest_presentation_time=ec(t,r),r+=4,e.first_offset=ec(t,r),r+=4):(e.earliest_presentation_time=rc(t,r),r+=8,e.first_offset=rc(t,r),r+=8),r+=2,e.references=[];var n=Jl(t,r);r+=2;for(var i=0;i<n;i++){var o={};e.references.push(o);var s=ec(t,r);r+=4,o.reference_type=s>>31&1,o.referenced_size=2147483647&s,o.subsegment_duration=ec(t,r),s=ec(t,r+=4),r+=4,o.starts_with_SAP=s>>31&1,o.SAP_type=s>>28&7,o.SAP_delta_time=268435455&s}})}},{key:"moov",value:function(t){return Ec(t,!1,function(t,r,n){t.mvhd=e.mvhd(e.findBox(r,["mvhd"],n)[0]),t.trak=e.findBox(r,["trak"],n).map(function(t){return e.trak(t)}),t.pssh=e.pssh(e.findBox(r,["pssh"],n)[0])})}},{key:"mvhd",value:function(e){return Ec(e,!0,function(e,t){var r=0;1===e.version?(e.timescale=ec(t,16),e.duration=rc(t,20),r+=28):(e.timescale=ec(t,8),e.duration=ec(t,12),r+=16),e.nextTrackId=ec(t,r+76)})}},{key:"trak",value:function(t){return Ec(t,!1,function(t,r,n){t.tkhd=e.tkhd(e.findBox(r,["tkhd"],n)[0]),t.mdia=e.mdia(e.findBox(r,["mdia"],n)[0]),t.edts=e.edts(e.findBox(r,["edts"],n)[0])})}},{key:"tkhd",value:function(e){return Ec(e,!0,function(e,t){var r=gc.fromUint8(t);1===e.version?(r.read(8),r.read(8),e.trackId=r.read(4),r.read(4),e.duration=r.read(8)):(r.read(4),r.read(4),e.trackId=r.read(4),r.read(4),e.duration=r.read(4)),r.skip(16),e.matrix=[];for(var n=0;n<36;n++)e.matrix.push(r.read(1));r.back(36);for(var i,o=[],s=0;s<3;s++)o.push(oc(r.readInt(2),r.readInt(2))),o.push(oc(r.readInt(2),r.readInt(2))),i=r.readInt(4),o.push(oc(i>>30,1073741823&i));e.rotation=function(e){if(e.length<5)return 0;var t=Math.hypot(e[0],e[3]),r=Math.hypot(e[1],e[4]);return 0===t||0===r?0:180*Math.atan2(e[1]/r,e[0]/t)/Math.PI}(o),e.width=r.read(4),e.height=r.read(4)})}},{key:"mdia",value:function(t){return Ec(t,!1,function(t,r,n){t.mdhd=e.mdhd(e.findBox(r,["mdhd"],n)[0]),t.hdlr=e.hdlr(e.findBox(r,["hdlr"],n)[0]),t.minf=e.minf(e.findBox(r,["minf"],n)[0])})}},{key:"edts",value:function(t){return Ec(t,!1,function(t,r,n){t.elst=e.elst(e.findBox(r,["elst"],n)[0])})}},{key:"elst",value:function(e){return Ec(e,!0,function(e,t,r){e.entries=[],e.entriesData=t;var n=0,i=ec(t,n);n+=4;for(var o=0;o<i;o++){var s={};e.entries.push(s),1===e.version?(s.segment_duration=rc(t,n),n+=8,s.media_time=nc(t,n),n+=8):(s.segment_duration=ec(t,n),n+=4,s.media_time=tc(t,n),n+=4),s.media_rate_integer=Jl(t,n),n+=2,s.media_rate_fraction=Jl(t,r),n+=2}})}},{key:"mdhd",value:function(e){return Ec(e,!0,function(e,t){var r=0;1===e.version?(e.timescale=ec(t,16),e.duration=rc(t,20),r+=28):(e.timescale=ec(t,8),e.duration=ec(t,12),r+=16);var n=Jl(t,r);e.language=String.fromCharCode(96+(n>>10&31),96+(n>>5&31),96+(31&n))})}},{key:"hdlr",value:function(e){return Ec(e,!0,function(e,t){0===e.version&&(e.handlerType=String.fromCharCode.apply(null,t.subarray(4,8)))})}},{key:"minf",value:function(t){return Ec(t,!1,function(t,r,n){t.vmhd=e.vmhd(e.findBox(r,["vmhd"],n)[0]),t.smhd=e.smhd(e.findBox(r,["smhd"],n)[0]),t.stbl=e.stbl(e.findBox(r,["stbl"],n)[0])})}},{key:"vmhd",value:function(e){return Ec(e,!0,function(e,t){e.graphicsmode=Jl(t),e.opcolor=[Jl(t,2),Jl(t,4),Jl(t,6)]})}},{key:"smhd",value:function(e){return Ec(e,!0,function(e,t){e.balance=Jl(t)})}},{key:"stbl",value:function(t){return Ec(t,!1,function(t,r,n){var i;t.stsd=e.stsd(e.findBox(r,["stsd"],n)[0]),t.stts=e.stts(e.findBox(r,["stts"],n)[0]),t.ctts=e.ctts(e.findBox(r,["ctts"],n)[0]),t.stsc=e.stsc(e.findBox(r,["stsc"],n)[0]),t.stsz=e.stsz(e.findBox(r,["stsz"],n)[0]),t.stco=e.stco(e.findBox(r,["stco"],n)[0]),t.stco||(t.co64=e.co64(e.findBox(r,["co64"],n)[0]),t.stco=t.co64);var o=null===(i=t.stsd.entries[0])||void 0===i||null===(i=i.sinf)||void 0===i||null===(i=i.schi)||void 0===i?void 0:i.tenc.default_IV_size;t.stss=e.stss(e.findBox(r,["stss"],n)[0]),t.senc=e.senc(e.findBox(r,["senc"],n)[0],o)})}},{key:"senc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return Ec(e,!0,function(e,r){var n=0,i=ec(r,n);n+=4,e.samples=[];for(var o=0;o<i;o++){for(var s={InitializationVector:[]},a=0;a<t;a++)s.InitializationVector[a]=r[n+a];if(n+=t,2&e.flags){s.subsamples=[];var l=Jl(r,n);n+=2;for(var c=0;c<l;c++){var u={};u.BytesOfClearData=Jl(r,n),n+=2,u.BytesOfProtectedData=ec(r,n),n+=4,s.subsamples.push(u)}}e.samples.push(s)}})}},{key:"pssh",value:function(e){return Ec(e,!0,function(e,t){for(var r=[],n=[],i=0,o=0;o<16;o++)n.push(kc(t[i+o]));if(i+=16,e.version>0){var s=ec(t,i);i+=4;for(var a=0;a<(""+s).length;a++)for(var l=0;l<16;l++){var c=t[i];i+=1,r.push(kc(c))}}var u=ec(t,i);e.data_size=u,i+=4,e.kid=r,e.system_id=n,e.buffer=t})}},{key:"bvc2",value:function(t){return Ec(t,!1,function(t,r,n){var i=wc(t,r),o=r.subarray(i);n+=i,t.vvcC=e.bv2C(e.findBox(o,["bv2C"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])})}},{key:"bv2C",value:function(e){return Ec(e,!1,function(e,t,r){var n=pc.parseVVCDecoderConfigurationRecord(t);for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])})}},{key:"stsd",value:function(t){return Ec(t,!0,function(t,r,n){t.entryCount=ec(r),t.entries=e.findBox(r.subarray(4),[],n+4).map(function(t){switch(t.type){case"av01":return e.av01(t);case"avc1":case"avc2":case"avc3":case"avc4":return e.avc1(t);case"hvc1":case"hev1":return e.hvc1(t);case"bvc2":return e.bvc2(t);case"mp4a":return e.mp4a(t);case"alaw":case"ulaw":return e.alaw(t);case"enca":return Ec(t,!1,function(t,r,n){t.channelCount=Jl(r,16),t.samplesize=Jl(r,18),t.sampleRate=ec(r,24)/65536,r=r.subarray(28),t.sinf=e.sinf(e.findBox(r,["sinf"],n)[0]),t.esds=e.esds(e.findBox(r,["esds"],n)[0])});case"encv":return Ec(t,!1,function(t,r,n){t.width=Jl(r,24),t.height=Jl(r,26),t.horizresolution=ec(r,28),t.vertresolution=ec(r,32),r=r.subarray(78),t.sinf=e.sinf(e.findBox(r,["sinf"],n)[0]),t.avcC=e.avcC(e.findBox(r,["avcC"],n)[0]),t.hvcC=e.hvcC(e.findBox(r,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(r,["pasp"],n)[0])})}}).filter(Boolean)})}},{key:"tenc",value:function(e){return Ec(e,!1,function(e,t){var r=6;e.default_IsEncrypted=t[r],r+=1,e.default_IV_size=t[r],r+=1,e.default_KID=[];for(var n=0;n<16;n++)e.default_KID.push(kc(t[r])),r+=1})}},{key:"schi",value:function(t){return Ec(t,!1,function(t,r,n){t.tenc=e.tenc(e.findBox(r,["tenc"],n)[0])})}},{key:"sinf",value:function(t){return Ec(t,!1,function(t,r,n){t.schi=e.schi(e.findBox(r,["schi"],n)[0]),t.frma=e.frma(e.findBox(r,["frma"],n)[0])})}},{key:"frma",value:function(e){return Ec(e,!1,function(e,t){e.data_format="";for(var r=0;r<4;r++)e.data_format+=String.fromCharCode(t[r])})}},{key:"colr",value:function(e){return Ec(e,!1,function(t,r){var n=gc.fromUint8(r);t.data=e.data,t.colorType=n.readString(4),"nclx"===t.colorType?(t.colorPrimaries=n.read(2),t.transferCharacteristics=n.read(2),t.matrixCoefficients=n.read(2),t.fullRangeFlag=n.read(1)>>7):"rICC"!==t.colorType&&"prof"!==t.colorType||(t.iccProfile=r.readToUint8())})}},{key:"av01",value:function(t){return Ec(t,!1,function(t,r,n){var i=wc(t,r),o=r.subarray(i);n+=i,t.av1C=e.av1C(e.findBox(o,["av1C"],n)[0]),t.colr=e.colr(e.findBox(o,["colr"],n)[0])})}},{key:"av1C",value:function(e){return Ec(e,!1,function(t,r){t.data=e.data;var n,i=gc.fromUint8(r),o=mc.fromByte(i,4);t.marker=o.read(1),t.version=o.read(7),t.seqProfile=o.read(3),t.seqLevelIdx0=o.read(5),t.seqTier0=o.read(1),t.highBitdepth=o.read(1),t.twelveBit=o.read(1),t.monochrome=o.read(1),t.chromaSubsamplingX=o.read(1),t.chromaSubsamplingY=o.read(1),t.chromaSamplePosition=o.read(2),t.reserved=o.read(3),t.initialPresentationDelayPresent=o.read(1),t.initialPresentationDelayPresent?t.initialPresentationDelayMinusOne=o.read(4):t.initialPresentationDelayMinusOne=0,t.configOBUs=i.readToUint8(),2===t.seqLevelIdx0&&1===t.highBitdepth?n=1===t.twelveBit?"12":"10":t.seqProfile<=2&&(n=1===t.highBitdepth?"10":"08"),t.codec=["av01",t.seqProfile,(t.seqLevelIdx0<10?"0"+t.seqLevelIdx0:t.seqLevelIdx0)+(t.seqTier0?"H":"M"),n].join(".")})}},{key:"avc1",value:function(t){return Ec(t,!1,function(t,r,n){var i=wc(t,r),o=r.subarray(i);n+=i,t.avcC=e.avcC(e.findBox(o,["avcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])})}},{key:"avcC",value:function(e){return Ec(e,!1,function(t,r){t.data=e.data,t.configurationVersion=r[0],t.AVCProfileIndication=r[1],t.profileCompatibility=r[2],t.AVCLevelIndication=r[3],t.codec=function(e){for(var t,r="avc1.",n=0;n<3;n++)(t=e[n].toString(16)).length<2&&(t="0".concat(t)),r+=t;return r}([r[1],r[2],r[3]]),t.lengthSizeMinusOne=3&r[4],t.spsLength=31&r[5],t.sps=[];for(var n=6,i=0;i<t.spsLength;i++){var o=Jl(r,n);n+=2,t.sps.push(r.subarray(n,n+o)),n+=o}t.ppsLength=r[n],n+=1,t.pps=[];for(var s=0;s<t.ppsLength;s++){var a=Jl(r,n);n+=2,t.pps.push(r.subarray(n,n+=a)),n+=a}})}},{key:"hvc1",value:function(t){return Ec(t,!1,function(t,r,n){var i=wc(t,r),o=r.subarray(i);n+=i,t.hvcC=e.hvcC(e.findBox(o,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(o,["pasp"],n)[0])})}},{key:"hvcC",value:function(e){return Ec(e,!1,function(t,r){t.data=e.data,t.codec="hev1.1.6.L93.B0",t.configurationVersion=r[0];var n=r[1];t.generalProfileSpace=n>>6,t.generalTierFlag=(32&n)>>5,t.generalProfileIdc=31&n,t.generalProfileCompatibility=ec(r,2),t.generalConstraintIndicatorFlags=r.subarray(6,12),t.generalLevelIdc=r[12],t.avgFrameRate=Jl(r,19),t.numOfArrays=r[22],t.vps=[],t.sps=[],t.pps=[];for(var i=23,o=0,s=0,a=0,l=0;l<t.numOfArrays;l++){o=63&r[i],s=Jl(r,i+1),i+=3;for(var c,u=[],d=0;d<s;d++)a=Jl(r,i),i+=2,u.push(r.subarray(i,i+a)),i+=a;if(32===o)(c=t.vps).push.apply(c,u);else if(33===o){var h;(h=t.sps).push.apply(h,u)}else if(34===o){var p;(p=t.pps).push.apply(p,u)}}})}},{key:"pasp",value:function(e){return Ec(e,!1,function(e,t){e.hSpacing=ec(t),e.vSpacing=ec(t,4)})}},{key:"mp4a",value:function(t){return Ec(t,!1,function(t,r,n){var i=Cc(t,r);t.esds=e.esds(e.findBox(r.subarray(i),["esds"],n+i)[0])})}},{key:"esds",value:function(e){return Ec(e,!0,function(e,t){e.codec="mp4a.";for(var r=0,n=0,i=0,o=0;t.length;){for(o=t[r=0],n=t[r+1],r+=2;128&n;)i=(127&n)<<7,n=t[r],r+=1;if(i+=127&n,3===o)t=t.subarray(r+3);else{if(4!==o){if(5===o){var s=e.config=t.subarray(r,r+i),a=(248&s[0])>>3;return 31===a&&s.length>=2&&(a=32+((7&s[0])<<3)+((224&s[1])>>5)),e.objectType=a,e.codec+=a.toString(16),void("."===e.codec[e.codec.length-1]&&(e.codec=e.codec.substring(0,e.codec.length-1)))}return void("."===e.codec[e.codec.length-1]&&(e.codec=e.codec.substring(0,e.codec.length-1)))}e.codec+=(t[r].toString(16)+".").padStart(3,"0"),t=t.subarray(r+13)}}})}},{key:"alaw",value:function(e){return Ec(e,!1,function(e,t){Cc(e,t)})}},{key:"stts",value:function(e){return Ec(e,!0,function(e,t){for(var r=ec(t),n=[],i=4,o=0;o<r;o++)n.push({count:ec(t,i),delta:ec(t,i+4)}),i+=8;e.entryCount=r,e.entries=n})}},{key:"ctts",value:function(e){return Ec(e,!0,function(e,t){var r=ec(t),n=[],i=4;if(1===e.version)for(var o=0;o<r;o++)n.push({count:ec(t,i),offset:ec(t,i+4)}),i+=8;else for(var s=0;s<r;s++)n.push({count:ec(t,i),offset:-(1+~ec(t,i+4))}),i+=8;e.entryCount=r,e.entries=n})}},{key:"stsc",value:function(e){return Ec(e,!0,function(e,t){for(var r=ec(t),n=new Array(r),i=4,o=0;o<r;o++)n[o]={firstChunk:ec(t,i),samplesPerChunk:ec(t,i+4),sampleDescriptionIndex:ec(t,i+8)},i+=12;e.entryCount=r,e.entries=n})}},{key:"stsz",value:function(e){return Ec(e,!0,function(e,t){var r=ec(t),n=ec(t,4),i=new Array(n);if(!r)for(var o=8,s=0;s<n;s++)i[s]=ec(t,o),o+=4;e.sampleSize=r,e.sampleCount=n,e.entrySizes=i})}},{key:"stco",value:function(e){return Ec(e,!0,function(e,t){for(var r=ec(t),n=new Array(r),i=4,o=0;o<r;o++)n[o]=ec(t,i),i+=4;e.entryCount=r,e.entries=n})}},{key:"co64",value:function(e){return Ec(e,!0,function(e,t){for(var r=ec(t),n=new Array(r),i=4,o=0;o<r;o++)n[o]=rc(t,i),i+=8;e.entryCount=r,e.entries=n})}},{key:"stss",value:function(e){return Ec(e,!0,function(e,t){for(var r=ec(t),n=new Array(r),i=4,o=0;o<r;o++)n[o]=ec(t,i),i+=4;e.entryCount=r,e.entries=n})}},{key:"moof",value:function(t){return Ec(t,!1,function(t,r,n){t.mfhd=e.mfhd(e.findBox(r,["mfhd"],n)[0]),t.traf=e.findBox(r,["traf"],n).map(function(t){return e.traf(t)})})}},{key:"mfhd",value:function(e){return Ec(e,!0,function(e,t){e.sequenceNumber=ec(t)})}},{key:"traf",value:function(t){return Ec(t,!1,function(t,r,n){t.tfhd=e.tfhd(e.findBox(r,["tfhd"],n)[0]),t.tfdt=e.tfdt(e.findBox(r,["tfdt"],n)[0]),t.trun=e.trun(e.findBox(r,["trun"],n)[0])})}},{key:"trun",value:function(e){return Ec(e,!0,function(e,t){var r=e.version,n=e.flags,i=t.length,o=e.sampleCount=ec(t),s=4;if(i>s&&1&n&&(e.dataOffset=-(1+~ec(t,s)),s+=4),i>s&&4&n&&(e.firstSampleFlags=ec(t,s),s+=4),i>s){var a;e.samples=new Array(o);for(var l=0;l<o;l++)a={},256&n&&(a.duration=ec(t,s),s+=4),512&n&&(a.size=ec(t,s),s+=4),1024&n&&(a.flags=ec(t,s),s+=4),2048&n&&(a.cts=r?-(1+~ec(t,s+4)):ec(t,s),s+=4),e.samples[l]=a}})}},{key:"tfdt",value:function(e){return Ec(e,!0,function(e,t){1===e.version?e.baseMediaDecodeTime=rc(t):e.baseMediaDecodeTime=ec(t)})}},{key:"probe",value:function(t){return!!e.findBox(t,["ftyp"])}},{key:"parseSampleFlags",value:function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}},{key:"moovToTrack",value:function(e,t,r){var n,i,o=e.trak;if(o&&o.length){var s=o.find(function(e){var t;return"vide"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),a=o.find(function(e){var t;return"soun"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)});if(s&&t){var l,c,u,d,h=t;null!=(null===(l=s.tkhd)||void 0===l?void 0:l.trackId)&&(h.id=s.tkhd.trackId),h.tkhdDuration=s.tkhd.duration,h.mvhdDurtion=e.mvhd.duration,h.mvhdTimecale=e.mvhd.timescale,h.timescale=h.formatTimescale=s.mdia.mdhd.timescale,h.duration=s.mdia.mdhd.duration||h.mvhdDurtion/h.mvhdTimecale*h.timescale,h.rotation=s.tkhd.rotation,h.matrix=s.tkhd.matrix,null!==(c=s.edts)&&void 0!==c&&c.elst&&(h.editList=s.edts.elst,h.editListApplied=s.editListApplied);var p,f,_,y,g=s.mdia.minf.stbl.stsd.entries[0];if(h.width=g.width,h.height=g.height,g.pasp&&(h.sarRatio=[g.pasp.hSpacing,g.pasp.vSpacing]),g.av1C)h.codecType="av1",h.codec=g.av1C.codec,h.av1C=g.av1C.data,h.colr=g.colr.data;else if(g.hvcC)h.codecType=_c,h.codec=g.hvcC.codec,h.vps=g.hvcC.vps,h.sps=g.hvcC.sps,h.pps=g.hvcC.pps,h.hvcC=g.hvcC.data;else if(g.avcC)h.codec=g.avcC.codec,h.sps=g.avcC.sps,h.pps=g.avcC.pps;else{if(!g.vvcC)throw new Error("unknown video stsd entry");h.codecType=yc,h.codec=g.vvcC.codec,h.sps=g.vvcC.sps,h.pps=g.vvcC.pps,h.vps=g.vvcC.vps,h.vvcC=g.vvcC.data}h.present=!0,h.ext={},h.ext.stss=null===(u=s.mdia)||void 0===u||null===(u=u.minf)||void 0===u||null===(u=u.stbl)||void 0===u?void 0:u.stss,h.ext.ctts=null===(d=s.mdia)||void 0===d||null===(d=d.minf)||void 0===d||null===(d=d.stbl)||void 0===d?void 0:d.ctts,g&&"encv"===g.type&&(h.isVideoEncryption=!0,g.default_KID=null===(p=g.sinf)||void 0===p||null===(p=p.schi)||void 0===p?void 0:p.tenc.default_KID,g.default_IsEncrypted=null===(f=g.sinf)||void 0===f||null===(f=f.schi)||void 0===f?void 0:f.tenc.default_IsEncrypted,g.default_IV_size=null===(_=g.sinf)||void 0===_||null===(_=_.schi)||void 0===_?void 0:_.tenc.default_IV_size,h.videoSenc=s.mdia.minf.stbl.senc&&s.mdia.minf.stbl.senc.samples,g.data_format=null===(y=g.sinf)||void 0===y||null===(y=y.frma)||void 0===y?void 0:y.data_format,h.useEME=e.useEME,h.kidValue=e.kidValue,h.pssh=e.pssh,h.encv=g)}if(a&&r){var m,v,b,w,C,E,k=r;null!=(null===(m=a.tkhd)||void 0===m?void 0:m.trackId)&&(k.id=a.tkhd.trackId),k.tkhdDuration=a.tkhd.duration,k.mvhdDurtion=e.mvhd.duration,k.mvhdTimecale=e.mvhd.timescale,k.timescale=k.formatTimescale=a.mdia.mdhd.timescale,k.duration=a.mdia.mdhd.duration||k.mvhdDurtion/k.mvhdTimecale*k.timescale,null!==(v=a.edts)&&void 0!==v&&v.elst&&(k.editList=a.edts.elst,k.editListApplied=a.editListApplied);var T,S,O,A,$=a.mdia.minf.stbl.stsd.entries[0];switch(k.sampleSize=$.sampleSize,k.sampleRate=$.sampleRate,k.channelCount=$.channelCount,k.present=!0,$.type){case"alaw":k.codecType=k.codec="g7110a",k.sampleRate=8e3;break;case"ulaw":k.codecType=k.codec="g7110m",k.sampleRate=8e3;break;default:k.sampleDuration=uc.getFrameDuration(k.sampleRate,k.timescale),k.sampleRateIndex=uc.getRateIndexByRate(k.sampleRate),k.objectType=(null===(n=$.esds)||void 0===n?void 0:n.objectType)||2,$.esds&&(k.config=Array.from($.esds.config)),k.codec=(null===(i=$.esds)||void 0===i?void 0:i.codec)||"mp4a.40.2"}k.sampleDuration=uc.getFrameDuration(k.sampleRate,k.timescale),k.objectType=(null===(b=$.esds)||void 0===b?void 0:b.objectType)||2,$.esds&&($.esds.config?k.config=Array.from($.esds.config):console.warn("esds config is null")),k.codec=(null===(w=$.esds)||void 0===w?void 0:w.codec)||"mp4a.40.2",k.sampleRateIndex=uc.getRateIndexByRate(k.sampleRate),k.ext={},k.ext.stss=null===(C=a.mdia)||void 0===C||null===(C=C.minf)||void 0===C||null===(C=C.stbl)||void 0===C?void 0:C.stss,k.ext.ctts=null===(E=a.mdia)||void 0===E||null===(E=E.minf)||void 0===E||null===(E=E.stbl)||void 0===E?void 0:E.ctts,k.present=!0,$&&"enca"===$.type&&(k.isAudioEncryption=!0,$.data_format=null===(T=$.sinf)||void 0===T||null===(T=T.frma)||void 0===T?void 0:T.data_format,$.default_KID=null===(S=$.sinf)||void 0===S||null===(S=S.schi)||void 0===S?void 0:S.tenc.default_KID,$.default_IsEncrypted=null===(O=$.sinf)||void 0===O||null===(O=O.schi)||void 0===O?void 0:O.tenc.default_IsEncrypted,$.default_IV_size=null===(A=$.sinf)||void 0===A||null===(A=A.schi)||void 0===A?void 0:A.tenc.default_IV_size,k.audioSenc=a.mdia.minf.stbl.senc&&a.mdia.minf.stbl.senc.samples,k.useEME=e.useEME,k.kidValue=e.kidValue,k.enca=$)}if(r&&(r.isVideoEncryption=!!t&&t.isVideoEncryption),t&&(t.isAudioEncryption=!!r&&r.isAudioEncryption),null!=t&&t.encv||null!=r&&r.enca){var P,R,x=null==t||null===(P=t.encv)||void 0===P?void 0:P.default_KID,L=null==r||null===(R=r.enca)||void 0===R?void 0:R.default_KID,I=x||L?(x||L).join(""):null;t&&(t.kid=I),r&&(r.kid=I)}return t&&(t.flags=3841),r&&(r.flags=1793),{videoTrack:t,audioTrack:r}}}},{key:"evaluateDefaultDuration",value:function(e,t,r){var n,i=null==t||null===(n=t.samples)||void 0===n?void 0:n.length;return i?1024*i/t.timescale*e.timescale/r:1024}},{key:"moofToSamples",value:function(t,r,n){var i={};return t.mfhd&&(r&&(r.sequenceNumber=t.mfhd.sequenceNumber),n&&(n.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach(function(t){var o=t.tfhd,s=t.tfdt,a=t.trun;if(o&&a){s&&(r&&r.id===o.trackId&&(r.baseMediaDecodeTime=s.baseMediaDecodeTime),n&&n.id===o.trackId&&(n.baseMediaDecodeTime=s.baseMediaDecodeTime));var l=o.defaultSampleSize||0,c=o.defaultSampleDuration||e.evaluateDefaultDuration(r,n,a.samples.length||a.sampleCount),u=a.dataOffset||0,d=0,h=-1;if(!a.samples.length&&a.sampleCount){i[o.trackId]=new Array(a.sampleCount);for(var p=0;p<a.sampleCount;p++)i[o.trackId][p]={offset:u,dts:d,duration:c,size:l},d+=c,u+=l}else i[o.trackId]=a.samples.map(function(e,t){return(e={offset:u,dts:d,pts:d+(e.cts||0),duration:e.duration||c,size:e.size||l,gopId:h,keyframe:0===t||null!==e.flags&&void 0!==e.flags&&(65536&e.flags)>>>0!=65536}).keyframe&&(h++,e.gopId=h),d+=e.duration,u+=e.size,e})}}),i}},{key:"moovToSamples",value:function(e){var t=e.trak;if(t&&t.length){var r=t.find(function(e){var t;return"vide"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),n=t.find(function(e){var t;return"soun"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)});if(r||n){var i,o;if(r){var s,a=null===(s=r.mdia)||void 0===s||null===(s=s.minf)||void 0===s?void 0:s.stbl;if(!a)return;var l=a.stts,c=a.stsc,u=a.stsz,d=a.stco,h=a.stss,p=a.ctts;if(!(l&&c&&u&&d&&h))return;i=bc(l,c,u,d,p,h)}if(n){var f,_,y=null===(f=n.mdia)||void 0===f||null===(f=f.minf)||void 0===f?void 0:f.stbl;if(!y)return;var g=null===(_=n.mdia.mdhd)||void 0===_?void 0:_.timescale,m=y.stts,v=y.stsc,b=y.stsz,w=y.stco;if(!(g&&m&&v&&b&&w))return;o=bc(m,v,b,w)}return{videoSamples:i,audioSamples:o}}}}}])}();function bc(e,t,r,n,i,o){var s,a,l,c=[],u=null==i?void 0:i.entries,d=t.entries,h=n.entries,p=r.entrySizes,f=null==o?void 0:o.entries;f&&(s={},f.forEach(function(e){s[e-1]=!0})),u&&(a=[],u.forEach(function(e){for(var t=e.count,r=e.offset,n=0;n<t;n++)a.push(r)}));var _=-1,y=0,g=0,m=0,v=0,b=0,w=d[0].samplesPerChunk,C=d[1]?d[1].firstChunk-1:1/0;return e.entries.forEach(function(e){for(var t=e.count,n=e.delta,i=0;i<t;i++)l={dts:y,duration:n,size:p[g]||r.sampleSize,offset:h[m]+b,index:g},f&&(l.keyframe=s[g],l.keyframe&&_++,l.gopId=_),a&&g<a.length&&(l.pts=l.dts+a[g]),c.push(l),y+=n,++g<w?b+=l.size:(m++,b=0,m>=C&&(v++,C=d[v+1]?d[v+1].firstChunk-1:1/0),w+=d[v].samplesPerChunk)}),c}function wc(e,t){return e.dataReferenceIndex=Jl(t,6),e.width=Jl(t,24),e.height=Jl(t,26),e.horizresolution=ec(t,28),e.vertresolution=ec(t,32),e.frameCount=Jl(t,40),e.depth=Jl(t,74),78}function Cc(e,t){return e.dataReferenceIndex=Jl(t,6),e.channelCount=Jl(t,16),e.sampleSize=Jl(t,18),e.sampleRate=ec(t,24)/65536,28}function Ec(e,t,r){if(e){if(e.size!==e.data.length)throw new Error("box ".concat(e.type," size !== data.length"));var n={start:e.start,size:e.size,headerSize:e.headerSize,type:e.type};return t&&(n.version=e.data[e.headerSize],n.flags=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<16)+(e[t+1]<<8)+(e[t+2]||0)}(e.data,e.headerSize+1),n.headerSize+=4),r(n,e.data.subarray(n.headerSize),n.start+n.headerSize),n}}var kc=function(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.forEach(function(t){e.push(function(e){for(var t=String(0),r=Math.ceil(2/t.length),n=[],i=String(e);r--;)n.push(t);return n.join("").substring(0,2-i.length)+i}(Number(t).toString(16)))}),e[0]},Tc=ll(function e(t,r){sl(this,e),this.type="file",this.message=t,this.data=r}),Sc=function(){return ll(function e(){sl(this,e),cl(this,"_data",Object.create(null))},[{key:"set",value:function(e,t){this._data[e]=t}},{key:"get",value:function(e){return this._data[e]}},{key:"clear",value:function(){this._data=Object.create(null)}}])}(),Oc=function(){return ll(function e(){sl(this,e),this.frames=[],this.dur=0,this.minPts=Number.MAX_VALUE,this.maxPts=0},[{key:"appendFrame",value:function(e){this.frames.push(e),this.dur+=e.duration}},{key:"calMinMaxPts",value:function(e){e.pts<this.minPts&&(this.minPts=e.pts);var t=e.pts+e.duration;t>this.maxPts&&(this.maxPts=t)}}])}();function Ac(e,t){var r=e.trak;if(r&&r.length){var n=r.find(function(e){var t;return"vide"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),i=r.find(function(e){var t;return"soun"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)});if(n||i){var o=[],s=[];if(t){var a=[],l=0,c=t.start+t.size;t.references.forEach(function(e,r){a.push({index:r,startTime:l,endTime:l+e.subsegment_duration/t.timescale,duration:e.subsegment_duration/t.timescale,range:[c,c+e.referenced_size],frames:[]}),l+=e.subsegment_duration/t.timescale,c+=e.referenced_size}),o=a,s=a}else{var u,d,h=function(t){return t?[{index:0,startTime:0,endTime:t.duration/t.timescale,duration:t.duration/t.timescale,range:[e.start+e.size,""],frames:[]}]:[]};s=h(e.mvhd.duration?e.mvhd:null===(u=n.mdia)||void 0===u?void 0:u.mdhd),o=h(e.mvhd.duration?e.mvhd:null===(d=i.mdia)||void 0===d?void 0:d.mdhd)}return{videoSegments:s,audioSegments:o}}}}function $c(e,t){var r=t.segmentDuration,n=e.trak;if(n&&n.length){var i=n.find(function(e){var t;return"vide"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),o=n.find(function(e){var t;return"soun"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)});if(i||o){var s,a=[],l=[];return i&&(s=(a=Pc("video",i,r,t)).map(function(e){return e.duration})),o&&(l=Pc("audio",o,r,t,s,a)),{videoSegments:a,audioSegments:l}}}}function Pc(e,t,r,n){var i,o,s,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5?arguments[5]:void 0,c=n.fixEditListOffset,u=n.fixEditListOffsetThreshold,d=n.audioGroupingStrategy,h=n.memoryOpt,p=null===(i=t.mdia)||void 0===i||null===(i=i.minf)||void 0===i?void 0:i.stbl;if(!p)return[];var f=null===(o=t.mdia.mdhd)||void 0===o?void 0:o.timescale,_=p.stts,y=p.stsc,g=p.stsz,m=p.stco,v=p.stss,b=p.ctts;if(!(f&&_&&y&&g&&m)||"video"===e&&!v)return[];var w=0,C=null===(s=t.edts)||void 0===s||null===(s=s.elst)||void 0===s?void 0:s.entries;if(c&&function(){var e=!0,t=navigator.userAgent||"";if(/Chrome/gi.test(t)&&!/Edge\//gi.test(t)){var r=t.match(/Chrome\/(\d+)/i),n=r?parseInt(r[1],10):0;e=!!n&&n>=75}return e}()&&Array.isArray(C)&&C.length>0){var E=C[0].media_time;E>0&&E<(u?u*f:5*f)&&(w=E)}var k,T,S=[],O=[],A=[],$=[],P=[],R=y.entries,x=m.entries,L=g.entrySizes,I=null==v?void 0:v.entries,M=null==b?void 0:b.entries,D=[],B={};h||(M&&M.forEach(function(e){for(var t=e.count,r=e.offset,n=0;n<t;n++)D.push(r)}),I&&I.forEach(function(e){B[e-1]=!0}));var N,j=0,U=0,V=0,F=0,H=R.length>0?R[0].samplesPerChunk:0,G=R.length>1&&R[1]?R[1].firstChunk-1:1/0,W=0,q=-1,K=!1,z={};(null==M?void 0:M.length)>0&&w>0&&(W-=w,K=!0),t.editListApplied=K,h&&(N=null==I?void 0:I.shift()),_.entries.forEach(function(e){var t=e.count,r=e.delta;T=r;for(var n=0;n<t;n++){if(k={dts:W,duration:T,size:L[j]||g.sampleSize,offset:x[U]+F,index:j},M&&(h?(Rc(M,j,z),k.pts=W+((null==z?void 0:z.offset)||0)):D&&j<D.length&&(k.pts=W+D[j])),0===w&&0===j&&(k.pts=0),void 0===k.pts&&(k.pts=k.dts),I){if(h?j+1===N&&(k.keyframe=!0,N=I.shift()):k.keyframe=B[j],k.keyframe)if(q++,h){var i=new Oc;i.appendFrame(k),O.push(i)}else O.push([k]),A.push(k.duration);else h?O[O.length-1].appendFrame(k):(O[O.length-1].push(k),A[O.length-1]+=k.duration);k.gopId=q,h&&O[O.length-1].calMinMaxPts(k)}if(!h)if(k.keyframe?$[$.length]=k.pts:k.pts<$[O.length-1]&&($[O.length-1]=k.pts),k.keyframe)P[P.length]=k.index;else if(O.length>0&&void 0!==P[O.length-1]){var o,s=null===(o=S[P[O.length-1]])||void 0===o?void 0:o.pts;void 0!==s&&k.pts>s&&(P[O.length-1]=k.index)}S[S.length]=k,W+=r,++j<H?F+=k.size:(U++,F=0,U>=G&&(V++,G=R[V+1]?R[V+1].firstChunk-1:1/0),H+=R[V].samplesPerChunk)}});var Z=S.length;if(!Z||v&&!S[0].keyframe)return[];var Y,X,Q=[],J=[],ee=0,te=0,re=0,ne=0,ie=function(e,t,r){Y=J[J.length-1],h?(re=(null==O?void 0:O.length)>0?O[t].minPts:J[0].pts,ne=(null==O?void 0:O.length)>0?O[r].maxPts:Y.pts+Y.duration):(re=$[t],X=S[P[r]],ne=X.pts+X.duration),0===Q.length&&(e=(ne-re)/f),Q.push({index:Q.length,startTime:re/f,endTime:ne/f,duration:e,range:[J[0].offset,Y.offset+Y.size-1],frames:J}),1!==d&&(ee=0),J=[]},oe=0;if(v)for(var se=r*f,ae=0,le=O.length;ae<le;ae++){var ce,ue;h?(ee+=O[ae].dur,(ce=J).push.apply(ce,vl(O[ae].frames))):(ee+=A[ae],(ue=J).push.apply(ue,vl(O[ae]))),ae+1<le?(0===ae||ee>se)&&(ie(ee/f,oe,ae),ee=0,oe=ae+1):(ie(ee/f,oe,ae),ee=0,oe=ae+1)}else{h||($=[],P=[]);var de=a[0]||r;if(1===d)for(var he,pe=0;pe<Z;pe++){var fe=S[pe],_e=S[pe+1],ye=pe===Z-1;J.push(fe),ee+=fe.duration;var ge=he||ee/f;he=(_e?ee+_e.duration:0)/f,(ye||(l[Q.length]?he>l[Q.length].endTime:he-J[0].pts/f>=de))&&(h||($.push(J[0].pts),P.push(J[J.length-1].index)),ie(ge,Q.length,Q.length),de=a[Q.length]||r)}else for(var me,ve=0;ve<Z;ve++){var be=S[ve],we=S[ve+1],Ce=ve===Z-1;J.push(be),ee+=be.duration;var Ee=me||ee/f;me=(we?ee+we.duration:0)/f,(Ce||me+te>=de)&&(te+=2===d?ee/f-de:me-de,h||($.push(J[0].pts),P.push(J[J.length-1].index)),ie(Ee,Q.length,Q.length),de=a[Q.length]||r)}}return Q}function Rc(e,t,r){r.offset=0;var n=(null==r?void 0:r.beforeFrameNum)||0,i=(null==r?void 0:r.usedCttsIdx)||0;if(!e||(null==e?void 0:e.length)<=0||(null==r?void 0:r.usedCttsIdx)>=e.length)r.offset=0,r.usedCttsIdx=i,r.beforeFrameNum=n;else{var o=e[i];if(t<n+((null==o?void 0:o.count)||1))r.offset=(null==o?void 0:o.offset)||0;else{var s=e[++i];s?(r.offset=s.offset||0,r.beforeFrameNum=n+o.count):(r.offset=0,r.beforeFrameNum=n+1),r.usedCttsIdx=i}}}function xc(e,t){var r="",n="",i=0,o=0,s=0,a=0,l=0,c=0,u=0;e.mvhd&&(l=e.mvhd.duration/e.mvhd.timescale);var d=e.trak;if(d){var h,p,f,_,y,g,m,v,b,w=d.find(function(e){var t;return"vide"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),C=d.find(function(e){var t;return"soun"===(null===(t=e.mdia)||void 0===t||null===(t=t.hdlr)||void 0===t?void 0:t.handlerType)}),E=null;return w&&(E=null===(p=w.mdia)||void 0===p||null===(p=p.minf)||void 0===p||null===(p=p.stbl)||void 0===p?void 0:p.stsd.entries[0])&&(i=E.width,o=E.height,c=null===(f=w.mdia)||void 0===f||null===(f=f.mdhd)||void 0===f?void 0:f.timescale,r=null===(_=E.avcC||E.hvcC||E.av1C||E.vvcC)||void 0===_?void 0:_.codec,"encv"===E.type&&(h=null===(y=E.sinf)||void 0===y||null===(y=y.schi)||void 0===y?void 0:y.tenc.default_KID)),C&&(E=null===(g=C.mdia)||void 0===g||null===(g=g.minf)||void 0===g||null===(g=g.stbl)||void 0===g?void 0:g.stsd.entries[0])&&(s=E.channelCount,a=E.sampleRate,n=null===(m=E.esds)||void 0===m?void 0:m.codec,u=null===(v=C.mdia)||void 0===v||null===(v=v.mdhd)||void 0===v?void 0:v.timescale,"enca"===E.type&&(h=h||(null===(b=E.sinf)||void 0===b||null===(b=b.schi)||void 0===b?void 0:b.tenc.default_KID))),{kid:h?h.join(""):null,videoCodec:r,audioCodec:n,width:i,height:o,videoTimescale:c,audioChannelCount:s,audioSampleRate:a,duration:l,audioTimescale:u,moov:e,isFragmentMP4:t}}}function Lc(e){return"number"==typeof e&&!Number.isNaN(e)}function Ic(e){if(!e)return!1;var t=e.audioSegments,r=e.videoSegments,n=!r||0===r.length,i=!t||0===t.length;return!n||!i}var Mc=["vid","cache"],Dc=function(e){function t(e){var r,n,i,o,s;sl(this,t),cl((i=this,o=ul(o=t),r=function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(i,dl()?Reflect.construct(o,s||[],ul(i).constructor):o.apply(i,s))),"vid",""),cl(r,"url",""),cl(r,"meta",{}),cl(r,"downloadInfo",[]),cl(r,"videoSegments",[]),cl(r,"audioSegments",[]),cl(r,"cache",null),cl(r,"_currentSegmentIndex",-1),cl(r,"_currentLoadingSegmentIndex",-1),cl(r,"buffer",void 0),cl(r,"bufferDataLen",0),cl(r,"_error",void 0),cl(r,"_transformError",function(e){return e}),r._config=("boolean"!=typeof(n=e).fixEditListOffset&&delete n.fixEditListOffset,pl({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",fixEditListOffset:!0,cache:null},n));var a=r._config,l=a.vid,c=a.cache,u=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(a,Mc);return r.cache=c||new Sc,r.vid=l||u.url,r.url=u.url,u.transformError=r._transformError,r.logger=new Ys("MP4Loader_"+r.vid),e.openLog&&Ys.enable(),u.logger=r.logger,r._loader=new Fl(u),r._loader.on(Ll,function(e){r.emit(Ll,e)}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gl(e,t)}(t,e),ll(t,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){Lc(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){var t,r;return!!Lc(e)&&e>=((null===(t=this.videoSegments[this.videoSegments.length-1])||void 0===t?void 0:t.index)||(null===(r=this.audioSegments[this.audioSegments.length-1])||void 0===r?void 0:r.index)||0)}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:(h=ol(_l().m(function e(t){var r,n,i,o=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:t,n=o.length>2?o[2]:void 0,i=o.length>3?o[3]:void 0,e.n=1,this.reset(i);case 1:t&&(this.url=t),r&&(this.vid=r),n&&(this._config.moovEnd=n);case 2:return e.a(2)}},e,this)})),function(e){return h.apply(this,arguments)})},{key:"getOrLoadMeta",value:(d=ol(_l().m(function e(t){return _l().w(function(e){for(;;)switch(e.n){case 0:if(this.isMetaLoaded){e.n=1;break}return e.n=1,this.loadMeta(t);case 1:return e.a(2,this.meta)}},e,this)})),function(e){return d.apply(this,arguments)})},{key:"newBufferArray",value:function(e,t){var r;if(this.buffer){if(t||(null===(r=this.buffer)||void 0===r?void 0:r.byteLength)<e){var n,i=this.buffer.subarray(0,this.bufferDataLen),o=Ul(((null===(n=this.buffer)||void 0===n?void 0:n.byteLength)||0)+e);o.set(i,0),delete this.buffer,this.buffer=o}}else this.buffer=Ul(e),this.bufferDataLen=0}},{key:"loadMetaProcess",value:(u=ol(_l().m(function e(t,r,n){var i,o,s,a,l,c,u=this,d=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:if(o=ml(r,2),s=o[0],a=o[1],l=d.length>3&&void 0!==d[3]?d[3]:{},this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[s,a]),null!==(i=this._config)&&void 0!==i&&i.memoryOpt&&(!this.buffer||null!=l&&l.isExp))try{this.newBufferArray(a-s+1,null==l?void 0:l.isExp)}catch(e){n(null,!0,{},new Tc(null==e?void 0:e.message),{})}return c=function(){var e=ol(_l().m(function e(r,i,o,c){var d,h,p,f,_,y,g,m,v,b,w,C,E,k,T,S,O;return _l().w(function(e){for(;;)switch(e.n){case 0:if(u.meta&&null!=o&&o.range&&o.range.length>0&&o.range[1]>=a&&(i=!0,u.logger.debug("[loadMetaProcess],data done,setstate true,[",s,a,"]")),i&&null!=o&&o.range&&o.range.length>0&&o.range[1]<a&&(i=!1,u.logger.debug("[loadMetaProcess],data not done,setstate false,[",s,a,"]")),u.logger.debug("[loadMetaProcess],task,[",s,a,"], range,",o.range,",dataLen,",r?r.byteLength:void 0,", state,",i,",err,",u._error),!u._error&&r&&r.byteLength>0&&n(r,i,o,null,c),!u.meta.moov&&!u._error){e.n=1;break}return e.a(2);case 1:if(!(r&&r.byteLength>0)){e.n=13;break}e.p=2,null!==(h=u._config)&&void 0!==h&&h.memoryOpt?(u.buffer.set(r,u.bufferDataLen),u.bufferDataLen+=(null==r?void 0:r.byteLength)||0,d=u.buffer.subarray(0,u.bufferDataLen)):(u.buffer=jl(u.buffer,r),d=u.buffer),e.n=4;break;case 3:return e.p=3,O=e.v,n(null,i,o,new Tc(null==O?void 0:O.message),c),e.a(2);case 4:if(p=vc.findBox(d,["moov"])[0]){e.n=7;break}if(f=vc.findBox(d,["mdat"])[0],!i){e.n=7;break}if(f){e.n=5;break}return u._error=!0,n(null,i,o,new Tc("cannot find moov or mdat box"),c),e.a(2);case 5:return _=f.start+f.size,e.n=6,u.loadData([_,""],t,l);case 6:(y=e.v)&&(p=vc.findBox(y.data,["moov"])[0]);case 7:if(!(p&&i&&p.size>p.data.length)){e.n=8;break}return u.logger.debug("[loadMetaProcess],moov not all, range,",o.range[1],",dataLen,",u.bufferDataLen,", state,",i),e.n=8,u.loadMetaProcess(t,[o.range[1],p.start+p.size-1],n,{isExp:!0});case 8:if(!(p&&p.size<=p.data.length)||u.meta.moov){e.n=13;break}if(m=vc.moov(p)){e.n=9;break}return u._error=!0,n(null,i,o,new Tc("cannot parse moov box"),c),e.a(2);case 9:if(v=$c(m,u._config),b=function(){var e=ol(_l().m(function e(r){var n,i;return _l().w(function(e){for(;;)switch(e.n){case 0:if(!(n=vc.findBox(u.buffer,[r])[0])){e.n=4;break}if(!(n.size>n.data.length)){e.n=3;break}return e.n=1,u.loadData([n.start,n.start+n.size-1],t,l);case 1:if(!(i=e.v)){e.n=2;break}return e.a(2,vc.findBox(i.data,[r])[0]);case 2:e.n=4;break;case 3:return e.a(2,n);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),w=!1,v&&v.videoSegments.length&&v.audioSegments.length){e.n=11;break}return e.n=10,b("sidx");case 10:(C=e.v)&&(E=vc.sidx(C))&&(Ac(m,E),fl("segments"),w=!0);case 11:if(Ic(v)){e.n=12;break}return u._error=!0,n(null,i,o,new Tc("cannot parse segments"),c),e.a(2);case 12:u.meta=xc(m,w),T=(k=v).videoSegments,S=k.audioSegments,u.videoSegments=T,u.audioSegments=S,null!==(g=u._config)&&void 0!==g&&g.memoryOpt&&(delete u.buffer,u.bufferDataLen=0),u.logger.debug("[loadMetaProcess] moov ok"),n(void 0,i,{meta:{meta:u.meta,videoSegments:T,audioSegments:S}},null,c);case 13:return e.a(2)}},e,null,[[2,3]])}));return function(t,r,n,i){return e.apply(this,arguments)}}(),e.n=1,this.loadData([s,a||this._config.moovEnd],t,pl({onProgress:c},l));case 1:return e.a(2)}},e,this)})),function(e,t,r){return u.apply(this,arguments)})},{key:"loadMeta",value:(c=ol(_l().m(function e(t,r){var n,i,o,s,a,l,c,u,d,h,p,f,_,y,g,m=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:return n=m.length>2&&void 0!==m[2]?m[2]:{},i=[],this.logger.debug("[loadMeta start]"),e.n=1,this.loadData([0,r||this._config.moovEnd],t,n);case 1:if(o=e.v){e.n=2;break}return e.a(2);case 2:if(i.push(o),s=vc.findBox(o.data,["moov"])[0]){e.n=6;break}if(a=vc.findBox(o.data,["mdat"])[0]){e.n=3;break}throw new Tc("cannot find moov or mdat box",o.data);case 3:return l=a.start+a.size,e.n=4,this.loadData([l],t,n);case 4:if(o=e.v){e.n=5;break}return e.a(2);case 5:if(i.push(o),s=vc.findBox(o.data,["moov"],l)[0]){e.n=6;break}throw new Tc("cannot find moov box",o.data);case 6:if(!(s.size>s.data.length)){e.n=9;break}return e.n=7,this.loadData([o.data.length,s.start+s.size-1],t,n);case 7:if(o=e.v){e.n=8;break}return e.a(2);case 8:i.push(o),s.data=jl(s.data,o.data);case 9:if(c=vc.moov(s)){e.n=10;break}throw new Tc("cannot parse moov box",s.data);case 10:if(Ic(u=$c(c,this._config))){e.n=11;break}throw new Tc("cannot parse segments",s.data);case 11:return u.videoSegments.length&&u.audioSegments.length||(h=vc.findBox(this.buffer,["moof"])[0],p=vc.findBox(this.buffer,["sidx"])[0],h&&h.size<=h.data.length&&p&&(f=vc.moof(h),d=vc.sidx(p),f&&d&&(Ac(c,d),fl("segments")))),this.meta=xc(c,d),y=(_=u).videoSegments,g=_.audioSegments,this.videoSegments=y,this.audioSegments=g,delete this.buffer,this.bufferDataLen=0,this.logger.debug("[load moov end!!!!!]"),e.a(2,{meta:this.meta,videoSegments:y,audioSegments:g,responses:i})}},e,this)})),function(e,t){return c.apply(this,arguments)})},{key:"loadCacheMeta",value:function(e,t){var r=$c(e.moov,this._config),n=r.videoSegments,i=r.audioSegments;this.videoSegments=n,this.audioSegments=i,this._currentSegmentIndex=t,this.meta=e}},{key:"getSegmentByTime",value:function(e){var t,r;return this.videoSegments.length?(t=this.videoSegments.find(function(t){return t.startTime<=e&&t.endTime>e}),t&&(r=this.audioSegments[t.index])):r=this.audioSegments.find(function(t){return t.startTime<=e&&t.endTime>e}),{video:t,audio:r}}},{key:"loadSegmentByTime",value:(l=ol(_l().m(function e(t,r){var n,i,o,s,a,l=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:if(n=!(l.length>2&&void 0!==l[2])||l[2],i=l.length>3&&void 0!==l[3]?l[3]:{},this.isMetaLoaded){e.n=1;break}return e.n=1,this.loadMeta(r);case 1:return o=this.getSegmentByTime(t),s=o.video,a=o.audio,e.a(2,this._loadSegment(s,a,r,n,i))}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"loadNextSegment",value:(a=ol(_l().m(function e(t){var r,n,i,o,s=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:if(r=!(s.length>1&&void 0!==s[1])||s[1],n=s.length>2&&void 0!==s[2]?s[2]:{},this.isMetaLoaded){e.n=1;break}return e.n=1,this.loadMeta();case 1:return i=this.videoSegments[this._currentSegmentIndex+1],o=this.audioSegments[this._currentSegmentIndex+1],e.a(2,this._loadSegment(i,o,t,r,n))}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"preload",value:(s=ol(_l().m(function e(t){var r,n,i,o,s,a,l,c=this;return _l().w(function(e){for(;;)switch(e.n){case 0:if(this.isMetaLoaded){e.n=1;break}return e.n=1,this.loadMeta(!0);case 1:if(t&&!(t<0)){e.n=2;break}return e.a(2);case 2:if(r=this.getSegmentByTime(t),n=r.video,i=r.audio,o=Math.max((null==n?void 0:n.index)||0,(null==i?void 0:i.index)||0)){e.n=3;break}return e.a(2);case 3:return s=this.videoSegments.slice(0,o),a=this.audioSegments.slice(0,o),l=function(){var e=ol(_l().m(function e(t){return _l().w(function(e){for(;;)switch(e.n){case 0:if(!(t>o)){e.n=1;break}return e.a(2);case 1:return e.n=2,c._loadSegment(s[t],a[t],!0,!1);case 2:return e.n=3,l(t+1);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),e.n=4,l(0);case 4:return e.a(2)}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:(o=ol(_l().m(function e(){var t,r=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:if(r.length>0&&void 0!==r[0]&&r[0]){e.n=1;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),e.n=1,this._loader.cancel();case 1:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1,null!==(t=this._config)&&void 0!==t&&t.memoryOpt&&(delete this.buffer,this.bufferDataLen=0);case 2:return e.a(2)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"destroy",value:(i=ol(_l().m(function e(){return _l().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,this.reset();case 1:this.cache.clear();case 2:return e.a(2)}},e,this)})),function(){return i.apply(this,arguments)})},{key:"_loadSegment",value:(n=ol(_l().m(function e(t,r,n,i,o){var s,a;return _l().w(function(e){for(;;)switch(e.n){case 0:if(t||r){e.n=1;break}return e.a(2);case 1:return s=(null==t?void 0:t.index)||(null==r?void 0:r.index)||0,this._currentLoadingSegmentIndex=s,e.p=2,e.n=3,this.loadData([Math.min((null==t?void 0:t.range[0])||1/0,(null==r?void 0:r.range[0])||1/0),Math.max((null==t?void 0:t.range[1])||0,(null==r?void 0:r.range[1])||0)],n,o);case 3:a=e.v;case 4:return e.p=4,this._currentLoadingSegmentIndex=-1,e.f(4);case 5:if(a){e.n=6;break}return e.a(2);case 6:return i&&(this._currentSegmentIndex=s),a.video=t,a.audio=r,e.a(2,a)}},e,this,[[2,,4,5]])})),function(e,t,r,i,o){return n.apply(this,arguments)})},{key:"loadData",value:(r=ol(_l().m(function e(t,r){var n,i,o,s,a,l=arguments;return _l().w(function(e){for(;;)switch(e.n){case 0:return n=l.length>2&&void 0!==l[2]?l[2]:{},i=this._getCacheKey(t),e.n=1,this.cache.get(i);case 1:if(o=e.v){e.n=3;break}return a=null!=n&&n.url?n.url:this.url,e.n=2,this._loader.load(a,pl({range:t,vid:this.vid},n));case 2:s=e.v,e.n=4;break;case 3:s={data:o,state:!0,options:{fromCache:!0,range:t,vid:this.vid}};case 4:if(s){e.n=5;break}return e.a(2);case 5:return o||(s.data&&this.downloadInfo.push({startTime:s.startTime,endTime:s.endTime,size:s.data.byteLength,range:t}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),e.a(2,s)}},e,this)})),function(e,t){return r.apply(this,arguments)})},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}]);var r,n,i,o,s,a,l,c,u,d,h}(Or()),Bc=function(){return ql(function e(){Gl(this,e),Kl(this,"id",1),Kl(this,"type",fc),Kl(this,"codecType","avc"),Kl(this,"pid",-1),Kl(this,"hvcC",void 0),Kl(this,"codec",""),Kl(this,"timescale",0),Kl(this,"formatTimescale",0),Kl(this,"sequenceNumber",0),Kl(this,"baseMediaDecodeTime",0),Kl(this,"baseDts",0),Kl(this,"duration",0),Kl(this,"warnings",[]),Kl(this,"samples",[]),Kl(this,"pps",[]),Kl(this,"sps",[]),Kl(this,"vps",[]),Kl(this,"fpsNum",0),Kl(this,"fpsDen",0),Kl(this,"sarRatio",[]),Kl(this,"width",0),Kl(this,"height",0),Kl(this,"nalUnitSize",4),Kl(this,"present",!1),Kl(this,"isVideoEncryption",!1),Kl(this,"isAudioEncryption",!1),Kl(this,"isVideo",!0),Kl(this,"kid",null),Kl(this,"pssh",null),Kl(this,"ext",void 0)},[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var e=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-e.dts+t.duration}return 0}},{key:"exist",value:function(){return!!/av01/.test(this.codec)||!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}])}(),Nc=function(){return ql(function e(){Gl(this,e),Kl(this,"id",2),Kl(this,"type","audio"),Kl(this,"codecType","aac"),Kl(this,"pid",-1),Kl(this,"codec",""),Kl(this,"sequenceNumber",0),Kl(this,"sampleDuration",0),Kl(this,"timescale",0),Kl(this,"formatTimescale",0),Kl(this,"baseMediaDecodeTime",0),Kl(this,"duration",0),Kl(this,"warnings",[]),Kl(this,"samples",[]),Kl(this,"baseDts",0),Kl(this,"sampleSize",16),Kl(this,"sampleRate",0),Kl(this,"channelCount",0),Kl(this,"objectType",0),Kl(this,"sampleRateIndex",0),Kl(this,"config",[]),Kl(this,"present",!1),Kl(this,"isVideoEncryption",!1),Kl(this,"isAudioEncryption",!1),Kl(this,"kid",null),Kl(this,"isHeAACExt",!1),Kl(this,"ext",void 0)},[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.isHeAACExt=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!!(this.sampleRate&&this.channelCount&&this.codec&&"aac"===this.codecType)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var e=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-e.dts+t.duration}return 0}}])}(),jc=function(){return ql(function e(t,r,n){Gl(this,e),Kl(this,"flag",{}),Kl(this,"keyframe",!1),Kl(this,"gopId",0),Kl(this,"duration",0),Kl(this,"size",0),Kl(this,"units",[]),Kl(this,"chromaFormat",420),this.originPts=this.pts=t,this.originDts=this.dts=r,n&&(this.units=n)},[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}])}(),Uc=ql(function e(t,r,n,i){Gl(this,e),Kl(this,"duration",1024),Kl(this,"flag",{dependsOn:2,isNonSyncSample:0}),Kl(this,"keyframe",!0),this.originPts=this.pts=this.dts=t,this.data=r,this.size=r.byteLength,this.sampleOffset=i,n&&(this.duration=n)}),Vc=function(){return ql(function e(){Gl(this,e),Kl(this,"id",3),Kl(this,"type","metadata"),Kl(this,"timescale",0),Kl(this,"flvScriptSamples",[]),Kl(this,"seiSamples",[])},[{key:"exist",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length||!this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length)}}])}(),Fc=function(){function e(t,r){Gl(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),e.disabled=r}return ql(e,[{key:"debug",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).debug.apply(t,[this._prefix].concat(n))}}},{key:"log",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).log.apply(t,[this._prefix].concat(n))}}},{key:"warn",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).warn.apply(t,[this._prefix].concat(n))}}},{key:"error",value:function(){var t;if(!e.disabled){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=console).error.apply(t,[this._prefix].concat(n))}}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}])}();Kl(Fc,"disabled",!0);var Hc,Gc=null,Wc=["stts","stsc","stsz","stco","co64","stss","ctts"],qc=function(){function e(t,r,n,i){var o,s,a=this;if(Gl(this,e),Kl(this,"_videoSamples",[]),Kl(this,"_audioSamples",[]),Kl(this,"_lastRemainBuffer",[]),Kl(this,"_lastRemainBufferStartPos",0),Kl(this,"videoMaxFrameIdx",-1),Kl(this,"audioMaxFrameIdx",-1),this.videoTrack=new Bc,this.audioTrack=new Nc,this.metadataTrack=n||new Vc,this.videoSegmnents=t,this.audioSegmnents=r,this.log=new Fc("MP4Demuxer",!i||!i.openLog||!i.openLog),this.memoryOpt=null==i?void 0:i.memoryOpt,this.memoryOpt||(t&&t.forEach(function(e){var t;(t=a._videoSamples).push.apply(t,zl(e.frames))}),r&&r.forEach(function(e){var t;(t=a._audioSamples).push.apply(t,zl(e.frames))})),(null===(o=this.videoSegmnents)||void 0===o?void 0:o.length)>0){var l=this.videoSegmnents[this.videoSegmnents.length-1].frames;this.videoMaxFrameIdx=l[l.length-1].index}if((null===(s=this.audioSegmnents)||void 0===s?void 0:s.length)>0){var c=this.audioSegmnents[this.audioSegmnents.length-1].frames;this.audioMaxFrameIdx=c[c.length-1].index}}return ql(e,[{key:"parseSamples",value:function(e){if(!e)throw new Error("moov is required");this.videoTrack.codec||this.audioTrack.codec||(vc.moovToTrack(e,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc,this.memoryOpt&&this.clearBoxEntries(e))}},{key:"demux",value:function(e,t,r,n,i){this.parseSamples(i);var o,s,a,l=this.videoTrack,c=this.audioTrack;l.samples=[],c.samples=[];var u={};if(r){var d,h=0;if(this.memoryOpt&&this.videoSegmnents&&!(u=this.getFramePosByIdx("video",r[0])))throw new Error("cannot found video frame #".concat(r[0]));for(var p=u,f=p.frameIdx,_=p.segmentIdx,y=r[0],g=r[1];y<=g;y++){if(!this._videoSamples.length&&this.videoSegmnents){var m=this.getFrameInfo("video",_,f);o=m.sample,_=m.segmentIdx,f=m.frameIdx}else o=this._videoSamples[y];if(!o)throw new Error("cannot found video frame #".concat(y));a=o.offset-t,s=e.subarray(a,a+o.size),(d=new jc("number"==typeof o.pts?o.pts:o.dts,o.dts)).duration=o.duration,d.gopId=o.gopId,o.keyframe&&d.setToKeyframe();for(var v=0,b=s.length-1;v<b;)h=ec(s,v),v+=4,d.units.push(s.subarray(v,v+h)),v+=h;l.samples.push(d)}l.baseMediaDecodeTime=l.samples[0].dts}if(u={},n){if(this.memoryOpt&&this.audioSegmnents&&!(u=this.getFramePosByIdx("audio",n[0])))throw new Error("cannot found video frame #".concat(n[0]));for(var w=u,C=w.frameIdx,E=w.segmentIdx,k=n[0],T=n[1];k<=T;k++){if(!this._audioSamples.length&&this.audioSegmnents){var S=this.getFrameInfo("audio",E,C);o=S.sample,E=S.segmentIdx,C=S.frameIdx}else o=this._audioSamples[k];if(!o)throw new Error("cannot found video frame #".concat(k));a=o.offset-t,s=e.subarray(a,a+o.size),c.samples.push(new Uc(o.dts,s,o.duration))}c.baseMediaDecodeTime=c.samples[0].dts}return{videoTrack:l,audioTrack:c,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(e,t,r,n,i,o,s,a){if(this.parseSamples(i),this.videoTrack.useEME=o,this.audioTrack.useEME=o,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&t>this._lastRemainBufferStartPos&&t<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var l=0;l<20;)try{var c=this._lastRemainBuffer.subarray(0,t-this._lastRemainBufferStartPos),u=new Uint8Array(e.byteLength+c.byteLength);u.set(c,0),u.set(new Uint8Array(e),c.byteLength),e=u,t-=c.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(e){if(!(l<20))throw new Error("new Uint8Array error:,"+e.errorMessage);l++}var d,h,p,f=this.videoTrack,_=this.audioTrack;f.samples=[],_.samples=[],f.videoSenc=null,_.audioSenc=null,(null==r?void 0:r[1])>this.videoMaxFrameIdx&&this.videoMaxFrameIdx>0&&(r[1]=this.videoMaxFrameIdx),(null==n?void 0:n[1])>this.audioMaxFrameIdx&&this.audioMaxFrameIdx>0&&(n[1]=this.audioMaxFrameIdx);var y=0,g=0,m={},v=e.byteLength+t;if(r.length>0){var b;if(this.memoryOpt&&this.videoSegmnents&&!(m=this.getFramePosByIdx("video",r[0])))throw new Error("cannot found video frame #".concat(r[0]));for(var w=m,C=w.frameIdx,E=w.segmentIdx,k=r[0];k<=r[1];k++){if(!this._videoSamples.length&&this.videoSegmnents){var T=this.getFrameInfo("video",E,C);d=T.sample,E=T.segmentIdx,C=T.frameIdx}else d=this._videoSamples[k];if(!d)throw new Error("cannot found video frame #".concat(k));if(this.memoryOpt&&d.offset+d.size>v)break;d.offset>=t&&d.offset+d.size<=v&&(y=(p=d.offset-t)+d.size,h=e.subarray(p,y),(b=new jc("number"==typeof d.pts?d.pts:d.dts,d.dts)).duration=d.duration,b.gopId=d.gopId,b.sampleOffset=d.index,d.keyframe&&b.setToKeyframe(),b.data=h,b.size=d.size,f.samples.push(b))}f.samples.length>0&&(f.gopId=f.samples[0].gopId,f.baseMediaDecodeTime=f.samples[0].dts,f.startPts=f.samples[0].pts/f.timescale,f.endPts=f.samples[f.samples.length-1].pts/f.timescale,f.startDts=f.samples[0].dts/f.timescale,f.endDts=f.samples[f.samples.length-1].dts/f.timescale,this.videoSenc&&(f.videoSenc=this.videoSenc.slice(f.samples[0].sampleOffset,f.samples[0].sampleOffset+f.samples.length),f.kidValue=s))}if(n.length>0){if(this.memoryOpt&&this.audioSegmnents&&!(m=this.getFramePosByIdx("audio",n[0])))throw new Error("cannot found video frame #".concat(n[0]));for(var S=m,O=S.frameIdx,A=S.segmentIdx,$=n[0];$<=n[1];$++){if(!this._audioSamples.length&&this.audioSegmnents){var P=this.getFrameInfo("audio",A,O);d=P.sample,A=P.segmentIdx,O=P.frameIdx}else d=this._audioSamples[$];if(!d)throw new Error("cannot found video frame #".concat($));if(this.memoryOpt&&d.offset+d.size>v)break;d.offset>=t&&d.offset+d.size<=v&&(g=(p=d.offset-t)+d.size,h=e.subarray(p,g),_.samples.push(new Uc(d.dts,h,d.duration,d.index)))}_.samples.length>0&&(_.gopId=_.samples[0].gopId||f.gopId,_.baseMediaDecodeTime=_.samples[0].dts,_.startPts=_.samples[0].pts/_.timescale,_.endPts=_.samples[_.samples.length-1].pts/_.timescale,this.audioSenc&&(_.audioSenc=this.audioSenc.slice(_.samples[0].sampleOffset,_.samples[0].sampleOffset+_.samples.length),_.kidValue=s))}this.decoderData(f,_,a);for(var R=0,x=0;x<f.samples.length;x++)for(var L=0,I=f.samples[x].data,M=I.length-1;L<M;)R=ec(I,L),L+=4,f.samples[x].units.push(I.subarray(L,L+R)),L+=R;var D=Math.max(y,g);return this._lastRemainBuffer=e.subarray(D),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=t+e.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:f,audioTrack:_,metadataTrack:this.metadataTrack,lastRemainBufferInfo:{data:this._lastRemainBuffer,pos:this._lastRemainBufferStartPos}}}},{key:"setLastRemainBufferInfo",value:function(e,t){this._lastRemainBuffer=e,this._lastRemainBufferStartPos=t}},{key:"reset",value:function(){this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(t,r,n){if(!t.useEME&&!r.useEME&&(null!=t&&t.videoSenc||null!=r&&r.audioSenc)){if(!e.Crypto)throw new Error("Crypto is not defined");e.Crypto.decoderAESCTRData(t,r,n)}}},{key:"getFramePosByIdx",value:function(e,t){var r="video"===e?this.videoSegmnents:this.audioSegmnents;if(!r||null==r||!r.length)return null;for(var n,i=0,o=0;o<r.length;o++){var s,a;if(n=r[o].frames,t<=(null===(s=r[o].frames)||void 0===s?void 0:s[(null===(a=n)||void 0===a?void 0:a.length)-1].index)){i=o;break}}return{frameIdx:n.findIndex(function(e){return e.index===t}),segmentIdx:i}}},{key:"getFrameInfo",value:function(e,t,r){var n,i,o,s="video"===e?this.videoSegmnents:this.audioSegmnents;return s?r<(null===(n=s[t])||void 0===n||null===(n=n.frames)||void 0===n?void 0:n.length)?{sample:null===(i=s[t])||void 0===i?void 0:i.frames[r],segmentIdx:t,frameIdx:r+1}:{sample:null===(o=s[t+1])||void 0===o?void 0:o.frames[0],segmentIdx:t+1,frameIdx:1}:{}}},{key:"clearBoxEntries",value:function(e){this.memoryOpt&&e.trak.forEach(function(e){Wc.forEach(function(t){var r=e.mdia.minf.stbl[t];r&&(r.entries&&(r.entries=null),r.entrySizes&&(r.entrySizes=null))})})}}],[{key:"Crypto",get:function(){return Gc},set:function(e){Gc=e}},{key:"probe",value:function(e){return vc.probe(e)}}])}(),Kc=function(){return ql(function e(){Gl(this,e),this.buffer=new Uint8Array(0)},[{key:"write",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){t?e.buffer=function(e){for(var t=0,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];n.forEach(function(e){t+=e.length});var o=new e(t),s=0;return n.forEach(function(e){o.set(e,s),s+=e.length}),o}(Uint8Array,e.buffer,t):window.console.warn(t)})}}],[{key:"writeUint16",value:function(e){return new Uint8Array([e>>8&255,255&e])}},{key:"writeUint32",value:function(e){return new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e])}}])}(),zc=Math.pow(2,32)-1,Zc=function(){function e(){Gl(this,e)}return ql(e,null,[{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=8+(r=r.filter(Boolean)).reduce(function(e,t){return e+t.byteLength},0),o=new Uint8Array(i);o[0]=i>>24&255,o[1]=i>>16&255,o[2]=i>>8&255,o[3]=255&i,o.set(e,4);var s=8;return r.forEach(function(e){o.set(e,s),s+=e.byteLength}),o}},{key:"FullBox",value:function(t,r,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return e.box.apply(e,[t,new Uint8Array([r,n>>16&255,n>>8&255,255&n])].concat(o))}},{key:"ftyp",value:function(t){return t.find(function(e){return e.type===fc&&e.codecType===_c})?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){return Xl(e.ftyp(t),e.moov(t))}},{key:"pssh",value:function(t){var r=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],ic(t.kid),[0,0,0,0]));return e.box(e.types.pssh,r)}},{key:"moov",value:function(t){if(t[0].useEME&&(t[0].encv||t[0].enca)){t[0].pssh||(t[0].pssh={kid:t[0].kid});var r=this.pssh(t[0].pssh);return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),e.mvex(t)].concat(zl(t.map(function(t){return e.trak(t)})),[r]))}return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat(zl(t.map(function(t){return e.trak(t)})),[e.mvex(t)]))}},{key:"mvhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,i>>8&255,255&i,0,0]))}},{key:"edts",value:function(t){return e.box(e.types.edts,e.elst(t))}},{key:"elst",value:function(t){t.entries;var r=t.entriesData,n=t.version;return e.FullBox(e.types.elst,n,0,r)}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]))}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===fc?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){return t&&t.ext,e.box(e.types.stbl,e.stsd(t),e.STTS,[][0],e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){var r;return r="audio"===t.type?t.useEME&&t.enca?e.enca(t):e.mp4a(t):t.useEME&&t.encv?e.encv(t):t.av1C?e.av01(t):e.avc1hev1vvc1(t),e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),r)}},{key:"enca",value:function(t){var r=t.enca.channelCount,n=t.enca.sampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,r,0,16,0,0,0,0,n>>8&255,255&n,0,0]),o=e.esds(t.config),s=e.sinf(t.enca);return e.box(e.types.enca,i,o,s)}},{key:"encv",value:function(t){var r,n,i=t.sps.length>0?t.sps[0]:[],o=t.pps.length>0?t.pps[0]:[],s=t.width,a=t.height,l=t.sarRatio[0],c=t.sarRatio[1],u=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,s>>8&255,255&s,a>>8&255,255&a,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d=new Uint8Array((r=(n=[1,i[1],i[2],i[3],255,225,i.length>>>8&255,255&i.length]).concat.apply(n,zl(i)).concat([1,o.length>>>8&255,255&o.length])).concat.apply(r,zl(o))),h=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),p=e.sinf(t.encv),f=new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,c>>24,c>>16&255,c>>8&255,255&c]);return e.box(e.types.encv,u,e.box(e.types.avcC,d),e.box(e.types.btrt,h),p,e.box(e.types.pasp,f))}},{key:"schi",value:function(t){var r=new Uint8Array([]),n=e.tenc(t);return e.box(e.types.schi,r,n)}},{key:"tenc",value:function(t){var r=new Uint8Array([0,0,0,0,0,0,255&t.default_IsEncrypted,255&t.default_IV_size].concat(ic(t.default_KID)));return e.box(e.types.tenc,r)}},{key:"sinf",value:function(t){var r=new Uint8Array([]),n=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),i=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),o=e.schi(t);return e.box(e.types.sinf,r,e.box(e.types.frma,n),e.box(e.types.schm,i),o)}},{key:"av01",value:function(t){return e.box(e.types.av01,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t.av1C,t.colr)}},{key:"avc1hev1vvc1",value:function(t){var r,n;t.codecType===_c?(r=e.hvcC(t),n=e.types.hvc1):t.codecType===yc?(r=e.vvcC(t),n=e.types.bvc2):(r=e.avcC(t),n=e.types.avc1);var i=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r];return t.codecType===_c?i.push(e.box(e.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&i.push(e.pasp(t.sarRatio)),e.box.apply(e,[n].concat(i))}},{key:"avcC",value:function(t){var r,n,i,o=[],s=[];return t.sps.forEach(function(e){i=e.byteLength,o.push(i>>>8&255),o.push(255&i),o.push.apply(o,zl(e))}),t.pps.forEach(function(e){i=e.byteLength,s.push(i>>>8&255),s.push(255&i),s.push.apply(s,zl(e))}),e.box(e.types.avcC,new Uint8Array((r=(n=[1,o[3],o[4],o[5],255,224|t.sps.length]).concat.apply(n,o).concat([t.pps.length])).concat.apply(r,s)))}},{key:"vvcC",value:function(t){var r=t.vvcC;return e.box(e.types.bv2C,new Uint8Array(r))}},{key:"hvcC",value:function(t){var r=t.hvcC;if(r instanceof ArrayBuffer||r instanceof Uint8Array)return r;var n,i=t.vps,o=t.sps,s=t.pps;if(r){var a=r.generalProfileCompatibilityFlags,l=r.generalConstraintIndicatorFlags,c=(i.length&&1)+(o.length&&1)+(s.length&&1);n=[1,r.generalProfileSpace<<6|r.generalTierFlag<<5|r.generalProfileIdc,a>>>24,a>>>16,a>>>8,a,l[0],l[1],l[2],l[3],l[4],l[5],r.generalLevelIdc,240,0,252,252|r.chromaFormatIdc,248|r.bitDepthLumaMinus8,248|r.bitDepthChromaMinus8,0,0,r.numTemporalLayers<<3|r.temporalIdNested<<2|3,c];var u=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,zl(e))};i.length&&(n.push(160,0,i.length),i.forEach(u)),o.length&&(n.push(161,0,o.length),o.forEach(u)),s.length&&(n.push(162,0,s.length),s.forEach(u))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var r,n,i=(n=2,function(e){if(Array.isArray(e))return e}(r=t)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(r,n)||Yl(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],s=i[1];return e.box(e.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var r=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+r,0,0,0,4,15+r,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([r]).concat(t).concat([6,1,2])))}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat(zl(t.map(function(t){return e.trex(t.id)}))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trex1",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]))}},{key:"trex2",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]))}},{key:"moof",value:function(t){return e.box.apply(e,[e.types.moof,e.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat(zl(t.map(function(t){return e.traf(t)}))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){var r=e.tfhd(t.id),n=e.tfdt(t.baseMediaDecodeTime),i=0;if(t.isVideo&&t.videoSenc&&t.videoSenc.forEach(function(e){i+=8,e.subsamples&&e.subsamples.length&&(i+=2,i+=6*e.subsamples.length)}),t.videoSencLength=i,t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)){if(t.isVideoEncryption){if(t.isVideo){var o=e.saiz(t),s=e.saio(t),a=e.trun1(t),l=e.senc(t);return e.box(e.types.traf,r,n,o,s,a,l)}if(t.isAudioEncryption){var c=e.sbgp(),u=e.saiz(t),d=e.saio(t),h=e.senc(t),p=e.trun1(t);return e.box(e.types.traf,r,n,c,u,d,h,p)}var f=e.sbgp(),_=e.trun1(t);return e.box(e.types.traf,r,n,f,_)}if(t.isVideo){var y=e.trun1(t);return e.box(e.types.traf,r,n,y)}var g=e.sbgp(),m=e.saiz(t),v=e.saio(t),b=e.senc(t),w=e.trun1(t);return e.box(e.types.traf,r,n,g,m,v,b,w)}var C=e.sdtp(t);return e.box(e.types.traf,r,n,C,e.trun(t.samples,C.byteLength+76))}},{key:"sdtp",value:function(t){var r=new Kc;return t.samples.forEach(function(e){r.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))}),e.box(e.types.sdtp,this.extension(0,0),r.buffer)}},{key:"trun1",value:function(t){var r=new Kc,n=Kc.writeUint32(t.samples.length),i=null;if(t.isVideo){var o=t.videoSencLength;i=Kc.writeUint32(76+16*t.samples.length+o+77),!t.isVideoEncryption&&t.isAudioEncryption&&(i=Kc.writeUint32(76+16*t.samples.length+20))}else{var s=76+12*t.samples.length+52;t.isAudioEncryption&&(s=76+12*t.samples.length+8*t.audioSenc.length+105),i=Kc.writeUint32(s)}return t.samples.forEach(function(e){r.write(Kc.writeUint32(e.duration)),r.write(Kc.writeUint32(e.size)),r.write(Kc.writeUint32(e.keyframe?33554432:65536)),t.isVideo&&r.write(Kc.writeUint32(e.cts?e.cts:0))}),e.box(e.types.trun,this.extension(0,t.flags),n,i,r.buffer)}},{key:"senc",value:function(t){var r=new Kc,n=t.samples.length,i=t.isVideo?16:8,o=t.isVideo?2:0,s=[],a=0;return t.isVideo?(s=t.videoSenc,a=t.videoSencLength):s=t.audioSenc,a=a||i*n,r.write(Kc.writeUint32(16+a),e.types.senc,this.extension(0,o)),r.write(Kc.writeUint32(n)),s.forEach(function(e){for(var t=0;t<e.InitializationVector.length;t++)r.write(new Uint8Array([e.InitializationVector[t]]));e.subsamples&&e.subsamples.length&&(r.write(Kc.writeUint16(e.subsamples.length)),e.subsamples.forEach(function(e){r.write(Kc.writeUint16(e.BytesOfClearData)),r.write(Kc.writeUint32(e.BytesOfProtectedData))}))}),r.buffer}},{key:"saio",value:function(t){var r=12*t.samples.length+141;!t.isVideo&&t.isAudioEncryption&&(r=149);var n=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r]);return e.box(e.types.saio,n)}},{key:"saiz",value:function(t){var r=t.samples.length,n=new Uint8Array([0,0,0,0,16,r>>24&255,r>>16&255,r>>8&255,255&r]);return e.box(e.types.saiz,n)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return e.box(e.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t){var r=Math.floor(t/(zc+1)),n=Math.floor(t%(zc+1));return e.box(e.types.tfdt,new Uint8Array([1,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n]))}},{key:"trun",value:function(t,r){var n=t.length,i=12+16*n;r+=8+i;var o=new Uint8Array(i);o.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0);for(var s=0;s<n;s++){var a=t[s],l=a.duration,c=a.size,u=a.flag,d=void 0===u?{}:u,h=a.cts,p=void 0===h?0:h;o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,c>>>24&255,c>>>16&255,c>>>8&255,255&c,d.isLeading<<2|(null===d.dependsOn||void 0===d.dependsOn?1:d.dependsOn),d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|(null===d.isNonSyncSample||void 0===d.isNonSyncSample?1:d.isNonSyncSample),61440&d.degradationPriority,15&d.degradationPriority,p>>>24&255,p>>>16&255,p>>>8&255,255&p],12+16*s)}return e.box(e.types.trun,o)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(zl(t.map(function(t){return e.trackMP4(t)}))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===fc?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var r=t.ext,n=[e.stsd(t),e.stts(r.stts),e.stsc(r.stsc),e.stsz(r.stsz),e.stco(r.stco)];return r.stss.length&&n.push(e.stss(r.stss)),r.ctts.length&&n.push(e.ctts(r.ctts)),e.box.apply(e,[e.types.stbl].concat(n))}},{key:"stts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach(function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8}),e.box(e.types.stts,Xl(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsc",value:function(t){var r=t.length,n=new Uint8Array(12*r),i=0;return t.forEach(function(e){var t=e.firstChunk,r=e.samplesPerChunk,o=e.sampleDescIndex;n.set([t>>24,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,o>>24,o>>16&255,o>>8&255,255&o],i),i+=12}),e.box(e.types.stsc,Xl(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stsz",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stsz,Xl(new Uint8Array([0,0,0,0,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stco",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stco,Xl(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"stss",value:function(t){var r=t.length,n=new Uint8Array(4*r),i=0;return t.forEach(function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],i),i+=4}),e.box(e.types.stss,Xl(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"ctts",value:function(t){var r=t.length,n=new Uint8Array(8*r),i=0;return t.forEach(function(e){var t=e.value,r=e.count;n.set([r>>24,r>>16&255,r>>8&255,255&r,t>>24,t>>16&255,t>>8&255,255&t],i),i+=8}),e.box(e.types.ctts,Xl(new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r]),n))}},{key:"styp",value:function(){return e.box(e.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var r=t.timescale,n=t.samples[0].duration,i=n*t.samples.length,o=t.samples[0].sampleOffset*n,s=8;t.samples.forEach(function(e){s+=e.size});var a=0;if(t.isVideo){var l,c=0;t.videoSenc&&(l=t.videoSenc),t.isVideo&&l.forEach(function(e){c+=8,e.subsamples&&e.subsamples.length&&(c+=2,c+=6*e.subsamples.length)}),t.videoSencLength=c,a=s+141+16*t.samples.length+c,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(a=s+16*t.samples.length+84)}else a=s+116+12*t.samples.length,t.useEME&&t.isAudioEncryption&&(a=s+169+12*t.samples.length+8*t.audioSenc.length);var u=new Uint8Array([0,0,0,0,0,0,0,255&t.id,r>>24&255,r>>16&255,r>>8&255,255&r,o>>24&255,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,1,0,a>>16&255,a>>8&255,255&a,i>>24&255,i>>16&255,i>>8&255,255&i,144,0,0,0]);return e.box(e.types.sidx,u)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}}])}();Hc=Zc,Kl(Zc,"types",["av01","av1C","avc1","avcC","hvc1","hvcC","dinf","dref","edts","elst","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp","bvc2","bv2C"].reduce(function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e},Object.create(null))),Kl(Zc,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),Kl(Zc,"FTYPAVC1",Hc.box(Hc.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),Kl(Zc,"FTYPHEV1",Hc.box(Hc.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),Kl(Zc,"DINF",Hc.box(Hc.types.dinf,Hc.box(Hc.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),Kl(Zc,"VMHD",Hc.box(Hc.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),Kl(Zc,"SMHD",Hc.box(Hc.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),Kl(Zc,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),Kl(Zc,"STTS",Hc.box(Hc.types.stts,Hc.StblTable)),Kl(Zc,"STSC",Hc.box(Hc.types.stsc,Hc.StblTable)),Kl(Zc,"STSZ",Hc.box(Hc.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),Kl(Zc,"STCO",Hc.box(Hc.types.stco,Hc.StblTable));var Yc=function(){return ql(function e(t,r,n){Gl(this,e),this.videoTrack=t,this.audioTrack=r;var i=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=i&&Number(i[1])<50,this.log=new Fc("FMP4Remuxer",!n||!n.openLog||!n.openLog)},[{key:"remux",value:function(){var e,t,r,n,i,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.videoTrack,l=this.audioTrack,c=a.exist(),u=l.exist(),d=[];return o&&(s&&s.initMerge?(c&&d.push(this.videoTrack),u&&d.push(this.audioTrack),r=Zc.initSegment(d)):(c&&(e=Zc.initSegment([this.videoTrack])),u&&(t=Zc.initSegment([this.audioTrack])))),c&&a.hasSample()&&(n=this._remuxVideo()),u&&l.hasSample()&&(i=this._remuxAudio()),a.samples=[],l.samples=[],{initSegment:r,videoInitSegment:e,audioInitSegment:t,videoSegment:n,audioSegment:i}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack;this.forceFirstIDR&&(e.samples[0].flag={dependsOn:2,isNonSyncSample:0});var t=e.samples,r=/av01/.test(e.codec),n=0;r?t.forEach(function(e){n+=e.data.byteLength}):t.forEach(function(e){n+=e.units.reduce(function(e,t){return e+t.byteLength},0),n+=4*e.units.length});var i=new Uint8Array(n);if(r)for(var o,s=0,a=t.length,l=0;s<a;s++)o=t[s],i.set(o.data,l),o.size=o.data.byteLength,l+=o.size;else for(var c,u=new DataView(i.buffer),d=function(e,r){r=t[h];var n=0;r.units.forEach(function(t){u.setUint32(e,t.byteLength),e+=4,i.set(t,e),e+=t.byteLength,n+=4+t.byteLength}),r.size=n,f=e,c=r},h=0,p=t.length,f=0;h<p;h++)d(f,c);var _=Zc.mdat(i);return Xl(Zc.moof([e]),_)}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=new Uint8Array(e.samples.reduce(function(e,t){return e+t.size},0));e.samples.reduce(function(e,r){return t.set(r.data,e),e+r.size},0);var r=Zc.mdat(t);return Xl(Zc.moof([e]),r)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}])}(),Xc=Object.defineProperty,Qc=(e,t,r)=>((e,t,r)=>t in e?Xc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const Jc={MEDIA_EXPIRED:"MEDIA_EXPIRED",INIT_FAIL:"INIT_FAIL",PARSE_ERROR:"PARSE_ERROR",PLAYER_LOG:"PLAYER_LOG",BUFFERED_RESET:"BUFFERED_RESET"},eu="real_time_speed",tu="is unsupported",ru="buffer_control",nu="cdn",iu="pcdn",ou=new Map,su=new Map,au=new Map,lu="gop",cu="size",uu={BUFFER_CONTROLS:"buffer_control"},du="timer_update",hu="h264",pu="h265",fu="h266",_u="0.3.16",yu={416:na[ra.NETWROK_RANGE_NOT_SATISFIABLE],403:na[ra.NETWORK_FORBIDDEN],404:na[ra.NETWORK_NOTFOUND],timeout:na[ra.NETWORK_TIMEOUT],"4xx":`${na[ra.NETWORK]}4XX`,"5xx":`${na[ra.NETWORK]}5XX`,networkError:na[ra.NETWORK],contentError:`${na[ra.NETWORK]}contentError`,mse:na[ra.MEDIA][ra.SUB_TYPES.MSE_OTHER],mseOpen:na[ra.MEDIA][ra.SUB_TYPES.MSE_ADD_SB],mseAppend:na[ra.MEDIA][ra.SUB_TYPES.MSE_APPEND_BUFFER],mse_hijack:na[ra.MEDIA][ra.SUB_TYPES.MSE_HIJACK],eme_hijack:na[ra.MEDIA][ra.SUB_TYPES.EME_HIJACK],metaError:na[ra.DEMUX][ra.SUB_TYPES.MP4],muxError:na[ra.REMUX][ra.SUB_TYPES.FMP4],other:na[ra.OTHER],waitTimeout:na[ra.RUNTIME][ra.SUB_TYPES.BUFFERBREAK_ERROR],waitTimeoutWithHidden:na[ra.RUNTIME][ra.SUB_TYPES.WAITING_TIMEOUT_ERROR],drm:na[ra.DRM][ra.SUB_TYPES.LICENSE]},gu=ra;class mu{constructor(e,t,r){let n=0,i=0;r&&r.range&&r.range.length>1&&(n=r.range[0],i=r.range[1]);const o=function(e){return yu[e]||e}(t);return{errorCode:o,errorType:e,errorMessage:(null==r?void 0:r.httpText)||(null==r?void 0:r.message),url:null==r?void 0:r.url,httpCode:t,version:_u,rangeStart:n,rangeEnd:i,ext:r,mediaError:{code:o,message:(null==r?void 0:r.httpText)||(null==r?void 0:r.message)}}}}class vu{constructor(e,t,r){return{errorCode:t,errorType:e,version:_u,errorMessage:r.msg,ext:r,mediaError:{code:t,message:r.msg}}}}const bu=[{range:[0,90],size:614400},{range:[90,120],size:819200},{range:[120,Number.MAX_VALUE],size:1024e3}];function wu(e,t,r){let n=r>51200?Math.min(r,t):t;if(!e)return n;for(let i=0;i<bu.length;i++)if(e>=bu[i].range[0]&&e<bu[i].range[1]){n=Math.min(Math.max(n,bu[i].size),r>0?r:t);break}return n}const Cu=function(){try{return typeof localStorage<"u"&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch{return!1}}()&&!function(){const e="_localstorage_support_test";try{return window.localStorage.setItem(e,!0),window.localStorage.removeItem(e),!1}catch{return!0}}(),Eu=Su(),ku=function(){if(Cu)try{return!!window.localStorage.getItem("playertestlog")}catch{return!1}return!1}(),Tu={1:"debug",2:"log",3:"warn",4:"error"};function Su(){if(Cu)try{return!!window.localStorage.getItem("playerlog")}catch{return!1}return!1}function Ou(e,t,r,...n){const i=Tu[t];i&&e&&e[i]&&e[i](r,...n)}function Au(e="div",t="",r={},n=""){const i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach(t=>{const n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)}),i}function $u(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]}function Pu(){try{return parseInt(performance.now(),10)}catch{return(new Date).getTime()}}function Ru(e,t){try{const r=e.indexOf("?");return r<0?Object.keys(t).forEach((r,n)=>{e+=0===n?`?${r}=${t[r]}`:`&${r}=${t[r]}`}):Object.keys(t).forEach(n=>{r===e.length-1?e+=`${n}=${t[n]}`:e+=`&${n}=${t[n]}`}),e}catch{return e}}function xu(e,t){return Object.keys(t).forEach(r=>{const n=$u(t[r]),i=$u(e[r]);"Array"===n?("Array"!==i&&(e[r]=[]),e[r].push(...t[r])):"Object"===n?("Object"!==i&&(e[r]={}),xu(e[r],t[r])):e[r]=t[r]}),e}function Lu(e,t){try{return e&&t?parseInt(t*e/8,10):0}catch{return 0}}function Iu(e,t){const r=[];let n=0;e&&r.push(e),t&&r.push(t),r.every(e=>(e&&(n+=e.byteLength),!0));const i=new Uint8Array(n);let o=0;return r.every(e=>(e&&(i.set(e,o),o+=e.byteLength),!0)),i}function Mu(e,t,r){let n=null,i=null;return n=e<t.length-1?t[e]:t[t.length-1],i=e<r.length-1?r[e]:r[r.length-1],[Math.min((null==n?void 0:n.range[0])||1/0,(null==i?void 0:i.range[0])||1/0),Math.max(null==n?void 0:n.range[1],null==i?void 0:i.range[1])]}function Du(e){if("String"!==$u(e)||!e)return"";const t=e.split("/");let r="";return t.length>3&&t[2]&&(r=t[2]),r}function Bu(e){let t,r=0;for(;r<10;)try{if(t=new Uint8Array(e),t&&t.byteLength>0)break;r++}catch{r<10?r++:console.error("repeat data cache  new array failed final",10)}return t}const Nu={playBtnClick:(e,t,r,n)=>{e.paused||e.waitingMoreBuffer&&(e.waitingMoreBuffer=!1),n.call(e,t,r)}},ju={waiting:(e,t)=>{const{player:r,eventName:n}=e;r.waitingMoreBuffer=!0,t(n,e)},play:(e,t)=>{const{player:r,eventName:n}=e;r.waitingMoreBuffer||t(n,e)},pause:(e,t)=>{const{player:r,eventName:n}=e;r.waitingMoreBuffer||t(n,e)},seeking:(e,t)=>{const{player:r,eventName:n}=e;r.isSeekingStart=!0,t(n,e)},progress:(e,t)=>{Ou(">>>>progress");const{player:r,eventName:n}=e;if(r.waitingMoreBuffer){const e=r.getBufferedRange(r.buffered2);0===e[0]&&0===e[1]||(void 0===r.inWaitingStart||r.isSeekingStart?(Ou("progress startplay or seek ended"),e[1]-r.currentTime>=(r.config.canplayWaterLevel||1)||e[1]>r.duration-1?(Ou("progress out bufferWaterLevel"),r.play()):(Ou("progress not out bufferWaterLevel"),r.emit("waiting"))):(Ou("progress video waiting end"),e[1]-r.currentTime>=(r.config.bufferWaterLevel||5)||e[1]>r.duration-1?(Ou("progress out bufferWaterLevel"),r.play()):(Ou("progress not out bufferWaterLevel"),r.emit("waiting"))))}t(n,e)},playing:(e,t)=>{const{player:r,eventName:n}=e;Ou("playing");const i=r.getBufferedRange(r.buffered2);if(0===i[0]&&0===i[1])return Ou("playing currentTime no buffer, not out bufferWaterLevel"),r.waitingMoreBuffer=!0,r.pause(),void t.call("waiting",e);void 0===r.inWaitingStart||r.isSeekingStart?(Ou("playing startplay or seek ended"),i[1]-r.currentTime>=(r.config.canplayWaterLevel||1)||i[1]>r.duration-1?(Ou("playing out bufferWaterLevel"),r.waitingMoreBuffer=!1,r.isSeekingStart=!1,t(n,e)):(Ou("playing not out bufferWaterLevel"),r.waitingMoreBuffer=!0,r.pause(),t.call("waiting",e))):(Ou("playing video waiting ended"),i[1]-r.currentTime>=(r.config.bufferWaterLevel||5)||i[1]>r.duration-1?(Ou("playing out bufferWaterLevel"),r.waitingMoreBuffer=!1,t(n,e)):(Ou("playing not out bufferWaterLevel"),r.waitingMoreBuffer=!0,r.pause(),t.call("waiting",e)))}};function Uu(e,t){return Math.round(8*e*1e3/t/1024)}function Vu(e){var t,r;return!((null==(t=null==e?void 0:e.message)?void 0:t.indexOf("Failed to fetch"))>=0||null!=e&&e.response&&(null==(r=e.response)?void 0:r.status)>=400&&e.response.status<=599)}function Fu(e,t,r){e.video&&e.video.addEventListener(t,r)}function Hu(e,t,r){e.video&&e.video.removeEventListener(t,r)}function Gu(e){return e&&e.video&&"function"==typeof e.video.getStats?e.video.getStats():null}function Wu(e){const{kid:t,drmKeyToken:r,secretKey:n,keyValue:i,drm:o}=e;return t||r||n||i||o}function qu(e){const{cachedBufferDur:t,loadTarDuration:r,loadDuration:n,forceSetMin:i}=e,{PCDNInBuffer:o,PCDNOutBuffer:s,loadSize:a}=e;return{buffer_dur:t||-1,load_tar_dur:r||-1,load_dur:n||-1,force_set_min:i,in_buf:o||-1,out_buf:s||-1,load_size:a||-1}}const Ku={"x-cache":"x_cache","x-response-sinfo":"server_ip","x-response-cinfo":"x-response-cinfo","content-range":"content-range","content-length":"content-length","content-type":"content-type"};function zu(e){const t={};return!e||!e.get||Object.keys(Ku).forEach(r=>{const n=Ku[r];e.get(r)&&(t[n]=e.get(r))}),t}function Zu(e){const t=Ku["content-range"];if(e&&e.get&&e.get(t)){const r=e.get(t).split("/");if(2===(null==r?void 0:r.length))return r[1]}return null}const Yu="error",Xu="metaReady",Qu="moov_request_Progress",Ju="progress_event",ed="updateEME",td="init_MSE",rd="chaneg_url",nd="update_load_fragmentIdx",id="remove_pcdn_node",od="load_error",sd="cancel_loaded_len",ad="load_len_not_match_error",ld="close",cd="forbidden",ud={},dd=class e extends Sr{constructor(t,r,n,i=[],o){var s;super(),Qc(this,"markErrHost",e=>{e&&(ud[e]=!0,this.log(zs.WARN,"[mp4loader markErrHost]",e))}),Qc(this,"onprogressDataArrive",async(e,t,r,n)=>{var i;const o=(null==(i=null==r?void 0:r.priOptions)?void 0:i.type)||nu,s=this.adaptTimeRange[r.index].range;if(e&&e.byteLength>0?(!this._optionDataLenInfo[o]&&(this._optionDataLenInfo[o]=0),this._optionDataLenInfo[o]+=e.byteLength,this._receiveDataPos=null==r?void 0:r.range[1],s&&r.range[1]>s[1]&&!t&&(t=!0,this.log(zs.LOG,"[onprogressDataArrive] receive data, check state set true >>> index,",r.index,",range,",JSON.stringify(r.range))),this.cacheRepeatData(this.adaptTimeRange[r.index].repeatRange,r.range,e),this.log(zs.LOG,"[onprogressDataArrive] receive data, >>> index,",r.index,",range,",JSON.stringify(r.range),", dataLen,",e.byteLength,",loadType,",o,t),this._mux(e,r.range[0],r.index,t)):this.log(zs.LOG,"[onprogressDataArrive] receive data null, >>> index,",r.index,",range,",JSON.stringify(r.range),", dataLen,",null==e?void 0:e.byteLength,",loadType,",o,t),t){this._optionDataLenInfo[o]=0;const e=zu(n.headers);this.totalSize||(this.totalSize=function(e){try{const t=Object.keys(e).filter(e=>"content-range"===e);if(t.length>0){const r=e[t[0]].split("/");if(2===(null==r?void 0:r.length))return parseInt(r[1],10)}return 0}catch(e){return console.error(e),0}}(e));const t=s&&s.length>=0?Number(s[1]):0;if((null==s?void 0:s.length)>0&&(!t||t&&((null==r?void 0:r.range[1])===t+1||this.totalSize===t)))this.adaptTimeRange[r.index].downloaded=!0,this.log(zs.LOG,"[FragLoadDowned],fragmentIdx,",r.index,",rangeEnd,",r.range[1]);else{await this.cancelLoading();const{startTime:t,endTime:i}=this.adaptTimeRange[r.index];this.emit(ad,[t,i]);const a=o===nu?this.url:this._pcdnNodeList[0].url,l=Du(a);this.emit(od,{src:a,host:l,errorCode:yu.contentError,message:"progress dataLen not match",range:JSON.stringify(s),headers:e}),this.log(zs.LOG,"[FragLoadDowned check false, len is not match],fragmentIdx,",r.index,",rangeEnd,",r.range[1],JSON.stringify(s),JSON.stringify(e),a,null==n?void 0:n.url),await this.loadAllFragmentData(this._curLoadSegIdx,this._loadSuccessCallBack)}}}),this.timeRecord={startMuxTime:-1,startLoadTime:-1,newMP4Time:Pu(),startLoadMetaTime:-1},this.updateUrl(t,i||[]),this._bitRate=r||0,this.options=e.getDefaultConfig(),Object.keys(n).map(e=>{void 0!==n[e]&&null!==n[e]&&(this.options[e]=n[e])}),this.logger=n.logger,this.timeRange=[],this.adaptTimeRange=[],this.firstFrameTime=o||{},this.fileSize=null==n?void 0:n.fileSize,this.totalSize=0,this.CHUNK_SIZE=(null==(s=this.options)?void 0:s.firstLoadSize)||wu(n.duration,this.options.chunkSize,this.fileSize),this._firstLoadSize=this.CHUNK_SIZE,this.log(zs.LOG,"[getFirstLoadSize], firstLoadSize ",this._firstLoadSize,",dur,",n.duration,",chunkSize,",this.CHUNK_SIZE,",fileSize,",this.fileSize),this._repeatInfo={startPos:-1,curDataPos:0,usedPos:0,data:Bu(1048576)},this.meta=null,this.preloadCache=null,this.videoTrak=null,this.audioTrak=null,this._loadSuccessCallBack=null,this._isPending=!1,this.metaLoading=!1,this.MP4Loader=new Dc({url:t,vid:`${n.vid}-${r}`,retry:n.retryCount||2,retryDelay:n.retryDelay||1e3,timeout:n.timeout||3e3,segmentDuration:n.segmentDuration,fixEditListOffset:n.fixEditListOffset,...n.reqOptions,loaderType:n.loaderType,retryCheckFunc:Vu,openLog:Eu}),this.MP4Demuxer=null,this.FMP4Remuxer=null,this._needInitSegment=!0,this._bitRateInfoMap=new Map,this._switchBitRate=!1,this._segmentToBitRateMap=new Map,this.useEME=!1,this.secretKey=null,this.decryptKey=null,this.keyValue=null,this.initTransMuxWorker(),this.seekTime=-1,this.changeBitRateTime=-1,this._PCDNState=ld,this._pcdnNodeList=[],this.loadInfo={},this.pcdnTraceInfo=null,this._loadedDataState=!1,this._PCDNSwitchCnt=0,this._isUseCDN=!0,this._curLoadSegIdx=0,this._receiveDataPos=-1,this._optionDataLenInfo={},this._lastPCDNUrl="",this._lastTargetDur=0,this.pcdnVVStat=this.resetPCDNVVStat(),this.pSCCancelCnt=0,this._lastDemuxSampleIdxRange={video:0,audio:0},this._mediaEndTime=-1}static get pcdnDownLoadReqCnt(){const{pcdn_download_request_cnt:t,pcdn_download_failed_cnt:r}=e;return e.pcdn_download_request_cnt=0,e.pcdn_download_failed_cnt=0,{pcdn_download_request_cnt:t,pcdn_download_failed_cnt:r}}static getDefaultConfig(){return{onProcessMinLen:1024,xhrSetup:null,chunkSize:8e5,isCache:!1,playerId:"",vid:"",afterLoadeddataCallBackLen:0,ext:{}}}get size(){return this.fileSize}initTransMuxWorker(){}updateSecretKey(e,t,r,n){var i;this.useEME=e,!e&&t?(this.log(zs.LOG,"[updateSecretKey] ,force enableWorker"),this.options.enableWorker=!0,this.transmuxerWorkerControl||this.initTransMuxWorker()):!e&&n&&(this.keyValue=n),this.log(zs.LOG,"[updateSecretKey] ,useEME, ",e,",secretKey,",t,",decryptKey",r),null==(i=this.transmuxerWorkerControl)||i.updateValue({secretKey:t,decryptKey:r})}updateLoadedDataDone(){this._loadedDataState=!0}get PCDNSwitchCnt(){return this._PCDNSwitchCnt}updateLoadInfo(e,t){this.loadInfo||(this.loadInfo={}),this.loadInfo[e]||(this.loadInfo[e]={},this.loadInfo[e].loadLen=0),this.loadInfo[e].loadLen+=t}async updatePCDNState(e){if(this._PCDNState!==cd&&this._PCDNState!==e&&this.log(zs.LOG,"[pcdn state update]",this._PCDNState," - ",e),e===cd)this._PCDNState=e;else if(this._PCDNState!==cd&&this._PCDNState!==e){if(this._isUseCDN||e!==ld)this._PCDNState=e;else{if(this._PCDNState=e,this.adaptTimeRange[this._curLoadSegIdx].downloaded||this._switchBitRate)return void this.log(zs.LOG,"[pcdn] switch cdn ",this._curLoadSegIdx,"downloaded",",switchBitRate, ",this._switchBitRate);await this.cancelLoading(),this.pSCCancelCnt++;const t=this._curLoadSegIdx;this.log(zs.LOG,"[pcdn] cancelLoading ",t,"switch cdn load");const r=this.getFragRange(t);if(this._receiveDataPos&&this._receiveDataPos>=r[0]&&this._receiveDataPos<=r[1]){const e=r[0];r[0]=this._receiveDataPos,this.log(zs.LOG,"[pcdn] switch cdn, adject range",t,JSON.stringify(r),",oldRange,",`${e} - ${r[1]}`)}this._receiveDataPos=-1,await this.startLoad(r,t)}this.log(zs.LOG,"[pcdn] openPCDN ",e)}}updateNode(e){if(e&&e.length>0){const t=e.filter(e=>{if(!Object.prototype.hasOwnProperty.call(ud,Du(null==e?void 0:e.url)))return e});this._pcdnNodeList=t}}clearPCDNNodeList(){this.log(zs.LOG,"[pcdn] clearPCDNNodeList"),this._pcdnNodeList=[]}get isUpdateNode(){return!this._pcdnNodeList||!this._pcdnNodeList.length}isUsePCDN(){var e;return"open"===this._PCDNState&&(null==(e=this._pcdnNodeList)?void 0:e.length)>0}async changeBitRate(e){e.bitrate!==this._bitRate&&(this.updateUrl(e._mainURL,e._backupURL),this._bitRate=e.bitrate,this._receiveDataPos=-1,await this.MP4Loader.changeUrl(this.url,`${this.options.vid}-${this._bitRate}`,this.CHUNK_SIZE),this._pcdnNodeList=null,this.emit(rd,this.url),this._switchBitRate=!0,this._mediaEndTime=-1,this.log(zs.LOG,"[switchBitrate] changeUrl, bitRate,",this._bitRate,"url",this.url))}_getByPreload(e,t,r,n){try{if(e&&e.byteLength>=t){const i={endTime:(new Date).getTime(),startTime:(new Date).getTime(),index:n,range:[],vid:this.options.vid,from:"local"};if(r<=e.byteLength){const n=e.slice(t,r);return i.range=[t,r],i.state=!0,{buffer:n,context:i,state:!0}}{const r=e.byteLength-1,n=e.slice(t,r);return i.range=[t,r],{context:i,buffer:n,state:!1}}}return null}catch(e){return console.error("[MP4] _getByPreload",t,r,e),null}}log(e,t,...r){const{options:n}=this,i=n&&n.vid?`[MP4]${this._logTag} ${n.vid} ${t}`:`[MP4]${this._logTag} ${t}`;Ou(this.logger,e,i,...r)}async errorHandler(e,t,r={}){const{response:n,message:i}=e,o=this.options?this.options.vid:"";let s=null;if(this._isPending=!0,n){const a=zu(n.headers);if(s=new mu("network",n.status,{httpText:n.httpText,message:i,url:n.url,range:r.range,headers:a}),this.log(zs.LOG,`[MP4] [${o}] errorHandler error state:[${t}],\n          _isPending:[${this._isPending}] `,null==n?void 0:n.status,i),this.backUrl&&this.backUrl.length>0){const n=this.backUrl.shift();if(this.updateUrl(n,this.backUrl),this.log(zs.LOG,`[${o}] errorHandler start backUpUrl retry`,this.backUrl.length,n),this._isPending=!1,this.MP4Loader&&(await this.MP4Loader.changeUrl(this.url,`${this.url}-${this._bitRate}`,this.CHUNK_SIZE),this.emit(rd,this.url)),this.emit(Ju,{type:"error",error:e}),"getMetaInfo"===t)return void this.getMetaInfo();if("loadFragment"===t){const{fragIndex:e,range:t}=r;if(null!==e&&e>=0&&t)return this.resetFragmentLoadState(e),void this.loadFragment(e,t)}}s.context=r,s.response=n,this.log(zs.LOG,`errorHandler end, ${JSON.stringify(r)}`),this.emit(Yu,s,t)}else this.log(zs.LOG,`errorHandler other end, ${t},${null==n?void 0:n.status}, ${i}`),s=e,s.context=r,this.emit(Yu,s,t)}async init(e){var t,r,n;this.url&&await this.MP4Loader.changeUrl(this.url,`${this.options.vid}-${this._bitRate}`,this.CHUNK_SIZE),this.emit(rd,this.url),this.meta=null;const{meta:i,mediaSegList:o,buffer:s,fileSize:a,initSeg:l,bitrate:c,adaptTimeRange:u,repeatData:d}=e;if(i&&i.ext){a&&(this.fileSize=a),this.meta=i,this.videoTrak=i.ext.videoTrak,this.audioTrak=i.ext.audioTrak,this.meta.videoSamplesLen=this.videoTrak.reduce((e,t)=>e+t.frames.length,0),this.meta.audioSamplesLen=this.audioTrak.reduce((e,t)=>e+t.frames.length,0),this._bitRate=c,this.timeRange=this.getTimeRange(),this.adaptTimeRange=function(e){const t=[];if(!e||!e.length||0===e.length)return t;for(let r=0;r<e.length;r++){const n=e[r],i={};for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(i[e]=n[e]);t.push(i)}return t}(u),o?(this.preloadCache={segList:o||[],initSeg:l},(null==(t=this.adaptTimeRange)?void 0:t.length)>0&&(null==d?void 0:d.byteLength)>0&&this.cacheRepeatData(this.adaptTimeRange[0].repeatRange,this.adaptTimeRange[0].repeatRange,d)):s&&(null==(r=this.adaptTimeRange)?void 0:r.length)>0&&(null==s?void 0:s.byteLength)>0&&this.cacheRepeatData(this.adaptTimeRange[0].range,this.adaptTimeRange[0].range,s),this.adaptTimeRange.map(e=>{e.downloaded=!1,e.isLoading=!1});for(let e=0;e<this.adaptTimeRange.length;e++)null==(n=this.updateTimeRangeInAdaptTimeRangeIdx)||n.call(this,this.adaptTimeRange[e].timeRangeIdx,e);const e={meta:i,videoSegments:i.ext.videoTrak,audioSegments:i.ext.audioTrak,bufferLoaded:s||null};this._bitRateInfoMap.set(this._bitRate,e),this.emit(Xu,this.meta)}else await this.getMetaInfo()}getTimeRange(){const e=[];let t=null;for(let r=0;this.videoTrak&&r<this.videoTrak.length;r++){const{startTime:n}=this.videoTrak[r],{endTime:i}=this.videoTrak[r];t={startTime:n,endTime:i,duration:i-n,downloaded:!1,isLoading:!1},e.push(t)}if(this.audioTrak&&this.audioTrak.length>e.length)for(let r=e.length;r<this.audioTrak.length;r++){const n=Math.max(this.audioTrak[r].startTime,t?t.endTime:0),i=Math.max(this.audioTrak[r].endTime,t?t.endTime:0);t={startTime:n,endTime:i,duration:i-n,downloaded:!1,isLoading:!1},e.push(t)}return e}async getMetaInfo(e=!0){var t;try{const t=Pu();this.metaLoading=!0,this.log(zs.LOG,"getMetaInfo start, bitRate,",this._bitRate,",url,",this.MP4Loader.url),this.resetRepeatInfo();const r=async(r,n,i,o,s)=>{var a;if(o){await this.cancelLoading();const e=new vu(gu.DEMUX,yu.metaError,{msg:JSON.stringify(o)});return void this.errorHandler(e,"getMetaInfo",{range:[0,this._firstLoadSize]})}!this.fileSize&&s&&(this.fileSize=Number(Zu(s.headers)));const l=(null==(a=null==i?void 0:i.priOptions)?void 0:a.type)||nu;if(r&&(this.cacheRepeatData([0,this._firstLoadSize],i.range,r),!this._optionDataLenInfo[l]&&(this._optionDataLenInfo[l]=0),this._optionDataLenInfo[l]+=r.byteLength),n&&this._optionDataLenInfo[l]&&(this._optionDataLenInfo[l]=0),i.meta&&!this.meta){this.firstFrameTime.metaload=Pu()-t;const r=i.meta;this.videoTrak=r.videoSegments,this.audioTrak=r.audioSegments,this.timeRange=this.getTimeRange();const n=this.videoTrak.reduce((e,t)=>e+t.frames.length,0),o=this.audioTrak.reduce((e,t)=>e+t.frames.length,0);this.meta={...r.meta,ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak},videoSamplesLen:n,audioSamplesLen:o,fileSize:this.fileSize},this._bitRateInfoMap.set(this._bitRate,r),this.log(zs.LOG,"meta reach, bitRate,",this._bitRate,this._repeatInfo.curDataPos),e&&this.emit(Xu,this.meta)}if(this.meta&&n&&(this.log(zs.LOG,"[getMetaInfo req end]",this._repeatInfo.curDataPos),this.metaLoading=!1),this._loadedDataState){let e=!1;this._repeatInfo.curDataPos-this._repeatInfo.usedPos>=this.options.afterLoadeddataCallBackLen&&(e=!0),this.meta&&(e||n)&&(this.log(zs.LOG,"emit moov_req_progress loadeddata after",JSON.stringify(i.range)),this.emit(Qu))}else this.meta&&(r||n)&&(this.log(zs.LOG,"emit moov_req_progress loadeddata before",JSON.stringify(i.range)),this.emit(Qu))},n=this._firstLoadSize-1;await this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,n],r)}catch(e){this.log(zs.ERROR,"[MP4] trigger errorHandler getMetaInfo",null==(t=null==e?void 0:e.response)?void 0:t.status,null==e?void 0:e.message),this.loadError(e,"getMetaInfo",!1,{url:e.url||this.url,range:[0,this._firstLoadSize]})}}getFragmentIdx(e){let t,r;if(this.videoTrak.length){if(t=this.videoTrak.find(t=>t.startTime<=e&&t.endTime>e),r=this.audioTrak.find(t=>t.startTime<=e&&t.endTime>e),t&&r)return Math.min(t.index,r.index);if(t||r)return t?t.index:r.index;{let e=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(e=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(e=Math.min(this.audioTrak.length-1,e)),e}}return r=this.audioTrak.find(t=>t.startTime<=e&&t.endTime>e),r?r.index:0}async _checkHasMeta(){var e,t,r,n;let i=this._bitRateInfoMap.get(this._bitRate);if(i)this.log(zs.LOG,"[switchBitrate], not need load InitSegment, bitRate, ",this._bitRate),this.meta=i.meta;else{this.log(zs.LOG,"[switchBitrate], need load InitSegment, bitRate, ",this._bitRate),this.metaLoading=!0;const n=await this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));this.log(zs.LOG,"[switchBitrate], loadMeta end, ",this._bitRate),this.metaLoading=!1;const{videoTrak:o,audioTrak:s}=this,a=o.reduce((e,t)=>e+t.frames.length,0),l=s.reduce((e,t)=>e+t.frames.length,0),c=Number(Zu(null==(r=null==(t=null==(e=null==n?void 0:n.responses)?void 0:e[0])?void 0:t.response)?void 0:r.headers));this.fileSize=c,this.log(zs.LOG,"[switchBitrate], fileSize set , ",c),this.meta={...n.meta,ext:{videoTrak:n.videoSegments,audioTrak:n.videoSegments},videoSamplesLen:a,audioSamplesLen:l,fileSize:c},i=n,i.fileSize=c,this._bitRateInfoMap.set(this._bitRate,n)}this.videoTrak=i.videoSegments,this.audioTrak=i.audioSegments,this.fileSize=i.fileSize,this.emit(ed,this.meta),this.emit(td,this.meta),this.timeRange=this.getTimeRange();for(let e=0;e<this.adaptTimeRange.length;e++)null==(n=this.updateTimeRangeInAdaptTimeRangeIdx)||n.call(this,this.adaptTimeRange[e].timeRangeIdx,e);return this._firstLoadSize=0,!0}async load(e,t){var r;if(this._loadSuccessCallBack=t,this._switchBitRate&&!this.metaLoading){this.log(zs.LOG,"[switchBitrate], switch bitRate start load, bitRate,",this._bitRate,", fragIndex,",e);const t=await this._checkHasMeta();if(this.changeBitRateTime>0){this.resetFragmentLoadState(e,!0),this.resetRepeatInfo();const t=this.getFragmentIdx(this.changeBitRateTime),r=e;if((e=this.getAdaptIdxBySrcIdx(t))<0)return void this.log(zs.ERROR,"[switchBitrate] start new bitrate fragIndex error");r!==e&&this.resetFragmentLoadState(e),this._curLoadSegIdx=e;const n=this.adaptTimeRange[e];this.log(zs.LOG,"[switchBitrate], need update load fragIndex",e,",oldFragIndex",r,",stTime,",this.changeBitRateTime,",newBitrateadaptTimeRange,",n.startTime,"-",n.endTime),this.emit(nd,e),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1}this.log(zs.LOG,"[switchBitrate], reset adaptTimeRange state,",e),this._needInitSegment=!0,this.resetTansmuxer(),t&&(this._switchBitRate=!1)}if(this._switchBitRate&&this.metaLoading)return;const n=this.getFragRange(e);let i=this.getFragmentFromCache(e,n);if(i&&this._needInitSegment&&!i.initSeg&&(i=null,this.log(zs.LOG,"[mp4.load], segment ,",e,"Data In Cache but not has init, so not use cacheData")),i){const{video:t,audio:r}=i.muxSampleIdxRange;this._lastDemuxSampleIdxRange.video=t,this._lastDemuxSampleIdxRange.audio=r,this.log(zs.LOG,"[mp4.load], segment ,",e,"Data In Cache",JSON.stringify(n),", needInit,",this._needInitSegment,",muxSampleIdxRange,",JSON.stringify(i.muxSampleIdxRange));const o=this.adaptTimeRange[e];o.downloaded=!0,o.isLoading=!0,this._needInitSegment=!1,this._loadSuccessCallBack&&this._loadSuccessCallBack(i)}else if(this.log(zs.LOG,"loadFragment,",e,",bitRate,",this._bitRate,",range,",JSON.stringify(n)),this.seekTime>0){const t=this.getSubRange(e,this.seekTime,n);null==(r=this.resetDemuxSampleIdx)||r.call(this,this.seekTime,t),this.loadFragment(e,t),this.seekTime=-1}else this.loadFragment(e,n)}getFragmentFromCache(e,t){const{preloadCache:r}=this;if(!r||!r.segList)return null;let n=-1;const{segList:i,initSeg:o}=r;for(let t=0;t<i.length;t++)if(i[t].index===e){n=t;break}if(n<0)return null;{const r=i[n];if(r.range[1]>=t[1]){const{startTime:n=0,endTime:i=0}=this.adaptTimeRange[e],s=[n,i];return{buffer:r.buffer,range:t,muxSampleIdxRange:r.muxSampleIdxRange,context:{range:t,fragIndex:e,state:!0,adaptTimeRange:[s[0],s[1]]},state:!0,initSeg:this._needInitSegment?o:void 0}}return null}}cacheRepeatData(e,t,r){var n;if(e&&null!=e&&e.length&&null!=(n=this._repeatInfo.data)&&n.byteLength&&(this._repeatInfo.startPos<0&&t[0]+r.byteLength>=e[0]&&t[0]+r.byteLength<=e[1]+1&&(this._repeatInfo.startPos=e[0]),this._repeatInfo.startPos>=0&&t[0]+r.byteLength>=e[0]&&t[0]+r.byteLength<=e[1]+1)){const n=this._repeatInfo.startPos+this._repeatInfo.curDataPos-t[0];if(n<0)return;const i=r.slice(n);if(this._repeatInfo.curDataPos+i.byteLength<this._repeatInfo.data.byteLength)this._repeatInfo.data.set(i,this._repeatInfo.curDataPos),this._repeatInfo.curDataPos+=i.byteLength,this.log(zs.LOG,", repeatInfo,startPos,",this._repeatInfo.startPos,", curDataPos,",this._repeatInfo.startPos+this._repeatInfo.curDataPos,",curAppendLen,",i.byteLength);else try{const t=Bu(Math.max(2*this._repeatInfo.data.byteLength,2*(e[1]-e[0])));if(!t)return;t.set(this._repeatInfo.data.slice(0,this._repeatInfo.curDataPos),0),t.set(i,this._repeatInfo.curDataPos),this._repeatInfo.curDataPos+=i.byteLength,delete this._repeatInfo.data,this._repeatInfo.data=t,this.log(zs.LOG,"_repeatInfo,startPos,",this._repeatInfo.startPos,", curDataPos,",this._repeatInfo.curDataPos)}catch{console.error("repeat data cache  new array failed")}}}_mux(e,t,r,n){const{firstFrameTime:i,timeRecord:o}=this;i.firstmux<0&&o.startMuxTime<0&&(this.timeRecord.startMuxTime=Pu(),i.startMuxTime=Pu()-o.startLoadTime);const s=this.getSamplesRange(r,"video"),a=this.getSamplesRange(r,"audio");this.log(zs.LOG,"mux videoSampleRange,",s,a);const l=[t,t+e.byteLength];if(this.transmuxerWorkerControl){const i={range:l,state:n,fragIndex:r};this.log(zs.LOG,"[transmuxerworker start] ,range, ",JSON.stringify(l),",dataLen,",e.byteLength,i),this.transmuxerWorkerControl.transmux(this.workerSequence,e,t,s,a,this.meta.moov,this.useEME,this.secretKey,i)}else try{this.MP4Demuxer||(this.MP4Demuxer=new qc(this.videoTrak,this.audioTrak,null,{openLog:Eu}));const c=this.MP4Demuxer.demuxPart(e,t,s,a,this.meta.moov,this.useEME,this.keyValue);!this.FMP4Remuxer&&(!this.checkCodecH265()||this.options.supportHevc)&&(this.FMP4Remuxer=new Yc(this.MP4Demuxer.videoTrack,this.MP4Demuxer.audioTrack,{openLog:Eu}));const{videoTrack:u,audioTrack:d}=c,h=null==u?void 0:u.samples,p=(null==h?void 0:h.length)>0?h[0].sampleOffset:-1,f=(null==h?void 0:h.length)>0?h[h.length-1].sampleOffset:-1,_=null==d?void 0:d.samples,y=(null==_?void 0:_.length)>0?_[0].sampleOffset:-1,g=(null==_?void 0:_.length)>0?_[_.length-1].sampleOffset:-1;let m;this.updateDemuxSampleIdxRange([p,f],[y,g]),this.log(zs.LOG,"[mux],videoTimeRange,",null==u?void 0:u.startPts,"-",null==u?void 0:u.endPts,",videoSampleIdx",p,"-",f,",audioTimeRange,",null==d?void 0:d.startPts,"-",null==d?void 0:d.endPts,",audioSampleIdx",y,"-",g,r,JSON.stringify(l),n);const v=n||(null==h?void 0:h.length)>0?null==u?void 0:u.startPts:-1,b=n||(null==h?void 0:h.length)>0?null==u?void 0:u.endPts:-1,w=n||(null==_?void 0:_.length)>0?null==d?void 0:d.startPts:-1,C=n||(null==_?void 0:_.length)>0?null==d?void 0:d.endPts:-1,E=[Math.min(v,w),Math.max(b,C)];if(this.FMP4Remuxer){const e=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:l});e.initSegment&&(this._needInitSegment=!1),m={buffer:Iu(e.audioSegment,e.videoSegment),range:l,state:n,context:{range:l,fragIndex:r,timeRange:E},initSeg:e.initSegment}}else m={videoTrack:u,audioTrack:d,buffer:null,range:l,state:n,context:{range:l,fragIndex:r,timeRange:E}};i.firstmux<0&&o.startMuxTime>0&&(i.firstmux=Pu()-o.startMuxTime),this._loadSuccessCallBack&&this._loadSuccessCallBack(m)}catch(n){const i=null==n?void 0:n.message;this.log(zs.ERROR,"mux err:",i);const o=new vu(gu.REMUX,yu.muxError,{msg:i});this.errorHandler(o,"mux",{fragIndex:r,range:[t,t+e.byteLength]})}}updateDemuxSampleIdxRange(e,t){(null==e?void 0:e[1])>=0&&(this._lastDemuxSampleIdxRange.video=e[1]),(null==t?void 0:t[1])>=0&&(this._lastDemuxSampleIdxRange.audio=t[1]),this.log(zs.LOG,"updateDemuxSampleIdxRange",JSON.stringify(this._lastDemuxSampleIdxRange))}async loadFragment(e,t){this._curLoadSegIdx=e;const r=this.adaptTimeRange[e];if(this._isPending||0===(null==t?void 0:t[1])||!r||r.isLoading||0===(null==t?void 0:t.length))return;this._segmentToBitRateMap.set(e,this._bitRate),this.timeRecord.startLoadTime<0&&(this.timeRecord.startLoadTime=Pu());const{startPos:n,curDataPos:i}=this._repeatInfo,{usedPos:o}=this._repeatInfo;if(t.length>=2&&t[1]&&t[1]>0&&t[0]>=n&&t[1]<n+i){r.isLoading=!0;const s=Math.max(t[0],n+o),a=new Uint8Array(this._repeatInfo.data.slice(s-n,t[1]-n+1));if(this.log(zs.LOG,"[mp4.loadFragment] has all data: ",s,t[1]),this.log(zs.LOG,"[mp4.loadFragment] ",",repeatInfo, startPos,",n,", usedPos,",n+o,",curDataPos, ",n+i),r.downloaded=!0,this.metaLoading||0===n)this._repeatInfo.usedPos=0,this.log(zs.LOG,"[mp4.loadFragment] has all data set repeatInfo.usedPos = 0");else{const e=r.range[0]-n,t=r.range[1]+1-n,i=new Uint8Array(this._repeatInfo.data.slice(e,t));this.resetRepeatInfo(),this.cacheRepeatData(r.repeatRange,r.range,i)}this._mux(a,s,e,!0)}else if(t.length>=2&&t[0]&&t[0]>=n&&t[0]<=n+i){if(!r.isLoading){const s=Math.max(t[0],n+o),a=Math.min(t[1]+1,n+i),l=new Uint8Array(this._repeatInfo.data.slice(s-n,a-n));if(l.byteLength>0){this._repeatInfo.usedPos=a-this._repeatInfo.startPos;const r=this._repeatInfo.usedPos;return this.log(zs.LOG,"[mp4.loadFragment] has part data: ",s,s+l.byteLength),this.log(zs.LOG,"[mp4.loadFragment] ",",repeatInfo, startPos,",n,", usedPos,",n+r,",curDataPos, ",n+i),void this._mux(l,s,e,t[1]<=n+r)}if(!this.metaLoading&&!r.isLoading){this.log(zs.LOG,"[mp4.loadFragment] load part data >>> ",n+i,t[1]),r.isLoading=!0;const s=[n+o,t[1]],a=null==r?void 0:r.repeatRange;if(a&&a[0]<s[0]){const e=[r.repeatRange[0],s[0]],{startPos:t,curDataPos:n,data:i}=this._repeatInfo,o=i.slice(e[0]-t,n);this.resetRepeatInfo(),this.cacheRepeatData(r.repeatRange,e,o)}else this.resetRepeatInfo();await this.startLoad(s,e)}}}else(!this.metaLoading||t[0]>n)&&!r.isLoading&&(r.isLoading=!0,this.log(zs.LOG,"[mp4.loadFragment],ready to load all data ,segmentIdx, ",e,",range >>> ",t),this.resetRepeatInfo(),await this.startLoad(t,e))}resetRepeatInfo(){this.log(zs.LOG,", resetRepeatInfo"),this._repeatInfo.startPos=-1,this._repeatInfo.curDataPos=0,this._repeatInfo.usedPos=0}setSwitchPCDNCallBack(e){this._switchPCDNCallBack=e}updateChangeBitRateTime(e){this.changeBitRateTime=e}async startLoad(t,r,n=!1){var i,o,s,a;const{firstFrameTime:l}=this;0===r&&(null==l?void 0:l.first_gop_req_cnt)<0?l.first_gop_req_cnt=1:r>0&&(null==l?void 0:l.first_gop_req_cnt)<0&&(l.first_gop_req_cnt=0);const c=this.selectedPCDN(n),u=c||this.url;this.log(zs.LOG,"[startLoad], ",r,JSON.stringify(t),u);try{await this.MP4Loader.loadData(t,this.MP4Loader.cache,{index:r,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen,url:u,headers:c?{"X-Origin-Server-Host":this._domain}:null,priOptions:{type:c?iu:nu}})}catch(n){const l=(null==(o=null==(i=null==n?void 0:n.options)?void 0:i.priOptions)?void 0:o.type)===iu||!!c;let u=null;const d=n.url||(l?c:this.url);l?(this.pcdnVVStat.conn_fail_num++,e.pcdn_download_failed_cnt++,u=this._pcdnNodeList.shift(),this.emit(id,u),this.log(zs.ERROR,"pcdn load err, retry use cdn,range",t,",fragIndex",r,(null==n?void 0:n.isTimeout)||(null==(s=null==n?void 0:n.response)?void 0:s.status),null==n?void 0:n.message,d),await this.startLoad(t,r,!0)):this.log(zs.ERROR,"cdn load err,range",JSON.stringify(t),",fragIndex",r,(null==n?void 0:n.isTimeout)||(null==(a=null==n?void 0:n.response)?void 0:a.status),null==n?void 0:n.message,d),this.loadError(n,"loadFragment",l,{range:t,fragIndex:r,url:d})}}loadError(e,t,r,n){var i,o;!e.response&&(e.response={}),e.isTimeout?e.response.status=yu.timeout:null!=(i=null==e?void 0:e.response)&&i.status||(e.response.status=yu.networkError);const s=Du(null==n?void 0:n.url);this.markErrHost(s),this.emit(od,{src:null==n?void 0:n.url,host:s,errorCode:null==(o=null==e?void 0:e.response)?void 0:o.status,message:null==e?void 0:e.message,range:(null==n?void 0:n.range)&&JSON.stringify(n.range),headers:null==n?void 0:n.headers}),r||this.errorHandler(e,t,n)}async loadAllFragmentData(t,r,n,i=!1){var o,s,a,l,c,u;if(this.hasDestroyed)return;this.resetRepeatInfo();const d=(null==(o=this.adaptTimeRange[t])?void 0:o.range)||this.getFragRange(t);this._curLoadSegIdx=t;const h=this.selectedPCDN(i),p=Ru(h||this.url,{__rand:(new Date).getTime()});try{this.log(zs.LOG,",[loadAllFragmentData], index,",t,",rang,",JSON.stringify(d),", use-pcdn,",!!h);const e=await this.MP4Loader.loadData(d,this.MP4Loader.cache,{index:t,url:p,headers:h?{"X-Origin-Server-Host":this._domain}:null,priOptions:{type:h?iu:nu}});if(this.log(zs.LOG,"loadAllFragmentData after",t,JSON.stringify(d)),!e||!e.data){const e=new Error("response null");return void(n?n(e):this.loadError(e,"loadFragment",!!h,{range:d,fragIndex:t,url:h||this.url}))}const{data:i}=e;if((null==i?void 0:i.byteLength)>0&&d&&d.length>=2)this._receiveDataPos=d[0]+(null==i?void 0:i.byteLength),this._loadSuccessCallBack=r,this.adaptTimeRange[t].downloaded=!0,this.cacheRepeatData(this.adaptTimeRange[t].repeatRange,d,i),this._mux(i,d[0],t,!0);else{const r=zu(null==(s=null==e?void 0:e.response)?void 0:s.headers);this.log(zs.LOG,"[FragLoadDowned check false, retry load],fragmentIdx,",t,",dataLen,",null==i?void 0:i.byteLength,JSON.stringify(d),JSON.stringify(r),p);const n=new Error("dataLen not match");this.resetRepeatInfo();const o=this.adaptTimeRange[t];this.emit(ad,[o.startTime,o.endTime]),this.loadError(n,"loadFragment",!!h,{range:d,fragIndex:t,url:p,headers:r})}}catch(i){const o=(null==(l=null==(a=null==i?void 0:i.options)?void 0:a.priOptions)?void 0:l.type)===iu||!!h;o?(e.pcdn_download_failed_cnt++,this._pcdnNodeList.shift(),this.log(zs.ERROR,"[loadAllFragmentData] ,pcdn load err, retry use cdn,fragIndex",t,i.isTimeout||(null==(c=null==i?void 0:i.response)?void 0:c.status),null==i?void 0:i.message),await this.loadAllFragmentData(t,r,n,!0)):this.log(zs.ERROR,"[MP4] loadAllFragmentData error",{fragIndex:t,range:JSON.stringify(d)},i.isTimeout||(null==(u=null==i?void 0:i.response)?void 0:u.status),null==i?void 0:i.message),this.loadError(i,"loadFragment",o,{range:d,fragIndex:t,url:i.url||(o?h:this.url)})}}currentLoadUseUrl(){var e;return this._isUseCDN?this.url:(null==(e=this._pcdnNodeList)?void 0:e.length)>0?this._pcdnNodeList[0].url:""}getCurSwitchPCDNCnt(){return this._PCDNSwitchCnt}selectedPCDN(t){if(this._PCDNState===cd||t)return void(this._isUseCDN=!0);let r;if(this.isUsePCDN()){if(this._isUseCDN){if(this._switchPCDNCallBack){const e=this._switchPCDNCallBack();e>0&&(this.options.switchPCDNMaxCnt=e)}if(this._PCDNSwitchCnt>=this.options.switchPCDNMaxCnt)return this._isUseCDN=!0,this.log(zs.LOG,"cdn switch pcdn outlimit, curSwitchCnt ,",this._PCDNSwitchCnt,",maxCnt,",this.options.switchPCDNMaxCnt),null;this._PCDNSwitchCnt++,this.log(zs.LOG,"cdn switch pcdn, curSwitchCnt,",this._PCDNSwitchCnt,",maxCnt,",this.options.switchPCDNMaxCnt)}this._isUseCDN=!1,r=Ru(this._pcdnNodeList[0].url,{__vid:this.options.vid}),this._lastPCDNUrl!==r&&(this.emit(rd,r),this._lastPCDNUrl=r,this.pcdnVVStat.conn_req_num+=1),e.pcdn_download_request_cnt++}else this._isUseCDN||(this.log(zs.LOG,"pcdn switch cdn PCDNSwitchCnt,",this._PCDNSwitchCnt,",maxCnt,",this.options.switchPCDNMaxCnt),this.pcdnVVStat.conn_jump_num+=1),this._isUseCDN=!0;return r}async cancelLoading(){this.MP4Loader&&await this.MP4Loader.cancel(),this._optionDataLenInfo[iu]&&this._optionDataLenInfo[iu]>0&&(this.emit(sd,{load_type:iu,len:this._optionDataLenInfo[iu]}),this._optionDataLenInfo[iu]=0),this._optionDataLenInfo[nu]&&this._optionDataLenInfo[nu]>0&&(this.emit(sd,{load_type:nu,len:this._optionDataLenInfo[nu]}),this._optionDataLenInfo[nu]=0)}updateUrl(e,t){const r=Du(e);this._defaultDomain||(this._defaultDomain=r),r.indexOf("www.")<0?this._domain=r:this._domain=this._defaultDomain,this.url=e,this.backUrl=t||[]}getDataBitRate(e){return this._segmentToBitRateMap.get(e)}checkCodecH265(){return this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1)}checkCodecH266(){return this.meta&&this.meta.videoCodec.indexOf("bvc2")>-1}destroy(){this.hasDestroyed||(this.resetTansmuxer(),this.transmuxerWorkerControl&&this.transmuxerWorkerControl.destroy(),this.fileSize=0,this.totalSize=0,this._isPending=!1,this.metaLoading=!1,this.resetRepeatInfo(),delete this._repeatInfo.data,this._bitRateInfoMap.clear(),this._segmentToBitRateMap.clear(),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.removeAllListeners(),this.hasDestroyed=!0,this.pcdnVVStat=this.resetPCDNVVStat())}resetPCDNVVStat(){return{try_req_node:0,req_node_succ:0,has_ret_node:0,conn_req_num:0,conn_fail_num:0,conn_jump_num:0}}resetTansmuxer(){var e;null==(e=this.resetDemuxSampleIdx)||e.call(this),this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null,this.transmuxerWorkerControl&&this.transmuxerWorkerControl.reset()}getMediaEndTime(){if(this._mediaEndTime>0)return this._mediaEndTime;const{videoTrak:e,audioTrak:t}=this;if((null==e?void 0:e.length)>0){const{endTime:t}=e[e.length-1];this._mediaEndTime=this._mediaEndTime<0?t:Math.min(t,this._mediaEndTime)}if((null==t?void 0:t.length)>0){const{endTime:e}=t[t.length-1];this._mediaEndTime=this._mediaEndTime<0?e:Math.min(e,this._mediaEndTime)}return this._mediaEndTime}};Qc(dd,"pcdn_download_request_cnt",0),Qc(dd,"pcdn_download_failed_cnt",0);let hd=dd;class pd extends hd{constructor(e,t,r,n=[],i,o){super(e,t,r,n,i,o),this._logTag=`${o}_${lu}`}updateAdaptTimeRange(e,t){this._lastTargetDur=t;const r=this.adaptTimeRange;for(let n=0;n<r.length;n++){const{timeRangeIdx:i}=r[n];if(e>=i[0]&&e<i[1])return this.log(zs.LOG,"has adaptTimeRange,startSrcIdx, ",e,",adaptTimeRangeIdx",n,", dur,",t,JSON.stringify(r[n])),n}let n=r.length>0?r[r.length-1].timeRangeIdx[1]:0;if(n>=this.timeRange.length)return r.length-1;for(;n<e;){const{startTime:e}=this.timeRange[n],{endTime:t}=this.timeRange[n],r={startTime:e,endTime:t,timeRangeIdx:[n,n+1],duration:t-e,downloaded:!1,isLoading:!1};this.adaptTimeRange.push(r),this.updateTimeRangeInAdaptTimeRangeIdx(r.timeRangeIdx,this.adaptTimeRange.length-1),this.log(zs.LOG,"gap adaptTimeRange,adaptTimeRangeIdx, ",this.adaptTimeRange.length-1,JSON.stringify(r)),n++}let i=0,o=n,s=n;for(;s<this.timeRange.length;s++){if(!(i<t)){o=s;break}i+=this.timeRange[s].endTime-this.timeRange[s].startTime}s===this.timeRange.length&&(o=this.timeRange.length);const a=[n,o],{startTime:l}=this.timeRange[a[0]],c=a[1]===this.timeRange.length?this.timeRange[a[1]-1].endTime:this.timeRange[a[1]].startTime,u={startTime:l,endTime:c,timeRangeIdx:a,duration:c-l,downloaded:!1,isLoading:!1};return this.log(zs.LOG,"update adaptTimeRange,startIdx,",a[0],", dur,",t,JSON.stringify(u)),this.adaptTimeRange.push(u),this.updateTimeRangeInAdaptTimeRangeIdx(a,this.adaptTimeRange.length-1),this.adaptTimeRange.length-1}updateTimeRangeInAdaptTimeRangeIdx(e,t){for(let r=e[0];r<e[1];r++)r<this.timeRange.length&&(this.timeRange[r].adaptTimeRangeIdx=t)}getAdaptIdxBySrcIdx(e,t){var r;const n=this.adaptTimeRange.length;if(!t&&e>=(null==(r=this.adaptTimeRange[n-1])?void 0:r.timeRangeIdx[1])){const t=this._lastTargetDur||5;this.updateAdaptTimeRange(e,t)}for(let t=0;t<this.adaptTimeRange.length;t++){const{timeRangeIdx:r}=this.adaptTimeRange[t];if(r&&e>=r[0]&&e<r[1])return t}return-1}getFragmentIdx(e){let t,r;if(this.videoTrak.length){if(t=this.videoTrak.find(t=>t.startTime<=e&&t.endTime>e),r=this.audioTrak.find(t=>t.startTime<=e&&t.endTime>e),t&&r)return Math.min(t.index,r.index);if(t||r)return t?t.index:r.index;{let e=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(e=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(e=Math.min(this.audioTrak.length-1,e)),e}}return r=this.audioTrak.find(t=>t.startTime<=e&&t.endTime>e),r?r.index:0}resetFragmentLoadState(e,t=!1){this.log(zs.LOG,", resetFragmentLoadState, fragIndex, ",e,",changeBitrate,",t);for(let r=0;r<this.adaptTimeRange.length;r++)if(r<e?(this.adaptTimeRange[r].downloaded=!0,this.adaptTimeRange[r].isLoading=!0):(this.adaptTimeRange[r].downloaded=!1,this.adaptTimeRange[r].isLoading=!1),t){this.adaptTimeRange[r].range=null;const{timeRangeIdx:t}=this.adaptTimeRange[r];if(t[0]>=this.timeRange.length){this.log(zs.WARN,"fix adaptTimeRange fragIndex",e," ,timeRangeIdx[0] >= this.timeRange.length, so end",t[0],this.timeRange.length,",endFragment,",r),this.adaptTimeRange=this.adaptTimeRange.slice(0,r);break}t[1]>=this.timeRange.length&&(this.log(zs.WARN,"fix adaptTimeRange fragIndex",e," ,timeRangeIdx[1],",t[1],">>>>",this.timeRange.length,",endFragment,",r),t[1]=this.timeRange.length,this.adaptTimeRange=this.adaptTimeRange.slice(0,r+1)),this.adaptTimeRange[r].startTime=this.timeRange[t[0]].startTime,this.adaptTimeRange[r].endTime=t[1]>=this.timeRange.length?this.timeRange[this.timeRange.length-1].endTime:this.timeRange[t[1]].endTime,this.adaptTimeRange[r].range=this.getFragRange(r)}}calculateRange(e){let t=null,r=null,n=null,i=null;const o=e<this.adaptTimeRange.length?this.adaptTimeRange[e].timeRangeIdx:null;if(!o)return this.log(zs.warn,"calculateRange err",e,JSON.stringify(this.adaptTimeRange)),[];const s=o[0],a=o[1];this.log(zs.LOG,"getFragRange, timeRangeIdx,",JSON.stringify(o));const l=this.videoTrak;l&&(t=s<l.length?l[s]:l[l.length-1],r=a<l.length?l[a-1]:l[l.length-1]);const c=this.audioTrak;c&&(n=s<c.length?c[s]:c[c.length-1],i=a<c.length?c[a-1]:c[c.length-1]);const u=Math.min((null==t?void 0:t.range[0])||1/0,(null==n?void 0:n.range[0])||1/0),d=[u,Math.max(u,(null==r?void 0:r.range[1])||0,(null==i?void 0:i.range[1])||0)];return this.log(zs.LOG,"calculateRange",e,d[0],"-",d[1]),d}getTimeRangeByIdx(e){let t=null;const r=this.videoTrak;r&&(t=e<r.length?r[e]:r[r.length-1]);let n=null;const i=this.audioTrak;return i&&(n=e<i.length?i[e]:i[i.length-1]),[Math.min((null==t?void 0:t.range[0])||1/0,(null==n?void 0:n.range[0])||1/0),Math.max((null==t?void 0:t.range[1])-1||0,(null==n?void 0:n.range[1])-1||0)]}getFragRange(e){var t;if(e<this.adaptTimeRange.length&&null!=(t=this.adaptTimeRange[e])&&t.range)return this.log(zs.LOG,"getFragRange exist",e,JSON.stringify(this.adaptTimeRange[e].range)),this.adaptTimeRange[e].range;const r=this.calculateRange(e);if(e<this.adaptTimeRange.length){this.adaptTimeRange[e].range=r;const t=this.adaptTimeRange[e].timeRangeIdx[1];if(t<this.timeRange.length){const n=this.getTimeRangeByIdx(t);(null==n?void 0:n.length)>1&&n[0]<n[1]&&r[1]>n[0]&&(this.adaptTimeRange[e].repeatRange=[n[0],r[1]])}}return r}getSubRange(e,t,r){const n=this.adaptTimeRange[e].timeRangeIdx;let i=n[0];for(let e=n[0];e<n[1];e++)if(t>=this.timeRange[e].startTime&&t<this.timeRange[e].endTime){i=e;break}const o=[this.getSrcFragRange(i)[0],r[1]];return this.log(zs.LOG,">>>>>getSubRange finalRange ",JSON.stringify(o),",oldRange,",JSON.stringify(r)),o}getSrcFragRange(e){let t=null,r=null;this.log(zs.LOG,"getFragRange, timeRangeIdx, srcFragment,",JSON.stringify(e));const n=this.videoTrak;n&&(t=e<n.length?n[e]:n[n.length-1]);const i=this.audioTrak;i&&(r=e<i.length?i[e]:i[i.length-1]);const o=[Math.min((null==t?void 0:t.range[0])||1/0,(null==r?void 0:r.range[0])||1/0),Math.max((null==t?void 0:t.range[1])-1||0,(null==r?void 0:r.range[1])-1||0)];return this.log(zs.LOG,",getSrcFragRange",e,o),o}getSamplesRange(e,t){const r=[],n=this.adaptTimeRange[e].timeRangeIdx;switch(t){case"video":if(this.videoTrak&&n[0]<this.videoTrak.length){const{frames:e}=this.videoTrak[n[0]];r.push(e[0].index);const t=this.videoTrak.length,i=n[1]-1,o=i<t?this.videoTrak[i].frames:this.videoTrak[t-1].frames;r.push(o[o.length-1].index)}break;case"audio":if(this.audioTrak&&n[0]<this.audioTrak.length){const{frames:e}=this.audioTrak[n[0]];r.push(e[0].index);const t=this.audioTrak.length,i=n[1]-1,o=i<t?this.audioTrak[i].frames:this.audioTrak[t-1].frames;r.push(o[o.length-1].index)}break;default:console.warn("[getSamplesRange] type ",t," is invalid")}return r}}function fd(){const e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/");return t>0||r>0}function _d(){return!!navigator.requestMediaKeySystemAccess&&!function(){const e=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent),t=fd(),r=function(){const{mimeTypes:e}=navigator,t=navigator.userAgent;let r=!1;return e&&t.indexOf("Chrome")>1&&(r=Object.keys(e).some(t=>!!(e[t].type&&e[t].type.indexOf("360")>-1||e[t].type&&e[t].type.indexOf("application/vnd.chromium.remoting-viewer")>-1||e[t].description&&e[t].description.indexOf("360")>-1))),r}(),n=navigator.userAgent.indexOf("Firefox")>0,i=navigator.userAgent.indexOf("Edge")>0;return e||t||r||n||i}()}function yd(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){console.log(e)}return!1}function gd(){const e=window.MediaSource=window.MediaSource||window.WebKitMediaSource;return e&&"function"==typeof e.isTypeSupported}class md{constructor(){let e,t;const r=new Promise((r,n)=>{e=r,t=n});return r.id=`${(new Date).getTime()}_${parseInt(100*Math.random())}`,r.resolve=function(t){e(t),r.state="fulfilled"},r.reject=function(e){t(e),r.state="rejected",r.isBreak="DESTROYED"===e},r.state="pending",r}resolve(e){}reject(e){}}class vd extends el{init(){return Promise.resolve()}preloadPredict(e){return e}}const bd="h264";function wd(e){let{mediaType:t,definition:r,codecType:n,vtype:i}=e;const{vid:o}=e;return t=t||"video",r=r||"-1",n=n||bd,i=i||tl.MP4,o?`${o}#${t}#${n}#${i}#${r}`:null}function Cd(e,t){return function(e,t){let r=-1;for(let n=0;n<e.length;n++)if(t===e[n].data.vid){r=n;break}return r}(e,t)>=0}function Ed(e,t){for(let r=0;r<e.length;r++)if(e[r]===t)return r;return-1}function kd(e,t){return Ed(e,t)>=0}const{PRELOAD_TYPES:Td}=xa,Sd="preload_ended";let Od=0,Ad=!0,$d=null;class Pd extends Ja{constructor(e,t){var r;const n=Pd.getDefaultConfig(e);Object.keys(e).forEach(t=>{n[t]=e[t]}),super(n),Qc(this,"_updateRealTimeSpeed",e=>{Od=e.speed,this.emit(eu,e)}),this.video=null,this._mp4=null,this._pendingPromise=null,this.playerId=t.playerId||"default",this._nextPreloadCount=0,this.isActive=!0,this.MP4Loader=null,this.playingVids=[],this.playingVids1=[],this.loadingCount=0;const{logCacheLevel:i,logMaxSize:o}=this.options.logCacheConfig;this.logger=new Ys("[Mp4Preloader]",{logCacheLevel:i,logMaxSize:o}),void 0===e.supportHevc&&!(typeof MediaSource>"u"||!MediaSource.isTypeSupported)&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))&&(this.options.supportHevc=!0),this.loadRangeType=(null==(r=this.options)?void 0:r.loadRangeType)||lu,Ou(zs.DEBUG,"[Preloader] new preloader, playerId",this.playerId),this.update({preloadMaxCacheCount:this.options.preloadMaxCacheCount})}static get PRELOAD_TYPES(){return Td}static get BitRateAdapter(){return $d}static set BitRateAdapter(e){$d=e}static getDefaultConfig(){return{supportHevc:!1,preloadTime:5,preloadSize:0,preloadType:0,segmentMinDuration:5,vtype:"MP4",codecType:"h264",preloadCacheType:1,preloadMaxCacheCount:5,globalKey:null,autoPreload:!1,reqOptions:null,getRequestOptionsCallback:null,minBufferLength:5,timeout:3e3,autoCheck:{enable:!0,interval:1e3},logCacheConfig:{logCacheLevel:2,logMaxSize:204800},pcdnConfig:{openPreloadPCDN:!1,enterMinBuffer:10,outMaxBuffer:5,pcdn_duration:2,pcdn_open:!0,openPCDN:!0,minDuration:25,trackerUrl:""},switchPCDNMaxCnt:2,retryCount:1,retryDelay:1e3,loaderType:"fetch"}}static registerPreloader(e,t){return e.vtype=tl.MP4,Pd.BitRateAdapter=t,new Pd(e,this)}static getInfoByUniqueKey(e){return function(e){const t=e.split("#"),r=["vid","mediaType","codecType","vtype","definition"],n={};return t.forEach((e,t)=>{n[r[t]]=e}),n}(e)}static generateUniqueKey(e){return wd(e)}static disable(){Ad=!1}static enable(){Ad=!0}set codecType(e){this.options.codecType=e}get codecType(){return this.options.codecType}get vtype(){return this.options.vtype}log(e,t,...r){Ou(this.logger,e,t,...r)}update(e){Object.keys(e).forEach(t=>{this.options[t]=e[t]}),this.preloadManager.setMaxCache?this.preloadManager.setMaxCache(this.options.preloadMaxCacheCount):this.preloadManager._cacheInst._maxCache=this.options.preloadMaxCacheCount}get currentPreloadInst(){return this.preloadManager._currentPreloadInst}startCheckTask(){this.preloadManager.startCheckTask()}stopCheckTask(){this.preloadManager.stopCheckTask()}getPreloadMetaByVid(e){const{allCachedKeys:t,allCachedTimeKeys:r}=this;return function(e,t,r){const n=[];let i="";Object.keys(t).forEach(t=>{const r=function(e){if(!e)throw new Error(`key ${e} is empty`);const t=e.split("#");if(t.length<5)throw new Error(`key ${e} is not right format`);return{vid:t[0],mediaType:t[1],codecType:t[2],vtype:t[3],definition:t[4],order:-1,timeStamp:0,total:0}}(t);r.vid===e&&(n.push(r),i=t)});let o=null;if(i){const e=function(e){const t=[];return Object.keys(e).forEach(r=>{t.push(Number(e[r]))}),t.sort((e,t)=>e-t)}(r),t=Number(r[i]),s=function(e,t){for(let r=0;r<e.length;r++)if(e[r]===t)return r;return-1}(e,t);o=n[0],o.timeStamp=t,o.order=s,o.total=e.length}return o}(e,t,r)}async getPreloadMemoryInfo(){const{allCachedKeys:e}=this;let t=0,r=0;for(const n in e)if(e.hasOwnProperty(n)){r++;try{const e=await this.getPreLoadData(n);t+=(null==e?void 0:e.memory)||0}catch{}}return{memory:t,cnt:r}}getPreloadUnuseInfo(){const e=[];for(const[t,r]of su)if(au.get(t))su.delete(t);else{const n=t.split("#"),i=(null==n?void 0:n.length)>0?n[0]:t;e.push({vid:i,bw:(null==r?void 0:r.bw)||0,pbw:(null==r?void 0:r.pbw)||0})}return e}generateUniqueKey(e){return wd(e)}addPlayingItem(e,t){const r=this.checkPlaying("_playerId",e);r>-1?this.playingVids[r].vid=t:this.playingVids.push({vid:t,_playerId:e}),this.log(zs.LOG,"addPlayingItem",r,e,t,this.playingVids)}delPlayingItem(e){const t=this.checkPlaying("_playerId",e);this.log(zs.LOG,"delPlayingItem",t,e,this.playingVids),t>-1&&this.playingVids.splice(t,1)}checkPlaying(e,t){const r=this.playingVids;for(let n=0;n<r.length;n++)if(t===r[n][e])return n;return-1}before(){this.handlers={checkIfCanPreload:()=>this.checkIfCanPreload(),start:e=>{const t=e.payload||[];if(0===t.length)return Promise.reject(new Error("preload_is_null"));const{vid:r}=e;let n=e.vtype||tl.MP4,i=e.codecType||bd;const o=this.getUserSelectDefinition(),s=this.checkCacheKey(r,t,o,n,i);if(this.log(zs.LOG,`${this.playerId} ${r}`,`codecType:${i} vtype:${n} hasCache:${s}`),s||"MP3"===n)return Promise.reject(new Error(`vtype_${n}`));const a=this.getInitDefinition(t,this.options.definition,o);if(this.log(zs.LOG,` ${this.playerId} ${r} getInitDefinition`,null==a?void 0:a.definition),!a)return Promise.reject(new Error("definition_error"));const{definition:l,orgDefinition:c}=a,u=a.vtype||n,d=a.codecType||i,h=e.preloadTime||this.options.preloadTime,p=e.preloadSize||this.options.preloadSize||Math.pow(25,4)-1,f=this.generateUniqueKey({vid:r,definition:l,vtype:u,codecType:d});this._nextPreloadCount>0&&this._nextPreloadCount--,Ou(zs.LOG,`${r} start duration:${a.duration} preloadTime:${h} cacheKey:${f},playerId:${this.playerId}`);const _={vid:r,definition:l,orgDefinition:c,preloadTime:h,preloadSize:p,cacheKey:f,codecType:d,vtype:u,...a};return e.reqOptions&&(_.reqOptions=e.reqOptions),this.loadingCount++,this.log(zs.LOG,`start preload,${r} loadingCount:${this.loadingCount},playerId:${this.playerId}`),this.start(_)},onRequest:({url:e,range:t,extData:r},n)=>this.getData(e,t,r,n)},this.loggerConfig={logger:()=>{},openLog:!1},this.predictInst=new vd(this.loggerConfig)}start(e){const t={mediaInfos:{dynamic_video_list:[],dynamic_audio_list:[]},onObtain:()=>{const e=new md;return e.resolve(t.mediaInfos),e},onTransform:()=>{const t=new md;this._pendingPromise=t;const{preloadType:r}=this.options;return this.emit("preload_start",{...e,type:r}),r===Td.DURATION?this.loadByPreloadTime(e,t):this.loadByChunkSize(e,t),t}};return Promise.resolve(t)}getInitDefinition(e,t,r=null){let n=null;return Pd.BitRateAdapter?(n=Pd.BitRateAdapter.select(e,this.codecType,this.vtype),this.log(zs.DEBUG,"Mp4Preloader.BitRateAdapter",null==n?void 0:n.type,null==n?void 0:n.definition,null==n?void 0:n.bitrate)):n=function(e,t){let r=null;if(!e||e.length<1)return r;for(let n=0;n<e.length;n++){const i=e[n];if(i.definition===t){r=i;break}}return r||(r=e[0]),r}(e,t),n||(n=e[0]),n}getPreLoadData(e){const t=new md;return this.getItemSameVid(e).then(e=>{if(this.log(zs.DEBUG,"[Preloader] getPreLoadData",!!e.value),e.value){const{mediaSegList:r,meta:n,type:i,buffer:o,preloadTime:s,vid:a,cacheKey:l,definition:c,orgDefinition:u,byteLength:d,duration:h,fileSize:p,from:f,vtype:_,codecType:y,initSeg:g,bitrate:m,adaptTimeRange:v,repeatData:b,memory:w}=e.value,C={vid:a,type:i,vtype:_,codecType:y,definition:c,orgDefinition:u,bitrate:m,cacheKey:l,duration:h||0,byteLength:d,from:f,adaptTimeRange:v,repeatData:b,memory:w,meta:n,preloadTime:s};i===Td.SIZE?(C.buffer=o,C.fileSize=p||0):(C.mediaSegList=r,C.fileSize=p||0,C.initSeg=g),t.resolve(C)}else t.resolve(null)}).catch(e=>{t.reject(e)}),t}async setPreLoadData(e,t){var r,n;const i=new md,{mediaSegList:o,meta:s,vid:a,definition:l,orgDefinition:c,type:u,buffer:d,duration:h,byteLength:p,preloadTime:f,fileSize:_,from:y,vtype:g,codecType:m,initSeg:v,bitrate:b,adaptTimeRange:w,repeatData:C}=t,E={codecType:m,vtype:g,vid:a,definition:l,orgDefinition:c,cacheKey:e,type:u,from:y,meta:s,fileSize:_,adaptTimeRange:w,repeatData:C,bitrate:b,memory:0};if(E.memory+=(null==C?void 0:C.byteLength)||0,u===Td.SIZE)E.buffer=d,E.byteLength=p||0,E.preloadSize=p||0,E.preloadTime=f||0,E.fileSize=_,E.buffer&&E.buffer.byteLength>0&&(E.memory+=(null==d?void 0:d.byteLength)||0,this.setItem(e,E),i.resolve(!0));else if(E.mediaSegList=[],E.duration=h,E.byteLength=p||0,E.preloadTime=f||0,E.initSeg=v,E.memory+=(null==v?void 0:v.byteLength)||0,E.fileSize=_,o.forEach(e=>{var t;E.memory+=(null==(t=null==e?void 0:e.buffer)?void 0:t.byteLength)||0,E.mediaSegList.push(e)}),s&&0===o.length)this.log(zs.LOG,"[Preloader] meta setPreLoadData1 success",e,null==(r=null==E?void 0:E.mediaSegList)?void 0:r.length),this.setItem(e,E),i.resolve(!0);else{const t=o.every(e=>!!e.buffer&&e.state);this.log(zs.LOG,"[Preloader] mediaSegList setPreLoadData1 success",e,null==(n=null==E?void 0:E.mediaSegList)?void 0:n.length,t),t||i.resolve(!1),this.setItem(e,E).then(()=>{this.log(zs.LOG,"[Preloader] setPreLoadData1 success",e)}),i.resolve(!0)}return i}getInitCacheData(e,t){const r={type:e,meta:null,byteLength:0,fileSize:0,bitrate:0,preloadTime:0};return e===Td.DURATION?(r.mediaSegList=[],r.initSeg=null,r.duration=0):r.buffer=null,Object.keys(t).map(e=>{r[e]=t[e]}),r}updatePreCacheData(e,t,r,n,i,o,s,a,l){const{mediaSegList:c,type:u}=e;if(u===Td.SIZE||-1===i)return e.buffer=rl(Uint8Array,e.buffer.buffer||[],new Uint8Array(t)),e;let d=-1;for(let e=0;e<c.length;e++)if(c[e].index===i){d=e;break}const h=o||[0,0];if(d>-1)t&&(c[d].buffer=rl(Uint8Array,c[d].buffer||[],new Uint8Array(t))),r.length>1&&(c[d].range.length>1?c[d].range[1]=r[1]:c[d].range=r),-1!==s[1]&&(n=c[d].range[1]>=s[1]),c[d].state=n;else{const{video:l,audio:u}=a;e.duration=h[1],c.push({buffer:t,range:r||[],index:i,totalRange:s||[],timeRange:[h[0],h[1]],muxSampleIdxRange:{video:l,audio:u},state:n});const d=`${null==t?void 0:t.byteLength},${JSON.stringify(r)},${i},${JSON.stringify(s)},${JSON.stringify(o)}`;this.log(zs.DEBUG,`[Preloader] ${e.cacheKey} mediaSegList set, dataLen`,d)}return n&&(e.byteLength+=r[1]-r[0],e.preloadTime+=l),n}checkCacheKey(e,t,r,n=tl.MP4,i=bd){const o=this.getPreloadMetaByVid(e);if(o)return this.generateUniqueKey(o);if(r){const t=this.generateUniqueKey({vid:e,definition:r,vtype:n,codecType:i});return this.hasItemSameVid(t)?t:null}for(let r=0;r<t.length;r++){const o=this.generateUniqueKey({vid:e,definition:t[r].definition,vtype:n,codecType:i});if(this.hasItemSameVid(o))return o}return null}attachPlayer(e){this.video=e.video?e.video:e}detachPlayer(){this.video=null}checkIfCanPreload(){let e;if(!Ad||this.loadingCount>=1||!this.isActive)return e=!1,e;if(this.video){const{minBufferLength:t,startPreloadControl:r,startPreloadMinBuffer:n,startPreloadMinPosTime:i}=this.options;e=function(e,t){if(!e)return!1;const r=function(e,t){const r=[0,0];if(e)for(let n=0,i=e.length;n<i&&(r[0]=e.start(n),r[1]=e.end(n),!(r[0]<=t&&t<=r[1]));n++);return r[0]-t<=0&&t-r[1]<=0?r:[0,0]}(e.buffered,e.currentTime),{startPreloadControl:n,startPreloadMinBuffer:i,startPreloadMinPosTime:o,minBufferLength:s}=t;if(n){const t=Math.max(r[1]-e.currentTime,0);if(t>i){if(e.currentTime>o)return!0;if(e.currentTime>e.duration/2)return!0}else if(e.currentTime+i+1>e.duration&&e.currentTime+t>e.duration-1)return!0}else{const t=e.duration>s+5?s:e.duration/2,n=Math.min(e.currentTime+s,e.duration),i=r[1]-n;if(e.currentTime>t&&(i>0||Math.abs(i)<1))return!0}return!1}(this.video,{startPreloadControl:r,startPreloadMinBuffer:n,startPreloadMinPosTime:i,minBufferLength:t})}else e=this._nextPreloadCount>0;return Ou(zs.DEBUG,"[Preloader] checkIfCanPreload",!!this.video,`nextPreloadCount:${this._nextPreloadCount} ret:${e}`),e}startPreloadNext(e=1){let t=!0;return this._nextPreloadCount=e,(this.loadingCount>=1||!this.isActive)&&(t=!1),t&&this.preloadNext(),t}get realTimeSpeed(){return Od}getRequestOption(e){const{getRequestOptionsCallback:t,reqOptions:r}=this.options;let n=null;return n=e.reqOptions?e.reqOptions:"Function"===$u(t)?t(e):r,n||{}}loadByPreloadTime(e,t){var r;const{vid:n,cacheKey:i,preloadTime:o,definition:s,orgDefinition:a,duration:l,bitrate:c}=e,{codecType:u,vtype:d,size:h}=e;let p="Array"===$u(e.url)?e.url[0].src:e.url;if(!p)return void this._endLoadFragments();p=Ru(p,{__vid:n});const{segmentMinDuration:f}=this.options,_=o>=f?f:o,y=this.getRequestOption({...e,url:p});this.log(zs.DEBUG,"[Preloader] loadByPreloadTime",`${e.cacheKey}, definition:${e.definition},segmentMinDuration:${_}`);const g=h||Lu(c,l),m=null==(r=null==e?void 0:e.pktOffsetMap)?void 0:r.find(e=>{var t;return(null==e?void 0:e.time)===((null==(t=this.options)?void 0:t.firstLoadTimePos)||5)}),v=null==m?void 0:m.offset;this._mp4=new pd(p,c,{segmentDuration:_,codecType:this.codecType,chunkSize:this.options.preloadSize,firstLoadSize:v,duration:l,fileSize:g,playerId:this.playerId,vid:n,useUrlRange:!1,retryCount:1,retryDelay:1e3,supportHevc:this.options.supportHevc,retryCheckFunc:Vu,switchPCDNMaxCnt:Number.MAX_VALUE,logger:this.logger,reqOptions:y,fixEditListOffset:this.options.fixEditListOffset},[],this.firstFrameTime,"[Preloader]");const b=this.getInitCacheData(Td.DURATION,{vid:n,definition:s,orgDefinition:a,cacheKey:i,codecType:u,vtype:d,bitrate:c||0});this._mp4.once("metaReady",async r=>{var o;const s=this._mp4;s&&(this.log(zs.DEBUG,`[Preloader] ${n} metaReady ${null==(o=null==b?void 0:b.mediaSegList)?void 0:o.length}`),b.meta=r,b.from=2,b.fileSize=s.size,await s.cancelLoading(),!s.hasDestroyed&&(s.metaLoading=!1,this.emit("prf_meta_ready",{...b}),await this.setPreLoadData(i,b),!s.hasDestroyed&&this.startLoadByFragments(b,e,t)))}),this._mp4.on(Yu,e=>{this.log(zs.ERROR,`[Preloader] ${n} loadByPreloadTime error`),this._endLoadFragments(),this.emit("error",e)}),this._mp4.on(sd,e=>{this.bwEventEmit(n,e.load_type,e.len,null,i,e)}),this._mp4.MP4Loader.on(eu,e=>{var t;if((null==e?void 0:e.len)>0){const r=(null==(t=null==e?void 0:e.priOptions)?void 0:t.type)||nu,o=Uu(e.len,e.time);this.bwEventEmit(n,r,e.len,o,i,e)}}),this._mp4.init({})}bwEventEmit(e,t,r,n,i,o){const s=su.get(i)||{bw:0,pbw:0};(!t||t===nu)&&(s.bw=s.bw+r,this.emit("prf_data_size",{vid:e,task_type:2,cdn_size:r,cdn_speed:n,...o})),su.set(i,s),this._updateRealTimeSpeed({speed:n,type:t||nu})}async loadByChunkSize(e){var t;const{vid:r,cacheKey:n,definition:i,orgDefinition:o,duration:s,bitrate:a,codecType:l,vtype:c,size:u}=e,{options:d}=this;let h="Array"===$u(e.url)?e.url[0].src:e.url;if(!h)return void this._endLoadChunk();h=Ru(h,{__vid:r});const p=u||Lu(a,s),f=null==(t=null==e?void 0:e.pktOffsetMap)?void 0:t.find(e=>(null==e?void 0:e.time)===((null==d?void 0:d.firstLoadTimePos)||5)),_=null==f?void 0:f.offset,y=wu(s,8e5,p);this.log(zs.LOG,`${r} loadByChunkSize`,e.cacheKey,e.definition,_||y);const g=this.getInitCacheData(Td.SIZE,{vid:r,definition:i,orgDefinition:o,cacheKey:n,codecType:l,vtype:c,fileSize:u,bitrate:a||0}),m=this.getRequestOption({...e,url:h});this.MP4Loader=new Dc({url:h,vid:`${r}-${a}`,retry:d.retryCount||2,retryDelay:d.retryDelay||1e3,timeout:d.timeout||3e3,...m,loaderType:d.loaderType,retryCheckFunc:Vu,openLog:Su(),fixEditListOffset:d.fixEditListOffset}),this.MP4Loader.on(eu,e=>{var t;if((null==e?void 0:e.len)>0){const i=(null==(t=null==e?void 0:e.priOptions)?void 0:t.type)||nu,o=Uu(e.len,e.time);this.bwEventEmit(r,i,e.len,o,n)}});try{let e=new Uint8Array(0),t=0,i=null,o=null;const s=async(s,a,l,c,u)=>{var d;if(g.fileSize||(g.fileSize=Number(Zu(u.headers))),s&&l.range&&l.range[0]===t&&(e=rl(Uint8Array,e,new Uint8Array(s)),t+=s.byteLength),l.meta){await this.MP4Loader.cancel();const c=(null==(d=null==s?void 0:s.priOptions)?void 0:d.type)||nu;this.bwEventEmit(r,c,e.byteLength,null,n);const u=l.meta,p=u.videoSegments,f=u.audioSegments;o={...u.meta,ext:{videoTrak:p,audioTrak:f}},g.meta=o,i=Mu(0,p,f),g.buffer=e.slice(i[0]),g.byteLength=g.buffer.byteLength;const _=Mu(1,p,f);let y=[];_[0]<_[1]&&i[1]>_[0]&&(y=[_[0],i[1]]);const m=(null==p?void 0:p.length)>0?p:f,{startTime:v}=m[0],{endTime:b}=m[0],w={startTime:v,endTime:b,range:[...i],repeatRange:y,duration:b-v,downloaded:!1,isLoading:!1,timeRangeIdx:[0,1]};g.adaptTimeRange=[w],this.log(zs.LOG,`${r} loadMetaProcess ret`,n,e.byteLength,JSON.stringify(i),g.buffer.byteLength,JSON.stringify(y)),this.setPreLoadData(n,g);const C=[t,i[1]];this.log(zs.LOG,`${n} loadMetaProcess end, loadOneChunk start`,a,JSON.stringify(C),t,e.byteLength),this._loadOneChunk(g,C,h,w.duration)}};await this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,_||y],s)}catch(e){console.error(`[Preloader] ${n} loadByChunkSize error`,e),this._endLoadChunk()}}async _loadOneChunk(e,t,r,n){if((null==t?void 0:t.length)>0&&t[0]>=t[1])return this._endLoadChunk(),void this.emit(Sd,e);const i=r,{vid:o,cacheKey:s,buffer:a}=e;try{const r=await this.MP4Loader.loadData(t,this.MP4Loader.cache,{index:0,url:i,priOptions:{}});this.log(zs.LOG,`${o} _loadOneChunk`,JSON.stringify(t),s);const{response:l,data:c}=r;if(c){if(this._endLoadChunk(),l&&l.headers){const t=Lu(l.headers);t&&(e.fileSize=t)}e.buffer=Iu(a,c),e.byteLength=e.buffer.byteLength,e.preloadTime+=n,this.log(zs.LOG,`${o} _loadOneChunk ret`,s,e.buffer.byteLength,null==c?void 0:c.byteLength),e.from=4,this.setPreLoadData(s,e)}else this._endLoadChunk()}catch(e){this.log(zs.ERROR,`[Preloader] ${o} loadByChunkSize error`,null==e?void 0:e.message),this._endLoadChunk()}}_endLoadChunk(){this.log(zs.LOG,`_endLoadChunk loadingCount:${this.loadingCount}`,this._pendingPromise?this._pendingPromise.state:null),this._pendingPromise&&(this._pendingPromise.resolve(),this._pendingPromise=null),this.loadingCount>0&&this.loadingCount--,this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy(),this.MP4Loader=null)}getAdaptRanges(e,t){const{timeRange:r}=e;for(let n=0;n<r.length&&r[n].startTime<=t;n++)e.updateAdaptTimeRange(n,1),e.getFragRange(n);return this._mp4.adaptTimeRange}async startLoadByFragments(e,t){const{preloadTime:r,vid:n}=t;this.log(zs.LOG,`[Preloader] ${n} startLoadByFragments`,t);const i=this.getAdaptRanges(this._mp4,r),o=e=>{this.log(zs.ERROR,`[Preloader] ${n} _failedCallback error`,null==e?void 0:e.message),this.emit("error",e),this._endLoadFragments()},s=async t=>{var r;if(!this._mp4)return;const{buffer:n,context:a,state:l,initSeg:c}=t,{fragIndex:u,range:d,timeRange:h}=a,{_repeatInfo:p,adaptTimeRange:f}=this._mp4,_=f[u],y=null==_?void 0:_.range,g=null==_?void 0:_.duration;!e.initSeg&&c&&(e.initSeg=c,e.adaptTimeRange=f);const m=this._mp4._lastDemuxSampleIdxRange;e.repeatData=(null==(r=p.data)?void 0:r.slice(0,p.curDataPos))||[];const v=this.updatePreCacheData(e,n,d,l,u,h,y,m,g);this.log(zs.LOG,`[Preloader] ${e.cacheKey} _successCallback`,u,l,v,e),e.from=3,v&&(await this.setPreLoadData(e.cacheKey,e),u>=i.length-1?(this.log(zs.LOG,`[Preloader] ${e.cacheKey} mp4.load end`,u),this.emit(Sd,e),this._endLoadFragments()):(this.log(zs.LOG,`[Preloader] ${e.cacheKey} mp4.load start`,u+1),await this._mp4.loadAllFragmentData(u+1,s,o)))};await this._mp4.loadAllFragmentData(0,s,o)}_endLoadFragments(){this.log(zs.LOG,`[Preloader] _endLoadFragments loadingCount:${this.loadingCount},${this.playerId}`,this._pendingPromise?this._pendingPromise.state:null),this._pendingPromise&&(this._pendingPromise.resolve(),this._pendingPromise=null),this.loadingCount>0&&this.loadingCount--,this._mp4&&(this._mp4.cancelLoading(),this._mp4.destroy(),this._mp4=null)}getFragment(e,t,r,n,i,o={}){const s=new md;return this.getData(e,t,o,!1).then(e=>{n.createFragment(new Uint8Array(e.res),t[0]-n.mdatStart,r,{range:t,context:e.context}).then(e=>{s.resolve(e)})}),s}getPreloadUrl({url:e,range:t,definition:r,vid:n}){return[{url:e,range:t,extData:{cacheKey:Pd.generateUniqueKey({vid:n,start:t[0],end:t[1],definition:r}),vid:n,format:"mp4"}}]}getRangeList(e){const{allCachedKeys:t}=this,r={timeRange:[],contentRange:[]};for(const n in t)if(t.hasOwnProperty(n)&&n.indexOf(e)>-1){const e=n.split("#");0===e[2].indexOf("pretime")?r.timeRange.push([0,parseFloat(e[2].slice(7))]):r.contentRange.push([parseInt(e[2]),parseInt(e[3])])}return r}hasItemSameVid(e){if(!e)return null;const t=e.split("#"),r=Object.keys(this.allCachedKeys);for(let n=0;n<r.length;n++){const i=r[n];if(i===e)return i;const o=i.split("#");if(o.length>=4&&t.length>=4&&o[0]===t[0]){if(0===o[2].indexOf("pretime")&&0===t[2].indexOf("pretime"))return i;{const e=[parseInt(o[2]),parseInt(o[3])],r=[parseInt(t[2]),parseInt(t[3])];if(r[0]>=e[0]&&r[1]>r[0]&&r[1]<=e[1])return i}}}return null}removeOthers(e=[]){const{allCachedKeys:t}=this;for(const r in t)if(t.hasOwnProperty(r)&&r.split("#").length>=1){const t=r.split("#")[0];e.every(e=>e.split("#").length>=1&&e.split("#")[0]!==t)&&(this.log(zs.LOG,`remove cache:${r}`),this.cacheInst.removeItem(r))}}removeAll(){const{allCachedKeys:e}=this;for(const t in e)e.hasOwnProperty(t)&&(this.log(zs.DEBUG,`remove cache:${t}`),this.cacheInst.removeItem(t))}removeAllPreloadTask(){this.preloadManager._preloadDataList=[],this.playingVids=[]}getItemSameVid(e,t){const r=this.hasItemSameVid(e);return this.log(zs.DEBUG,`getItemSameVid: key:${e} checkResult:${r}`),r?this.cacheInst.getItem(r,t).then(e=>({value:e,key:r})):Promise.resolve({})}setItem(e,t){return this.cacheInst.setItem(e,t)}removeItem(e,t){return this.cacheInst.removeItem(e,t)}get allCachedKeys(){return this.cacheInst._allCachedKeys||{}}get allCachedTimeKeys(){return this.cacheInst._allCachedTimeKeys||{}}get cacheInst(){return this.preloadManager._cacheInst}get preloadQueueList(){return this.preloadManager._preloadDataList||[]}cancelPreloadByVid(e,t){if(!e)return;const{_preloadDataList:r}=this.preloadManager,n=[];for(let t=0;t<r.length;t++){const{data:i}=r[t];i.vid!==e?n.push(r[t]):this.log(zs.LOG,"cancelPreloadByVid",e)}this.preloadManager._preloadDataList=n;const i=this.currentPreloadInst,o=i&&i.options?i.options:{};this.log(zs.LOG,"cancelPreloadByVid",e,t,e===o.vid,o),o.vid===e&&this.cancelLoading(),this.addPlayingItem(t,e)}addPlayingVid(e){if(!e)return;const{_preloadDataList:t}=this.preloadManager,r=function(e,t){return e.filter(e=>e.data.vid!==t)}(t,e);this.preloadManager._preloadDataList=r;const n=this.currentPreloadInst,i=n&&n.options?n.options:{};this.log(zs.LOG,"cancelPreloadByVid",e,e===i.vid,i),i.vid===e&&this.cancelLoading(),kd(this.playingVids1,e)||this.playingVids1.push(e)}removePlayingVid(e){const t=Ed(this.playingVids1,e);t>=0&&this.playingVids1.splice(t,1)}cancelLoading(){this.log(zs.LOG,"cancelLoading"),this._endLoadFragments(),this._endLoadChunk()}clearTaskItem(e){const{preloadManager:t}=this;if(t._currentPreloadInst){const{_toLoadList:r}=t._currentPreloadInst,n=[];r.map(t=>(t._playerId!==e&&n.push(t),t)),t._currentPreloadInst._toLoadList=n}const r=[],n=[];this.log(zs.LOG,"clearTaskItem before",e,t._preloadDataList.length),t._preloadDataList.map(t=>(t._playerId!==e?r.push(t):n.push(t.data.vid),t)),this.log(zs.LOG,"clearTaskItem",e,n.join(","),t._preloadDataList.length),t._preloadDataList=r}clearTask(){const{preloadManager:e}=this;e._preloadDataList=[]}addPreloader(e){if(!e.data)return;const{_preloadDataList:t}=this.preloadManager,{vid:r}=e.data,n=Cd(t||[],r),i=kd(this.playingVids1,r);if(this.log(zs.LOG,"[Preloader] addPreloader checkIfVidInList",r,n),n||i)return;const o=xu({},e);o.vtype||(o.vtype=tl.MP4),this.addDashPreloader(o)}addPreloaderList(e=[]){const t=[],{_preloadDataList:r}=this.preloadManager;for(let n=0;n<e.length;n++){const{vid:i,vtype:o}=e[n].data,s=Cd(r||[],i),a=kd(this.playingVids1,i);if(this.log(zs.LOG,"[Preloader] addPreloaderList checkIfVidInList",i,s,a),s||a)continue;const l=xu({},e[n]);o||(l.data.vtype=tl.MP4),t.push(l)}return this.log(zs.LOG,`[Preloader] addPreloaderList length is ${t.length}`),this.addDashPreloaderList(t),t}setUserSelectDefinition(e){this.preloadManager&&(this.preloadManager.userDefinition=e)}getUserSelectDefinition(){return this.preloadManager.userDefinition||null}cancel(e){this.clearTaskItem(e),this.delPlayingItem(e,null)}destroy(e){this.cancelLoading(),this.clearTaskItem(e),this.delPlayingItem(e,null)}on(e,t,...r){super.on(e,t,...r)}off(e,t,...r){super.off(e,t,...r)}}var Rd=Object.defineProperty,xd=(e,t,r)=>((e,t,r)=>t in e?Rd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);function Ld(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Id(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Md(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vd(n.key),n)}}function Dd(e,t,r){return t&&Md(e.prototype,t),r&&Md(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bd(e,t,r){return(t=Vd(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function jd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nd(Object(r),!0).forEach(function(t){Bd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ud(e){return function(e){if(Array.isArray(e))return Ld(e)}(e)||function(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ld(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ld(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vd(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function Fd(e){return Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fd(e)}var Hd=typeof window<"u"&&window.location&&window.location.href.indexOf("xgplayerdebugger=1")>-1,Gd={info:"color: #525252; background-color: #90ee90;",error:"color: #525252; background-color: red;",warn:"color: #525252; background-color: yellow; "},Wd="%c[xgplayer]",qd={config:{debug:Hd?3:0},logInfo:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=3&&(t=console).log.apply(t,[Wd,Gd.info,e].concat(n))},logWarn:function(e){for(var t,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.config.debug>=1&&(t=console).warn.apply(t,[Wd,Gd.warn,e].concat(n))},logError:function(e){var t;if(!(this.config.debug<1)){for(var r=this.config.debug>=2?"trace":"error",n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=console)[r].apply(t,[Wd,Gd.error,e].concat(i))}}},Kd=function(){return Dd(function e(t){Id(this,e),this.bufferedList=t},[{key:"start",value:function(e){return this.bufferedList[e].start}},{key:"end",value:function(e){return this.bufferedList[e].end}},{key:"length",get:function(){return this.bufferedList.length}}])}(),zd={createDom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return i.className=n,i.innerHTML=t,Object.keys(r).forEach(function(t){var n=t,o=r[t];"video"===e||"audio"===e||"live-video"===e?o&&i.setAttribute(n,o):i.setAttribute(n,o)}),i},createDomFromHtml:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{var n=document.createElement("div");n.innerHTML=e;var i=n.children;return n=null,i.length>0?(i=i[0],r&&zd.addClass(i,r),t&&Object.keys(t).forEach(function(e){i.setAttribute(e,t[e])}),i):null}catch(e){return qd.logError("util.createDomFromHtml",e),null}},hasClass:function(e,t){if(!e||!t)return!1;try{return Array.prototype.some.call(e.classList,function(e){return e===t})}catch{var r=e.className&&"object"===Fd(e.className)?e.getAttribute("class"):e.className;return r&&!!r.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}},addClass:function(e,t){if(e&&t)try{t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&e.classList.add(t)})}catch{zd.hasClass(e,t)||(e.className&&"object"===Fd(e.className)?e.setAttribute("class",e.getAttribute("class")+" "+t):e.className+=" "+t)}},removeClass:function(e,t){if(e&&t)try{t.replace(/(^\s+|\s+$)/g,"").split(/\s+/g).forEach(function(t){t&&e.classList.remove(t)})}catch{zd.hasClass(e,t)&&t.split(/\s+/g).forEach(function(t){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className&&"object"===Fd(e.className)?e.setAttribute("class",e.getAttribute("class").replace(r," ")):e.className=e.className.replace(r," ")})}},toggleClass:function(e,t){e&&t.split(/\s+/g).forEach(function(t){zd.hasClass(e,t)?zd.removeClass(e,t):zd.addClass(e,t)})},classNames:function(){for(var e=arguments,t=[],r=function(r){"String"===zd.typeOf(e[r])?t.push(e[r]):"Object"===zd.typeOf(e[r])&&Object.keys(e[r]).map(function(n){e[r][n]&&t.push(n)})},n=0;n<arguments.length;n++)r(n);return t.join(" ")},findDom:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,r=arguments.length>1?arguments[1]:void 0;try{e=t.querySelector(r)}catch(n){qd.logError("util.findDom",n),0===r.indexOf("#")&&(e=t.getElementById(r.slice(1)))}return e},getCss:function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,!1)[t]},padStart:function(e,t,r){for(var n=String(r),i=0|t,o=Math.ceil(i/n.length),s=[],a=String(e);o--;)s.push(n);return s.join("").substring(0,i-a.length)+a},format:function(e){if(window.isNaN(e))return"";e=Math.round(e);var t=zd.padStart(Math.floor(e/3600),2,0),r=zd.padStart(Math.floor((e-3600*t)/60),2,0),n=zd.padStart(Math.floor(e-3600*t-60*r),2,0);return("00"===t?[r,n]:[t,r,n]).join(":")},event:function(e){if(e.touches){var t=e.touches[0]||e.changedTouches[0];e.clientX=t.clientX||0,e.clientY=t.clientY||0,e.offsetX=t.pageX-t.target.offsetLeft,e.offsetY=t.pageY-t.target.offsetTop}e._target=e.target||e.srcElement},typeOf:function(e){return Object.prototype.toString.call(e).match(/([^\s.*]+)(?=]$)/g)[0]},deepCopy:function(e,t){if("Object"===zd.typeOf(t)&&"Object"===zd.typeOf(e))return Object.keys(t).forEach(function(r){"Object"!==zd.typeOf(t[r])||t[r]instanceof Node?"Array"===zd.typeOf(t[r])?e[r]="Array"===zd.typeOf(e[r])?e[r].concat(t[r]):t[r]:e[r]=t[r]:void 0===e[r]||void 0===e[r]?e[r]=t[r]:zd.deepCopy(e[r],t[r])}),e},deepMerge:function(e,t){return Object.keys(t).map(function(r){var n;"Array"===zd.typeOf(t[r])&&"Array"===zd.typeOf(e[r])?"Array"===zd.typeOf(e[r])&&(n=e[r]).push.apply(n,Ud(t[r])):zd.typeOf(e[r])!==zd.typeOf(t[r])||null===e[r]||"Object"!==zd.typeOf(e[r])||t[r]instanceof window.Node?null!==t[r]&&(e[r]=t[r]):zd.deepMerge(e[r],t[r])}),e},getBgImage:function(e){var t=(e.currentStyle||window.getComputedStyle(e,null)).backgroundImage;if(!t||"none"===t)return"";var r=document.createElement("a");return r.href=t.replace(/url\("|"\)/g,""),r.href},copyDom:function(e){if(e&&1===e.nodeType){var t=document.createElement(e.tagName);return Array.prototype.forEach.call(e.attributes,function(e){t.setAttribute(e.name,e.value)}),e.innerHTML&&(t.innerHTML=e.innerHTML),t}return""},setInterval:function(e,t,r,n){e._interval[t]||(e._interval[t]=window.setInterval(r.bind(e),n))},clearInterval:function(e,t){clearInterval(e._interval[t]),e._interval[t]=null},setTimeout:function(e,t,r){e._timers||(e._timers=[]);var n=setTimeout(function(){t(),zd.clearTimeout(e,n)},r);return e._timers.push(n),n},clearTimeout:function(e,t){var r=e._timers;if("Array"===zd.typeOf(r)){for(var n=0;n<r.length;n++)if(r[n]===t){r.splice(n,1),clearTimeout(t);break}}else clearTimeout(t)},clearAllTimers:function(e){var t=e._timers;"Array"===zd.typeOf(t)&&(t.map(function(e){clearTimeout(e)}),e._timerIds=[])},createImgBtn:function(e,t,r,n){var i,o,s,a=zd.createDom("xg-".concat(e),"",{},"xgplayer-".concat(e,"-img"));return a.style.backgroundImage='url("'.concat(t,'")'),r&&n&&(["px","rem","em","pt","dp","vw","vh","vm","%"].every(function(e){return!(r.indexOf(e)>-1&&n.indexOf(e)>-1&&(i=parseFloat(r.slice(0,r.indexOf(e)).trim()),o=parseFloat(n.slice(0,n.indexOf(e)).trim()),s=e,1))}),a.style.width="".concat(i).concat(s),a.style.height="".concat(o).concat(s),a.style.backgroundSize="".concat(i).concat(s," ").concat(o).concat(s),a.style.margin="start"===e?"-".concat(o/2).concat(s," auto auto -").concat(i/2).concat(s):"auto 5px auto 5px"),a},Hex2RGBA:function(e,t){var r=[];if(/^\#[0-9A-F]{3}$/i.test(e)){var n="#";e.replace(/[0-9A-F]/gi,function(e){n+=e+e}),e=n}return/^#[0-9A-F]{6}$/i.test(e)?(e.replace(/[0-9A-F]{2}/gi,function(e){r.push(parseInt(e,16))}),"rgba(".concat(r.join(","),", ").concat(t,")")):"rgba(255, 255, 255, 0.1)"},getFullScreenEl:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},checkIsFunction:function(e){return e&&"function"==typeof e},checkIsObject:function(e){return null!==e&&"object"===Fd(e)},hide:function(e){e.style.display="none"},show:function(e,t){e.style.display=t||"block"},isUndefined:function(e){if(typeof e>"u"||null===e)return!0},isNotNull:function(e){return null!=e},setStyleFromCsstext:function(e,t){t&&("String"===zd.typeOf(t)?t.replace(/\s+/g,"").split(";").map(function(t){if(t){var r=t.split(":");r.length>1&&(e.style[r[0]]=r[1])}}):Object.keys(t).map(function(r){e.style[r]=t[r]}))},filterStyleFromText:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["width","height","top","left","bottom","right","position","z-index","padding","margin","transform"],r=e.style.cssText;if(!r)return{};var n=r.replace(/\s+/g,"").split(";"),i={},o={};return n.map(function(e){if(e){var r=e.split(":");r.length>1&&(function(e,t){for(var r=0,n=t.length;r<n;r++)if(e.indexOf(t[r])>-1)return!0;return!1}(r[0],t)?i[r[0]]=r[1]:o[r[0]]=r[1])}}),e.setAttribute("style",""),Object.keys(o).map(function(t){e.style[t]=o[t]}),i},getStyleFromCsstext:function(e){var t=e.style.cssText;if(!t)return{};var r=t.replace(/\s+/g,"").split(";"),n={};return r.map(function(e){if(e){var t=e.split(":");t.length>1&&(n[t[0]]=t[1])}}),n},preloadImg:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};if(e){var n=new window.Image;n.onload=function(e){n=null,t&&t(e)},n.onerror=function(e){n=null,r&&r(e)},n.src=e}},stopPropagation:function(e){e&&e.stopPropagation()},scrollTop:function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},scrollLeft:function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},checkTouchSupport:function(){return"ontouchstart"in window},getBuffered2:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=[],n=0;n<e.length;n++)r.push({start:e.start(n)<.5?0:e.start(n),end:e.end(n)});r.sort(function(e,t){return e.start-t.start||t.end-e.end});var i=[];if(t)for(var o=0;o<r.length;o++){var s=i.length;if(s){var a=i[s-1].end;r[o].start-a<t?r[o].end>a&&(i[s-1].end=r[o].end):i.push(r[o])}else i.push(r[o])}else i=r;return new Kd(i)},getEventPos:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.touches&&e.touches.length>0&&(e=e.touches[0]),{x:e.x/t,y:e.y/t,clientX:e.clientX/t,clientY:e.clientY/t,offsetX:e.offsetX/t,offsetY:e.offsetY/t,pageX:e.pageX/t,pageY:e.pageY/t}},requestAnimationFrame:function(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(t)return t(e)},getHostFromUrl:function(e){if("String"!==zd.typeOf(e))return"";var t=e.split("/"),r="";return t.length>3&&t[2]&&(r=t[2]),r},cancelAnimationFrame:function(e){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.cancelRequestAnimationFrame;t&&t(e)},isMSE:function(e){return e.media&&(e=e.media),!!(e&&e instanceof HTMLMediaElement)&&(/^blob/.test(e.currentSrc)||/^blob/.test(e.src))},isBlob:function(e){return"string"==typeof e&&/^blob/.test(e)},generateSessionId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=(new Date).getTime();try{e=parseInt(e)}catch{e=0}return t+=e,window.performance&&"function"==typeof window.performance.now&&(t+=parseInt(window.performance.now())),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?r:3&r|8).toString(16)})},createEvent:function(e){var t;return"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t},adjustTimeByDuration:function(e,t,r){return t&&e&&(e>t||r&&e<t)?t:e},createPositionBar:function(e,t){var r=zd.createDom("xg-bar","",{"data-index":-1},e);return t.appendChild(r),r},getTransformStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,scale:1,rotate:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r={scale:"".concat(e.scale||1),translate:"".concat(e.x||0,"%, ").concat(e.y||0,"%"),rotate:"".concat(e.rotate||0,"deg")};return Object.keys(r).forEach(function(e){var n=new RegExp("".concat(e,"\\([^\\(]+\\)"),"g"),i="".concat(e,"(").concat(r[e],")");n.test(t)?(n.lastIndex=-1,t=t.replace(n,i)):t+="".concat(i," ")}),t},convertDeg:function(e){return Math.abs(e)<=1?360*e:e%360},getCurrentTimeByOffset:function(e,t){var r=-1;if(!t||t.length<0)return e;for(var n=0;n<t.length;n++)if(e<=t[n].duration){r=n;break}if(-1!==r){var i=t[r].start;return r-1<0?i+e:i+(e-t[r-1].duration)}return e},getIndexByTime:function(e,t){var r=t.length,n=-1;if(r<1)return n;if(e<=t[0].end||r<2)n=0;else if(e>t[r-1].end)n=r-1;else for(var i=1;i<r;i++)if(e>t[i-1].end&&e<=t[i].end){n=i;break}return n},getOffsetCurrentTime:function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if((r=n>=0&&n<t.length?n:zd.getIndexByTime(e,t))<0)return-1;var i=t.length,o=t[r],s=o.start,a=o.end,l=o.cTime,c=o.offset;return e<s?l:e>=s&&e<=a?e-c:e>a&&r>=i-1?a-c:-1}},Zd=/(Android)\s([\d.]+)/,Yd=/(Version)\/([\d.]+)/,Xd=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"],Qd={get device(){return Qd.os.isPc?"pc":"mobile"},get browser(){if(typeof navigator>"u")return"";var e=navigator.userAgent.toLowerCase(),t={ie:/rv:([\d.]+)\) like gecko/,firefox:/firefox\/([\d.]+)/,chrome:/chrome\/([\d.]+)/,opera:/opera.([\d.]+)/,safari:/version\/([\d.]+).*safari/};return[].concat(Object.keys(t).filter(function(r){return t[r].test(e)}))[0]},get os(){if(typeof navigator>"u")return{};var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),r=/(?:SymbianOS)/.test(e)||t,n=/(?:Android)/.test(e),i=/(?:Firefox)/.test(e),o=/(?:iPad|PlayBook)/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,s=o||n&&!/(?:Mobile)/.test(e)||i&&/(?:Tablet)/.test(e),a=/(?:iPhone)/.test(e)&&!s;return{isTablet:s,isPhone:a,isIpad:o,isIos:a||o,isAndroid:n,isPc:!(a||n||r||s),isSymbian:r,isWindowsPhone:t,isFireFox:i}},get osVersion(){if(typeof navigator>"u")return 0;var e=navigator.userAgent,t="",r=(t=/(?:iPhone)|(?:iPad|PlayBook)/.test(e)?Yd:Zd)?t.exec(e):[];if(r&&r.length>=3){var n=r[2].split(".");return n.length>0?parseInt(n[0]):0}return 0},get isWeixin(){return!(typeof navigator>"u")&&!!/(micromessenger)\/([\d.]+)/.exec(navigator.userAgent.toLocaleLowerCase())},isSupportMP4:function(){var e={isSupport:!1,mime:""};if(typeof document>"u")return e;if(this.supportResult)return this.supportResult;var t=document.createElement("video");return"function"==typeof t.canPlayType&&Xd.map(function(r){"probably"===t.canPlayType('video/mp4; codecs="'.concat(r,'"'))&&(e.isSupport=!0,e.mime+="||".concat(r))}),this.supportResult=e,t=null,e},isMSESupport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"';if(typeof MediaSource>"u"||!MediaSource)return!1;try{return MediaSource.isTypeSupported(e)}catch(t){return this._logger.error(e,t),!1}},isHevcSupported:function(){return!(typeof MediaSource>"u"||!MediaSource.isTypeSupported)&&(MediaSource.isTypeSupported('video/mp4;codecs="hev1.1.6.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.2.4.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.3.E.L120.90"')||MediaSource.isTypeSupported('video/mp4;codecs="hev1.4.10.L120.90"'))},probeConfigSupported:function(e){var t={supported:!1,smooth:!1,powerEfficient:!1};if(!e||typeof navigator>"u")return Promise.resolve(t);if(navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo)return navigator.mediaCapabilities.decodingInfo(e);var r=e.video||{},n=e.audio||{};try{var i=MediaSource.isTypeSupported(r.contentType),o=MediaSource.isTypeSupported(n.contentType);return Promise.resolve({supported:i&&o,smooth:!1,powerEfficient:!1})}catch{return Promise.resolve(t)}}},Jd="3.0.30",eh={1:5101,2:5102,3:5103,4:5104,5:5105,6:5106},th=Dd(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{errorType:"",errorCode:0,errorMessage:"",originError:"",ext:{},mediaError:null};Id(this,e);var n=t&&t.i18n?t.i18n.ERROR_TYPES:null;if(t.media){var i=r.mediaError?r.mediaError:t.media.error||{},o=t.duration,s=t.currentTime,a=t.ended,l=t.src,c=t.currentSrc,u=t.media,d=u.readyState,h=u.networkState,p=r.errorCode||i.code;eh[p]&&(p=eh[p]);var f={playerVersion:Jd,currentTime:s,duration:o,ended:a,readyState:d,networkState:h,src:l||c,errorType:r.errorType,errorCode:p,message:r.errorMessage||i.message,mediaError:i,originError:r.originError?r.originError.stack:"",host:zd.getHostFromUrl(l||c)};return r.ext&&Object.keys(r.ext).map(function(e){f[e]=r.ext[e]}),f}if(arguments.length>1){for(var _={playerVersion:Jd,domain:document.domain},y=["errorType","currentTime","duration","networkState","readyState","src","currentSrc","ended","errd","errorCode","mediaError"],g=0;g<arguments.length;g++)_[y[g]]=arguments[g];return _.ex=n?(n[arguments[0]]||{}).msg:"",_}}),rh="loadeddata",nh="loadstart",ih="definition_change",oh="after_definition_change";function sh(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];var s=t.call.apply(t,[e].concat(i));!r||"function"!=typeof r||(s&&s.then?s.then(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];r.call.apply(r,[e].concat(n))}):r.call.apply(r,[e].concat(i)))}function ah(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pre:null,next:null};return this.__hooks||(this.__hooks={}),!this.__hooks[e]&&(this.__hooks[e]=null),function(){var n=arguments,i=this;if(r.pre)try{var o;(o=r.pre).call.apply(o,[this].concat(Array.prototype.slice.call(arguments)))}catch(t){throw t.message="[pluginName: ".concat(this.pluginName,":").concat(e,":pre error] >> ").concat(t.message),t}if(this.__hooks&&this.__hooks[e])try{var s,a=(s=this.__hooks[e]).call.apply(s,[this,this].concat(Array.prototype.slice.call(arguments)));a?a.then?a.then(function(e){!1!==e&&sh.apply(void 0,[i,t,r.next].concat(Ud(n)))}).catch(function(e){throw e}):sh.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments))):void 0===a&&sh.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments)))}catch(t){throw t.message="[pluginName: ".concat(this.pluginName,":").concat(e,"] >> ").concat(t.message),t}else sh.apply(void 0,[this,t,r.next].concat(Array.prototype.slice.call(arguments)))}.bind(this)}function lh(e,t){var r=this.__hooks;if(r)return r.hasOwnProperty(e)?(r&&(r[e]=t),!0):(console.warn("has no supported hook which name [".concat(e,"]")),!1)}function ch(e,t){var r=this.__hooks;r&&delete r[e]}function uh(e,t){qd.logError("[".concat(e,"] event or callback cant be undefined or null when call ").concat(t))}var dh=function(){return Dd(function e(t){Id(this,e),zd.checkIsFunction(this.beforeCreate)&&this.beforeCreate(t),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e.__hooks={},t&&t.map(function(t){e.__hooks[t]=null}),Object.defineProperty(e,"hooks",{get:function(){return e.__hooks&&Object.keys(e.__hooks).map(function(t){if(e.__hooks[t])return t})}})}(this),this.__args=t,this.__events={},this.__onceEvents={},this.config=t.config||{},this.player=null,this.playerConfig={},this.pluginName="",this.__init(t)},[{key:"beforeCreate",value:function(e){}},{key:"afterCreate",value:function(){}},{key:"beforePlayerInit",value:function(){}},{key:"onPluginsReady",value:function(){}},{key:"afterPlayerInit",value:function(){}},{key:"destroy",value:function(){}},{key:"__init",value:function(e){this.player=e.player,this.playerConfig=e.player&&e.player.config,this.pluginName=e.pluginName?e.pluginName.toLowerCase():this.constructor.pluginName.toLowerCase(),this.logger=e.player&&e.player.logger}},{key:"updateLang",value:function(e){e||(e=this.lang)}},{key:"lang",get:function(){return this.player.lang}},{key:"i18n",get:function(){return this.player.i18n}},{key:"i18nKeys",get:function(){return this.player.i18nKeys}},{key:"domEventType",get:function(){var e=zd.checkTouchSupport()?"touch":"mouse";return this.playerConfig&&("touch"===this.playerConfig.domEventType||"mouse"===this.playerConfig.domEventType)&&(e=this.playerConfig.domEventType),e}},{key:"on",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(this.__events[e]=t,this.player.on(e,t)):Array.isArray(e)&&e.forEach(function(e){r.__events[e]=t,r.player.on(e,t)}):uh(this.pluginName,"plugin.on(event, callback)")}},{key:"once",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(this.__onceEvents[e]=t,this.player.once(e,t)):Array.isArray(e)&&e.forEach(function(n){r.__onceEvents[n]=t,r.player.once(e,t)}):uh(this.pluginName,"plugin.once(event, callback)")}},{key:"off",value:function(e,t){var r=this;e&&t&&this.player?"string"==typeof e?(delete this.__events[e],this.player.off(e,t)):Array.isArray(e)&&e.forEach(function(n){delete r.__events[e],r.player.off(n,t)}):uh(this.pluginName,"plugin.off(event, callback)")}},{key:"offAll",value:function(){var e=this;["__events","__onceEvents"].forEach(function(t){Object.keys(e[t]).forEach(function(r){e[t][r]&&e.off(r,e[t][r]),r&&delete e[t][r]})}),this.__events={},this.__onceEvents={}}},{key:"emit",value:function(e){var t;if(this.player){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this.player).emit.apply(t,[e].concat(n))}}},{key:"emitUserAction",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.player){var n=jd(jd({},r),{},{pluginName:this.pluginName});this.player.emitUserAction(e,t,n)}}},{key:"hook",value:function(e,t){return ah.call.apply(ah,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"useHooks",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return lh.call.apply(lh,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"removeHooks",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return ch.call.apply(ch,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"registerPlugin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(this.player)return r&&(t.pluginName=r),this.player.registerPlugin({plugin:e,options:t})}},{key:"getPlugin",value:function(e){return this.player?this.player.getPlugin(e):null}},{key:"__destroy",value:function(){var e=this,t=this.player,r=this.pluginName;this.offAll(),zd.clearAllTimers(this),zd.checkIsFunction(this.destroy)&&this.destroy(),["player","playerConfig","pluginName","logger","__args","__hooks"].map(function(t){e[t]=null}),t.unRegisterPlugin(r),this.__hooks=null}}],[{key:"defineGetterOrSetter",value:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&Object.defineProperty(e,r,t[r])}},{key:"defaultConfig",get:function(){return{}}},{key:"pluginName",get:function(){return"pluginName"}}])}();class hh{constructor(e){xd(this,"onTick",e=>{this&&(this.cancelPending&&this.cancelPending(),this.alive&&(this.onTick_&&this.onTick_(),e&&e()))}),this.onTick_=e,this.timeoutId=null,this.alive=!0}tickAfter(e,t=null){return this.cancelPending?this.cancelPending():this.cancelPending=()=>{clearTimeout(this.timeoutId),this.timeoutId=null},this.alive=!0,this.timeoutId=setTimeout(this.onTick,1e3*e,t),this}tickEvery(e){this.tickAfter(e,()=>{this.tickEvery(e)})}stop(){this.alive=!1,this.cancelPending&&(this.cancelPending(),this.cancelPending=null)}}class ph extends Sr.EventEmitter{constructor(e){super(),this.masterTimer=void 0,this.onVisibleChange=()=>{const e=this.masterTimer||this.workerTimer;this.stop(),e&&this.start()},this.options=e,document.addEventListener("visibilitychange",this.onVisibleChange)}start(){const{frequency:e}=this.options;this.stop(),this.masterTimer=new hh(()=>{try{(this.masterTimer||this.workerTimer)&&this.emit(du)}catch{}}),this.masterTimer.tickEvery(e)}stop(){this.workerTimer&&(this.workerTimer=void 0),this.masterTimer&&(this.masterTimer.stop(),this.masterTimer=void 0)}destroy(){this.removeAllListeners(),document.removeEventListener("visibilitychange",this.onVisibleChange),this.stop()}}const fh="DESTROYED",_h="xglog_cache",yh="degrade",gh="fps_stuck";let mh=null,vh=null,bh=null,wh=null,Ch=null,Eh=0,kh=null;class Th extends dh{constructor(e){var t,r;super(e),xd(this,"_onChangeConfig",e=>{if(e){const t=e.nextBufferLength===this.config.minBufferLength;if(this.setConfig(e),e.nextBufferLength&&!t)try{this._onTimeUpdate()}catch{}}}),xd(this,"fpsStuckHandle",e=>{const{player:t,mse:r}=this;if(this.fpsStuckTime||(this.fpsStuckTime=e.currentTime,this.log(zs.LOG,"fpsStuckHandle, currentTime,",e.currentTime)),this.fpsStuckTime>0){const e=t.bufferedPoint;r.clearOpQueues(ua.VIDEO),this.log(zs.LOG,"fpsStuckHandle, remove,",e.start,"-",e.end,",seekTime,",this.fpsStuckTime),null==r||r.remove(ua.VIDEO,e.start,e.end).then(()=>{t.currentTime=this.fpsStuckTime,this.fpsStuckTime=null})}}),xd(this,"_retryHook",()=>{const{player:e,playerConfig:t}=this,{paused:r}=e;this.softDecode?e.vtype="MP4_MSE_SOFT":e.vtype="MP4_MSE",this._defInited=!1;const n=e.currentTime||0;return this.log(zs.LOG,"retryHook ",t.vid,this.codecType,n),this._addMetaDataEvent(()=>{n&&(e.currentTime=n,this.log(zs.LOG,"retryHook update currentTime",t.vid,this.codecType,n)),r?e.pause():e.play(),this._removeMetaDataEvent()}),this.destroyMSE(),this._reset(),this.playerStartInit(t.url),!1}),xd(this,"_playHook",(e,...t)=>{this._usePaused=!1,this._canceLoading=!1,this.log(zs.LOG,"playHook"),this._startProgress()}),xd(this,"_pauseHook",(e,...t)=>{var r,n;this._usePaused=!0,this.log(zs.LOG,"pauseHook",t[0],null==(r=this.player)?void 0:r.currentTime),t.indexOf(null==(n=uu)?void 0:n.BUFFER_CONTROLS)<0&&(clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=null,this.log(zs.LOG,"pause hook clear buffer_control state")),this._loadStuckCheck()}),xd(this,"abrSwitchURL",async e=>{const{playerConfig:t}=this,r=t.definition.list;let n=0;for(let t=0;t<r.length;t++)if(e.definition===r[t].definition){n=t;break}const i=this.player.curDefinition;this.changeDefinition(r[n],i,!0)}),xd(this,"timerHandle",()=>{this._requestTimer&&this._onTimeUpdate()}),xd(this,"changeDefineCanPlay",(e,t,r,n)=>{const{player:i}=this;if(i.ended)return void(i.currentTime=0);const{_changeDefState:o}=this;i.currentTime=o?o.currentTime:e,(o?o.paused:t)?i.pause():i.play(),this._changeDefState=null,i.emit(oh,{from:r,to:n})}),xd(this,"changeDefinition",(e,t,r)=>{var n,i;const{player:o,playerConfig:s,mp4:a,config:l}=this;if(t||(t=o.curDefinition),this._MSEError=!1,this._isReceiveEndedEvent=!1,this.useVideoLoad)return"__auto__"===e.url&&(e.url=s.definition.list[0].url),void bh.call(this.player,e,t);const{definitionList:c}=o,u=c.filter(t=>t.definition===e.definition);u.length>0&&(e=u[0]);const d=this._handlerUrl(e.url);if(!d)return;if(l._mainURL=d.main,l._backupURL=d.backup,e._mainURL=l._mainURL,e._backupURL=l._backupURL,l.switchBitRateWay&&!r)return void this.oldChangeDefinition(e,t);const h="自动"===e.definition||"auto"===e.definition;if(r)this.log(zs.LOG,"[switchBitrate:ABR], ready to switch bitRate, ",e.bitrate,e.definition);else{let r=!1;if(h)this._abrService&&this._abrService.enable(),r=!0;else{this._abrService&&this._abrService.disable();const r=null==(n=s.definition)?void 0:n.list;if(r&&(!e.bitrate||!e.uri||!e.size||!e.duration))for(let n=0;n<r.length;n++)if(e.definition===r[n].definition){e.bitrate=r[n].bitrate,e.uri=r[n].uri||t.uri,e.size=r[n].size||Lu(e.bitrate,s.duration),e.duration=r[n].duration||this.playerConfig.duration;break}}null==(i=this.adaptRange)||i.updateBitrate(e.bitrate),o.emit(ih,{from:t,to:e}),setTimeout(()=>{this._abrService&&this._abrService.updateAutoDefiDesc(o.curDefinition.definition,!h)}),r&&(e=o.curDefinition),this.log(zs.LOG,"[switchBitrate:CBS],switch bitRate, ",e.bitrate,e.definition)}if(o.curDefinition=e,this.mp4.clearPCDNNodeList(),this.checkPCDN(),!a)return;["keyValue","kid","secretKey","drm","getLicenseUrl","drmKeyToken","sessionId"].forEach(t=>{l[t]=e[t]});let p=null;Wu(this.config)?(this._initSecret(),p=this._secretkey.getLicenseSecret()):(p=new md,p.resolve()),p.then(async n=>{var i;null!=n&&n.secretKey&&(!l.keyValue&&(l.secretKey=n.secretKey),l.decryptKey=n.decryptKey),s.url=e.url;let c=0,u=!1;if(this._abrService&&this._abrService.isCurrentInAbr()){const e=o.getBufferedRange(o.buffered2);c=e[1],c<o.currentTime&&(c=o.currentTime,this.log(zs.LOG,"abr,bufferRange is invalid, adjust",e,",timeStart,",c))}else c=o.currentTime,u=!0;const d=a.getFragmentIdx(c);let h=this.getAdaptTimeRangeIdx(d);h<0&&(h=this._curLoadSegmentIdx),this.log(zs.LOG,`switchBitrate point: ${h}`,`startTime: ${a.adaptTimeRange[h].startTime}`,`currentTime: ${o.currentTime}, timeStart: ${c}`),u&&o.emit("definitionSwitchTime",a.adaptTimeRange[h].startTime+1);const p=Math.max(a.adaptTimeRange[h].startTime,o.currentTime);this._definitionChangePointInfo={changeStartTime:p,changeInfo:{from:t,to:e}},this.changeState("changeDefinition",{abr:r,fragIndex:h,startTime:a.adaptTimeRange[h].startTime,currentTime:o.currentTime}),a&&(a.updateChangeBitRateTime(c),this.canDownload=!1,await a.cancelLoading(),a.metaLoading&&(a.metaLoading=!1)),this._removeBuffeEndTime=a.adaptTimeRange[h].startTime,this._isChangeDefinition=!0;const f=o.getBufferedRange(o.buffered),_=null==(i=this._abrService)?void 0:i.isCurrentInAbr();f[1]>0&&f[1]-o.currentTime>5&&(!this._abrService||!_)&&(this.mse.clearOpQueues(ua.VIDEO),this.removeBuffer(ua.VIDEO,o.currentTime+5,f[1])),this.log(zs.LOG,"switchBitrate: resetFragmentLoadState,",h),a.resetFragmentLoadState(h),this._curLoadSegmentIdx=h,await this.mp4.changeBitRate(e),this._setCurrentDefinition(e.bitrate),this._emitDefinitionChangeDetailEvent(c),this.canDownload=!0,this._onTimeUpdate();const y={width:e.width||e.vwidth,height:e.height||e.vheight};o.emit("RESOLUTION_UPDATE",y)}).catch(t=>{this.log(zs.ERROR,"switchBitrate: GET_LICENSE_ERROR,",null==t?void 0:t.message);const r=new th(this.player,{errorType:gu.DRM,errorCode:yu.drm,errorMessage:(null==t?void 0:t.message)||"GET_LICENSE_ERROR",vid:s.vid});t.errorType="GET_LICENSE_ERROR",this.emit("GET_LICENSE_ERROR",r),this.changeState("LICENSE_ERROR",{d:e.definition})})}),xd(this,"_onVideoError",e=>{var t,r,n,i;const{player:o}=this;this.changeState("video_error",{code:e.code||(null==(r=null==(t=null==o?void 0:o.video)?void 0:t.error)?void 0:r.code),message:e.message||(null==(i=null==(n=null==o?void 0:o.video)?void 0:n.error)?void 0:i.message),videoType:this.useVideoLoad})}),xd(this,"removeBuffer",(e,t,r,n)=>{var i;const o=this.getBufferDur();null==(i=this.mse)||i.remove(e,t,r).then(()=>{const e=this.getBufferDur(),t=o-e;t>0&&(this.emit("removeBuffer",{removeDur:t}),this.log(zs.LOG,"removeBuffer dur,",t)),n&&n()})}),xd(this,"_onPause",()=>{this._loadStuckCheck()}),xd(this,"_onPlaying",()=>{var e,t,r;this.changeState("playing",{curtime:this.player.currentTime,buffer:JSON.stringify(null==(t=null==(e=this.player)?void 0:e.buffered2)?void 0:t.bufferedList)}),this._waitAdjustTimeCnt>0&&this._waitInBufferTimer&&(this._waitAdjustTimeCnt-=1,this.changeState("waitInBuffer_resume"),this.log(zs.WARN,"[waitInBuffer resume play], waitAdjustTimeCnt,",this._waitAdjustTimeCnt)),clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null;const{mp4:n,player:i}=this,{resumePlayWaterLevel:o}=this.config;if(n){if(!(n&&n.meta&&n.meta.duration-i.currentTime<=o)&&(this.waitLevelStartTime<0&&(this.waitLevelStartTime=i.currentTime),this.playFlag||(this.playFlag=!0),o>0&&i.currentTime-this.waitLevelStartTime>=2)){const e=i.getBufferedRange(i.buffered2);e[1]>0&&e[1]-i.currentTime<o?(i.paused||(this.emit(ru,{type:"waiting"}),i.pause(null==(r=uu)?void 0:r.BUFFER_CONTROLS),this.log(zs.LOG,"[!!!!!buffer not rich, pause],currentTime, ",i.currentTime,", bufferEnd,",e[1])),clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=setTimeout(this._onPlaying,o/2*1e3)):i.isBufferControlPaused&&i.paused&&(this.log(zs.LOG,"[!!!!!buffer rich, play],, currentTime, ",i.currentTime,", bufferEnd,",e[1]),clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=null,i.isBufferControlPaused=!1,this.emit(ru,{type:"playing"}),i.play())}}else this.checkResumePlayTimer>0&&(clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=null,i.isBufferControlPaused&&(i.isBufferControlPaused=!1),i.paused&&i.play())}),xd(this,"_lowDecoder",e=>{var t,r;const n=Gu(this.player);this.log(zs.WARN,`H265 lowdecode: ${this.playerConfig.vid} `,n,", h265Degrade, ",this.config.h265Degrade),this.config.h265Degrade&&this._onDegrade({errorCode:null==(t=null==e?void 0:e.detail)?void 0:t.code,errorMessage:null==(r=null==e?void 0:e.detail)?void 0:r.message,...e.detail})}),xd(this,"_onError",e=>{this._onDegrade(e)}),xd(this,"_onDegrade",(e,t=!1)=>{var r;const{player:n,playerConfig:i,config:o}=this;Hu(n,"warning",this._onDegrade),Hu(n,"error",this._onError),null==(r=this.mp4)||r.destroy();const{currentTime:s}=n;this.log(zs.WARN,"[h265 degrade], vid,",i.vid,",currtime,",s);const a=(null==e?void 0:e.errorCode)||-1;if(this.emit(yh,{errorCode:a,errorMessage:(null==e?void 0:e.errorMessage)||(null==e?void 0:e.message),codecType:this.codecType,mediaType:i.mediaType,passive:t?1:0,isSoftWareDecodeError:a>1e4}),null!=o&&o.H264Config){const{H264Config:e}=o;["drm","getLicenseUrl","kid","keyValue","secretKey","isEncrypt","useEME"].forEach(t=>{o[t]=e[t]||null})}const l={mp4encryptplayer:o,mediaType:"video",codecType:hu},c=(null==i?void 0:i.H264DefinitionList)||[];if(c.length>0){i.definition.list=c,i.url=c[0].url,i.defaultBitrate=c[0].bitrate,i.defaultDefinition=c[0].definition,this.config.needPreloadCheck=!0,this.isH265DegradeH264=!0,n.playNext(l,!1);const e=()=>{n.currentTime=s,this.isH265DegradeH264=!1,this.log(zs.LOG,"H265DegradeH264 update currentTime",s),this._removeMetaDataEvent()};this._addMetaDataEvent(e)}else n.pause(),this._reset(),this.checkReUseMSE(!1),this.log(zs.ERROR,"H265 error,degrade h264 but no h264 url"),this.emit("error",e)}),xd(this,"_onMp4MetaReady",e=>{var t,r;if(!this.mp4)return;const n=this.firstFrameTime;n.metaload=this.mp4.firstFrameTime.metaload,n.bitrate=this.player.curDefinition.bitrate;const i=this._checkMetaInfo(e);if(this.emit(Xu,{...e,error:i,timeRange:(null==(t=this.mp4)?void 0:t.timeRange)||[]}),i)this._errorHandler(i);else{try{this._initEME(this.mp4,e),this.softDecode?(this.log(zs.LOG,"initH265MseProxy"),this._initH265MseProxy()):this.player.video instanceof HTMLVideoElement&&(this.log(zs.LOG,"initMse"),this._initMse(e)),null==(r=this._initPromise)||r.resolve()}catch(e){return void this._errorHandler(new th(this.player,{errorType:gu.MEDIA,errorCode:yu.eme_hijack,errorMessage:(null==e?void 0:e.message)||"eme or mse catch err",vid:this.playerConfig.vid}))}if(this.mp4&&this.mp4.timeRange){const e=[];this.mp4.timeRange.every(t=>(e.push({startTime:t.startTime,endTime:t.endTime}),!0)),this.emit("KEYFRAMETIME",e)}this._loadData()}}),xd(this,"_onMp4Error",async(e,t)=>{const{vid:r}=this.playerConfig;console.error("[Index] _onMp4Error",r,e),this.changeState("MP4_ERROR",{state:t,errmsg:(null==e?void 0:e.errorMessage)||(null==e?void 0:e.message),errorType:null==e?void 0:e.errorType,code:null==e?void 0:e.errorCode,httpCode:null==e?void 0:e.httpCode}),this._errorHandler(e)}),xd(this,"_onMp4Progress",e=>{this.emit("progress_event",e)}),xd(this,"_onMp4DataCallBack",()=>{this._isMseInit&&this._onTimeUpdate()}),xd(this,"_updateDrmConfig",e=>{const{config:t,mp4:r}=this;r.updateSecretKey(t.useEME,t.secretKey,t.decryptKey,t.keyValue),this._secretkey&&e.kid&&this._secretkey.updateKid(e.kid)}),xd(this,"_updateMSE",e=>{const{player:t}=this;t.video instanceof HTMLVideoElement&&(this.log(zs.LOG,"updateMse",e.videoCodec),this._initMse(e))}),xd(this,"_onVideoTimeUpdate",()=>{var e,t;const{mse:r,player:n}=this;this.waitLevelStartTime<0&&(this.waitLevelStartTime=n.currentTime),this.checkReStartTimer(),this._isEnded(),n.isSeeking&&(n.isSeeking=!1),!this.useVideoLoad&&r&&this._removeBuffeEndTime>0&&n.currentTime>this._removeBuffeEndTime+1&&(this.log(zs.LOG,"remove old bitrate buffer",this._removeBuffeEndTime),this.removeBuffer(ua.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0);const i=this._definitionChangePointInfo;if(i&&n.currentTime>i.changeStartTime){n.emit(oh,i.changeInfo);const r=i.changeInfo||{};this.log(zs.LOG,oh,", currentTime,",n.currentTime,",from ",null==(e=null==r?void 0:r.from)?void 0:e.definition," to ",null==(t=null==r?void 0:r.to)?void 0:t.definition),this._definitionChangePointInfo=null}!this.useVideoLoad&&null===this._requestTimer&&!this._offineLine&&!this._canceLoading&&this._startProgress()}),xd(this,"_onBufferedReset",()=>{this.mp4&&this.mp4.videoTrak&&this.mp4.resetFragmentLoadState(0)}),xd(this,"_onOnlineHandler",()=>{this._offineLine=!1;const{playerConfig:e,player:t}=this,{currentTime:r,paused:n}=t;if(this.log(zs.LOG,"online useVideoLoad:",this.useVideoLoad,this._hasStartProgressBack),this.useVideoLoad){const i=()=>{r&&(t.currentTime=r),this.log(zs.LOG,"onOnlineHandler update currentTime",e.vid,this.codecType,this._currentTime),n?t.pause():t.play(),this._removeMetaDataEvent()};this._addMetaDataEvent(i),this._setPlayerSrc(e.url)}else this._hasStartProgressBack&&this._startProgress(),this._hasStartProgressBack=!1}),xd(this,"_onOfflineHandler",()=>{this._offineLine=!0,this.log(zs.LOG,"offline, ",this._hasStartProgress),this._hasStartProgress&&(this._stopProgress(),this._hasStartProgressBack=!0)}),xd(this,"_loadDataSuccess",e=>{var t,r,n;if(this.isDestroy||!this.mse&&!this.mseProxy)return;const i=this.firstFrameTime;if(i.startload_stmux<0){const{startMuxTime:e,firstmux:t}=this.mp4.firstFrameTime;i.startload_stmux=e,i.firstmux=t}i.loadst_loadeddata<0&&(i.loaddata=Pu()-this.loadstart);try{e.initSeg&&(this._appendInitSeg(e.initSeg),(!e.buffer||e.buffer.byteLength<1)&&this._onTimeUpdate());const{buffer:i,state:o,context:s,videoTrack:a,audioTrack:l}=e;this.debugInfo.loadIndx=s?s.fragIndex:-1;const c=null==(n=null==(r=null==(t=this.mp4)?void 0:t.adaptTimeRange[s.fragIndex])?void 0:r.timeRangeIdx)?void 0:n[1];if(this.mse&&o&&(!i||i.byteLength<=0)&&c>=this.mp4.timeRange.length){const{buffered:e}=this.player;e&&(null==e?void 0:e.length)>0&&(this.bufferEndTime=e.end(e.length-1)),this._isEnded(),this.log(zs.LOG,"loaded ended !!!==>>>",JSON.stringify(s.range),", fragIndex,",s.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}if(i&&this.mse){if(i&&i.byteLength>0){this._appendBuffer(ua.VIDEO,i,s,o);const e=this.getDataBitRate(s.fragIndex);this.player.emit("addVideoBufferEnd",{start:Math.floor(s.startPts),end:s.endPts,bandwidth:e.bitrate})}}else this.mseProxy&&(a&&a.samples.length>0||l&&l.samples.length>0)&&(this.log(zs.LOG,"[livevideo] append,index,",s.fragIndex,",range,",JSON.stringify(e.context.range),", timeRange,",s.timeRange),this.mseProxy.appendBuffer(a,l))}catch(e){this.changeState("APPEND_DATA_ERROR",{errMsg:null==e?void 0:e.message});const t=new th(this.player,{errorType:gu.MEDIA,errorCode:yu.mseAppend,vid:this.playerConfig.vid,errorMessage:e.message,mediaError:{code:yu.mseAppend,message:e.message}});this._errorHandler(t)}null!=e&&e.state&&this._onTimeUpdate()}),xd(this,"_onResumePlaying",()=>{this._resumePlay=!0}),xd(this,"_seekOnce",e=>{const{player:t}=this;t&&(t.currentTime=e+.1*Math.pow(2,this._currentSeekTimes||0),this._currentSeekTimes++,this.log(zs.LOG,`当前第${this._currentSeekTimes}次Seek，currentTime=${null==t?void 0:t.currentTime}`))}),xd(this,"_onWaiting",()=>{var e,t,r;this.checkReStartTimer(),this._isEnded();const n=null==(t=null==(e=this.player)?void 0:e.buffered2)?void 0:t.bufferedList;this.changeState("waiting",{curtime:this.player.currentTime,buffer:JSON.stringify(n)});const{player:i,config:o,playerConfig:s,mp4:a}=this;clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null;const l=i.currentTime;this.log(zs.LOG,",[onWaiting],curTime, ",l,",buffer,",JSON.stringify(n),",dur,",null==(r=null==a?void 0:a.meta)?void 0:r.duration);const c=i.bufferedPoint;c.end>0&&c.end-l>=2?this._waitAdjustTimeCnt<o.waitJampBufferMaxCnt?this._waitInBufferTimer=setTimeout(()=>{this._waitAdjustTimeCnt++,this.changeState("waitInBuffer_seek",{waitAdjustTimeCnt:this._waitAdjustTimeCnt,curTime:l}),i.currentTime=i.currentTime+.5},o.waitingInBufferTimeOut):this._errorHandler(new th(this.player,{errorType:gu.RUNTIME,errorCode:yu.waitTimeout,errorMessage:"onWaitTimeout_in_buffer",vid:s.vid})):this._loadStuckCheck()}),xd(this,"_onEnded",()=>{this.log(zs.LOG,"[player.onEnded], stopProgress"),this._stopProgress()}),xd(this,"_errorHandler",e=>{const{player:t,playerConfig:r,preLoadData:n}=this;if(!t||this.useVideoLoad)return;if(e.errorCode===yu[403]&&this._emitExpireEvent(e)&&this.config.urlExpireDisableErrorEvent)return this.log(zs.LOG,"_errorHandler urlExpireDisableErrorEvent",this.config.urlExpireDisableErrorEvent,",errorCode,",e.errorCode),this._stopProgress(),void this.emit(_h);if("object"!=typeof e){const t={};t.err=e,e=t}e.ext||(e.ext={});const i=t.paused;if(e.ext.vid=r.vid,e.ext.preloadHit=this.hitpreload?1:0,e.ext.preloadCached=n?n.duration:0,e.ext.timerStep=Math.max(...this.timerStepList),e.ext.codectype=this.codecType,e.errorMessage=e.message,e=new th(t,e),this.log(zs.ERROR,"_errorHandle",`preState is ${i}`,null==e?void 0:e.errorCode,(null==e?void 0:e.message)||(null==e?void 0:e.errorMessage)),!e.url&&(e.url=t.src),e.errd&&"object"==typeof e.errd&&this.mp4&&(e.errd.url=this.mp4.url,e.url=this.mp4.url),this.player.emit("playCatch",this.player.vtype,e),this.emit("DATA_REPORT",e),this.mp4&&this.mp4.cancelLoading(),this._abrService&&this._abrService.disable(),this.canDownload=!1,this.mp4&&this.mp4.bufferCache&&this.mp4.bufferCache.clear(),this.checkIsDegraded(e))this.player.vtype="MP4_2",this._initPromise&&this.removeAndRejectInitPromise(e),this.startDegradedPlayback(e,i);else{this.log(zs.ERROR,"final error !!!!, ",r.vid,null==e?void 0:e.errorCode,(null==e?void 0:e.errorMessage)||(null==e?void 0:e.message)),this.player.pause(),this._reset();const{currentTime:n}=t;this.destroyMSE(),t.currentTime=n,this.emit("error",e)}this.emit(_h)}),xd(this,"_onSeeking",async()=>{var e,t,r;if(this._isReceiveEndedEvent=!1,this.useVideoLoad)return;const{player:n,mp4:i}=this;this.waitLevelStartTime=n.currentTime;const o=n.currentTime;if(this.changeState("seeking",{curTime:o}),this.log(zs.LOG,"[seeking], curTime,",o,",buffer,",JSON.stringify(n.buffered2.bufferedList)),!i||!i.meta)return;this._startProgress(),this.endofstream=!1,i.bufferUsedPos=0,i.metaLoading=!1,this._definitionChangePointInfo&&(this._definitionChangePointInfo.changeStartTime=o,this.log("[seeking update definitionChangePointInfo.changeStartTime]",o)),i.changeBitRateTime>0&&(i.updateChangeBitRateTime(o),this.log("[seeking update changeBitRateTime]",o));const s=n.bufferedPoint;let a=!1,l=0;if(s.end>0){if(a=!0,i.meta.duration-s.end<.5)return void this.log("[seeking in buffered range], buffer end,",s.end,", duration,",null==(e=null==i?void 0:i.meta)?void 0:e.duration);const t=i.getFragmentIdx(s.end);l=this.getAdaptTimeRangeIdx(t),i.seekTime=s.end,l<0&&(l=this._curLoadSegmentIdx),this.log(zs.LOG,"[seeking in buffered range], seekTime ",o,",bufferRange,",s.start,"-",s.end,", fragIndex,",l)}if(!a){i.seekTime=o;const e=i.getFragmentIdx(o);l=this.getAdaptTimeRangeIdx(e),this.log(zs.LOG,"[seekTime out buffer range], srcFragIndex,",e,", fragIndex,",l),l<0&&(l=this._curLoadSegmentIdx),this.log(zs.LOG,"[seekTime out buffer range], curTime,",o,", srcFragIndex,",e,", adaptIdx,",l);const{mse:t}=this;if(t&&null!=t&&t.isFull()){const e=n.buffered2.bufferedList,t=e[e.length-1];this._checkRemoveSourceBuffer([t.start,t.end],n.currentTime,!0,!0)}}this._curLoadSegmentIdx===l&&null!=(t=i.adaptTimeRange[l])&&t.isLoading?this.log(zs.LOG,"[seeking in buffered range], seek fragIndex is current load segmentIdx",l):(i.canDownload=!1,await i.cancelLoading(),i.resetFragmentLoadState(l),this.log(zs.LOG,"[seekTime resetFragmentLoadState],adaptIdx,",l,"mp4.seekTime",i.seekTime,JSON.stringify(i.adaptTimeRange)),null==(r=this.mse)||r.clearOpQueues(ua.VIDEO),this._curLoadSegmentIdx=l,this.canDownload=!0,this._onTimeUpdate(),this._isEnded())}),this.initLog(null==(r=null==(t=this.player.playerId)?void 0:t.toString())?void 0:r.slice(-4)),this._pendingPromises=[],this._allInitPromise=new md,this._isInit=!1,this._isEventInit=!1,this.playerId=this.player.playerId,this.preloader=null,this.log(zs.LOG,"playerId",this.playerId,this.playerConfig.vid),this._useVideoLoad=!1,this.mse=null,this.mp4=null,this.eme=null,this._isMseInit=!1,this._corePromise=null,this._initPromise=null,this._hasStartProgress=!1,this._hasStartProgressBack=!1,this._curLoadSegmentIdx=0,this._abrService=null,this._checkRemoveBufferLastTime=Pu(),this.playFlag=!1,this.config.resumePlayWaterLevel=Math.min(this.config.minBufferLength,this.config.resumePlayWaterLevel),this.checkResumePlayTimer=null,this._MSEError=!1,this.loadstart=-1,this._loadStartEventTime=-1,this._waitAdjustTimeCnt=0,this._waitInBufferTimer=null,this.codecType=this.playerConfig.codecType?this.playerConfig.codecType.toLowerCase():hu,this.playerConfig.vtype&&(this._vtype=this.playerConfig.vtype.toUpperCase()),this.isActive=!0,this.firstFrameTime={newplayer:Pu(),initmse_sbopen:-1,mseopen:-1,metaload:-1,metaready_initsegend:-1,startload_stmux:-1,firstmux:-1,apcnt:0,aplen:0,data_ap:-1,loaded_data:-1,loadst_loadeddata:-1,new_loadeddata:-1,bitrate:-1,hitpreload:-1,first_gop_req_cnt:-1},this.debugInfo={},this.states=[],this.removeVideoList=[],this._lastCheckTime=Pu(),this._lastCheckLagTime=Pu(),this._changeDefState=null,this._defInited=!1,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._lastTimeupdateTime2=0,this.waitLevelStartTime=-1,this.preLoadData=null,this.forPreloadTimeCache=null,this._usePaused=!1,this.endofstream=!1,this.bufferEndTime=-1,this.hitpreload=!1,this.isH265DegradeH264=!1,this.loadstartTimer=null,this.loadeddataTimer=null,this.canplayTimer=null,this.adaptRangeRes=[],this._isReceiveEndedEvent=!1,this._checkEndedTimer=null,this._definitionChangePointInfo=null,Ch&&(this.player.preloader=Ch),this._lastTimeupdateTime2=0,this.waitLevelStartTime=-1,this.timerStepList=[],window&&window.location.href.indexOf("playerInstance=true")>-1&&(void 0===window.mp4PlayerInstanceList&&(window.mp4PlayerInstanceList=[]),window.mp4PlayerInstanceList.push(void 0)),this._isH265SoftDecoder=!1,this._beforeLoadStartCostTime=0,this._requestTimer=null,this.mseEndInfo={mseEndType:0,mseEndTime:0}}static get pluginName(){return"Mp4EncryptPlayer"}static get defaultConfig(){return{onlyInit:!1,useWaterLevel:!1,maxBufferLength:10,minBufferLength:5,tickInSeconds:.2,getLicenseUrl:"",xhrSetup:{},chunkSize:209715,retryCount:1,retryDelay:1e3,timeout:3e3,needPreloadCheck:!1,needAutoBitrate:!0,keyValue:null,drm:null,switchBitRateWay:!1,enableWorker:!1,bufferThreshold:10,removeBufferLen:60,focusUserDefinition:!1,resumePlayWaterLevel:2,waitJampBufferMaxCnt:3,waitingInBufferTimeOut:5e3,waitingTimeOut:1e4,notDegradeErrorList:[],h265Degrade:!1,forceVideoPlay:!1,segmentMinDuration:3,supportHevc:void 0,H264Config:null,reqOptions:{},rangeMaxDuration:15,getRequestOptionsCallback:null,closeDowngrade:!1,loaderType:"fetch",reUseMSE:!1,urlExpireDisableErrorEvent:!1,logCacheConfig:{logCacheLevel:zs.LOG,logMaxSize:204800},noPreloadAddBufferLen:0,enableFPSStuckHandle:!1,loadRangeType:lu,timerInWorker:!1}}static registerPreloader(e){Ch=e}static set ENCRYPT_SECRET(e){kh=e}static get speed(){return Eh}static get realTimeSpeed(){return Eh}static get version(){return _u}setConfig(e){this.config=Object.assign(this.config,e)}initLog(e){const{logCacheLevel:t,logMaxSize:r}=this.config.logCacheConfig;this.logger=new Ys(Th.pluginName+e,{logCacheLevel:t,logMaxSize:r}),Eu&&Ys.enable()}playerlogger(e){e?Ys.enable():Ys.disable()}afterCreate(){const{playerConfig:e,config:t,player:r}=this;t.width=e.width||0,t.height=e.height||0,e.vid=e.vid||t.vid,ua.isSupported('video/mp4; codecs="avc1.64001f, mp4a.40.5"')&&!fd()&&(void 0===t.supportHevc&&null!=Qd&&Qd.isHevcSupported&&Qd.isHevcSupported()&&this.player.video instanceof HTMLVideoElement&&(t.supportHevc=!0),t.supportVvcc=!(typeof MediaSource>"u"||!MediaSource.isTypeSupported)&&MediaSource.isTypeSupported("video/mp4;codecs=bvc2.1.6.L93.B0"),this.softDecode?r.vtype="MP4_MSE_SOFT":r.vtype="MP4_MSE",(!_d()||this.softDecode)&&(t.useEME=!1),t.useEME=!1!==t.useEME,this.checkConfig(),t.onlyInit&&(e.autoplay=!1,e.videoInit=!1,this._hasStartProgress=!1,this._hasStartProgressBack=!1),e.useWaterLevel&&(!e.userGestureEventMiddleware&&(e.userGestureEventMiddleware=Nu),!e.videoEventMiddleware&&r.setEventsMiddleware(ju)),this._proxyPlayer(),r.useHooks("play",this._playHook),r.useHooks("pause",this._pauseHook),r.useHooks("retry",this._retryHook),Fu(r,Jc.BUFFERED_RESET,this._onBufferedReset),this._bindNetworkStateChange(),this.on("timeupdate",this._onVideoTimeUpdate),this.on(rh,()=>{var e;this.changeState("LOADED_DATA"),this.deleteVideo(),this.mp4&&this.mp4.updateLoadedDataDone(),this._firstFrameTime(),this._onTimeUpdate(),this.firstFrameTime.loaded_data=this._loadStartEventTime>0?Pu()-this._loadStartEventTime:-1,null!=(e=this.config)&&e.enableFPSStuckHandle&&this.on(gh,this.fpsStuckHandle)}),this.on(nh,()=>{this.changeState("LOAD_START"),this._loadStartEventTime=Pu(),this._beforeLoadStartCostTime=(new Date).getTime()-this._tm,this.codecType===pu&&!this.config.supportHevc&&(this._isMseInit=!0,this._onTimeUpdate())}),this.on("ended",()=>{this.log(zs.LOG,"mp4plugin receive player video ended event"),this._onEnded()}),this.on("pause",()=>{this._usePaused=!0}),this.on("play",()=>{this._usePaused=!1}),this.on("xglog",e=>{if("firstFrame"===e.eventType){const t=this.preLoadData&&this.preLoadData.definition?this.preLoadData.definition:-1,{player:r,firstFrameTime:n}=this;Eu&&console.log(`[xgplayer-encrypt-mp4]>>>>firstFrame ${this.playerConfig.vid}, ${e.fvt}, codecType: ${this.codecType}`,`hitPreload: ${this.hitpreload}, video: ${this._useVideoLoad}, preloadBitrate: ${t}`,` metaLoad: ${n.metaload}, mseOpen: ${n.mseopen}`,`curDefinition: ${r.curDefinition.definition},appendInit: ${n.metaready_initsegend}`)}}),r.mp4MseFlag=!0)}_startBufferCheck(){const{player:e}=this;if(!e.video)return;const t=[];if(e.video.buffered){for(let r=0,n=e.video.buffered.length;r<n;r++)t.push([e.video.buffered.start(r),e.video.buffered.end(r)]);t.toString()!==this.lastBuffer&&(this.lastBuffer=t.toString(),this._onBufferReachThreshold())}}_onBufferReachThreshold(){const{player:e,config:t}=this;if(e.video){const r=e.video.buffered,{currentTime:n}=e.video;let i=0,o=0;for(let e=0;e<r.length&&(i=r.start(e),o=r.end(e),!(i<=n&&n<=o));e++);o-n>=t.bufferThreshold&&!this._hasTriggerBufferThreshold&&(this._hasTriggerBufferThreshold=!0,e.emit("BUFFER_THRESHOLD",o-n))}}_startUrlExpiredCheck(){const{definition:e}=this.playerConfig;e&&e.list&&e.list.length>0&&(this.urlExpireTimestamp=e.list[0].url_expire||0,this._handleUrlExpire())}async cancelLoading(){this.mp4&&(this._canceLoading=!0,this.log(zs.LOG,"player cancelLoading",this.playerConfig.vid),this._stopProgress(),this.cancelPreloadTask(),await this.mp4.cancelLoading())}checkConfig(){const{playerConfig:e,config:t}=this;let r=e.defaultDefinition,n=e.defaultBitrate;if(!r){const{definition:e}=this.playerConfig;r=e&&e.defaultDefinition?e.defaultDefinition:t.definition}!n&&t.bitrate&&(n=t.bitrate),e.defaultDefinition=r,e.defaultBitrate=n}_addMetaDataEvent(e){const{player:t}=this;this.__mHandler=e,Fu(t,"loadedmetadata",this.__mHandler)}_removeMetaDataEvent(){if(!this.__mHandler)return;const{player:e}=this;Hu(e,"loadedmetadata",this.__mHandler),this.__mHandler=null}beforePlayerInit(){const{player:e}=this,t=this;this._isInit||(dh.defineGetterOrSetter(e,{__url:{get:()=>t.mse?t.mse.url:e.config.url,configurable:!0},downloadSpeed:{get:()=>Eh/8,configurable:!0},playerVersion:{get:()=>_u,configurable:!0},menuCodeType:{get:()=>t.mp4&&t.mp4.meta?t.mp4.meta.videoCodec:t.codecType===hu?"avc":"hevc",configurable:!0},playerType:{get:()=>"MP4",configurable:!0},supportMenus:{get:()=>({speed:null==e?void 0:e.mp4MseFlag,cdn:null==e?void 0:e.mp4MseFlag,resolution:null==e?void 0:e.mp4MseFlag}),configurable:!0},preloadActive:{get:()=>this.isActive,set:e=>{this.isActive=e,this.isActive&&this._startProgress()},configurable:!0},performance:{get:()=>this.firstFrameTime,configurable:!0},domain:{get:()=>t.domain,configurable:!0},loadURL:{get:()=>t.loadURL,configurable:!0},abrInstance:{get:()=>t.abrInstance,configurable:!0},pcdnReq:{get:()=>{},configurable:!0},retryInfo:{get:()=>ud,configurable:!0},softDecoder:{get:()=>this._isH265SoftDecoder,configurable:!0},logCache:{get:()=>{if(t.logger)return t.log(zs.LOG,`,version:${_u},timerStepList,`,JSON.stringify(this.timerStepList)),t.logger.getLogCache()},configurable:!0},pcdnVVStat:{get:()=>{var e;const{mp4:r,pcdn:n}=t;return r?{...r.pcdnVVStat,trace_id:null==(e=r.pcdnTraceInfo)?void 0:e.trace_id,cancelCnt:(null==r?void 0:r.pSCCancelCnt)||0,is_try_open:n?1:0}:null},configurable:!0},beforeLoadStartCostTime:{get:()=>this.useVideoLoad?0:this._beforeLoadStartCostTime,configurable:!0},bandwidth:{get:()=>{const{mp4:e,playerConfig:r}=t;return function(e,t){const r=e?e.loadInfo:null,n=r?r[nu]:null,i=r?r[iu]:null;return{vid:t,cdn:{speed:null==n?void 0:n.loadSpeed,size:n?n.loadLen:0},pcdn:{size:i?i.loadLen:0,...null==e?void 0:e.pcdnTraceInfo}}}(e,null==r?void 0:r.vid)},configurable:!0},ext:{get:()=>t?function(e){var t,r;const n=[],{video:i,currentTime:o,duration:s}=e.player,{playerConfig:a,mp4:l,mse:c,debugInfo:u,_curLoadSegmentIdx:d,states:h,_requestTimer:p,timerStepList:f}=e,_=i?i.buffered:[];if(_.length>0)for(let e=0,t=(null==_?void 0:_.length)||0;e<t;e++)n.push([_.start(e),_.end(e)]);return{type:"MP4",usevideo:e.useVideoLoad?1:0,curTime:o,duration:(null==(t=null==l?void 0:l.meta)?void 0:t.duration)||s,loadIdx:d,curload:null!=l&&l.adaptTimeRange?l.adaptTimeRange[d]:{},buffer:n,speed:null==u?void 0:u.speed,states:h,msequeLen:(null==c?void 0:c.opQueues)&&(null==(r=c.opQueues.video)?void 0:r.length),timer:!!p,timerlist:JSON.stringify(f),maxtimerstep:Math.max(...f),url:null==a?void 0:a.url}}(this):{},configurable:!0},currentDefitionFromPlayer:{get:()=>t.abrInstance&&t.abrInstance.isCurrentInAbr?e._currentDefitionFromPlayer:e.curDefinition,configurable:!0}}),this._isInit=!0)}destroy(){var e,t;const{player:r}=this;r.preloader&&r.preloader.cancel(this.playerId),r.removeHooks("play",this._playHook),r.removeHooks("pause",this._pauseHook),r.removeHooks("retry",this._retryHook),null==(e=this._requestTimer)||e.destroy(),this._requestTimer=null,this._reset(),this.checkReUseMSE(!1),this._secretkey&&kh.destroySecretKey(this._secretkey,this._errorHandler),this.player.playNext=mh,this.player._startInit=vh,this.player.changeDefinition=bh,this.player.switchURL=wh,this._unbindNetworkStateChange(),this._unbindEvents(),Hu(r,Jc.BUFFERED_RESET,this._onBufferedReset),this._bufferCheckTimer&&clearInterval(this._bufferCheckTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),null!=(t=this.logger)&&t.reset&&this.logger.reset(),this._removeMetaDataEvent(),this.timerStepList=[]}_proxyPlayer(){"function"==typeof this.player.playNext&&(mh=this.player.playNext),this.player.playNext=(...e)=>{this.playNext(...e)},vh=this.player._startInit,wh=this.player.switchURL,bh=this.player.changeDefinition,this.player._startInit=this.playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this)}getInitBitrate(){const{player:e,config:t,playerConfig:r}=this;let n=null;const{definitionList:i}=e;if(i&&i.length>0){const{preloader:o}=e;o&&i.forEach(e=>{const t=o.generateUniqueKey({vid:r.vid,definition:e.definition||-1,vtype:r.vtype,codecType:r.codecType});e.cacheKey=t,t&&!n&&o&&o.hasItemSameVid(t)&&(n=e,n.type="preload")});const{userSelectDefinition:s}=r;n&&s&&t.focusUserDefinition&&r.userSelectDefinition!==n.definition&&(n=null),!n&&this.bitRateAdapter&&(this.bitRateAdapter.speed=hd.speed,n=this.getDefinitonFromAdapter(i,s),n&&(n.type="bitRateAdapter"))}if(!n||!n.url){const{url:e,definition:t,defaultDefinition:o}=r,s=(null==t?void 0:t.defaultDefinition)||o;if("Array"===$u(e)&&e.length>0||"String"===$u(e)&&e){const t=this._getDefinitionItem(s),i=r.defaultBitrate||r.bitrate||(null==t?void 0:t.bitrate);n={url:e,definition:(null==t?void 0:t.definition)||s||-1,duration:(null==t?void 0:t.duration)||r.duration||this.config.duration||0,bitrate:i,uri:r.uri||(null==t?void 0:t.uri),file_id:null==t?void 0:t.file_id,size:(null==t?void 0:t.size)||r.size,type:"default"}}else n=i[i.length-1]}return n&&(r.url=n.url,n.networkSpeed=hd.speed),e.curDefinition=n,n}_setPlayerSrc(e){const{player:t}=this;this._removeVideoSource(),"Array"===$u(e)?(t.video.removeAttribute("src"),!t._detachSourceEvents&&e.forEach(e=>{t.video.appendChild(Au("source","",{src:`${e.src}`,type:`${e.type||""}`}))}),t._attachSourceEvents(t.video,e),t.play()):(t.video.src=e,t.play()),t.mp4MseFlag=!1,t.emit("playertypechange")}_removeVideoSource(e){const{player:t}=this;e=e||t.video;const{children:r}=e;if(r.length>0)for(t._detachSourceEvents(e);r.length>0;)e.removeChild(r[0])}_getDefinitionItem(e){const{definition:t}=this.playerConfig;if(!t||!t.list)return null;for(let r=0;r<t.list.length;r++){const n=t.list[r];if(n.definition===e)return n}return null}async _initAbrService(){}_initSecret(){kh&&(this._secretkey?this._secretkey.updateConfig(this.config):this._secretkey=kh.createSecretKey(this.config,this._errorHandler))}_initMp4Kernel(){const{playerConfig:e,config:t}=this,r=new md;try{const n=this.player.curDefinition;this.log(zs.LOG,`[_initMp4Kernel] ${e.vid} curDefinition`,null==n?void 0:n.definition);const i=this._handlerUrl(e.url);if(!i)return this.log(zs.LOG,"emptyUrl"),r.reject(new Error("emptyUrl")),r;if(t._mainURL=i.main,t._backupURL=i.backup,t.forceVideoPlay&&(this.codecType===hu||t.supportHevc))return this.useVideoLoad=!0,this.log(zs.LOG,"forceVideoPlay"),r.reject(new Error("forceVideoPlay")),r;const o=[];this._secretkey&&o.push(this._secretkey.getLicenseSecret()),o.push(this._checkPreloader()),Promise.all(o).then(e=>{if(this.isDestroy)return void r.reject(new Error("destroy"));let i=null;if(e&&e.length>0&&(e.length>1&&(!t.keyValue&&(t.secretKey=e[0].secretKey),t.decryptKey=e[0].decryptKey),i=e[e.length-1].data,this.firstFrameTime&&(this.firstFrameTime.hitpreload=i?1:0)),i||!t.needPreloadCheck||this.codecType===pu&&!t.supportHevc)if(this._vtype&&"MP3"===this._vtype)this.useVideoLoad=!0,this.log(zs.LOG,"vtype_not_MP4"),r.reject(new Error("vtype_not_MP4"));else{const e=t._mainURL;this.player.rawSrc=e,this._initMp4(e,i,{fileSize:n?n.size:0}),this.updateLoadInfo(null==i?void 0:i.cacheKey),this.checkPCDN(),this.initAdaptRange(),this._initAbrService()}else this.useVideoLoad=!0,this.log(zs.LOG,"no_preload"),r.reject(new Error("no_preload"))}).catch(t=>{this.log(zs.ERROR,"getLicense or checkPreloader reject",null==t?void 0:t.message);const i=new th(this.player,{errorType:gu.DRM,errorCode:yu.drm,errorMessage:(null==t?void 0:t.message)||"getLicense or checkPreloader reject",vid:e.vid});this.emit("GET_LICENSE_ERROR",i),this.changeState("LICENSE_ERROR",{d:n?n.definition:0}),r.reject(i)})}catch(e){r.reject(e)}return r}updateLoadInfo(e){!e||!this.mp4||(this.mp4.loadInfo=ou.get(e),ou.delete(e))}initAdaptRange(){const{config:e,player:t,playerConfig:r}=this,{bitrate:n,duration:i}=t.curDefinition;if(null!=e&&e.adaptRange){let o=null;o=(null==e?void 0:e.loadRangeType)===cu?_o:fo,this.adaptRange=new o(t,n,i||r.duration,e.adaptRange)}}checkPCDN(){const{config:e,player:t,playerConfig:r}=this;t.curDefinition,this.pcdn=null}isOpenPCDN(e){}_pcdnReqSuccess(e,t){const{playerConfig:r,player:n,mp4:i}=this;if(!i||!e)return;const o=null.getPCDNReqId(n.curDefinition,r.vid);if(e.req_id&&o!==e.req_id)return void this.log(zs.LOG,`,${t} is not match curDefinition reqId', reqId, ', pcdnRet.req_id`,e.req_id);const s=e.nodes||[];this.log(zs.LOG,`${r.vid} get peer end,pcdn node update,`,s.length),i.updateNode(s),i.pcdnTraceInfo={uri:e.vid,fid:e.fid,trace_id:e.trace_id},i.pcdnVVStat&&(i.pcdnVVStat.try_req_node+=1,i.pcdnVVStat.req_node_succ+=1,i.pcdnVVStat.has_ret_node+=s.length>0?1:0)}_pcdnReqFail(e,t){const{mp4:r}=this;null!=r&&r.pcdnVVStat&&(r.pcdnVVStat.try_req_node+=1),this.checkURLExpired(e,t)}initTimer(){if(!this._requestTimer){const{timerInWorker:e,tickInSeconds:t}=this.config;this._requestTimer=new ph({frequency:t,timerInWorker:e}),this._requestTimer.on(du,this.timerHandle)}}playerStartInit(e){var t;if(this.log(zs.LOG,"playerStartInit",this.player.hasStart,this.playerId,e),this.isDestroy)return;const{playerConfig:r,player:n}=this;if(this._usePaused=!1,this.isActive&&0!==(null==n?void 0:n.currentTime)&&!this.config.frameFreeze&&(this.log(zs.LOG,"[playerStartInit] reset current  = 0 ,buffer,",JSON.stringify(null==(t=null==n?void 0:n.buffered2)?void 0:t.bufferedList)),this.player.currentTime=0),this._isH265SoftDecoder=this.softDecode,this.config.reUseMSE&&this.mse&&"String"===$u(e)&&/^blob/.test(e)&&e!==this.mse.url&&(e=r.url,this.destroyMSE()),!e||"__auto__"===e||"anytext"===e){const{definition:e}=r,t=function(e){let t="",r=null;const n=e?e.list:[];if(n&&n.length>0&&e.defaultDefinition&&(n.forEach(n=>{n.definition===e.defaultDefinition&&(t=n.url,r=n)}),!t)){const i=n[0];t=i.url,e.defaultDefinition=i.definition,r=i}return r}(e);t&&(r.url=t.url,e.defaultDefinition=t.definition,n.curDefinition=t)}const i=this._defInited?null:this.getInitBitrate();if(r.nullUrlStart&&!i&&!r.url)return;this.initTimer(),Wu(this.config)?this._initSecret():this._secretkey=null,this._defInited=!0,this.log(zs.LOG,`[playerStartInit] ${r.vid} curDefinition`,i||this.player.curDefinition);const{config:o}=this,{preloader:s}=this.player;s&&s.addPlayingVid(r.vid);const a=!this.softDecode;if(o.needPreloadCheck&&a&&!this._secretkey){let e,t=!1;const{curDefinition:n}=this.player;if(s&&n&&(e=n.cacheKey?n.cacheKey:s.generateUniqueKey({vid:r.vid,definition:n.definition||-1,vtype:r.vtype,codecType:r.codecType}),t=s.hasItemSameVid(e)),!t){this.useVideoLoad=!0,this.player.vtype="MP4_0",this.log(zs.LOG,`[playerStartInit] ${r.vid} no_preload`,!!s,e);const t=new th(this.player,{errorType:"runtime",errorTypeCode:gu.runtime,errorCode:yu.other,vid:this.playerConfig.vid,errorMessage:"no preload"});this.player.emit("playCatch",this.player.vtype,t)}}if(this.useVideoLoad){if(e=this.playerConfig.url,o.closeDowngrade)return;return this._sTime=Pu(),vh.call(this.player,e),void this._startProgress()}if(this.isDestroy)return;if(this.player.mp4MseFlag=!0,this.bufferEndTime=-1,this._tm=(new Date).getTime(),this._initPromise&&"pending"===this._initPromise.state){const e=this._handlerUrl(r.url);if(e&&e.main===o._mainURL)return}this._reset();const{vid:l}=this.playerConfig;this.changeState("PLAYER_START_INIT");const c=this._initMp4Kernel();this._initPromise=c,this._addPendingPromise(this._initPromise),c.then(()=>{this.isDestroy||(this.mse&&(e=this.mse.url),this.changeState("PLAY_INIT_OK"),this._bindEvents(),this._startProgress())}).catch(t=>{let r=!1;if(this._initPromise&&(r=this._initPromise.id!==c.id||this._initPromise.isBreak),this.isDestroy||r||t===fh)return;if(this.log(zs.LOG,`_initMp4Kernel.catch: ${l} isDestroy:${this.isDestroy},\n          errorCode:${(null==t?void 0:t.errorCode)||yu.other},errMsg:${(null==t?void 0:t.errorMessage)||(null==t?void 0:t.message)}`),(null==t?void 0:t.errorCode)===yu[403]&&this._emitExpireEvent(t)&&o.urlExpireDisableErrorEvent)return this._initPromise=null,this.log(zs.LOG,"initMp4Kernel urlExpireDisableErrorEvent",o.urlExpireDisableErrorEvent,",errorCode,",t.errorCode),this._stopProgress(),void this.emit(_h);let n=t;n.errorCode||(n=new th(this.player,{errorType:gu.RUNTIME,errorCode:(null==t?void 0:t.errorCode)||yu.other,vid:this.playerConfig.vid,errorMessage:(null==t?void 0:t.errorMessage)||(null==t?void 0:t.message),mediaError:{code:(null==t?void 0:t.httpCode)||yu.other,message:(null==t?void 0:t.errorMessage)||(null==t?void 0:t.message),errorType:null==t?void 0:t.errorType}}),n.url=e),this.changeState("PLAY_INIT_CATCH",{c:n.errorCode,m:(null==t?void 0:t.errorMessage)||(null==t?void 0:t.message),t:null==t?void 0:t.errorType}),this.useVideoLoad=!0,this.player.vtype="MP4_1",this.player.emit("playCatch",this.player.vtype,n);const i=this.checkIsDegraded(n);return this.log(zs.WARN,"PLAY_INIT_CATCH final error !!!!, ",l,null==n?void 0:n.errorCode,null==n?void 0:n.errorMessage,",degrade:",i),this.emit(_h),i?void 0:(this.player.pause(),this._reset(),this.emit("error",n),void(this._initPromise=null))}).finally(()=>{var t;if(!this._initPromise)return;const{isBreak:r,id:n}=this._initPromise;if(n!==c.id)return;this._removePendingPromise(this._initPromise),this._initPromise=null,this._usePaused&&(this.playerConfig.autoplay=!1),this.softDecode&&"Array"===$u(e)&&(e=e[0].src),"String"===$u(e)&&!/^blob/.test(e)&&!this.config.frameFreeze&&this.destroyMSE();const i=(null==(t=this.player)?void 0:t.currentSrc)===e;this.changeState("PLAY_INIT_FINALLY",{isDestroy:this.isDestroy,isBreak:r,reUseSrc:i}),!this.isDestroy&&!r&&vh.call(this.player,e),this.reUseMSEEmitEvents(i),this._abrService&&this._abrService.isCurrentInAbr()&&(this._abrService.enable(),this._abrService.execute())})}async destroyMSE(){var e;await(null==(e=this.mse)?void 0:e.unbindMedia()),this.mse&&this.log(zs.LOG,"destroyMSE ",this.playerConfig.vid),this.mse=null}reUseMSEEmitEvents(e){var t;e&&/^blob/.test(null==(t=this.player)?void 0:t.currentSrc)&&(clearTimeout(this.loadstartTimer),clearTimeout(this.loadeddataTimer),clearTimeout(this.canplayTimer),this.loadstartTimer=setTimeout(()=>{clearTimeout(this.loadstartTimer),this.loadstartTimer=null,this.emit(nh),this.log(zs.LOG,"reUseMSE add emit loadstart event")},10),this.loadeddataTimer=setTimeout(()=>{clearTimeout(this.loadeddataTimer),this.loadeddataTimer=null,this.emit(rh),this.log(zs.LOG,"reUseMSE add emit loadeddataevent")},50),this.canplayTimer=setTimeout(()=>{clearTimeout(this.canplayTimer),this.canplayTimer=null,this.emit("canplay"),this.log(zs.LOG,"reUseMSE add emit canplayevent")},90))}playNext(e,t=!0){const{player:r}=this,n=!!this.isActive;n&&(e.autoplay=n),this._defInited=!1,this._hasTriggerBufferThreshold=!1,r.resetState(),r._currentTime=0,r._duration=0,r.isPlaying=!1,this.preloader&&this.preloader.clearTask(),this._useVideoLoad=!1,this._MSEError=!1;const i=this.softDecode;r.pause(),this._reset(),e.vtype&&(this._vtype=e.vtype.toUpperCase()),r.setConfig(e),this.config.frameFreeze||this.checkReUseMSE(this.config.reUseMSE,!0),this.softDecode?r.vtype="MP4_MSE_SOFT":r.vtype="MP4_MSE";const{codecType:o,mediaType:s}=this.playerConfig;if(this.codecType=o?o.toLowerCase():hu,i!==this.softDecode&&this.h265_h264_switch(s||"video"),this.checkConfig(),this.log(zs.LOG,"[Index] playNext",e.vtype,e.vid),r.resetState(),r.start(),r.play(),this.config.reUseMSE&&!this.isH265DegradeH264){const e=()=>{this.log(zs.LOG,"[Index] playNext metadata update currentTime = 0"),0!==r.currentTime&&(r.currentTime=0),this._removeMetaDataEvent()};this._addMetaDataEvent(e)}t&&this.emit("playnext")}h265_h264_switch(e){this.log(zs.LOG,"[Index],h265_switch_h264",e);const{player:t}=this,{mediaConfig:r}=t,n=Au(e,"",r,`xgplayer-${e}-img`),i=t.media.parentElement;this.removeVideoList.push(t.media),t.detachVideoEvents(t.media);const{muted:o,volume:s}=t.media;n.muted=o,n.volume=s,n.setAttribute("media_type","video"),t.media=n,t.attachVideoEvents(n),i.appendChild(n)}next(e){this.playNext(e)}oldChangeDefinition(e,t){const{config:r,player:n,playerConfig:i}=this;n.emit(ih,{from:t,to:e}),n.emit("waiting");const o=n.definitionList,s=o.filter(t=>t.definition===e.definition||t.definition===Number(e.definition)),a=o.filter(e=>e.definition===t.definition||e.definition===Number(t.definition));if(a.length>0&&(a[0].selected=!1),!(s.length>0))return;(e=s[0]).selected=!0,n.curDefinition=e,this.log(zs.LOG,"[oldChangeDefinition],currentTime,",n.currentTime,",from,",t,",to,",e);const{currentTime:l,paused:c}=n;this._changeDefState||(this._changeDefState={currentTime:l,paused:c}),r.definition=e.definition,["keyValue","kid","secretKey","drm","getLicenseUrl","drmKeyToken","sessionId"].forEach(t=>{r[t]=e[t]}),i.url=e.url,i.userSelectDefinition=e.definition,i.defaultDefinition=e.definition,r.focusUserDefinition=!0,n.currentTime=0,n.pause(),this._reset(),this.checkReUseMSE(),this._isMseInit=!1,this.eme=null;const u=this._handlerUrl(e.url);r._mainURL=u.main,r._backupURL=u.backup,this._changeDefineCanPlay&&n.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=()=>{this.changeDefineCanPlay(l,c,t,e),this._changeDefineCanPlay=null},n.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.playerStartInit(i.url)}_emitDefinitionChangeDetailEvent(e){const{bitrate:t,definition:r,file_id:n,width:i,vwidth:o,height:s,vheight:a}=this._currDefinition;this.player.emit("definitionChangeDetail",{start:e,bitrate:t,definition:r,mediaType:"video",url:this.config._mainURL,fileid:n});const l={width:i||o,height:s||a};this.player.emit("RESOLUTION_UPDATE",l)}_setCurrentDefinition(e){const{config:t}=this.player;if(t.definition&&t.definition.list){const r=t.definition.list.filter(t=>t.bitrate===e);this._currDefinition=r&&r[0]}this._currDefinition||(this._currDefinition={bitrate:e}),e&&(this._currDefinition.bitrate=e)}switchURL(e){if(this.useVideoLoad)return void wh.call(this.player,e);const{player:t,playerConfig:r,config:n}=this;r.definition.list=[e],r.url=e.url,r.defaultBitrate=e.bitrate,r.defaultDefinition=e.definition,["keyValue","kid","secretKey","drm","getLicenseUrl","drmKeyToken","sessionId"].forEach(t=>{n[t]=e[t]}),this._addMetaDataEvent(()=>{t.currentTime=0,this._removeMetaDataEvent()}),this.playNext(n)}_handlerUrl(e){const{playerConfig:t}=this;if(!e)return null;let r;const n=[];if("String"===$u(e))r=e,t.backupURL&&n.push(t.backupURL);else if("Array"===$u(e)&&e.length>0&&(r=e[0].src,e.length>1))for(let r=1;r<e.length;r++)n.push(Ru(e[r].src,{__vid:t.vid}));return!(!r&&0===n.length)&&{main:Ru(r,{__vid:t.vid}),backup:n}}_firstFrameTime(){const{firstFrameTime:e,player:t,config:r,loadstart:n}=this,i={supportHevc:r.supportHevc,firstmux:this.mp4?this.mp4.firstFrameTime.firstmux:-1,stats:Gu(t),loadstart:n};this.firstFrameTime=function(e,t,r={supportHevc:!1,loadstart:0,firstmux:-1,stats:{}}){var n;if(t===hu||r.supportHevc)return e.new_loadeddata<0&&(e.loadst_loadeddata=Pu()-r.loadstart,e.new_loadeddata=Pu()-e.newplayer),e;if(t===pu){const{stats:t,firstmux:i}=r,{metaload:o,startMuxTime:s}=e,a={};for(let e=0;e<(null==(n=null==t?void 0:t.bootStats)?void 0:n.length);e++)a[t.bootStats[e].action]=t.bootStats[e].dot;const l={...t,metaload:o,startload_stmux:s,firstmux:i,...a};return delete l.bootStats,l}}(e,this.codecType,i)}_bindEvents(){this.log(zs.LOG,"bindEvents,",this._isEventInit);const{config:e,player:t}=this;this._isEventInit||(this.on("seeking",this._onSeeking),this.on("waiting",this._onWaiting),this.on("error",this._onVideoError),this.on("playing",this._onPlaying),this.on("pause",this._onPause),this.on("detectGap",()=>{e.gapDegrade&&e.useEME&&(e.useEME=!1,this._replay())}),this.on(yo.CHANGE_FLYING_PLUGIN_CONFIG,this._onChangeConfig),t.setEventsMiddleware({error:(e,r)=>{var n;const i=null==e?void 0:e.error,o={errorCode:null==i?void 0:i.code,errorMessage:null==i?void 0:i.message,videoType:this.useVideoLoad};if(this.changeState("video_error.Middleware",o),this.codecType===pu&&(null==i?void 0:i.message.indexOf("video decoder initialization failed"))>=0&&this.emit("DECODER_FAILED",{codecType:this.config.codecType,vid:this.playerConfig.vid}),this.log(zs.ERROR,"error middleware",JSON.stringify(o),", isDegrade,",!this._MSEError&&!this.useVideoLoad,t.currentTime),!this._MSEError&&!this.useVideoLoad)return t.vtype="MP4_2",this._MSEError=!0,null==(n=this.mp4)||n.cancelLoading(),this.startDegradedPlayback(o,t.paused),void this.emit(_h);this.emit(_h),this.useVideoLoad&&r(e.eventName,null==e?void 0:e.error)}})),this._isEventInit=!0}getBufferDur(){var e;if(null==(e=this.player)||!e.buffered)return 0;const{buffered:t}=this.player;let r=0;for(let e=0,n=t.length;e<n;e++)r+=t.end(e)-t.start(e);return r}deleteVideo(){var e;if((null==(e=this.removeVideoList)?void 0:e.length)>0){for(let e=0;e<this.removeVideoList.length;e++){const t=this.removeVideoList[e],r=t.parentNode;r&&r.removeChild(t),this.log(zs.WARN,"[_removeVideoSource]")}this.removeVideoList=[]}}_unbindEvents(){var e;this.log(zs.LOG,"unbindEvents,",this._isEventInit),this.off("seeking",this._onSeeking),this.off("waiting",this._onWaiting),this.off("ended",this._onEnded),this.off("error",this._onError),this.off("playing",this._onPlaying),this.off("pause",this._onPause),this.off(yo.CHANGE_FLYING_PLUGIN_CONFIG,this._onChangeConfig),this._isEventInit=!1,null!=(e=this.config)&&e.enableFPSStuckHandle&&this.off(gh,this.fpsStuckHandle)}changeState(e,t={}){this._pTime||(this._pTime=Pu());const r=Pu()-this._pTime,n=Pu()-this._sTime;this.log(zs.LOG,`>>>changeState[${e}]`,r,n,JSON.stringify(t)),this.states.push({state:e,t1:r,t2:n,data:t}),this._pTime=Pu()}get softDecode(){var e,t;return"tt-video"===(null==(t=null==(e=this.player)?void 0:e.config)?void 0:t.mediaType)}_initH265MseProxy(){const{player:e}=this;e.video instanceof HTMLVideoElement&&this.h265_h264_switch(this.playerConfig.mediaType);const t=e.video;this.softDecode&&t.setPlayMode&&t.setPlayMode("VOD"),this.mseProxy=t,this.softDecode&&(e.forceDegradeToVideo=()=>{},Fu(e,"warning",this._lowDecoder),Fu(e,"error",this._onError))}notSupportError(e){return this.log(zs.LOG,e,tu),new th(this.player,{errorType:gu.MEDIA,errorCode:yu.mse,errorMessage:`${e} ${tu}`,vid:this.playerConfig.vid})}removeAndRejectInitPromise(e){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(e))}_initMp4(e,t={},r={}){var n,i,o,s,a,l,c;const{config:u,player:d,playerConfig:h}=this;this.mp4&&(this.mp4.destroy(),this.mp4=null),this.changeState("MP4_NEW",{});let p=0;null!=(n=null==u?void 0:u.pcdnConfig)&&n.openPCDN&&(p=(null==(i=null==u?void 0:u.pcdnConfig)?void 0:i.switchPCDNMaxCnt)||2),null!=(o=null==u?void 0:u.pcdnConfig)&&o.adaptPCDNConfig&&(p=0),this._setCurrentDefinition(d.curDefinition.bitrate);let f=pd;null==u||u.loadRangeType;const _=null==(a=null==(s=d.curDefinition)?void 0:s.pktOffsetMap)?void 0:a.find(e=>(null==e?void 0:e.time)===((null==u?void 0:u.firstLoadTimePos)||5)),y=null==_?void 0:_.offset,g=function(e,t){const{getRequestOptionsCallback:r,reqOptions:n}=e;let i=null;return i=t.reqOptions?t.reqOptions:"Function"===$u(r)?r(t):n,{...n,...i}}(this.config,{url:e});this.mp4=new f(e,d.curDefinition.bitrate,{segmentDuration:u.segmentMinDuration,enableWorker:u.enableWorker,codecType:this.codecType,chunkSize:u.chunkSize,firstLoadSize:y,duration:h.duration||0,fileSize:r.fileSize||0,playerId:this.playerId,vid:h.vid,useUrlRange:u.useUrlRange,retryCount:u.retryCount,retryDelay:u.retryDelay,timeout:u.timeout,onProcessMinLen:u.onProcessMinLen,supportHevc:u.supportHevc,afterLoadeddataCallBackLen:u.afterLoadeddataCallBackLen,firstLoadBuffer:u.firstLoadBuffer,logger:this.logger,switchPCDNMaxCnt:p,reqOptions:g,fixEditListOffset:u.fixEditListOffset},this.config._backupURL,this.firstFrameTime,""),this.mp4.once(Xu,this._onMp4MetaReady),this.mp4.on(Yu,this._onMp4Error),this.mp4.on(ed,this._updateDrmConfig),this.mp4.on(td,this._updateMSE),this.mp4.on(Ju,this._onMp4Progress),this.mp4.on(Qu,this._onMp4DataCallBack),this.mp4.on(od,e=>{this.player&&this.player.emit("source_error",e)}),this.mp4.on(ad,e=>{var t,r;const{player:n,config:i}=this;this.emit(_h),this.log(zs.LOG,"not match remove buffer start,buffer,",JSON.stringify(null==(t=null==n?void 0:n.buffered2)?void 0:t.bufferedList),", removeRange,",JSON.stringify(e)),null==(r=this.mse)||r.remove(ua.VIDEO,e[0]+.1,e[1]-.1).then(()=>{var e;this.log(zs.LOG,"not match remove buffer end,",JSON.stringify(null==(e=null==n?void 0:n.buffered2)?void 0:e.bufferedList));const{currentTime:t}=n;(null==i?void 0:i.loadRangeType)===cu&&(n.currentTime=t,this.log(zs.LOG,"not match remove buffer end, fix currentTime",n.currentTime))}).catch(()=>{})}),this.mp4.on(id,e=>{this.pcdn&&e&&this.pcdn.removePCDNNode(e.vid,e.bitrate,e.url)}),this.mp4.on(rd,e=>{this.player&&(this.player.rawSrc=e,this.player.emit("initialUrl",{url:e}),this.player.emit("changeHost",Du(e)))}),this.mp4.on(nd,async e=>{var t;await(null==(t=this.mp4)?void 0:t.cancelLoading()),this._curLoadSegmentIdx=e,this.log(zs.LOG,"[update curLoadSegmentIdx]",e)}),this.mp4.on(sd,e=>{var t,r,n;if(!this.player)return;const{vid:i}=h,o={vid:i,taskType:1,changeCnt:null==(t=this.mp4)?void 0:t.getCurSwitchPCDNCnt(),traceId:null==(n=null==(r=this.mp4)?void 0:r.pcdnTraceInfo)?void 0:n.trace_id},s=function(e,t,r={}){const{vid:n,taskType:i,changeCnt:o,traceId:s}=r,{bitrate:a,definition:l,file_id:c}=t,u={vid:n,task_type:i,change_cnt:o,definition:l,bitrate:a,fileid:c};return((null==e?void 0:e.load_type)||nu)===nu?u.cdn_size=e.len:(u.pcdn_size=e.len,u.trace_id=s),u}(e,this._currDefinition,o);this.player.emit("prf_data_size",s);const a=(null==e?void 0:e.load_type)||nu;this.mp4&&this.mp4.updateLoadInfo(a,e.len),ku&&console.log("prf_data_size emit, vid,",i,",loadType,",a,", task_type, 1",",len,",e.len)}),this.mp4.MP4Loader.on(eu,e=>{var t,r,n,i,o,s,a,l,c,u;Eh=e.speed,function(e,t){e.speed||(e.speed=[]);const{speed:r}=e;r.push(t),r.length>10&&r.shift()}(this.debugInfo,e.speed);const d=(null==(t=null==e?void 0:e.priOptions)?void 0:t.type)||nu;this.emit(eu,{speed:e.speed,type:d,...e});const h=(null==(r=this.playerConfig)?void 0:r.vid)||(null==e?void 0:e.vid);if((null==e?void 0:e.len)>0){if(!this.player)return;const t=(null==(n=null==e?void 0:e.priOptions)?void 0:n.type)||nu,r=(null==(i=this.adaptRangeRes)?void 0:i.length)>0?this.adaptRangeRes.shift():{},d=null==(o=this.mp4)?void 0:o.getCurSwitchPCDNCnt(),{bitrate:p,definition:f,file_id:_}=this._currDefinition,y={vid:h,task_type:1,change_cnt:d,bitrate:p,definition:f,fileid:_},g=qu(r),m=function(e,t){const r=Uu(t.len,t.time),n={cdn_size:0,cdn_speed:0,pcdn_size:0,pcdn_speed:0};return e===nu?(n.cdn_size=t.len,n.cdn_speed=r):(n.pcdn_size=t.len,n.pcdn_speed=r),n}(t,e),v={...y,...g,...m},{idx:b}=r;this.player.emit("prf_data_size",v),ku&&console.log("prf_data_size emit,",b,JSON.stringify(v));const w=e.index?null==(l=null==(a=null==(s=this.mp4)?void 0:s.adaptTimeRange[e.index])?void 0:a.timeRangeIdx)?void 0:l[1]:null;if(w&&w>=this.mp4.timeRange.length-1)for(;(null==(c=this.adaptRangeRes)?void 0:c.length)>0;){const e=this.adaptRangeRes.shift(),t=null==(u=this.mp4)?void 0:u.getCurSwitchPCDNCnt(),r={...y,...m,...qu(e)};r.change_cnt=t,this.player.emit("prf_data_size",r),ku&&console.log("prf_data_size emit,",b,JSON.stringify(r))}this.mp4&&this.mp4.updateLoadInfo(t,e.len)}}),null!=(l=null==u?void 0:u.pcdnConfig)&&l.adaptPCDNConfig&&(null==(c=this.mp4)||c.setSwitchPCDNCallBack(()=>{const{pcdn:e}=this;if(!e)return-1;const t=e.getPCDNChangeCnt()||-1;return this.log(zs.LOG,"[updateSwitchPCDNMaxCnt]",t),t})),this.changeState("MP4_INIT",{}),this.emit("loadstart_mse"),t||(t={}),this.mp4.init(t),this._emitDefinitionChangeDetailEvent(0)}_checkPreloader(){const{playerConfig:e}=this,t=new md,r={method:"checkPreloader",success:0,type:"error",cacheKey:""};this.changeState("CHECK_PRELOAD");const{curDefinition:n,preloader:i}=this.player;if(!i)return this.changeState("PRELOAD_ERROR",{t:2}),r.success=0,r.error=new Error("no_preloader"),t.resolve(r),t;const o=n.cacheKey?n.cacheKey:i.generateUniqueKey({vid:e.vid,definition:n.definition||-1,vtype:e.vtype,codecType:e.codecType});return r.cacheKey=o,o?i.getPreLoadData(o).then(e=>{if(e){const{bitrate:i,orgDefinition:s}=e;if(i&&n.bitrate&&i!==n.bitrate)return this.preLoadData=null,r.success=0,r.error=new Error(`bitrate_not_match_cut_${n.bitrate}_cache_${i}`),this.changeState("PRELOAD_ERROR",{bitrate:i,ck:o}),t.resolve(r),void this.log(zs.LOG,`>>>check Preloader bitrate_not_match cacheKey${o}\n                curDefinition:${n.bitrate}  cache:${i}`);n.orgDefinition=s,Eu&&console.log(">>>>[mp4]check Preloader result",o,e),this.preLoadData=e,this.emit("PRELOAD_INFO",this.preLoadData),this.emit("hitCache",e),r.success=1,r.data=e,au.set(o,!0),this.changeState("PRELOAD_OK",{l:this.preLoadData.byteLength,ck:o}),e.mediaSegList&&e.mediaSegList.length>0||e.buffer&&e.buffer.byteLength>0?this.hitpreload=!0:this.hitpreload=!1,t.resolve(r)}else this.preLoadData=null,this.changeState("PRELOAD_ERROR",{t:0}),r.success=0,r.error=new Error("none_preload"),t.resolve(r)}):(this.changeState("PRELOAD_ERROR",{t:2}),r.success=0,r.error=new Error("none_preload"),t.resolve(r)),t}_initEME(e,t){var r,n;const i=Wu(this.config),{useEME:o}=this.config;if(i&&o&&!kh.checkEMEValid())return this.log(zs.ERROR,"checkEMEInValid"),void this._errorHandler(new th(this.player,{errorType:gu.MEDIA,errorCode:yu.eme_hijack,errorMessage:"checkEMEInValid",vid:this.playerConfig.vid}));const{player:s,config:a}=this;this._updateDrmConfig(t),this.log(zs.LOG,"useEME: ",a.useEME),null==(r=this._secretkey)||r.setOptions('video/mp4; codecs="avc1.64001E"','audio/mp4; codecs="mp4a.40.2"'),null==(n=this._secretkey)||n.setupEME(s.video)}async _initMse(e,t=!1){var r;const{useEME:n}=this.config;if(Wu(this.config)&&n&&!kh.checkMSEValid())return this.log(zs.ERROR,"checkMSEInValid "),void this._errorHandler(new th(this.player,{errorType:gu.MEDIA,errorCode:yu.mse_hijack,errorMessage:"checkMSEInValid",vid:this.playerConfig.vid}));if(null==(r=this.player)||r.emit("codecsupdate",e.videoCodec),this.config.frameFreeze){if(this.log(zs.LOG,"release freezed frame"),this.mse){const e=this.mse;this.mse=null,await e.unbindMedia()}this.player&&this.player.src&&(this.player.removeAttribute("src"),this.player.load())}else this.updateMSEDuration();const i=function(e,t){const r=e&&e.checkCodecH265(),n=e&&e.checkCodecH266(),i=!!t.videoCodec,o=!!t.audioCodec;let s;return s=i&&o?r?'video/mp4; codecs="hev1.1.6.L93.B0, mp4a.40.5"':n?'video/mp4; codecs="bvc2.1.6.L93.B0, mp4a.40.5"':'video/mp4; codecs="avc1.64001E, mp4a.40.5"':i?r?'video/mp4; codecs="hev1.1.6.L93.B0"':n?'video/mp4; codecs="bvc2.1.6.L93.B0"':'video/mp4; codecs="avc1.64001E"':'video/mp4; codecs="mp4a.40.5"',s}(this.mp4,e),o={[ua.VIDEO]:{mimeType:"video/mp4",codec:i}};let s;this.mse?(this.log(zs.LOG,"MSE exit"),s=new md,s.resolve()):(this.log(zs.LOG,"new MSE"),this.mse=new ua,s=this.mse.bindMedia(this.player.video)),s.then(e=>{var r;this.changeState("MSE_OPEN");const{firstFrameTime:n}=this;n.initmse_sbopen=null==e?void 0:e.costtime,this._loadStartEventTime>0&&(n.mseopen=Pu()-this._loadStartEventTime);const i=Object.keys(o);try{for(let e=0;e<i.length;e++){const n=i[e];null==(r=this.mse)||r.createOrChangeSource(n,o[n].codec).then(()=>{this.changeState("MSE_OPEN_DONE"),this._isMseInit=!0,this._onTimeUpdate()}).catch(async e=>{var r;this.config.reUseMSE=!1,this.log(zs.WARN,"MSE createOrChangeSource catch err: ",null==e?void 0:e.message),await(null==(r=this.mse)?void 0:r.unbindMedia()),this.mse=null,this._isMseInit=!1,t?this.MSEErrorHandle(e):this._initMse(this.mp4.meta,!0)})}}catch(e){this.MSEErrorHandle(e)}}).catch(e=>this.MSEErrorHandle(e)),this.changeState("MSE_INIT")}MSEErrorHandle(e){const t=new th(this.player,{errorType:gu.mse,errorCode:yu.mse,vid:this.playerConfig.vid,errorMessage:e.message,mediaError:{code:yu.mse,message:e.message}});this.log(zs.ERROR,"initMse error: ",null==e?void 0:e.message),this._errorHandler(t)}_appendInitSeg(e){!this.mse||this._MSEError||(this.changeState("MSE_INITSEG"),this.mse.append(ua.VIDEO,e,{vid:this.playerConfig.vid,range:null,dataLen:e.byteLength,isinit:!0}).then(e=>{this.firstFrameTime.metaready_initsegend=null==e?void 0:e.costtime,this.changeState("MSE_INITSEG_OK",{costtime:null==e?void 0:e.costtime})}),this.config.useEME&&this._secretkey&&this._secretkey.encryptHandle())}_checkMetaInfo(e){if(!e)return new th(this.player,{errorType:gu.DEMUX,errorCode:yu.metaError,errorMessage:"meta is null",vid:this.playerConfig.vid});const t=this.mp4.checkCodecH265(),r=this.mp4.checkCodecH266();return this.changeState("MP4_META_READY",{isH265:t,isH266:r}),!t||(this.codecType!==pu&&(this.codecType=pu,this.log(zs.LOG,"codecType fix ",this.codecType)),this.softDecode||this.config.supportHevc)?r&&(this.codecType!==fu&&(this.codecType=fu,this.log(zs.LOG,"codecType fix ",this.codecType)),!this.config.supportVvcc)?this.notSupportError(this.codecType):null:this.notSupportError(this.codecType)}_stopProgress(){this.log(zs.LOG,"stopProgress",this._hasStartProgress),this._hasStartProgress=!1,this._requestTimer&&this._requestTimer.stop(),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0),this._seekResumTimer&&(clearTimeout(this._seekResumTimer),this._seekResumTimer=null)}checkReStartTimer(){const e=Pu()-this._lastTimeupdateTime2;e>2*this.config.tickInSeconds*1e3&&!this._offineLine&&(this.log(zs.LOG,"checkReStartTimer reStart timer",e,Pu()),this._stopProgress(),this._startProgress(),this._lastTimeupdateTime2=Pu())}_bindNetworkStateChange(){window.addEventListener("online",this._onOnlineHandler),window.addEventListener("offline",this._onOfflineHandler)}_unbindNetworkStateChange(){window.removeEventListener("online",this._onOnlineHandler),window.removeEventListener("offline",this._onOfflineHandler)}_onSuperStart(e){const{player:t}=this;Ou(`_onSuperStart:${e}`,this.mse),t.video.src=e,this.once("canplay",()=>{t.play(),this.on("waiting",this._onWaiting)})}_appendBuffer(e,t,r={},n){const{mse:i,playerConfig:o,player:s}=this,{vid:a}=o;this.log(zs.LOG,"appendStart",a,r.fragIndex,JSON.stringify(r.range)),this._MSEError?this.log(zs.ERROR,"_MSEError, not append return"):i.append(e,t,{vid:a,fragIndex:r.fragIndex,range:r.range,dataLen:t.byteLength,state:n}).then(e=>{var t,i,o,a,l,c,u;const d=s.getBufferedRange();this.log(zs.LOG,"appendEnd ",null==(t=null==e?void 0:e.context)?void 0:t.fragIndex,JSON.stringify(null==(i=null==e?void 0:e.context)?void 0:i.range),null==(o=null==e?void 0:e.context)?void 0:o.dataLen,", costTime,",null==e?void 0:e.costtime,", opt,",null==e?void 0:e.name,",buffer,",JSON.stringify(d),s.currentTime),this.checkBufferArriveEndTime();const h=this.firstFrameTime;if(h.loadst_loadeddata<0){h.apcnt++;const t=(null==(a=null==e?void 0:e.context)?void 0:a.dataLen)||0,r=(null==e?void 0:e.costtime)||0;h.aplen+=t,h.data_ap+=r;let n=!1;for(let e=this.states.length-1;e>=0;e--)if("APPEND_DATA_OK"===this.states[e].state){this.states[e].data.cnt+=1,this.states[e].data.costime+=r,this.states[e].data.dataLen+=t,n=!0;break}n||this.changeState("APPEND_DATA_OK",{costime:r,dataLen:t,cnt:1})}const p=null==(u=null==(c=null==(l=this.mp4)?void 0:l.adaptTimeRange[r.fragIndex])?void 0:c.timeRangeIdx)?void 0:u[1];if(this.mse&&n&&p>=this.mp4.timeRange.length){const{buffered:e}=this.player;e&&(null==e?void 0:e.length)>0&&(this.bufferEndTime=e.end(e.length-1)),this._isEnded(),this.log(zs.LOG,"loaded ended !!!==>>>",JSON.stringify(r.range),", fragIndex,",r.fragIndex,", bufferEndTime,",this.bufferEndTime,",meta_duration,",this.mp4.meta.duration)}}).catch(e=>{const{player:t,mse:n}=this;if(this._MSEError||!t)return;const i=t.media||t.video;if(e&&null!=n&&n.isFull()){this.log(zs.WARN,"[MSE is full]");const e=t.getBufferedRange(t.buffered2);this._checkRemoveSourceBuffer(e,t.currentTime,!0)}else{const n=`${null!=i&&i.error?[i.error.code,i.error.message].join("-"):"MEDIA_EMPTY"}`,o=`${(null==e?void 0:e.errorCode)||""}-${(null==e?void 0:e.errorMessage)||(null==e?void 0:e.message)||"MSE_EMPTY"}|${n}`;this._MSEError=!0,this.changeState("_MSEError",{fragIndex:null==r?void 0:r.fragIndex,range:null==r?void 0:r.range}),this.log(zs.LOG,"MSE append error",null==r?void 0:r.fragIndex,null==r?void 0:r.range);const s=new th(t,{errorType:gu.MEDIA,errorCode:yu.mseAppend,vid:a,errorMessage:o,mediaError:{code:yu.mseAppend,message:o}});this._errorHandler(s)}})}async _loadData(){if(this.mp4&&this._isMseInit){this.loadstart<0&&(this.loadstart=Pu());try{await this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess)}catch(e){this.log(zs.ERROR,"[Index] _loadData error",this.playerConfig.vid,null==e?void 0:e.message)}}}getDataBitRate(e){const{mp4:t,playerConfig:r}=this,{definition:n}=r;if(!t||!n||n.list)return 0;const i=t.getDataBitRate(e),{list:o}=n;let s=0;for(let e=0;o&&e<o.length;e++)if(o[e].bitrate===i){s=o[e];break}return s}_loadStuckCheck(){var e;const{config:t,player:r}=this;if(!t.disableBufferBreakCheck){const n=r.isUserActive;if(r.currentTime-(this._lastCurrentTime||0)>.1||!n&&r.paused||n&&this.playFlag&&r.paused)(1===this._bufferBreakFlag||2===this._bufferBreakFlag)&&(this.log(zs.LOG,"视频没有卡死,重置卡死标记,curtime,",r.currentTime),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null);else if(!this._bufferBreakFlag){this._bufferBreakFlag=1;const i=JSON.stringify(null==(e=null==r?void 0:r.buffered2)?void 0:e.bufferedList);this.log(zs.LOG,`卡死计时开始! ${t.waitingTimeOut}ms后确认卡死,`,r.currentTime,i),this._bufferBreakTimer=setTimeout(()=>{if(!(this.isDestroy||t.disableInactiveWaitingCheck&&(!n||null!=r&&r.paused))){if(1===this._bufferBreakFlag){const e=r.currentTime,t=r.bufferedPoint;if(t.end>0&&t.end-e>=2)return void this.retrySeekResum(e)}this._bufferBreakFlag=2,this.waitTimeoutDegrade()}},t.waitingTimeOut)}this._lastCurrentTime=r.currentTime}}waitTimeoutDegrade(){var e,t,r;const{player:n}=this;this.changeState("wait_timeout"),this.log(zs.LOG,"确认卡死!!!,curtime,",n.currentTime,JSON.stringify(null==(e=null==n?void 0:n.buffered2)?void 0:e.bufferedList),",duration,",null==(r=null==(t=this.mp4)?void 0:t.meta)?void 0:r.duration),this.emit("waittimeout");const i=document.hidden||"hidden"===document.visibilityState,o=new th(this.player,{errorType:gu.RUNTIME,errorCode:i?yu.waitTimeoutWithHidden:yu.waitTimeout,errorMessage:"wait_timeout",vid:this.playerConfig.vid});this._errorHandler(o)}async retrySeekResum(e){const{player:t,config:r}=this;if(this.changeState("retrySeek"),this.log(zs.LOG,"卡死但有超过2s的buffer,seek下!!!"),clearTimeout(this._seekResumTimer),this._resumePlay=!1,r.waitingRetrySeekTimes>0&&r.waitingRetryDuration){const n=Math.min(r.waitingRetrySeekTimes,3);this._currentSeekTimes=0,this.off("playing",this._onResumePlaying),this.once("playing",this._onResumePlaying);const i=()=>{if(t&&!this._resumePlay&&!t.paused)return this._currentSeekTimes<n?(this._seekOnce(e),void(this._seekResumTimer=setTimeout(i,r.waitingRetryDuration))):(this.waitTimeoutDegrade(),void(this._seekResumTimer=null));this.log(zs.LOG,`当前播放实例已恢复或处于暂停状态，退出重试 player=${!!t},_resumePlay=${this._resumePlay},paused=${null==t?void 0:t.paused}`)};return this._seekOnce(e),void(this._seekResumTimer=setTimeout(i,r.waitingRetryDuration))}t.currentTime=e+1,this.once("playing",()=>{this._resumePlay=!0}),this._seekResumTimer=setTimeout(()=>{this._resumePlay||this.waitTimeoutDegrade(),this._seekResumTimer=null},Math.ceil(r.waitingTimeOut/2))}_isInBuffer(e,t=0){let r=!1;const{buffered:n}=this.player.video;for(let i=0;i<n.length;i++){const o=n.start(i)-t,s=n.end(i)+t;if(o<=e.startTime&&e.endTime<=s){r=!0;break}}return r}_doubleCheckBuffer(e){const{player:t}=this;if(!(e.startTime>t.currentTime&&t.video&&t.video.buffered))return!0;const{buffered:r}=t.video;return 1===r.length||this._isInBuffer(e,.2)}checkURLExpired(e,t){var r,n,i,o;const s=function(e){if(!e||"String"!==$u(e))return 0;let t=0;try{const r=new RegExp("(\\?|&)x-tos-expires=([^&]*)(&|$)"),n=e.match(r);if(null!==n)t=parseInt(n[2],10);else{const r=e.split("/");r.length>5&&8===r[4].length&&(t=parseInt(r[4],16))}return t>0?t<parseInt((new Date).getTime()/1e3,10)?1:2:0}catch{return 0}}(this.config._mainURL);1===s&&this.pcdn&&(this.pcdn=null);const a=(null==(r=null==e?void 0:e.response)?void 0:r.url)||(null==(n=this.config.pcdnConfig)?void 0:n.trackerUrl);null==(o=this.player)||o.emit("source_error",{host:Du(a),src:a,errorCode:null==(i=null==e?void 0:e.response)?void 0:i.status,message:`${null==e?void 0:e.message}-${s}${t}`})}pushTimerStep(){var e;(null==(e=this.timerStepList)?void 0:e.length)>10&&this.timerStepList.shift(),this._lastTimeupdateTime2>0&&this.timerStepList.push(Pu()-this._lastTimeupdateTime2)}_onTimeUpdate(){this.pushTimerStep(),this._lastTimeupdateTime2=Pu();const{mse:e,mp4:t,player:r,config:n}=this;if(!r||this.useVideoLoad||!t)return;this.checkBufferArriveEndTime();const i=r.getBufferedRange();Pu()-this._lastCheckTime>1e3&&(this._lastCheckTime=Pu(),this._loadStuckCheck(),this._startUrlExpiredCheck(),this._checkRemoveSourceBuffer(i,r.currentTime));const{timeRange:o}=t;if(o&&!(o.length<1)&&(e||this.mseProxy)&&this.canDownload){let e=n.maxBufferLength,t=!1;(this.playFlag&&r.paused||!this.isActive)&&(t=!0);const{nextBufferLength:o,minBufferLength:s,adaptRange:a,noPreloadAddBufferLen:l}=n,c=null==a?void 0:a.targetCacheControl;t?e=r.isInstNext&&o>=0?o:s:c&&(e=this.adaptRange.getAdaptCacheBuffer()),!this.preLoadData&&c&&(e+=l);const u=r.currentTime+e;i[1]-u<0&&(this.isOpenPCDN(i[1]),(null==n?void 0:n.loadRangeType)===cu?this.sizeRangeCheckLoad(t,e,i[1]-r.currentTime):this.gopRangeCheckLoad(t,u,e)),this.playFlag&&!this._hasTriggerBufferThreshold&&this._startBufferCheck()}}sizeRangeCheckLoad(e,t,r){var n,i,o;const{player:s,mp4:a}=this,{adaptTimeRange:l}=a,c=l.length;if(!c||(null==(n=l[c-1])?void 0:n.range[1])<(a.size-1||s.curDefinition.size-1)||!l[c-1].downloaded){const n=l.findIndex(e=>!e.isLoading);if(null==l||!l.length||n>=0||l[c-1].downloaded){const{adaptRangeRes:c,loadDuration:u}=this.calculateAdaptRange(e,t),d=null==(i=this.adaptRange)?void 0:i.getAdaptRangeSize(u);d>0&&(c.loadSize=d),c.loadDuration=u,this._curLoadSegmentIdx=n<0?a.updateAdaptTimeRange(null,u,d):n;let h=this._curLoadSegmentIdx;l[h].downloaded||(h=Math.max(h-1,0));const p=l[h];if(r>0&&(null==p?void 0:p.endTime)-s.currentTime>=t)return;const f=l[this._curLoadSegmentIdx];if(this._curLoadSegmentIdx>=0&&this._isInBuffer(f)&&!this._isChangeDefinition&&this._curLoadSegmentIdx>=0&&f.endTime-f.startTime>1){const e=l[this._curLoadSegmentIdx];return e.downloaded=!0,e.isLoading=!0,this.log(zs.LOG,`onTimeUpdate, ${this._curLoadSegmentIdx} download segment, has buffer`,f.startTime,f.endTime,s.currentTime),void(a.seekTime=f.endTime)}c.idx=this._curLoadSegmentIdx,(!this.adaptRangeRes.length||(null==(o=this.adaptRangeRes[c.length-1])?void 0:o.idx)!==this._curLoadSegmentIdx)&&(this.adaptRangeRes.push(c),this.log(zs.LOG,"adaptRangeRes>>>>",c)),this.log(zs.LOG,"[onTimeUpdate],load index==>>>, ",this._curLoadSegmentIdx,JSON.stringify(l[this._curLoadSegmentIdx])),this._loadData()}}}gopRangeCheckLoad(e,t,r){const{timeRange:n,adaptTimeRange:i}=this.mp4,{player:o}=this;n.every((n,s)=>{var a,l,c,u;if(void 0!==n.adaptTimeRangeIdx&&n.adaptTimeRangeIdx>=0&&i&&i[n.adaptTimeRangeIdx].downloaded)return!0;const d=this.mp4.getAdaptIdxBySrcIdx(s,!0),h=d>=0?i[d]:null,p=d>=0&&this._isInBuffer(h);if(!this._isChangeDefinition&&d>=0&&h.endTime-h.startTime>1&&p)return i[d].downloaded=!0,i[d].isLoading=!0,this.log(zs.LOG,`onTimeUpdate, ${d} download segment, has buffer`,h.startTime,h.endTime,o.currentTime),!0;if(n.startTime-o.currentTime<t){if(d<i.length&&null!=(a=i[d])&&a.isLoading)return!1;const{adaptRangeRes:t,loadDuration:n}=this.calculateAdaptRange(e,r);this._curLoadSegmentIdx=this.mp4.updateAdaptTimeRange(s,n),t.idx=this._curLoadSegmentIdx,null!=(c=null==(l=this.config)?void 0:l.adaptRange)&&c.rangeControl&&(t.loadDuration=this.mp4.adaptTimeRange[this._curLoadSegmentIdx].duration),(!this.adaptRangeRes.length||(null==(u=this.adaptRangeRes[this.adaptRangeRes.length-1])?void 0:u.idx)!==this._curLoadSegmentIdx)&&(this.adaptRangeRes.push(t),this.log(zs.LOG,"adaptRangeRes>>>>",t));const h=i[this._curLoadSegmentIdx];if(this._isInBuffer(h))return h.downloaded=!0,h.isLoading=!0,this.log(zs.LOG,`onTimeUpdate_, ${this._curLoadSegmentIdx} download segment, has buffer`,h.startTime,h.endTime,o.currentTime),!0;this.log(zs.LOG,"[onTimeUpdate],load index==>>>, ",this._curLoadSegmentIdx,JSON.stringify(this.mp4.adaptTimeRange[this._curLoadSegmentIdx])),this._loadData()}})}checkBufferArriveEndTime(){const{player:e,mse:t,mp4:r}=this;if(!e||!t||!r)return;const n=e.getBufferedRange(),i=r.getMediaEndTime();i>0&&n[1]>=i&&!t.isEnded&&(this.log(zs.LOG,"checkBufferArriveEndTime endOfStream, enfTime",i,", bufferRange,",JSON.stringify(n),",currentTime,",e.currentTime),this.mseEndInfo.mseEndType=1,this.mseEndInfo.mseEndTime=parseInt(1e3*i,10),t.endOfStream())}calculateAdaptRange(e,t){var r,n;let i;const o={forceSetMin:e};null!=(r=this.pcdn)&&r.isOpenAdaptPCDN&&(o.PCDNInBuffer=this.pcdn.curPCDNInBuffer,o.PCDNOutBuffer=this.pcdn.curPCDNOutBuffer);const s=null==(n=this.config)?void 0:n.adaptRange;return!this.playFlag||e?i=this.config.minBufferLength:null!=s&&s.rangeControl?(i=this.adaptRange.getAdaptLoadDuration(),o.loadTarDuration=i):i=this.config.rangeMaxDuration,null!=s&&s.targetCacheControl&&(o.cachedBufferDur=t),!this.playFlag&&null!=s&&s.rangeControl&&(o.loadTarDuration=i),{adaptRangeRes:o,loadDuration:i}}checkReUseMSE(e,t){var r;const{mse:n}=this;if(n)if(e||this.config.reUseMSE){n.clearOpQueues(ua.VIDEO,t),n.abort(ua.VIDEO);const e=null==(r=this.player)?void 0:r.buffered;if((null==e?void 0:e.length)>0){const t=e.end(e.length-1);this.log(zs.LOG,"reUseMSE remove buffer, 0-",t),this._canUpdateDuration=!1,this.removeBuffer(ua.VIDEO,0,t,()=>{var e,t;this._canUpdateDuration=!0,null!=(t=null==(e=this.mp4)?void 0:e.meta)&&t.duration&&this.updateMSEDuration()})}}else n.unbindMedia(),this.mse=null,this._unloadVideo()}updateMSEDuration(){var e;const{mse:t,mp4:r}=this,n=null==(e=null==r?void 0:r.meta)?void 0:e.duration;this._canUpdateDuration&&n&&n!==t.duration&&(this.log(zs.LOG,"updateMSEDuration ",n,",oldDuration,",t.duration),t.updateDuration(n),this._canUpdateDuration=null)}_reset(){this._definitionChangePointInfo=null,this._isReceiveEndedEvent=!1,this.adaptRangeRes=[],this.states=[],this.hitpreload=!1,this._sTime=Pu(),this._isChangeDefinition=!1,this._removeBuffeEndTime=0,this._usePaused=!1,this.useVideoLoad=!1,this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this.emitExpireTimestamp=null,this.preLoadData=null,this.forPreloadTimeCache=null,this.playFlag=!1,this.waitLevelStartTime=-1,this._waitAdjustTimeCnt=0,this._initPromise&&"pending"===this._initPromise.state&&this._initPromise.reject(fh),clearTimeout(this.checkResumePlayTimer),this.checkResumePlayTimer=null,this._stopProgress(),this.mp4&&(this.mp4.destroy(),this.mp4=null),this.mseProxy&&(Hu(this.player,"warning",this._onDegrade),Hu(this.player,this._onError)),this.config.frameFreeze||this._unloadVideo(),this._cancelPendingPromises(),this._abrService&&(this._abrService.destroy(),this._abrService=null);const e=this.firstFrameTime;Object.keys(e).forEach(t=>{e[t]="apcnt"===t||"aplen"===t?0:"newplayer"===t?Pu():-1}),clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null,this.canDownload=!0,this.loadstart=-1,this._loadStartEventTime=-1,this.startLoadData=-1}removeErrorUrls(e,t,r){return e.errorCode===yu[403]&&this._emitExpireEvent(e),r}checkIsDegraded(e){const{notDegradeErrorList:t}=this.config;return!((null==t?void 0:t.length)>0&&(e.errorCode===yu.timeout&&t.indexOf("timeout")>=0||e.errorCode===yu[403]&&(t.indexOf(403)>=0||t.indexOf("403")>=0)||e.errorCode===yu[404]&&(t.indexOf(404)>=0||t.indexOf("404")>=0)))}startDegradedPlayback(e,t,r){this.canDownload=!1;const{player:n,playerConfig:i,config:o}=this;this.endofstream=!1,this._currentTime=n.currentTime||0,this.player.pause(),this._reset(),this._replay=null;const{H264DefinitionList:s}=i;if(this.codecType===pu&&this.softDecode)this.log(zs.LOG,"h265 softDecode err,degrade use 264 play",i.vid),this._onDegrade(e,r);else if(this.codecType===hu||o.supportHevc||o.supportVvcc||(null==s?void 0:s.length)>0){const{drm:r,kid:a,drmKeyToken:l,keyValue:c,secretKey:u}=o;if(r||a||l||c||u)r&&Object.keys(r).map(t=>{r&&(e[t]=r[t])}),this.log(zs.ERROR,"final error !!!!, ",i.vid,null==e?void 0:e.errorCode,null==e?void 0:e.errorMessage),this.emit("error",e);else{this.log(zs.LOG,this.codecType,"MSE degrade video,",i.vid,n.currentTime),this.emit(yh,{errorCode:null==e?void 0:e.errorCode,errorMessage:(null==e?void 0:e.errorMessage)||(null==e?void 0:e.message),codecType:this.codecType,mediaType:i.mediaType}),this.useVideoLoad=!0,this.destroyMSE();const r=()=>{this._currentTime&&(n.currentTime=this._currentTime),this.log(zs.LOG,"DegradedPlayback update currentTime",i.vid,this.codecType,this._currentTime),t?this.player.pause():this.player.play(),this._removeMetaDataEvent()};this._addMetaDataEvent(r);let o=i.url;if((null==s?void 0:s.length)>0){const e=s.length,t=this.player.curDefinition.definition;let r=t&&s.find(e=>e.definition===t);r||(i.H264DefinitionList.sort((e,t)=>e.bitrate-t.bitrate),r=i.H264DefinitionList[Math.floor(e/2)]),r&&(o=r.url,this.playerConfig.codecType=hu,this.codecType=hu)}this._setPlayerSrc(o)}}else this.log(zs.ERROR,"degrade player failed"),this.emit("error",e)}getAdaptTimeRangeIdx(e){var t,r;const{config:n,adaptRange:i}=this;let o=n.segmentMinDuration;return i&&null!=(t=null==n?void 0:n.adaptRange)&&t.rangeControl&&(o=i.getAdaptLoadDuration()),null==(r=this.mp4)?void 0:r.updateAdaptTimeRange(e,o)}_startProgress(){this.initTimer(),this._requestTimer.start(),this._hasStartProgress=!0}_unloadVideo(){this.log(zs.LOG,"unloadVideo");const{player:e}=this;try{e.video&&e.video.src&&!/^blob/.test(e.currentSrc)&&!/^blob/.test(e.video.src)&&(this.log(zs.LOG,"unloadVideo src"),e.video.removeAttribute("src"),e.video.load())}catch(e){this.log(zs.ERROR,"unloadVideo error",null==e?void 0:e.message)}}_addPendingPromise(e){this._pendingPromises.push(e)}_removePendingPromise(e){this.log(zs.LOG,"removePendingPromise",null==e?void 0:e.id);const t=this._pendingPromises.indexOf(e);t>-1&&this._pendingPromises.splice(t,1)}_cancelPendingPromises(){this._pendingPromises.length>0&&this._pendingPromises.forEach(e=>{e.reject(fh)}),this._pendingPromises=[]}_onMediaExpired(){this.log(zs.LOG,"MediaExpired stopProgress"),this._stopProgress(),this.emit(Jc.MEDIA_EXPIRED)}_isEnded(){var e,t;const{player:r,mp4:n}=this,i=r.bufferedPoint,o=i?i.end:0,s=r.currentTime;s>1&&o>s&&(o-s>=2||r.duration-s<1)&&2===r.video.readyState?Pu()-this._lastCheckLagTime>=3e3&&(this.log(zs.LOG,"[has buffer but waiting,seek 0.2 adjust],curTime,",s,", bufferend,",o,", duration,",null==(e=null==n?void 0:n.meta)?void 0:e.duration),r.currentTime=s+.2,this._lastCheckLagTime=Pu()):this._lastCheckLagTime=Pu();const{seeking:a}=r.video;return!this.endofstream&&this.bufferEndTime>0&&this.mse&&!a&&this.bufferEndTime-s<.5&&(this.log(zs.LOG,"[isEnded endOfStream],curTime,",r.currentTime,", bufferend,",o,", duration,",null==(t=null==n?void 0:n.meta)?void 0:t.duration),this.endofstream=!0,this.mseEndInfo.mseEndType=2,this.mseEndInfo.mseEndTime=parseInt(1e3*this.bufferEndTime,10),this.mse.endOfStream().then(()=>{})),!!(n&&n.meta&&!a&&n.meta.duration-s<.5)&&(this._stopProgress(),this.log(zs.LOG,"[isEnded],stopProgress and endOfStream,curTime, ",r.currentTime,", bufferend,",o,", duration,",n.meta.duration),this.mse&&(this.mseEndInfo.mseEndType=3,this.mseEndInfo.mseEndTime=parseInt(1e3*n.meta.duration,10),this.mse.endOfStream().then(()=>{})),!0)}emitVideoEvent(e){if(this._checkEndedTimer)return;const{player:t,mp4:r}=this;this._checkEndedTimer=setTimeout(()=>{this._checkEndedTimer=null,!this._isReceiveEndedEvent&&r.meta.duration-t.currentTime<.5&&(this.log(zs.LOG,"[ do emit video ended event],curTime,",t.currentTime,", bufferend,",e,", duration,",r.meta.duration),this.emit("ended"))},2e3)}_clearMediaKeys(){const{player:e}=this;e.video&&"function"==typeof e.video.setMediaKeys&&e.video.setMediaKeys(null).catch(()=>{})}_checkRemoveSourceBuffer(e,t,r,n){const{mse:i,mp4:o,player:s}=this;if(i&&o&&s&&(r&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),e||(e=s.getBufferedRange(s.buffered2)),t||(t=s.currentTime),!(!r&&Pu()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=Pu(),e&&e[0]>=0&&(t-e[0]>this.config.removeBufferLen||i.isFull())))){const r=n?e[1]:t-(i.isFull()?0:15),s=o.getFragmentIdx(r);if(s>0&&(n||o.timeRange[s].startTime<t)){const r=Math.floor(Math.min(o.timeRange[s].startTime,e[1])),n=Math.max(o.timeRange[0].endTime+1,e[0]);n<r?(this.log(zs.LOG,"[checkremoveSourceBuffer], remove range==>>>",n,r,t),this.removeBuffer(ua.VIDEO,n,r)):i.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout(()=>{this._checkRemoveSourceBuffer(null,null,!0)},1e4))}}}onMediaUpdate(e){const{vid:t,kid:r,url:n}=e,{player:i,config:o,playerConfig:s}=this;if(t===s.vid&&r===o.kid&&n){this.playerConfig.url=n;const e=this._handlerUrl(n);o._mainURL=e.main,o._backupURL=e.backup;const t=o._mainURL;return i.rawSrc=n,this.useVideoLoad?i.src=n:this.mp4&&this.mp4.updateUrl(t),!0}return!1}enableAutoBuffer(e){if(e){if(!this._allInitPromise)return void this.log(zs.LOG,"player destroyed!!");this._allInitPromise.then(()=>{this.log(zs.LOG,"enableAutoBuffer true"),this._startProgress()})}else this._stopProgress(),this.log(zs.LOG,"enableAutoBuffer false")}get bitRateAdapter(){if(!this.player||!this.player.plugins)return null;if(this.config.needAutoBitrate){const{bitrateselector:e}=this.player.plugins;return e}return null}getDefinitonFromAdapter(e,t){if(!this.bitRateAdapter)return null;const r=this.bitRateAdapter;return r.getSuitableBitrate?r.getSuitableBitrate(e,t):r.bitRateAdapter?r.bitRateAdapter.select(e):null}addPreloader(e={}){e.playerId=this.playerId;const{preloader:t}=this.player;t?t.addPreloader(e,this.playerConfig.vid,this.playerId):this.log(zs.LOG,"preloader has destroyed")}addPreloaderList(e=[]){const{preloader:t}=this.player;t?t.addPreloaderList(e,this.playerConfig.vid,this.playerId):this.log(zs.LOG,"preloader has destroyed")}log(e,t,...r){const{vid:n}=this.playerConfig||{},i=n?`[Index]${n} ${t}`:`[Index] ${t}`;Ou(this.logger,e,i,...r)}_emitInitFail(e){this.log(zs.ERROR,"initFail, reason:",e),this.emit(Jc.INIT_FAIL,e)}set useVideoLoad(e){this._useVideoLoad=e}get useVideoLoad(){return this._useVideoLoad}get ready(){return this._allInitPromise}get speed(){return parseInt(hd.speed,10)}get version(){return _u}get realTimeSpeed(){return Eh}get opQueueLen(){const e=this.mse&&this.mse._queue?this.mse._queue[ua.VIDEO]:[];return e?e.length:0}get loadSegmentTimeRange(){if(!this.mp4)return[0,0,0,0];const e=this.mp4.adaptTimeRange;if(e&&e.length>0&&this._curLoadSegmentIdx>=0&&this._curLoadSegmentIdx<e.length){const t=e[this._curLoadSegmentIdx];if(t.isLoading){const e=t.range;return[Number(t.startTime),Number(t.endTime),...e]}}return[0,0,0,0]}get preloadState(){return this.player.preloader&&this.player.preloader.loadingCount}get moovSize(){return 0}get isDestroy(){return!this.player}cancelPreloadTask(){this.preloader&&this.preloader.cancelLoading(this.player.playerId)}removeAllPreloadData(){this.preloader&&this.preloader.removeAll()}removeAllPreloadTask(){this.preloader&&this.preloader.removeAllPreloadTask()}get domain(){return Du(this.loadURL)}get loadURL(){const{player:e}=this;let t=e.currentSrc;return/^blob/.test(e.currentSrc)&&(t=this.mp4.currentLoadUseUrl()),t}get abrInstance(){return this._abrService?this._abrService.abrInstance:null}_handleUrlExpire(){const{config:e,player:t}=this,{paused:r}=t;(new Date).getTime()/1e3>=this.urlExpireTimestamp&&this.urlExpireTimestamp>0&&!r&&e.getServerTime&&(t.serverTimeDiffPromise=t.serverTimeDiffPromise||e.getServerTime().catch(()=>0),t.serverTimeDiffPromise.then(e=>{if(e&&(t.serverTimeDiff=(new Date).getTime()/1e3-e),(new Date).getTime()/1e3>=this.urlExpireTimestamp+t.serverTimeDiff){this.urlExpireTimestamp=(new Date).getTime()/1e3+86400;const e=new mu("network",yu[403]);this._emitExpireEvent(e)}}))}_emitExpireEvent(e){const{player:t}=this,r=(new Date).getTime()/1e3;return this.emitExpireTimestamp?r-this.emitExpireTimestamp>300&&(this.emitExpireTimestamp=r,t.emit("MEDIA_EXPIRED",e),!0):(this.emitExpireTimestamp=r,t.emit("MEDIA_EXPIRED",e),!0)}reportBugPostPlayerLog(){this.emit(_h)}}Th.isSupported=function(){return gd()&&yd()&&!fd()},Th.isEMESupported=_d,Th.isSupportedWithXgmse=function(){return yd()&&!fd()},Th.isMediaSourceSupported=gd,Th.isWebAssemblySupported=yd,Th.CUSTOM_EVENTS=Jc;var Sh=r(67018),Oh=Object.defineProperty;class Ah extends Ht{constructor(){super(),((e,t,r)=>{((e,t,r)=>{t in e?Oh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"_proxyEvent",e=>"playCatch"==e?(t,r)=>{this.trigger(e,{vtype:t,error:r})}:"prf_data_size"==e?e=>{this.trigger("downloaderChunkReady",{chunkSize:e.cdn_size,speed:e.cdn_speed})}:"PRELOAD_INFO"==e?e=>{this.trigger("preloaderInfoReady",{size:e.byteLength||e.total,duration:e.duration,type:e.type||e.vtype,vid:e.vid})}:t=>{this.trigger(e,t)}),this.currentPlayer=null,this.rawEvents=["loadstart","loadeddata","loadedmetadata","durationchange","timeupdate","error","canplay","canplaythrough","volumechange","pause","playing","waiting","ended","seeking","seeked","stalled","abort","play","progress","downloaderError","downloaderChunkReady","memoryCompleted","playCatch","prf_data_size","PRELOAD_INFO","preloaderInfoReady","source_error","source_success","resolutionReady","exception"],this.extensionEvents=["autoplayPrevented"],this._callbacks=[],this.events=this.rawEvents.concat(this.extensionEvents)}set player(e){this.remove(),this.currentPlayer=e,this.bind()}remove(){this.currentPlayer&&this._callbacks.forEach((e,t)=>{e()})}bind(){this.currentPlayer&&(this.rawEvents.forEach((e,t)=>{const r=this._proxyEvent(e);this.currentPlayer.bindEvent&&this.currentPlayer.bindEvent(e,r),this.currentPlayer.on&&this.currentPlayer.on(e,r),this._callbacks.push(()=>{this.currentPlayer.removeEvent&&this.currentPlayer.removeEvent(e,r),this.currentPlayer.off&&this.currentPlayer.off(e,r)})}),this.extensionEvents.forEach((e,t)=>{const r=this._proxyEvent(e);this.currentPlayer.proxyOn&&this.currentPlayer.proxyOn(e,r),this._callbacks.push(()=>{this.currentPlayer.proxyOff&&this.currentPlayer.proxyOff(e,r)})}))}release(){this.remove(),this.currentPlayer=null,this._events=[],this.rawEvents=[],this._callbacks=[]}}const $h="error",Ph="timeupdate",Rh="canplay",xh="volumechange",Lh="loadeddata",Ih="loadedmetadata",Mh="ratechange",Dh="progress",Bh="loadstart",Nh="emptied",jh="autoplay_started",Uh="autoplay_was_prevented",Vh=(Symbol.toStringTag,{index:0,prefix:"_Multimedia_"});function Fh(){return++Vh.index}function Hh(e,t){return e+Vh.prefix+t}function Gh(e,t,r,n="default"){return`${e}#${t}#${r}#${n}`}function Wh(e,t,r,n){const{url:i,vtype:o,codecType:s,definition:a}=t,l=Gh(e,s,o,a),c={vid:e,...t,bitrateList:r||[],targetCodec:(null==n?void 0:n.targetCodec)||t.codecType,targetVtype:(null==n?void 0:n.targetVtype)||t.vtype};return{cacheKey:l,urls:"string"==typeof i?[i]:i.map(e=>e.src),extra:c}}function qh(e){if(!e||e.length<1)return null;let t=0,r=0;const{codecType:n,vid:i="",vtype:o="",definition:s,bitrate:a,size:l=0,qualityType:c=0}=e[0].extra;return e.forEach(e=>{const{data:n,origin:i}=e.segment;i===J.PRELOAD?r+=n.byteLength:t+=n.byteLength}),{cacheSize:t,preloadSize:r,dataSize:t+r,codecType:n,vtype:o,vid:i,definition:s,qualityType:c,bitrate:a,size:l,hitType:Ut.C.UNKNOWN,mediaType:"video",total:l,order:0,timeStamp:0}}function Kh(e){return qh(X.get(e))}function zh(e,t,r){const n=X.getCacheKeys(),i=`${e}#${t}#${r}`;for(let e=n.length-1;e>=0;e--)if(n[e].includes(i))return Kh(n[e]);return null}Symbol.toStringTag;class Zh extends Ht{constructor(e=Ut.P.XG,t){super(),this.vid=null,this.mediaType=null,this.uuIndex=Fh(),this.uuid=Hh(e,this.uuIndex),this.playerType=e,this.player=null,this.forceAutoplay=!1,this.attemptPlayCount=0,this.vqscore=0,this.mvmaf="",this.events=["autoplayPrevented"],this.state=t||Ut.R.ACTIVE,this.bitrateList=[],this.curBitrate=null,this.resolutionInfo=null}get element(){return null}get type(){return this.playerType}get isActive(){return this.state===Ut.R.ACTIVE}style(e,t){this.element&&(this.element.style[e]=t)}set volume(e){this.element&&(this.element.volume=e)}set muted(e){this.element&&(this.element.muted=e)}set objectFit(e){e?this.element&&(this.element.style.objectFit=e):(0,Ut.a)(this.element,"object-fit")}get readyState(){var e;return(null==(e=this.player)?void 0:e.readyState)||0}get networkState(){var e;return(null==(e=this.player)?void 0:e.networkState)||0}set playbackRate(e){this.element&&(this.element.playbackRate=e)}get currentTime(){return this.element?this.element.currentTime:0}get duration(){return this.element?this.element.duration:0}get width(){return this.element?this.element.videoWidth:0}get height(){return this.element?this.element.videoHeight:0}get paused(){var e;return(null==(e=this.element)?void 0:e.paused)||!1}get ended(){var e;return(null==(e=this.player)?void 0:e.ended)||!1}get error(){return this.element?this.element.error:null}get attributes(){const{element:e}=this;return{error:(null==e?void 0:e.error)||null,src:(null==e?void 0:e.currentSrc)||"",currentTime:(null==e?void 0:e.currentTime)||0,muted:!(null==e||!e.muted),duration:(null==e?void 0:e.duration)||0,readyState:(null==e?void 0:e.readyState)||0,networkState:(null==e?void 0:e.networkState)||0,buffered:null==e?void 0:e.buffered,volume:(null==e?void 0:e.volume)||1,ended:!(null==e||!e.ended),paused:!(null==e||!e.paused),seeking:!(null==e||!e.seeking),currentSrc:(null==e?void 0:e.currentSrc)||""}}get isReady(){return!!this.element&&this.element.readyState>=2}get curDefinition(){return{url:"",definition:"",bitrate:-1,duration:-1,codecType:"h264"}}get playbackQuality(){var e,t;return this.element&&"VIDEO"===this.element.tagName&&(null==(t=(e=this.element).getVideoPlaybackQuality)?void 0:t.call(e))||null}getVideoPlaybackQuality(){return this.playbackQuality}proxyOn(e,t){return super.on(e,t)}proxyOff(e,t){return super.off(e,t)}updateConfig(e){}on(e,t){this.element&&this.element.addEventListener(e,t)}off(e,t){this.element&&this.element.removeEventListener(e,t)}once(e,t){}mute(e){this.element&&(this.element.muted=e)}access(){if(this.element)return this.play().then(()=>{this.pause()})}load(e){if(!this.element)return;let t="";t=e instanceof Array?e.length>0?e[0].src:"":e,this.element.src=t}seek(e){this.element&&(this.element.currentTime=e)}play(){return this.element?this.element.play():Promise.resolve()}replay(){return this.seek(0),this.play()}pause(){this.element&&this.element.pause()}get buffered(){var e;return null==(e=this.element)?void 0:e.buffered}reset(){}release(e){this.attemptPlayCount=0}addSubtitle(e,t){}async enterFullscreen(e){this.element&&(this.element.requestFullscreen?this.element.requestFullscreen():this.element.mozRequestFullScreen?this.element.mozRequestFullScreen():this.element.webkitRequestFullscreen?this.element.webkitRequestFullscreen():this.element.msRequestFullscreen?this.element.msRequestFullscreen():this.element.webkitEnterFullscreen&&this.element.webkitEnterFullscreen())}async exitFullscreen(e){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.webkitExitFullscreen?window.document.webkitExitFullscreen():window.document.msExitFullscreen?window.document.msExitFullscreen():this.element&&this.element.webkitExitFullScreen&&this.element.webkitExitFullScreen()}tryPlay(e){window.setTimeout(()=>{this.attemptPlayCount>=3||(!e.message.match(Ut.b.LoadInterrupt)&&!e.message.match(Ut.b.Abort)&&this.trigger("autoplayPrevented",e),(e.message.match(Ut.b.NoInteract)||e.message.match(Ut.b.SafariNoInteract)||e.message.match(Ut.b.FireFox))&&this.mute(!0),this.play(),this.attemptPlayCount+=1)},0)}initStyle(){this.element&&(this.element.style.width="100%",this.element.style.height="100%",this.element.style.position="absolute",this.element.style.top="0",this.element.style.left="0",this.element.style["::-webkit-media-controls-enclosure"]={display:"none !important"})}initProperty(){this.element&&(this.element.controls=!1,this.element.loop=!1,this.element.muted=!1,this.element.playsInline=!0,this.element.poster="",this.element.preload="auto")}getVideoDesc(){return{videoType:"mp4"}}preloadResources(e){}updatePreloadCodec(e){}updatePreloadConfig(e){}getPreloadMeta(e){return null}changeState(e){this.state=e}changeVideo(e,t,r){}mountDom(e){var t;const r=null==(t=this.player)?void 0:t.root;if(r&&e&&r.parentNode!==e)try{e.appendChild(r)}catch(e){console.error(e)}}unMountDom(){var e,t;const r=null==(e=this.player)?void 0:e.root;if(r)try{null==(t=null==r?void 0:r.parentElement)||t.removeChild(r)}catch(e){console.error(e)}}isSoftHevc(){return!1}}var Yh=(e=>(e.R_240="240P",e.R_360="360P",e.R_480="480P",e.R_540="540P",e.R_720="720P",e.R_1080="1080P",e.R_1440="1440P",e.R_2K="2K",e.R_4K="4K",e.R_8K="8K",e))(Yh||{});const Xh=["240P","360P","480P","540P","720P","1080P","2K","4K","4K","8K"],Qh={"240P":"240p","360P":"360p","480P":"480p","540P":"540p","720P":"720p","1080P":"1080p","1440P":"1440p","2K":"2k","4K":"4k","8K":"8k"},Jh=new Map([[2,{name:"adapt_lowest_1080p",resolution:"1080P"}],[3,{name:"adapt_lower_1080p",resolution:"1080P"}],[4,{name:"adapt_1080p",resolution:"1080P"}],[7,{name:"adapt_lowest_1440p",resolution:"1440P"}],[10,{name:"normal_720p",resolution:"720P"}],[11,{name:"low_720p",resolution:"720P"}],[12,{name:"adapt_high_720p",resolution:"720P"}],[13,{name:"adapt_higher_720p",resolution:"720P"}],[14,{name:"adapt_lower_720p",resolution:"720P"}],[15,{name:"adapt_lowest_720p",resolution:"720P"}],[16,{name:"higher_720p",resolution:"720P"}],[18,{name:"adapt_720p",resolution:"720P"}],[19,{name:"adapt_low_720p",resolution:"720P"}],[191,{name:"lower_720p",resolution:"720P"}],[20,{name:"normal_540p",resolution:"540P"}],[21,{name:"adapt_lower_540p",resolution:"540P"}],[22,{name:"adapt_high_540p",resolution:"540P"}],[23,{name:"adapt_higher_540p",resolution:"540P"}],[24,{name:"lower_540p",resolution:"540P"}],[25,{name:"lowest_540p",resolution:"540P"}],[26,{name:"higher_540p",resolution:"540P"}],[27,{name:"highest_540p",resolution:"540P"}],[28,{name:"adapt_540p",resolution:"540P"}],[29,{name:"adapt_lowest_540p",resolution:"540P"}],[291,{name:"adapt_low_540p",resolution:"540P"}],[30,{name:"adapt_low_540p",resolution:"480P"}],[31,{name:"low_480p",resolution:"480P"}],[32,{name:"high_480p",resolution:"480P"}],[33,{name:"medium_480p",resolution:"480P"}],[34,{name:"lower_480p",resolution:"480P"}],[35,{name:"lowest_480p",resolution:"480P"}],[36,{name:"higher_480p",resolution:"480P"}],[37,{name:"highest_480p",resolution:"480P"}],[39,{name:"adapt_lower_480p",resolution:"480P"}],[391,{name:"adapt_high_480p",resolution:"480P"}],[40,{name:"normal_360p",resolution:"360P"}],[41,{name:"low_360p",resolution:"360P"}],[42,{name:"high_360p",resolution:"360P"}],[43,{name:"medium_360p",resolution:"360P"}],[44,{name:"lower_360p",resolution:"360P"}],[45,{name:"lowest_360p",resolution:"360P"}],[46,{name:"higher_360p",resolution:"360P"}],[47,{name:"highest_360p",resolution:"360P"}],[48,{name:"adapt_360p",resolution:"360P"}],[49,{name:"adapt_lowest_360p",resolution:"360P"}],[50,{name:"adapt_high_360p",resolution:"360P"}]]);function ep(e,t){var r;let n="";return t&&(n=(null==(r=Jh.get(t))?void 0:r.resolution)||""),n||(Object.keys(Qh).forEach(t=>{const r=Qh[t];!n&&e.indexOf(r)>-1&&(n=t)}),n)}const tp="auto",rp=new class{constructor(){this.resolutionOrder=[],this.config={disableList:[],resolutionOrder:[...Xh],priority:{"360P":["adapt_lowest_360_1","normal_360_0"],"480P":["normal_480_1","normal_480_0"],"540P":["adapt_540_1","adapt_lowest_540_1","normal_540_1","lower_540_1","lowest_540_1","normal_540_0","lower_540_0","lowest_540_0"],"720P":["adapt_lower_720_1","normal_720_0","normal_720_1"],"1080P":["adapt_lowest_1080_1","normal_1080_1","normal_1080_0","vladder_1080_1","original_1080_0"]}}}setConfig(e){Object.keys(e).forEach(t=>{this.config[t]=e[t]})}filterByVtypeAndCodec(e,t,r,n){if(e.length<1||!n||0===n.length)return e.filter(e=>e.codecType===t&&e.vtype===r);const i=e.filter(e=>e.codecType===t&&e.vtype===r&&e.resolution&&!n.includes(e.resolution));return i.length>0?i:e.length>0?[e[0]]:[]}duplicatesResolution(e){const t=[],r=[];for(let n=0;n<e.length;n++){const i=e[n],o=i.resolution||"";t.indexOf(o)<0&&(t.push(o),r.push(i))}return r}getResolutionList(e){const t=[],r=[];for(let n=0;n<e.length;n++){const i=e[n].resolution||"";t.indexOf(i)<0&&(t.push(i),r.push({resolution:i}))}return r}getResolutionKey(e,t){return ep(e,t)}addResolutionKey(e){return e.map(e=>{const t=e.gearName||e.definition||"";return e.resolution=ep(t),e})}filterUserSelectResolution(e){const{disableList:t=[],resolutionOrder:r}=this.config;if(e===tp||!t.includes(e))return e;const n=r.findIndex(t=>t===e);let i=null;for(let o=n;o>=0;o--)if(r[o]!==e&&!t.includes(r[o])){i=r[o];break}return i||r[0]}filterByResolution(e,t,r){const{codecType:n,vtype:i}=r,{resolutionOrder:o,disableList:s=[]}=this.config,a=function(e,t){if(t.length<1)return e;const r=[];for(let n=0;n<e.length;n++)t.includes(e[n])||r.push(e[n]);return r}(o,s);let l=this.filterByVtypeAndCodec(t,n,i,s);if(0===l.length&&n===Ut.c.H265&&(l=this.filterByVtypeAndCodec(t,Ut.c.H264,Ut.V.MP4)),l.length<1||e===tp)return l;let c=a.indexOf(e)||0,u=[];for(;0===u.length&&c>=0;)u=l.filter(e=>e.resolution===a[c]),c--;return u.sort((e,t)=>t.bitrate-e.bitrate),u.length>0?u:[t[0]]}filter(e,t){const{codecType:r=Ut.c.H264,vtype:n=Ut.V.MP4}=t,{disableList:i}=this.config;e.sort((e,t)=>e.bitrate-t.bitrate),e=this.addResolutionKey(e);let o=this.filterByVtypeAndCodec(e,r,n,i);return 0===o.length&&"h265"===r&&(o=this.filterByVtypeAndCodec(e,Ut.c.H264,n,i)),o=this.duplicatesResolution(o),o}};function np(e,t,r){const n=r.filter(r=>{if(e===r.vtype&&r.codecType===t)return r});return n.sort((e,t)=>e.bitrate-t.bitrate),n}class ip{constructor(e){this.selectorName="base",this.config={}}updateConfig(e){}getMP4H264List(e){return np(Ut.V.MP4,Ut.c.H264,e)}getTargetBitrate(e,t){return 0}select(e,t,r){return null}}class op extends ip{constructor(e){super(e),this.selectorName="default",this.config={...e}}updateConfig(e){Object.keys(e).forEach(t=>{this.config[t]=e[t]})}getMP4H264List(e){return np(Ut.V.MP4,Ut.c.H264,e)}select(e,t,r){const{quality:n,hevcQuality:i}=t||this.config,{codecType:o,vtype:s}=r||{codecType:Ut.c.H264,vtype:Ut.V.MP4},a=np(s,o,e),l=this.getMP4H264List(e),c=o===Ut.c.H265?i:n;let u=null;if(a.length>0){if(u=a.find(e=>e.qualityType===c),!u){const e=function(e){return 14===e?"720P":"540P"}(c),t=rp.filterByResolution(e,a,{codecType:o,vtype:s});u=t.length>0?t[0]:a[0]}}else u=l.find(e=>e.qualityType===n),u||(u=l.length>0?l[0]:null);return u}}function sp(e){return parseInt(e,10)}function ap(e,t,r=0){return r?1===r?function(e,t){if(!e)return null;let r=-1,n=1/0,i=-1;for(let o=0;o<e.length;o++)i=e[o].bitrate-t,i>0&&i<n&&(n=i,r=o);return r<0?null:e[r]}(e,t):null:function(e,t){if(!e)return null;let r,n=1/0;return e.forEach(e=>{const i=Math.abs(e.bitrate-t);n>i&&(r=e,n=i)}),r||null}(e,t)}const lp=new class{constructor(e={}){this._queue=[],this._config={},this.setConfig(e)}setConfig(e){this._config=Object.assign({},e)}get records(){return this._queue}appendPlayInfo(e){const{duration:t,endBufferTime:r,stalledTime:n,downloadDuration:i,bitrate:o}=e;if(!t||!o||!r)return;const{slidingWindowWeight:s=0,slidingWindowType:a=0,slidingWindowWeightThreshold:l=0,slidingWindowCountThreshold:c=0}=this._config,u=this.getAdjust(this._config,e);let d=0;if(d="time"===s?Math.min(i,t+n):Math.min(i,t)*o,d=sp(d),this._queue.push([u,d,e]),"by_weight"===a){this._queue=this._queue.slice(-30);let e=this._queue.reduce((e,t)=>e+t[1],0)-l;for(;e>0;){const t=this._queue.shift();if(!t)break;if(t[1]>e){t[1]-=e,this._queue.unshift(t);break}e-=t[1]}}else this._queue=this._queue.slice(-c)}getAdjust(e,t){const{startBufferTime:r,endBufferTime:n,leaveWithBlock:i,stalledTime:o,pausedTime:s,downloadDuration:a,bitrate:l}=t,{paramBf:c=.3,paramBp:u=.5,paramUpperBl:d=.7,paramUpper:h=1.5}=e;let p=1+((n-r)*c-(o+s)*u)/a;return i&&(p=Math.min(p,d)),i&&(p=Math.min(p,d)),sp(l*Math.max(h,p))}getDefaultBitrate(e){if(!e||0===e.length)return 0;const{defaultTargetBitrate:t=1e6}=this._config;let r=0;for(let n=0;n<e.length;n++)e[n].bitrate<=t&&e[n].bitrate>=r&&(r=e[n].bitrate);return r||(r=e[e.length-1].bitrate),r}getTargetBitrate(e={},t){const r=t.duration;if(!this._queue.length||!r)return 0;const n={...this._config,...e},{paramVlLower:i=.8,paramVlUpper:o=.9,paramVl1:s=.7,paramVl2:a=1e3,bitrateLower:l=2e5,bitrateUpper:c=2e6,slidingWindowExtraction:u}=n;let d=0;const h=this._queue.reduce((e,t)=>e+t[1],0);if("weighted_median"===u){const e=h/2;let t=1/0,r=0;this._queue.forEach(i=>{const o=this.getAdjust(n,i[2]);r=Math.abs(e-i[1]),r<t&&(d=o,t=r)})}else d=this._queue.reduce((e,t)=>e+t[1]/h*t[0],0);const p=Math.min(o,Math.max(i,s+a/r));return sp(Math.max(l,Math.min(c,d*p)))}};function cp(){return lp}class up extends ip{constructor(e){super(e),this.selectorName="buffer-info",this.rule=cp(),this.rule.setConfig(e)}updateConfig(e){this.rule.setConfig(e)}getTargetBitrate(e,t){return this.rule.getTargetBitrate(e,t)}select(e,t,r){const{codecType:n,vtype:i}=r||{codecType:Ut.c.H264,vtype:Ut.V.MP4},o=np(i,n,e),s=this.getMP4H264List(e),a=e.length>0?e[0].duration:0,l=(null==t?void 0:t.selectAlgType)||0,c=this.rule.getTargetBitrate(t,{duration:a||0});let u=null;return u=o.length>0?ap(o,c,l)||null:ap(s,c,l)||null,u}}const dp=[];class hp{constructor(e,t={}){this._timer=-1,this._prevPauseTime=0,this.video=null,this._onPlay=()=>{this._calcPausedTime()},this._onPause=()=>{this._prevPauseTime=Date.now()},this._onEnded=()=>{!this._info.downloadDuration&&this._info.canPlayTime&&(this._info.downloadDuration=sp(Date.now()-this._info.canPlayTime)/1e3),this.endPlay(),this.disable()},this._canPlay=()=>{if(!this.video)return;this._info.canPlayTime=Date.now(),this._info.duration=this.video.duration;const e=this.video.buffered;e.length&&(this._info.startBufferTime=e.end(e.length-1))},this._onProgress=()=>{if(!this.video)return;const e=this.video.buffered;this._info.canPlayTime&&e.length&&e.end(e.length-1)+.8>this.video.duration&&(this._info.downloadDuration=sp(Date.now()-this._info.canPlayTime)/1e3)},this._onTick=()=>{const e=this.video;if(!e)return;this._timer=setTimeout(this._onTick,500);const t=e.currentTime;!e.paused||e.ended||0===e.playbackRate||0===e.readyState?(this._prevCurrentTime===t?this._prevStallTime||(this._prevStallTime=Date.now()):this._calcStallTime(),this._prevCurrentTime=t):this._prevCurrentTime=t},this.video=e,this._videoId=e.getAttribute("data-xgplayerid")||(new Date).getTime(),this._timer=0,this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this.resetInfo(),this.enable(),null!=t&&t.bitrate&&(this.bitrate=t.bitrate),null!=t&&t.vid&&(this._info.vid=t.vid)}static get videoInfoList(){return dp}static checkIsInList(e){for(let t=0;t<dp.length;t++)if(dp[t].video===e)return t;return-1}static attachVideo(e,t={}){if(!e)return;const{duration:r}=e,n=hp.checkIsInList(e);n<0?dp.push({video:e,playInfo:new hp(e,{...t,duration:r||0})}):t.bitrate&&(dp[n].playInfo.bitrate=t.bitrate)}static detachVideo(e){if(!e)return;const t=hp.checkIsInList(e);if(t>=0){const e=dp.splice(t,1);e.length>0&&e[0].playInfo.destroy()}}get isStalling(){return!!this._prevStallTime}set bitrate(e){this._info.bitrate=e}enable(){this.disable();const e=this.video;e&&(e.addEventListener("play",this._onPlay),e.addEventListener("pause",this._onPause),e.addEventListener("loadeddata",this._canPlay),e.addEventListener("progress",this._onProgress),e.addEventListener("ended",this._onEnded),this._timer=setTimeout(this._onTick,500))}disable(){clearTimeout(this._timer),this.resetInfo();const e=this.video;e&&(e.removeEventListener("play",this._onPlay),e.removeEventListener("pause",this._onPause),e.removeEventListener("loadeddata",this._canPlay),e.removeEventListener("progress",this._onProgress),e.removeEventListener("ended",this._onEnded))}endPlay(){if(!this.video)return;const e=this.video.buffered;if(e.length)try{this._info.endBufferTime=e.end(e.length-1)}catch{}this._info.leaveWithBlock=this.isStalling,this._calcPausedTime(),this._calcStallTime();const{downloadDuration:t,canPlayTime:r}=this._info;!t&&r&&(this._info.downloadDuration=sp(Date.now()-r)/1e3),this.updateRuleByPlayInfo()}updateRuleByPlayInfo(){const e=this.getInfo();cp().appendPlayInfo({duration:e.duration,bitrate:e.bitrate,downloadDuration:e.downloadDuration,startBufferTime:e.startBufferTime,endBufferTime:e.endBufferTime,pausedTime:e.pausedTime,stalledTime:e.stalledTime,leaveWithBlock:e.leaveWithBlock,vid:e.vid})}getInfo(){return this._info}resetInfo(){this._prevPauseTime=0,this._prevStallTime=0,this._prevCurrentTime=0,this._info={vid:"",duration:0,pausedTime:0,stalledTime:0,downloadDuration:0,startBufferTime:0,endBufferTime:0,canPlayTime:0,leaveWithBlock:!1,bitrate:0}}destroy(){this.endPlay(),this.disable(),this.video=null}_calcStallTime(){this._prevStallTime&&(this._info.stalledTime+=sp(Date.now()-this._prevStallTime)/1e3,this._prevStallTime=0)}_calcPausedTime(){this._prevPauseTime&&(this._info.pausedTime+=sp(Date.now()-this._prevPauseTime)/1e3,this._prevPauseTime=0)}}const pp="BitRateAdapter",fp=new class{constructor(){this.defaultSelector="default";const e={quality:20,hevcQuality:28,minBitrate:0,maxBitrate:0,defaultVtype:Ut.V.MP4,defaultCodecType:Ut.c.H264,userSelectResolution:"auto",resolutionOrder:["360P","480P","540P","720P","1080P"],selector:"default",selectConfig:{},selectAlgType:0,disableList:[]};this._selectors={default:new op(e),"buffer-info":new up(e)},this.config={...e}}static get PlayingInfo(){return hp}set disableList(e){this.config.disableList=e,rp.config.disableList=e}updateConfig(e){const t=this.getSelector(this.defaultSelector);if(Object.keys(e).forEach(r=>{this.config[r]=e[r],t&&(t.config[r]=e[r])}),e.selectConfig){const t=this.getSelector(this.defaultSelector);t&&t.updateConfig(e.selectConfig)}e.filterConfig&&rp.setConfig(e.filterConfig)}setUseSelectResolution(e){this.config.useSelectResolution=e}addSelector(e,t,r){this._selectors[e]=new t(r||{})}getSelector(e){let t=this._selectors[e];return t||(t=this._selectors[this.defaultSelector]||this._selectors.defalut),t}getDefaultSelector(){return this._selectors[this.defaultSelector]}getFixedDefinition(e,t){if(t.length<0)return null;if(1===t.length)return t[0];const r=t.filter(t=>t.definition===e||t.qualityType===e);return r.length>0?r[0]:null}getLowestBitrate(e,t,r){const n=rp.filterByVtypeAndCodec(e,t||Ut.c.H264,r||Ut.V.MP4);return n.sort((e,t)=>e.bitrate-t.bitrate),n.length>0?n[0]:null}select(e,t,r,n={},i){const o=n.selector||this.config.selector||this.defaultSelector,{defaultVtype:s,defaultCodecType:a}=this.config,l=t||a,c=r||s;let u=this.config.userSelectResolution||tp;u=rp.filterUserSelectResolution(u);let d=null;const h=e.length>0?e[0].uri:"";rp.addResolutionKey(e),e.sort((e,t)=>e.bitrate-t.bitrate);const p=(null==i?void 0:i.definition)||"",f=rp.getResolutionKey(p);if(p&&("auto"===u||"auto"!==u&&f===u)&&(d=this.getFixedDefinition(p,e)),d)return(0,Ut.l)(pp,h,"select FixedDefinition",`codecType:${l} vtype:${c} userSelectResolution:${u} selector:[${o}] defaultDefinition:${p}`,e,d),d;const _={...this.config.selectConfig,...n.config,quality:this.config.quality,hevcQuality:this.config.hevcQuality};let y=this.getSelector(o);const g=e.length>1?e[0].duration:0,m=rp.filterByResolution(u,e,{codecType:l,vtype:c}),v=y.getTargetBitrate(_,{duration:g})||0;return 0===v&&(y=this.getDefaultSelector()),d=y.select(m,_,{codecType:l,vtype:c,...i}),(0,Ut.l)(pp,h,"select return",`codecType:${l} vtype:${c} userSelectResolution:${u} selector:[${o}] targetBitrate:${v}`,e,d),d}filterResolutionList(e,t){const r=e.length>0?e[0].uri:"",n=rp.filter(e,t);return(0,Ut.l)(pp,r,"filterResolutionList",t,n),n}attachVideo(e,t){hp.attachVideo(e,t)}detachVideo(e){hp.detachVideo(e)}},_p={preloadTime:10,segmentMinDuration:10,preloadCacheType:1,preloadMaxCacheCount:5,minBufferLength:10};function yp(e){return e===Ut.P.NEW_TT}function gp(e,t){return!(!e||!t)&&e.findIndex(e=>e===t)>-1}function mp(e,t){return(null==e?void 0:e.addPreloaderList(t))||[]}const vp="[ITTPreloader]";function bp(e){var t;const{error:r,config:n}=e,i=e.getStats();if(r)return null;{const r=(null==(t=n.src)?void 0:t.extra)||{},{vid:o,codecType:s,vtype:a,qualityType:l=0,definition:c}=r;return{url:e.getCurrentUrl(),vid:o,definition:c,qualityType:l,vtype:a,codecType:s,mediaType:"video",timeStamp:Date.now(),order:n.priority,total:(null==i?void 0:i.byteSize)||0,duration:Math.round(1e3*((null==i?void 0:i.duration)||0))}}}const wp=e=>{const t=e.src;if(!t||"string"==typeof t||!t.extra)return e;const r=t.extra,{bitrateList:n=[],definition:i,targetCodec:o,targetVtype:s=Ut.V.MP4,vid:a}=r,l=zh(a,Ut.c.H265,Ut.V.MP4),c=zh(a,Ut.c.H264,Ut.V.MP4)||l,u=(null==c?void 0:c.definition)||"",d=fp.select(n,o,s,{},{definition:u});if(d){const t=Wh(a,d,n);e.src=t,(0,Ut.l)(vp,"onDequeue bitrateSelect",`getWaitCount:${Op(Pt)} cacheDefinition:${u} targetCodec:${o}, targetVtype:${s}`,t.cacheKey,i,null==d?void 0:d.definition)}return e};function Cp(e,t,r,n,i){const{vid:o,payload:s,getRequestOptionsCallback:a,reqOptions:l}=t.data,c=function(e,t,r){return fp.getLowestBitrate(e,t,r)}(s,r,n);if(c){const u=Wh(o,c,s,{targetCodec:r,targetVtype:n||Ut.V.MP4});if(!u)return null;const d=a||i,h={src:u,priority:e,loaderOptions:{onBeforeRequest:(e,r)=>{const n=d;let i=null;return n?(i=n({url:e}),i&&(r.credentials=i.credentials)):l&&(r.credentials=l.credentials),(0,Ut.l)(vp,"onBeforeRequest",`callback:${!!n}`,i,l,t,r,"url",e),r}},onDequeue:wp};return(0,Ut.l)(vp,"transformTTPreload",r,c,s,h),h}return null}function Ep(e){const t=e.startPreloadControl,r=e.preloadMaxCacheCount||0,n=!e.maxPreloadByteSize||e.maxPreloadByteSize<0?0:e.maxPreloadByteSize;return{maxConcurrency:(null==e?void 0:e.maxConcurrency)||1,maxPreloadedCount:e.maxPreloadedCount||r,maxPreloadDuration:e.maxPreloadDuration||e.preloadTime,maxPreloadByteSize:n,preloadTriggerPlayTime:e.preloadTriggerPlayTime||(t?e.startPreloadMinPosTime:0),preloadTriggerBufferDuration:e.preloadTriggerBufferDuration||(t?e.startPreloadMinBuffer:e.minBufferLength)}}function kp(e,t){t&&e.add(t)}function Tp(e,t){const r=e.getSource(t)||null;if(r){const e=bp(r);return(0,Ut.l)(vp,"getPreloadMeta",t,r,e),e}return null}function Sp(e,t,r){const n=[],i=r||Ut.e;return Ut.d.forEach(r=>{i.forEach(i=>{const o=Gh(t,r,i),s=Tp(e,o);s&&n.push(s)})}),n}function Op(e){return e.getWaitQueue().length}const Ap="[MultiMediaPreloader]",$p=new class{constructor(){if(this.ttPreloader=Pt,this.type=Ut.P.XG,this.codecType=Ut.c.H264,this.ttQueue=[],this.open=!1,this.playingVids=[],this.loadingVid="",this.ttPriority=0,this.getRequestOptionsCallback=null,this.onPreloaderStart=e=>{var t;(0,Ut.l)(Ap,"onPreloaderStart",null==(t=bp(e))?void 0:t.vid)},this.onPreloaderEnded=e=>{var t;(0,Ut.l)(Ap,"onPreloaderEnded",null==(t=bp(e))?void 0:t.vid,`waitCount:${Op(this.ttPreloader)}`)},this.onPreloaderError=e=>{(0,Ut.l)(Ap,"onPreloaderError",e)},this.maxQueueCount=3,typeof window>"u")return void(this.preloader=null);this.preloader=Pd.registerPreloader({..._p}),Pd.BitRateAdapter=fp,this.ttPreloader=Pt;const e=Ep({..._p});Pt.setConfig(e),window.globalLoaderCache=X,this.enable()}setType(e){this.type=e}update(e,t){var r;if((0,Ut.l)(Ap,"update",e,_p),yp(t)){const t=Ep({..._p,...e});(0,Ut.l)(Ap,"ttPreloadConfig",t),this.ttPreloader.setConfig(t)}else null==(r=this.preloader)||r.update(e);e.getRequestOptionsCallback&&(this.getRequestOptionsCallback=e.getRequestOptionsCallback)}changeCodec(e,t){(0,Ut.l)(Ap,"changeCodec",e,t);const r=this.codecType;this.codecType=e,yp(t)?function(e,t,r){e&&r===Ut.c.H265&&t===Ut.c.H264&&e.getCacheKeys().forEach(t=>{t.includes(Ut.c.H265)&&e.remove(t)})}(this.ttPreloader,e,r):function(e,t){if(e){if(e.codecType===Ut.c.H265&&t===Ut.c.H264){const{allCachedKeys:t}=e;for(const r in t)r.includes(Ut.c.H265)&&e.removeItem(r,e=>{(0,Ut.l)("[changeCodec] remove success",r,e)})}e.codecType=t}}(this.preloader,e)}attachPlayer(e,t){yp(t)?this.ttPreloader:function(e,t){null==e||e.attachPlayer(t)}(this.preloader,e)}detachPlayer(e){yp(e)?this.ttPreloader:function(e){null==e||e.detachPlayer()}(this.preloader)}addTTPreloadItem(){let e=null;const t=Op(this.ttPreloader);if((0,Ut.l)(Ap,"addTTPreloadItem",`waitCount:${t}`,this.ttQueue),!(t>0)){for(;!e&&this.ttQueue.length>0;){const t=this.ttQueue.shift(),r=(null==t?void 0:t.data.vid)||"",n=gp(this.playingVids,r),i=Sp(this.ttPreloader,r,[Ut.V.MP4]);if(!(r===this.loadingVid||n||i.length>0)&&t){e=t;break}}if(e){const t=Cp(this.ttPriority++,e,this.codecType,Ut.V.MP4,this.getRequestOptionsCallback);this.loadingVid=e.data.vid,(0,Ut.l)(Ap,"addTTPreloadItem result",e.data.vid,e,t),kp(this.ttPreloader,t)}}}addPreloadListSingle(e,t){return this.open?yp(t)?(e.forEach(e=>{const{vid:t}=e.data,r=gp(this.playingVids,t),n=Sp(this.ttPreloader,t,[Ut.V.MP4]);!r&&0===n.length&&this.ttQueue.push(e)}),(0,Ut.l)(Ap,"addPreloadListSingle",t,this.ttQueue),this.addTTPreloadItem(),e):mp(this.preloader,e):[]}addPreloadList(e,t){if(yp(t)){const t=function(e,t,r,n){let i=n.ttPriority;const{codec:o,vtype:s,getRequestOptionsCallback:a}=n,l=[];return t.forEach(t=>{var n,c;const{vid:u}=t.data,d=gp(r,u),h=Sp(e,u,[s]);if(!d&&0===h.length){const r=Cp(i++,t,o,s,a),u=null==(n=null==r?void 0:r.src)?void 0:n.cacheKey,d=null==(c=null==r?void 0:r.src)?void 0:c.extra,h=function(e,t){return e.getWaitQueue().findIndex(e=>{var r;return(null==e?void 0:e.src)===t||(null==(r=null==e?void 0:e.src)?void 0:r.cacheKey)===t})>-1}(e,u);(0,Ut.l)(vp,"addPreload",u,null==d?void 0:d.definition,`exitInQueue:${h}`,r),h||(kp(e,r),l.push(t))}}),l}(this.ttPreloader,e,this.playingVids,{codec:this.codecType,vtype:Ut.V.MP4,getRequestOptionsCallback:this.getRequestOptionsCallback,ttPriority:this.ttPriority});return t.length>0&&(this.ttPriority+=t.length),(0,Ut.l)(Ap,"addPreloadList TTPreloader1",`ttPriority:${this.ttPriority}`,`orgLength:${e.length} addLength:${t.length}`),t}return mp(this.preloader,e)}clearTask(e){yp(e)?function(e){null==e||e.clearWaitQueue()}(this.ttPreloader):function(e){null==e||e.clearTask()}(this.preloader),this.ttQueue=[]}clearAll(e){if(this.clearTask(e),yp(e))this.ttPreloader.clearAll();else if(this.preloader){this.preloader.clearTask(),this.preloader.playingVids1=[];const{cacheInst:e}=this.preloader;e&&(e.clear(),e._allCachedKeys={},e._allCachedTimeKeys={})}}getPreloadMeta(e,t){let r=null;return r=yp(t)?Tp(this.ttPreloader,e):function(e,t){return(null==e?void 0:e.getPreloadMetaByVid(t))||null}(this.preloader,e),(0,Ut.l)(Ap,"getPreloadMeta",e,t,r),r}addPlayingVid(e,t){(0,Ut.l)(Ap,"addPlayingVids",e,t),yp(t)?this.playingVids.push(e):function(e,t){null==e||e.addPlayingVid(t)}(this.preloader,e)}getPlayingVid(e){return yp(e)?this.playingVids:function(e){return e?e.playingVids1:[]}(this.preloader)}removePlayingVid(e,t){if(yp(t)){const{playingVids:t}=this,r=t.findIndex(t=>t===e);r>-1&&t.splice(r,1)}else!function(e,t){null==e||e.removePlayingVid(t)}(this.preloader,e);(0,Ut.l)(Ap,"removePlayingVids",e,t,this.getPlayingVid(t))}on(e,t,r){var n,i;yp(r)?null==(n=this.ttPreloader)||n.on(e,t):null==(i=this.preloader)||i.on(e,t)}off(e,t,r){var n,i;yp(r)?null==(n=this.ttPreloader)||n.off(e,t):null==(i=this.preloader)||i.off(e,t)}bindTTEvents(){this.ttPreloader.on("preloadend",this.onPreloaderEnded),this.ttPreloader.on("preloadstart",this.onPreloaderStart),this.ttPreloader.on("error",this.onPreloaderError)}unbindTTEvents(){this.ttPreloader.off("preloadend",this.onPreloaderEnded),this.ttPreloader.off("preloadstart",this.onPreloaderStart),this.ttPreloader.off("error",this.onPreloaderError)}disable(){this.open&&(this.open=!1,this.unbindTTEvents())}enable(){this.open||(this.open=!0,this.bindTTEvents())}getCore(e){return yp(e)?this.ttPreloader:this.preloader}getCacheDataByCacheKey(e){return Kh(e)}formatCacheData(e){return qh(e)}},Pp="multiplex";function Rp(e,t){return e!==Ut.c.H265||t&&t!==Ut.c.H265?Ut.c.H264:Ut.c.H265}function xp(){const{regionInfo:e}=Sh.M,{shortData:t,deviceScore:r,gpuScoreData:n}=Sh.M.getInstance().deviceMark;return{playMode:Sh.M.playMode,tag:Sh.M.pageName,subtag:Sh.M.playMode,preTag:Sh.M.prePageName,preSubtag:Sh.M.prePlayMode,region:(null==e?void 0:e.region)||"",isLogin:!(null!=e&&e.isLogin),deviceScore:t,d_score:r||0,gpu:n.gpu||"",vendor:n.vendor||""}}function Lp(){return Sh.M.getAbVersions()}function Ip(e,t=!0){return!e||e.length<1?-1:t?e.end(e.length-1):e.start(e.length-1)}function Mp(e){return e?e.hasStart?1:0:-1}function Dp(e){return e?e.isPlaying?1:0:-1}function Bp(e){if(!e)return null;const t=Ip(e.buffered);return{buff:t<0?t:(0,Ut.f)(t),state:e.state,hasStart:Mp(e),playing:Dp(e)}}function Np(e,t){return null==e?void 0:e.getPlugin(t)}function jp(e){return e.state===Ut.R.ACTIVE}function Up(e){return e.state===Ut.R.RELEASE||e.state===Ut.R.DESTROY}function Vp(e,t){let r=null;return e.forEach(e=>{e.type===t&&(r=e)}),r}function Fp(e,t){const{H264DefinitionList:r,h264DefinitionList:n}=e.config,i=n||r;if(i&&i.length>0){const r=i[0];return e.emit("playCatch","MP4_3",{errorCode:(null==t?void 0:t.code)||8200,message:(null==t?void 0:t.message)||"width and height is 0"}),e.setConfig({defaultBitrate:r.bitrate,defaultDefinition:r.definition,url:r.url,codecType:r.codecType}),e.src=r.url,e.play(),!0}return!1}function Hp(e,t){const{minBuffer:r}=t;if(!e||!r)return!0;if(e&&e.length>0){const t=e.end(e.length-1);if((0,Ut.f)(t)>=r)return!0}return!1}function Gp(e){return e&&e.player?e.player.hasStart?1:0:-1}function Wp(e){return e&&e.player?e.player.isPlaying?1:0:-1}function qp(e){if(!e)return null;const t=Ip(e.buffered);return{buff:t<0?t:(0,Ut.f)(t),state:e.state,hasStart:Gp(e),playing:Wp(e)}}function Kp(e){return(null==e?void 0:e.vodLogger)||null}function zp(e){return(null==e?void 0:e.getPlugin("mp4encryptplayer"))||null}function Zp(e){const{enableHevcSoftwareDecode:t}=e;return!!t&&(0,Ut.k)()}function Yp(e,t,r,n){n&&fp.updateConfig(n);const i=$p.getPreloadMeta(t),o=Rp(r,null==i?void 0:i.codecType),s=(null==i?void 0:i.definition)||"";let a=[];if(e.length>0){a=fp.filterResolutionList(e,{codecType:o,vtype:Ut.V.MP4});const t=fp.select(e,o,Ut.V.MP4,{},{definition:s});(0,Ut.l)(`userSelectResolution:${fp.config.userSelectResolution}`,"adapterConfig",n,e,t);let r=null;return"h265"===(null==t?void 0:t.codecType)&&(r=fp.select(e,Ut.c.H264,Ut.V.MP4)),t?{curBitrate:t,preloadCodec:(null==i?void 0:i.codecType)||null,preloadDefinition:(null==i?void 0:i.definition)||null,h264Bitrate:r,bitrateList:a}:null}return null}const Xp="[XGplayer]";class Qp extends Zh{constructor(e,t){super(Ut.P.XG),this.useSoftHevc=!1,this._onAutoplayPrevent=()=>{var e;(0,Ut.l)(Xp,this.uuid,"_onAutoplayPrevent",this.uuid,`forceAutoplay:${this.forceAutoplay}`,this.attemptPlayCount),!(this.attemptPlayCount>=3)&&this.forceAutoplay&&(this.mute(!0),null==(e=this.player)||e.play(),this.attemptPlayCount+=1)},this._onAutoplayStart=()=>{var e;(0,Ut.l)(Xp,this.uuid,"onAutoplayStart",this.uuid),null==(e=this.player)||e.off(Uh,this._onAutoplayPrevent)},this._onCanplay=()=>{if(this.state!==Ut.R.ACTIVE&&this.player){const e=this.player;e.currentTime>.1&&(e.currentTime=0),null==e||e.pause()}},this._onLoadedData=()=>{const e=this.player;if(!e||!e.media)return;const{videoWidth:t,videoHeight:r}=e.media;(0,Ut.l)(Xp,"_onLoadedData",`useSoftHevc:${this.useSoftHevc}`,e.config.codecType,t,r),0===t&&0===r&&this.useSoftHevc&&"h265"==e.config.codecType&&(Sh.a.focusDisableHevc({hevcMsg:"width and height is 0",hevcCode:2}),Fp(e),this.updatePreloadCodec(Ut.c.H264)),this.useSoftHevc&&this.initStyle()},this._onTimeupdate=()=>{var e;this.state!==Ut.R.ACTIVE&&(null==(e=this.player)||e.pause())},this._onEmptied=()=>{this.initStyle()},this._onDegrade=e=>{if(!this.player)return;const{errorCode:t,errorMessage:r,mediaType:n,isSoftWareDecodeError:i}=e;n===Ut.M.TT_VIDEO&&this.player.on(Nh,this._onEmptied),(0,Ut.l)(Xp,"_onDegrade",`isSoftWareDecodeError:${i}`,n,e),i&&(Sh.a.forceDisableSoftHevc({code:t,message:r}),$p.changeCodec(Ut.c.H264)),this.useSoftHevc=!1,this.initStyle()},this.plugins=[],this.metrics=null,this.event=null,this.config={};const r=t||Ut.R.ACTIVE;this.state=r,this.timerId=void 0,this._init(e),this.changeState(r)}getVideoMiddleware(){return{error:(e,t)=>{const{player:r}=e;if(r)try{const n=Fp(r,null==e?void 0:e.error);r.setEventsMiddleware({error:null}),n||t("error",e)}catch{t("error",e)}else t("error",e)}}}_getInitBitrate(e,t,r,n){n&&fp.updateConfig(n);const i=this.getPreloadMeta(t),o=Rp(r,null==i?void 0:i.codecType),s=(null==i?void 0:i.definition)||"";let a=[];if(e.length>0){a=fp.filterResolutionList(e,{codecType:o,vtype:Ut.V.MP4});const t=fp.select(e,o,Ut.V.MP4,{},{definition:s});(0,Ut.l)(Xp,this.uuid,`userSelectResolution:${fp.config.userSelectResolution}`,"adapterConfig",n,e,t);let r=null;return"h265"===(null==t?void 0:t.codecType)&&(r=fp.select(e,Ut.c.H264,Ut.V.MP4)),t?{curBitrate:t,preloadCodec:(null==i?void 0:i.codecType)||null,preloadDefinition:(null==i?void 0:i.definition)||null,h264Bitrate:r,bitrateList:a}:null}return null}get element(){var e;return(null==(e=this.player)?void 0:e.media)||null}_init(e){var t,r,i,o,s;const a={};e||(e={}),e.enableSubtitle&&this._initSubtitle(),e.enablePreloader&&e.preloader?this._initPreloader(e.preloader):$p.disable(),e.enableLogger&&e.logger&&this._initLoggerBefore(e.logger);const{video:l,logger:c,extra:u,enableHevcSoftwareDecode:d,softHevcDisableResolution:h}=e,p=void 0===(null==l?void 0:l.autoplay)||l.autoplay,f=void 0!==(null==l?void 0:l.muted)&&l.muted;f&&(a.muted=f),this.vqscore=(null==l?void 0:l.vqscore)||0;const _=(null==c?void 0:c.line_app_id)||0,y=(null==c?void 0:c.vid)||"",{actualUrl:g,url:m}=u||{actualUrl:void 0,url:""},v=(null==u?void 0:u.vid)||"";this.vid=v;const{bitrateList:b=[]}=e,w=(null==l?void 0:l.codecType)||"h264",C=Zp(e),{dScore:E}=Sh.M.getDeviceScore(),k=function(e,t){for(let r=0;r<e.length;r++){const{range:n,disableList:i=[]}=e[r];if(n&&!(n.length<2)&&t>n[0]&&(t<=n[1]||n[1]<0))return i||[]}return[Yh.R_1080]}(h||[],E);fp.disableList=C?k||[Yh.R_1080]:[];const{bitrateAdapter:T}=e;this.bitrateList=b||[];const S=Yp(b,v,w,T),O=(null==S?void 0:S.curBitrate)||null,A=(null==O?void 0:O.codecType)||w,$=(null==O?void 0:O.url)||g||m||"",P=null!=S&&S.h264Bitrate?[null==S?void 0:S.h264Bitrate]:(null==u?void 0:u.h264BitrateList)||[],R=(null==O?void 0:O.bitrate)||(null==l?void 0:l.defaultBitrate)||0,x=(null==O?void 0:O.definition)||(null==l?void 0:l.defaultDefinition)||"";this.mvmaf=(null==O?void 0:O.mvmaf)||(null==l?void 0:l.mvmaf)||"";const L="h265"===A&&C;this.useSoftHevc=L;const I=L?Ut.M.TT_VIDEO:Ut.M.VIDEO;if(this.mediaType=I,(0,Ut.l)(Xp,this.uuid,"_init",`[${v}]`,"_getInitBitrate",`initCodec:${w} codecType:${null==O?void 0:O.codecType} preloadCodec:${null==S?void 0:S.preloadCodec} preloadDefinition:${null==S?void 0:S.preloadDefinition} defaultDefinition:${null==l?void 0:l.defaultDefinition} defaultBitrate:${null==l?void 0:l.defaultBitrate} userResolution:${null==T?void 0:T.userSelectResolution} definition:${null==O?void 0:O.definition} bitrate:${null==O?void 0:O.bitrate} mediaType:${I}`,null==S?void 0:S.h264Bitrate,null==S?void 0:S.bitrateList,b),this.plugins.push(Th),this.config={vid:v,isNoRoot:!0,controls:!1,plugins:this.plugins,autoplay:p,codecType:A,width:"100%",height:"100%",videoConfig:a||{},volume:(null==l?void 0:l.volume)||1,playbackRate:(null==l?void 0:l.playbackRate)||1,H264DefinitionList:P,url:$,nullUrlStart:!$,ignores:(null==u?void 0:u.ignores)||[],defaultDefinition:x,defaultBitrate:R,duration:(null==l?void 0:l.duration)||0,videoInit:void 0===(null==u?void 0:u.videoInit)||u.videoInit,autoplayMuted:f,mediaType:I,startTime:(null==u?void 0:u.startTime)||0},this.curBitrate=O,(0,Ut.l)(Xp,"config",this.uuid,this.state,`videoInit:${this.config.videoInit}`,`addMSEPlugin:true needCheck:${null==(t=e.mp4EncryptPlayer)?void 0:t.needCheck}`,e),e.enableLogger){const{logger:t}=e,{ext:o={}}=t||{},s=Sh.a.getHevcDisableInfo()||{},a={...xp(),codec_type:L?`soft_${A}`:A,decodeFlag:"h265"===A,defaultBitrate:R,defaultDefinition:x,line_app_id:_,vid:y,vtype:"MP4",...t,fIndex:this.uuIndex,playerCoreVersion:Th.version,pv:hi.version,strategyVersion:jt.v,ext:{...o,...s,preload_codec:null==S?void 0:S.preloadCodec,preload_def:null==S?void 0:S.preloadDefinition},bitrateAdapter:{userResolution:(null==T?void 0:T.userSelectResolution)||"auto",qualityType:(null==O?void 0:O.qualityType)||0,selector:(null==T?void 0:T.selector)||"default"},closeEvents:(null==t?void 0:t.closeEvents)||[],playerType:"XG",videoInfo:{volumeInfo:{loudness:(null==(r=null==l?void 0:l.volumeInfo)?void 0:r.Loudness)||0,peak:(null==(i=null==l?void 0:l.volumeInfo)?void 0:i.Peak)||0}}};if(this.config.vodLogOpts=a,this.player){const e=Kp(this.player);null==e||e.update(a,n.Tx.RELOAD)}}e.mp4EncryptPlayer&&(this.config.mp4EncryptPlayer=e.mp4EncryptPlayer,L&&(this.config.mp4EncryptPlayer.needCheck=!1,this.config.mp4EncryptPlayer.supportHevc=!1,this.player&&function(e,t){const r=zp(e);null==r||r.setConfig(t)}(this.player,this.config.mp4EncryptPlayer),$p.update({supportHevc:!1}))),(0,Ut.l)(Xp,"PlayerInit",this.uuid,this.state,`enableHevcSoftwareDecode:${d}, useSoftHevc:${L} initCodec:${w} codecType:${A} videoInit:${this.config.videoInit}`,`addMSEPlugin:true closeMSE:${null==(o=e.extra)?void 0:o.closeMSE} needCheck:${null==(s=e.mp4EncryptPlayer)?void 0:s.needCheck}`,this.config),this.player?((0,Ut.l)(Xp,"PlayerInit reuse",this.uuid,this.state,this.config),this.player.playNext(this.config),this.player.volume=(null==l?void 0:l.volume)||1,this.player.muted=f,this.player.playbackRate=(null==l?void 0:l.playbackRate)||1):((0,Ut.l)(Xp,"PlayerInit new",this.uuid,this.state,this.config),this.player=new hi(this.config),this.player.uuid=this.uuid),this.bindPlayerEvents(this.player),fp.attachVideo(this.player.media,{bitrate:this.config.defaultBitrate,vid:this.config.vid}),$p.addPlayingVid(v),this.player.preloader=$p.preloader,this.initStyle(),this.initProperty(),this.resolutionInfo={currentResolution:(null==O?void 0:O.resolution)||"",codecType:A,vtype:"MP4",resolutionList:(null==S?void 0:S.bitrateList)||[],bitrateList:b},this._emitResolutionReady()}_emitResolutionReady(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0),this.timerId=setTimeout(()=>{this.player.emit("resolutionReady",this.resolutionInfo),this.timerId=void 0},0)}_initSubtitle(){this.plugins.push(uo)}_initPreloader(e){n.DS.attachPreloader($p.preloader),$p.update(e)}_initLoggerBefore(e){n.DS.AB_SDK_VERSION=Lp(),n.K.init(ar.Collector,e.channelConfig,{region:e.region,user_unique_id:e.webId,user_is_login:e.isLogin,user_id:e.uid||e.webId}),this.plugins.push(n.Ay)}supportMSE(){return!!zp(this.player)}set objectFit(e){this.player&&this.player.media&&(this.player.config.mediaType===Ut.M.TT_VIDEO?this.player.media.objectFit=e:this.player.media.style.objectFit=e)}set volume(e){this.player&&(this.player.volume=e||1)}set muted(e){this.player&&(this.player.muted=e)}set playbackRate(e){this.player&&(this.player.playbackRate=e)}get currentTime(){var e;return null==(e=this.player)?void 0:e.currentTime}get duration(){var e;return(null==(e=this.player)?void 0:e.duration)||0}get attributes(){const{element:e,player:t}=this,r=(null==t?void 0:t.rawSrc)||(null==e?void 0:e.currentSrc)||(null==e?void 0:e.src)||"";return{error:(null==e?void 0:e.error)||null,src:r,currentTime:(null==e?void 0:e.currentTime)||0,muted:!(null==e||!e.muted),duration:(null==e?void 0:e.duration)||0,readyState:(null==e?void 0:e.readyState)||0,networkState:(null==e?void 0:e.networkState)||0,buffered:null==e?void 0:e.buffered,volume:(null==e?void 0:e.volume)||1,ended:!(null==e||!e.ended),paused:!(null==e||!e.paused),seeking:!(null==e||!e.seeking),currentSrc:r}}get isReady(){var e;return(null==(e=this.player)?void 0:e.isCanplay)||!1}get volume(){var e;return(null==(e=this.player)?void 0:e.volume)||1}get muted(){var e;return(null==(e=this.player)?void 0:e.muted)||!1}get playbackRate(){var e;return(null==(e=this.player)?void 0:e.playbackRate)||1}get curDefinition(){var e;const t=(null==(e=this.player)?void 0:e.curDefinition)||null,{config:r}=this;return{url:(null==t?void 0:t.url)||"",bitrate:(null==t?void 0:t.bitrate)||r.defaultBitrate||-1,definition:(null==t?void 0:t.definition)||r.defaultDefinition,codecType:(null==t?void 0:t.codecType)||r.codecType||-1,duration:this.duration||0}}changeResolution(e){var t,r,n;const i=this.bitrateList,o=(null==(t=this.curBitrate)?void 0:t.codecType)||"h264",{resolution:s}=e;if(!this.player||s===(null==(r=this.curBitrate)?void 0:r.resolution))return;const a=fp.select(i,o,Ut.V.MP4,{},{resolution:e.resolution});if(fp.updateConfig({userSelectResolution:e.resolution}),a){this.curBitrate=a;const e=this.player,t=this.state===Ut.R.ACTIVE;if(e.currentSrc.indexOf("blob:")<0||this.useSoftHevc){const r=e.currentTime;e.src=a.url,e.currentTime=r,e.config.url=a.url,t?e.play():e.pause()}else e.changeDefinition(a),t||e.pause();null!=(n=this.resolutionInfo)&&n.currentResolution&&(this.resolutionInfo.currentResolution=a.resolution||""),e.emit("resolutionReady",{...this.resolutionInfo})}}on(e,t,...r){var n;null==(n=this.player)||n.on(e,t,...r)}off(e,t){var r;null==(r=this.player)||r.off(e,t)}once(e,t){var r;null==(r=this.player)||r.once(e,t)}load(e){var t;null==(t=this.player)||t.playNext({url:e})}seek(e){this.player&&(this.player.currentTime=e)}play(){return(0,Ut.l)(Xp,this.uuid,"play"),new Promise(e=>{(!this.player||Up(this))&&e();const t=this.player.play();t||e(),t.then(()=>{e()}).catch(()=>{})})}pause(){return(0,Ut.l)(Xp,this.uuid,"pause"),this.player.config.autoplay=!1,this.player.pause()}startSoftHevcDegrade(e,t){var r,n;const i=null==(r=this.player)?void 0:r.paused;if((0,Ut.l)(Xp,"startSoftHevcDegrade",this.uuid,`useSoftHevc:${this.useSoftHevc} paused:${i}`,e),!this.useSoftHevc)return;const o=null==(n=this.player)?void 0:n.plugins.mp4encryptplayer;o&&o.startDegradedPlayback(e,i,t)}unBindPlayerEvents(e){e.off(Uh,this._onAutoplayPrevent),e.off(jh,this._onAutoplayStart),e.off(Ih,this._onLoadedData),e.off(Ph,this._onTimeupdate),e.off(Rh,this._onCanplay),e.off(yh,this._onDegrade),e.off(Nh,this._onEmptied)}bindPlayerEvents(e){e.on(Uh,this._onAutoplayPrevent),e.on(jh,this._onAutoplayStart),e.on(Ih,this._onLoadedData),e.on(Ph,this._onTimeupdate),e.on(Rh,this._onCanplay),e.on(yh,this._onDegrade)}reset(){var e;this.forceAutoplay=!1,this.attemptPlayCount=0,this.bitrateList=[],this.curBitrate=null,this.resolutionInfo=null,null==(e=this.player)||e.pause(),this.vid&&$p.removePlayingVid(this.vid),window.clearTimeout(this.timerId),this.timerId=void 0,function(e){var t,r,n,i,o;e&&(e.reset(),null==(t=e._detachSourceEvents)||t.call(e,e.media),null==(n=null==(r=e.media)?void 0:r.removeAttribute)||n.call(r,"src"),null==(o=null==(i=e.media)?void 0:i.load)||o.call(i))}(this.player),this.vid=null}release(){const e=this.player;if((0,Ut.l)(Xp,this.uuid,"release",this.state,`isPlaying: ${null==e?void 0:e.isPlaying}`),super.release(),this.changeState(Ut.R.RELEASE),(0,Ut.a)(this.element,"object-fit"),e){fp.detachVideo(e.media),this.unBindPlayerEvents(e);const t=Kp(e);null==t||t.reset(!1),this.unMountDom()}window.clearTimeout(this.timerId),this.timerId=void 0}destroy(){const e=this.player;(0,Ut.l)(Xp,this.uuid,"destroy",this.state,`isPlaying: ${null==e?void 0:e.isPlaying}`);const{vid:t}=this.config;$p.removePlayingVid(t),super.release(),this.changeState(Ut.R.DESTROY),e&&(fp.detachVideo(e.media),this.unBindPlayerEvents(e),e.destroy(),this.unMountDom(),this.player=null),window.clearTimeout(this.timerId),this.timerId=void 0}replay(){return this.player.replay()}addSubtitle(e,t){const r=this.player;!this.player||!r.plugins||!r.plugins.texttrack||r.plugins.texttrack.updateSubtitles(e,e=>{t(e.text)})}getVideoDesc(){return this.player?{videoType:this.player.vtype}:super.getVideoDesc()}preloadResources(e){$p&&($p.clearTask(),$p.addPreloadList(e))}updatePreloadConfig(e){$p.update(e)}updatePreloadCodec(e){$p.changeCodec(e)}updateConfig(e){this.player.setConfig({mp4encryptplayerConfig:{reqOptions:e}})}changeState(e){if(this.state=e,!this.player)return;const t=this.player,{mp4encryptplayer:r}=t.plugins;e===Ut.R.ACTIVE?($p.attachPlayer(t),r&&(r.isActive=!0)):r&&(r.isActive=!1),(0,Ut.l)(Xp,"changeState",this.uuid,e===Ut.R.ACTIVE,e,t.isUserActive),t.emit("renderStateChange",{state:e})}getPreloadMeta(e){return $p.getPreloadMeta(e)}async enterFullscreen(e){await this.player.getFullscreen(e)}async exitFullscreen(e){await this.player.exitFullscreen(e)}changeVideo(e,t,r=!0){var i,o,s,a;const l=null==(i=null==e?void 0:e.extra)?void 0:i.vid,c=t||Ut.R.ACTIVE,{autoplay:u=!1,muted:d=!1,volume:h=1,playbackRate:p=1}=e.video||{},f=l===this.vid&&!r,{startTime:_=0}=e.extra||{};if((0,Ut.l)(Xp,"changeVideo",this.uuid,`renderState:${t} needReset:${r} vid: ${null==(o=null==e?void 0:e.extra)?void 0:o.vid} sameVid:${this.vid===(null==(s=null==e?void 0:e.extra)?void 0:s.vid)}`,`isContinue:${f} startTime:${_} currentTime:${null==(a=this.player)?void 0:a.currentTime} mediaType: ${this.mediaType}`),this.player&&f){this.changeState(c),this.player.playbackRate=p,this.player.volume=h,this.player.muted=d,this.player.seek(_,u&&this.isActive?"play":"pause"),this.bindPlayerEvents(this.player),fp.attachVideo(this.player.media,{bitrate:this.config.defaultBitrate,vid:this.config.vid}),$p.addPlayingVid(l);const e=Kp(this.player);e&&(e.reuseType=n.Tx.CONTINUE),this._emitResolutionReady()}else this.reset(),this.changeState(c),this._init(e||this.config)}isSoftHevc(){return!1}}class Jp{constructor(e,t){this.h264Bitrate=null,this.metrics=null,this.event=null,this.forceAutoplay=!1,this.attemptPlayCount=0,this.isPlaying=!1,this.hasStart=!1,this.vid=null,this.mediaType=null;const{playerType:r=Ut.P.NEW_TT}=e;this.uuIndex=Fh(),this.uuid=Hh(r,this.uuIndex),this.playerType=r,this.el=null,this.player=null,this.state=t||Ut.R.ACTIVE,this.bitrateList=[],this.curBitrate=null,this.resolutionInfo=null,this.config=e}get type(){return this.playerType}style(e,t){this.element&&(this.element.style[e]=t)}createInnerContainer(){this.el||(this.el=document.createElement("div"))}initStyle(){this.element&&(this.element.style.width="100%",this.element.style.height="100%",this.element.style.position="absolute",this.element.style.top="0",this.element.style.left="0",this.element.style["::-webkit-media-controls-enclosure"]={display:"none !important"})}get element(){return null}set volume(e){this.player&&(this.player.volume=e)}get volume(){var e;return(null==(e=this.player)?void 0:e.volume)||0}get playbackRate(){var e;return(null==(e=this.player)?void 0:e.playbackRate)||1}set playbackRate(e){this.player&&(this.player.playbackRate=e)}set muted(e){this.player&&(this.player.muted=e)}get muted(){var e;return(null==(e=this.player)?void 0:e.muted)||!1}get currentTime(){var e;return(null==(e=this.player)?void 0:e.currentTime)||0}set currentTime(e){this.player&&(this.player.currentTime=e)}get duration(){var e;return(null==(e=this.player)?void 0:e.duration)||0}get buffered(){var e;return null==(e=this.player)?void 0:e.buffered}get paused(){var e;return(null==(e=this.player)?void 0:e.paused)||!0}get ended(){var e;return(null==(e=this.player)?void 0:e.ended)||!1}get readyState(){var e;return(null==(e=this.player)?void 0:e.readyState)||0}get networkState(){var e;return(null==(e=this.player)?void 0:e.networkState)||0}get attributes(){const{element:e}=this;return{error:(null==e?void 0:e.error)||null,src:(null==e?void 0:e.currentSrc)||"",currentTime:(null==e?void 0:e.currentTime)||0,muted:!(null==e||!e.muted),duration:(null==e?void 0:e.duration)||0,readyState:(null==e?void 0:e.readyState)||0,networkState:(null==e?void 0:e.networkState)||0,buffered:null==e?void 0:e.buffered,volume:(null==e?void 0:e.volume)||1,ended:!(null==e||!e.ended),paused:!(null==e||!e.paused),seeking:!(null==e||!e.seeking),currentSrc:(null==e?void 0:e.currentSrc)||""}}set objectFit(e){e?this.player&&(this.player.objectFit=e):(0,Ut.a)(this.element,"object-fit")}changeState(e){this.state=e}startPlay(){var e;null==(e=this.player)||e.play()}play(){return this.player?this.player.play():Promise.resolve()}replay(){return this.seek(0),this.play()}pause(){var e;return null==(e=this.player)?void 0:e.pause()}load(e){}seek(e){this.player&&(this.player.currentTime=e)}tryPlay(){this.paused&&this.play()}addSubtitle(e,t){}get playbackQuality(){var e,t;return this.element&&"VIDEO"===this.element.tagName&&(null==(t=(e=this.element).getVideoPlaybackQuality)?void 0:t.call(e))||null}getVideoPlaybackQuality(){return this.playbackQuality}mountDom(e){const{el:t}=this;if(t&&e&&t.parentNode!==e)try{e.appendChild(t)}catch(e){console.error(e)}}unMountDom(){var e;const{el:t}=this;if(t)try{null==(e=null==t?void 0:t.parentElement)||e.removeChild(t)}catch(e){console.error(e)}}updatePreloadCodec(e){}get curDefinition(){var e,t,r,n,i;return{url:null==(e=this.curBitrate)?void 0:e.url,definition:null==(t=this.curBitrate)?void 0:t.definition,bitrate:null==(r=this.curBitrate)?void 0:r.bitrate,duration:null==(n=this.curBitrate)?void 0:n.duration,codecType:null==(i=this.curBitrate)?void 0:i.codecType}}getPreloadMeta(e,t){return null}async exitFullscreen(e){return async function(){if(!document.fullscreenElement)return Promise.resolve();for(let e=0;e<Ut.E.length;e++){const t=Ut.E[e];if("function"==typeof document[t])return await document[t]()}}()}async enterFullscreen(e){return async function(e){if(!e)return Promise.reject(new Error("requestFullscreen dom is undefined"));for(let t=0;t<Ut.G.length;t++){const r=Ut.G[t];if("function"==typeof e[r])return await e[r]()}}(e)}isSoftHevc(){return!1}on(e,t,...r){var n;null==(n=this.player)||n.on(e,t,...r)}off(e,t){var r;null==(r=this.player)||r.off(e,t)}once(e,t,...r){var n;null==(n=this.player)||n.once(e,t,...r)}emit(e,...t){var r;null==(r=this.player)||r.emit(e,...t)}}const ef="[TTPlayer]";class tf extends Jp{constructor(e,t){super(e),this.playerConfig={},this.player=null,this.vodCollector=null,this.downloadedSize=0,this.downloadedTime=0,this.loadStartTime=0,this.vid=null,this.preloadMeta=null,this._startTime=-1,this.cacheHitType=Ut.C.UNKNOWN,this.preloadTime=0,this._onDownloaded=e=>{var t;const{duration:r,byteLength:n}=e;this.downloadedSize+=n,this.downloadedTime+=1e3*r,this.emit("prf_data_size",{mediaType:"video",cdn_size:n,pcdn_size:0,bitrate:(null==(t=this.curBitrate)?void 0:t.bitrate)||0})},this._onLoadedMetaData=()=>{var e;if(!this.player)return;const t=null==(e=Np(this.player,Pp))?void 0:e.getMetadata();if(t){const e=function(e){const t=Vp(e.tracks,"audio"),r=Vp(e.tracks,"video");return{duration:e.duration/1e3,formatType:e.formatType,timescale:e.timescale,audioCodec:(null==t?void 0:t.codec)||"",videoCodec:(null==r?void 0:r.codec)||"",videoDuration:((null==r?void 0:r.duration)||0)/1e3,audioDuration:((null==t?void 0:t.duration)||0)/1e3,sampleRate:(null==t?void 0:t.sampleRate)||0}}(t);this.emit("metaReady",e)}this._startTime>0&&this.isActive&&(this.currentTime=this._startTime,this._startTime=-1)},this._onDowngrade=e=>{var t,r;this.log("_onDowngrade",e.name,e.message,null==(t=this.player)?void 0:t.rawSrc);const{message:n=""}=e;return"h265"===(null==(r=this.resolutionInfo)?void 0:r.codecType)&&n.includes("unsupported")?(this.retryUseH264Source(),this.emit("downgrade",e),!1):(this.emit("downgrade",e),!0)},this._onCachehit=e=>{this.cacheHitType===Ut.C.UNKNOWN&&(this.cacheHitType=Ut.C.DATA);const t=qh(e);t&&(t.hitType=this.cacheHitType||Ut.C.DATA,t.duration=this.preloadTime),this.preloadMeta=t,this.emit("hitcache",t),this.log("_onCachehit",this.uuid,this.vid,(0,Ut.n)(),this.cacheHitType,`cacheSize:${null==t?void 0:t.cacheSize} preloadSize:${null==t?void 0:t.preloadSize} duration:${null==t?void 0:t.duration}`)},this._onPreloadHit=e=>{var t;const{duration:r=0,byteSize:n=0}=(null==(t=null==e?void 0:e.getStats)?void 0:t.call(e))||{};this.cacheHitType=Ut.C.MULTIPLEX,this.preloadTime=(0,Ut.f)(r),this.log("_onPreloadHit",this.uuid,this.vid,(0,Ut.n)(),this.cacheHitType,`preloadSize:${n} duration:${this.preloadTime}`,e)},this._onLoadedData=()=>{if(this.log("_onLoadedData"),!this.player)return;const{videoWidth:e,videoHeight:t}=this.player;0===e&&0===t&&(Sh.a.focusDisableHevc({hevcMsg:"width and height is 0",hevcCode:2}),this.updatePreloadCodec("h264"),this.retryUseH264Source())},this._onLoadStart=()=>{this.log("_onLoadStart",this.uuid,(0,Ut.n)(),this.vid),0===this.loadStartTime&&(this.loadStartTime=(0,Ut.n)())},this._onError=e=>{var t,r;const n=(0,Ut.n)()-this.loadStartTime;(0,Ut.l)("_onError",`costTime: ${n}`,`rawSrc:${!(null==(t=this.player)||!t.rawSrc)} currentSrc:${null==(r=this.player)?void 0:r.currentSrc}`,e)},this._onException=e=>{var t,r;const n=(0,Ut.n)()-this.loadStartTime;(0,Ut.l)("_onException",`costTime: ${n}`,`rawSrc:${!(null==(t=this.player)||!t.rawSrc)} currentSrc:${!(null==(r=this.player)||!r.currentSrc)}`,e)},this._onCanplay=()=>{if(this.state!==Ut.R.ACTIVE&&this.player){const e=this.player;null==e||e.pause()}},this._onceCanplay=()=>{var e,t;this.log("_onceCanplay",`forceAutoplay:${this.forceAutoplay} isActive:${this.isActive} paused:${null==(e=this.player)?void 0:e.paused}`),this.player&&this.forceAutoplay&&this.isActive&&this.player.paused&&this.startPlay(),null==(t=this.player)||t.off(Rh,this._onceCanplay)},this._onTimeupdate=()=>{var e;this.state!==Ut.R.ACTIVE&&(null==(e=this.player)||e.pause())},this._emitAutoplayPrevent=()=>{(0,Ut.l)(ef,this.uuid,"_emitAutoplayPrevent"),this.emit(Ut.A)},this._emitAutoplayStart=()=>{(0,Ut.l)(ef,this.uuid,"_emitAutoplayStart"),this.emit(Ut.m)},this.playerType=Ut.P.NEW_TT;const r=t||Ut.R.ACTIVE;this._init(e),this.changeState(r)}get element(){var e;return(null==(e=this.player)?void 0:e.getElement())||null}get isActive(){return this.state===Ut.R.ACTIVE}log(e,...t){(0,Ut.l)(ef,this.uuid,e,...t)}changeState(e){var t,r;if(this.state=e,!this.player)return;const n=this._startTime;e===Ut.R.ACTIVE?(this.log("setPreloader",this.uuid,this.state,this.playerType),null==(t=Np(this.player,Pp))||t.setPreloader($p.getCore(this.playerType)),this._startTime>-1&&(this.player.currentTime=this._startTime,this._startTime=-1)):null==(r=Np(this.player,Pp))||r.setPreloader(null),(0,Ut.l)(ef,"changeState",this.uuid,e===Ut.R.ACTIVE,e,`startTime:${n}`),this.emit("renderStateChange",{state:e})}getPlugin(e){var t,r;return null==(r=null==(t=this.player)?void 0:t.getPlugin(e))?void 0:r.core}getMultiplexPluginConfig(e,t){const{getRequestOptionsCallback:r,reqOptions:n}=e,{multiplexConfig:i,videoPlayMode:o,mp4ParserConfig:s}=t;return{parsers:[new At(s)],minBackwardBufferDuration:5,maxBackwardBufferDuration:60,minForwardBufferDuration:15,maxForwardBufferDuration:30,eosFallback:!1,fallback:"MSE"!==o,...i,loaderOptions:{onBeforeRequest:(e,t)=>{if(r){const n=r({url:e});n&&(t.credentials=n.credentials)}else n&&(t.credentials=n.credentials);return t},timeout:3e3,...null==i?void 0:i.loaderOptions}}}getLoggerConfig(e,t,r){var n,i;const{videoInfo:o,strategyConfig:s={},loggerParams:a,switchPlayerTime:l}=e,{bitrateAdapter:c}=s,u=this.curBitrate,{ext:d={}}=a||{},h=Sh.a.getHevcDisableInfo()||{},p=xp(),f={app_id:a.lineAppId,line_app_id:a.lineAppId,...p,codec_type:t,decodeFlag:"h265"===t,defaultBitrate:(null==u?void 0:u.bitrate)||o.bitrate||0,defaultDefinition:(null==u?void 0:u.definition)||o.definition||0,vid:o.id||o.vid,vtype:r||"MP4",fIndex:this.uuIndex,switchPlayerTime:l,...a,playerCoreVersion:"0.3.16",pv:"0.3.16",strategyVersion:jt.v,ext:{...d,...h},bitrateAdapter:{userResolution:(null==c?void 0:c.userSelectResolution)||"auto",qualityType:(null==u?void 0:u.qualityType)||0,selector:(null==c?void 0:c.selector)||"default"},closeEvents:(null==a?void 0:a.closeEvents)||[],playerType:this.playerType,videoInfo:{volumeInfo:{loudness:(null==(n=null==o?void 0:o.volumeInfo)?void 0:n.Loudness)||0,peak:(null==(i=null==o?void 0:o.volumeInfo)?void 0:i.Peak)||0}}};return{tea:{init:a.channelConfig,config:{region:a.region,user_unique_id:a.webId,user_is_login:a.isLogin}},config:f,type:"vod"}}_init(e){var t,r;this.hasStart=!1,this.downloadedSize=0;const{videoInfo:n,playerConfig:i,strategyConfig:o={}}=e;this.createInnerContainer(),this._initPreloader(o);const s=(null==i?void 0:i.codecType)||"h264",a=(null==n?void 0:n.vid)||"";this.bitrateList=(null==n?void 0:n.bitrateList)||[],this.vid=a,this.mediaType=Ut.M.VIDEO;const l=function(e,t,r,n,i){i&&fp.updateConfig(i);const o=zh(t,Ut.c.H265,Ut.V.MP4),s=zh(t,Ut.c.H264,Ut.V.MP4)||o,a=Rp(r,null==s?void 0:s.codecType),l=(null==s?void 0:s.definition)||"";(0,Ut.l)("getInitBitrate",`initCodec:${r} codecType:${a} preloadDefinition:${l}`,s);let c=[];if(e.length>0){c=fp.filterResolutionList(e,{codecType:a,vtype:Ut.V.MP4});const t=fp.select(e,a,Ut.V.MP4,{},{definition:l});(0,Ut.l)(`userSelectResolution:${fp.config.userSelectResolution}`,"adapterConfig",i,e,t);let r=null;if("h265"===(null==t?void 0:t.codecType)&&(r=fp.select(e,Ut.c.H264,Ut.V.MP4)),t)return{curBitrate:t,preloadCodec:(null==s?void 0:s.codecType)||null,preloadDefinition:(null==s?void 0:s.definition)||null,h264Bitrate:r,resolutionList:c,preloadMeta:s}}return null}(this.bitrateList,a,s,this.playerType,o.bitrateAdapter),{curBitrate:c=null,h264Bitrate:u=null,resolutionList:d}=l||{},h=(null==c?void 0:c.codecType)||s;this.curBitrate=c||function(e){return{definition:e.definition||Ut.U,bitrate:e.bitrate||0,codecType:e.codecType||Ut.c.H264,vtype:e.vtype||Ut.V.MP4,url:e.url,qualityType:(null==e?void 0:e.qualityType)||0}}(n),this.h264Bitrate=u,this.resolutionInfo={currentResolution:(null==c?void 0:c.resolution)||"",codecType:h,vtype:"MP4",resolutionList:d||[],bitrateList:this.bitrateList||[]},this.preloadMeta=(null==l?void 0:l.preloadMeta)||null,$p.addPlayingVid(a,this.playerType);const p=Wh(a,this.curBitrate,this.bitrateList),f=!(null==l||!l.preloadDefinition),_=function(e){return!(!(0,Ut.i)()||(0,Ut.j)()||e!==Ut.h.MSE&&e!==Ut.h.AUTO)}(o.videoPlayMode||Ut.h.H5),y=this.getMultiplexPluginConfig(i,o),{maxCacheCount:g=0}=e.strategyConfig;g>0&&X.setConfig({maxCount:g}),this.log("getInitBitrate",this.uuid,a,_,`hasPreload:${f} preloadDefinition: ${null==l?void 0:l.preloadDefinition} preloadCode:${null==l?void 0:l.preloadCodec} curBitrate: ${null==(t=this.curBitrate)?void 0:t.definition}`,"preloadMeta:",null==l?void 0:l.preloadMeta,y);const m={container:this.el,src:"",plugins:_?[new Nt(y)]:[],muted:i.muted||!1,autoplay:!1,preload:i.preload?i.preload:"",volume:i.volume||1,playbackRate:i.playbackRate||1};(0,Ut.l)(ef,this.uuid,"PlayerInit",!this.player,`autoplay:${i.autoplay} startTime:${i.startTime}`,this.config),this.player?(this.player.volume=i.volume||1,this.player.muted=i.muted||!1,this.player.playbackRate=i.playbackRate||1):(this.player=new Z(m),this.player.uuid=this.uuid),this._initLogger(e,h),this.initStyle(),this.bindPlayerEvents(this.player),this.load(p);const{startTime:v=-1}=i;if(this._startTime=v,i.autoplay&&this.isActive){this.forceAutoplay=!0;const{readyState:e,duration:t}=this.player;e&&t>0?this.startPlay():this.player.on(Rh,this._onceCanplay)}fp.attachVideo(this.element,{bitrate:(null==(r=this.curBitrate)?void 0:r.bitrate)||0,vid:a}),this._emitResolutionReady()}_emitResolutionReady(){this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0),this.timerId=setTimeout(()=>{this.emit("resolutionReady",{...this.resolutionInfo}),this.log("PRELOAD_INFO",this.preloadMeta),this.preloadMeta&&this.emit("PRELOAD_INFO",this.preloadMeta)},0)}bindPlayerEvents(e){const t=Np(e,Pp);t&&(t.on("preloadhit",this._onPreloadHit),t.on("cachehit",this._onCachehit),t.on("downgrade",this._onDowngrade),t.on("downloaded",this._onDownloaded),this.state===Ut.R.ACTIVE&&t.setPreloader($p.getCore(this.playerType))),e.on(Ih,this._onLoadedMetaData),e.on(Ph,this._onTimeupdate),e.on(Lh,this._onLoadedData),e.on(Bh,this._onLoadStart),e.on(Rh,this._onCanplay),e.on($h,this._onError),e.on("exception",this._onException)}unBindPlayerEvents(e){const t=Np(e,Pp);t&&(t.off("preloadhit",this._onPreloadHit),t.off("cachehit",this._onCachehit),t.off("downgrade",this._onDowngrade),t.off("downloaded",this._onDownloaded)),e.off(Ih,this._onLoadedMetaData),e.off(Ph,this._onTimeupdate),e.off(Lh,this._onLoadedData),e.off(Bh,this._onLoadStart),e.off(Rh,this._onCanplay),e.off(Rh,this._onceCanplay),e.off($h,this._onError),e.off("exception",this._onException)}retryUseH264Source(e){var t;if(null==this||this.emit("playCatch","MP4_3",{errorCode:(null==e?void 0:e.code)||8200,message:(null==e?void 0:e.message)||"width and height is 0"}),this.log("retryUseH264Source",this.h264Bitrate),null!=(t=this.h264Bitrate)&&t.url){const{vid:e=""}=this.config.videoInfo,t=Wh(e,this.h264Bitrate);this.load(t),this.isActive&&this.startPlay()}}startPlay(){var e;if(this.log("startPlay",this.state,`isPlaying:${this.isPlaying} currentSrc:${null==(e=this.player)?void 0:e.currentSrc}`),!this.player)return;const t=this.player.play();this.startPlayTimerId&&(window.clearTimeout(this.startPlayTimerId),this.startPlayTimerId=void 0),t&&t.then&&t.then(e=>{var t;if(this.player)if(e){if(this.log("startPlay error",`attemptPlayCount:${this.attemptPlayCount} isPlaying:${this.isPlaying} muted:${this.player.muted}`,null==e?void 0:e.name,null==e?void 0:e.message,`currentSrc:${!(null==(t=this.player)||!t.currentSrc)}`),!this.player||!function(e){return"NotAllowedError"===e.name||"AbortError"===e.name}(e)||!this.forceAutoplay)return this.isPlaying=!1,void this._emitAutoplayPrevent();this.attemptPlayCount<3?(this.player.muted=!0,this.attemptPlayCount++,this.startPlayTimerId=setTimeout(()=>{if(!this.player)return this.player;this.player.muted=!0,this.startPlay()},0)):(this._emitAutoplayPrevent(),this.isPlaying=!1)}else this.log("startPlay success"),this.isPlaying=!0,this._emitAutoplayStart()}).catch(e=>{var t;this.log("startPlay catch",`attemptPlayCount:${this.attemptPlayCount} isPlaying:${this.isPlaying} muted:${this.muted}`,`currentSrc:${!(null==(t=this.player)||!t.currentSrc)}`)})}play(){return this.log("call play",this.state,`paused:${this.paused} isPlaying:${this.isPlaying}`),!this.player||Up(this)?Promise.resolve():(this.forceAutoplay=!0,this.player.play())}pause(){var e;return this.log("call pause",this.state,`attemptPlayCount:${this.attemptPlayCount} paused:${this.paused} isPlaying:${this.isPlaying}`),this.forceAutoplay=!1,null==(e=this.player)?void 0:e.pause()}supportMSE(){return!!Np(this.player,Pp)}_initPreloader(e){if(!e)return;n.DS.attachPreloader($p.ttPreloader);const{enablePreloader:t=!0,preloaderConfig:r}=e;r&&$p.update(r,this.playerType),(0,Ut.l)(ef,"_initPreloader",e,t,r),t?$p.enable():$p.disable()}_initLogger(e,t){n.DS.AB_SDK_VERSION=Lp();const{loggerParams:r}=e;this.log("initLogger loggerParams",r),n.K.init(ar.Collector,r.channelConfig,{region:r.region,user_unique_id:r.webId,user_is_login:r.isLogin,user_id:r.uid||r.webId});const i=this.getLoggerConfig(e,t,"MP4").config;this.vodCollector?this.vodCollector.update(i,n.Tx.RELOAD):this.vodCollector=new n.DS(i),this.vodCollector.attachPlayer(this.player)}load(e){this.player&&e?((0,Ut.l)(ef,"loadPlayerSource",e),this.player.src=e):console.warn("load warn","url is null || this.player is null")}getPreloadMeta(e,t){return this.log("getPreloadMeta",e),$p.getPreloadMeta(e,this.playerType)}updatePreloadCodec(e){this.log("updatePreloadCodec",e),$p.changeCodec(e)}changeResolution(e){var t,r;const n=this.bitrateList,i=(null==(t=this.curBitrate)?void 0:t.codecType)||"h264",{resolution:o}=e;if(o===(null==(r=this.curBitrate)?void 0:r.resolution))return;const s=fp.select(n,i,Ut.V.MP4,{},{resolution:e.resolution});fp.updateConfig({userSelectResolution:e.resolution}),(0,Ut.l)(ef,this.uuid,`changeResolution:${o}`,s),s&&(this.curBitrate=s)}reset(){var e;window.clearTimeout(this.timerId),window.clearTimeout(this.startPlayTimerId),this.timerId=void 0,this.startPlayTimerId=void 0,this._startTime=-1,this.vid&&$p.removePlayingVid(this.vid,this.playerType),this.curBitrate=null,this.bitrateList=[],this.curBitrate=null,this.resolutionInfo=null,this.downloadedSize=0,this.downloadedTime=0,this.loadStartTime=0,this.preloadMeta=null,this.preloadTime=0,this.cacheHitType=Ut.C.UNKNOWN,null==(e=this.player)||e.reset(),this.vid=null}release(){var e,t;null==(e=this.player)||e.pause(),this.forceAutoplay=!1,this.attemptPlayCount=0,this.log("release",this.state,`isPlaying: ${this.isPlaying}`,this.vid,$p.playingVids),(0,Ut.a)(this.element,"object-fit"),fp.detachVideo(this.element),this.changeState(Ut.R.RELEASE),this.unMountDom(),this.player&&this.unBindPlayerEvents(this.player),null==(t=this.vodCollector)||t.reset(!1),window.clearTimeout(this.timerId),this.timerId=void 0;const r=Np(this.player,Pp);null==r||r.suspend()}destroy(){var e,t,r;this.log("destroy",this.state,`isPlaying: ${this.isPlaying}`),null==(e=this.player)||e.pause();const n=this.config.videoInfo.vid;n&&$p.removePlayingVid(n,this.playerType),this.player&&this.unBindPlayerEvents(this.player),this.changeState(Ut.R.DESTROY),this.emit("destroy"),this.unMountDom(),null==(t=this.player)||t.destroy(),null==(r=this.vodCollector)||r.destroy(),this.player=null,this.vodCollector=null,window.clearTimeout(this.timerId),this.timerId=void 0}changeVideo(e,t,r=!0){var i,o,s;const a=null==(i=null==e?void 0:e.videoInfo)?void 0:i.vid,l=t||Ut.R.ACTIVE,c=a===this.vid&&!r,{startTime:u=-1,playbackRate:d=1,volume:h=1,muted:p=!1,autoplay:f=!1}=e.playerConfig||this.config;if(this.log("changeVideo",`renderState:${t} needReset:${r} vid:${a} sameVid:${this.vid===a}`,`isContinue:${c} startTime:${u} currentTime:${null==(o=this.player)?void 0:o.currentTime}`),this.player&&c){const e=Np(this.player,Pp);if(null==e||e.resume(),this.changeState(l),this.player.playbackRate=d,this.player.volume=h,this.player.muted=p,this.player.currentTime=u,this.isActive&&f){this.forceAutoplay=!0;const{readyState:e,duration:t}=this.player;this.player.play(),(e<2||t>0)&&this.player.on(Rh,this._onceCanplay)}else this.player.pause();this.bindPlayerEvents(this.player),fp.attachVideo(this.element,{bitrate:(null==(s=this.curBitrate)?void 0:s.bitrate)||0,vid:this.vid}),$p.addPlayingVid(a);const t=this.vodCollector;t&&(t.reuseType=n.Tx.CONTINUE),this._emitResolutionReady(),this.preloadMeta&&this.emit("hitcache",this.preloadMeta)}else if(this.reset(),this.changeState(l),e&&(this.config=e),this._init(e||this.config),a===this.vid){const e=Np(this.player,Pp);null==e||e.resume()}}on(e,t,...r){var n;null==(n=this.player)||n.on(e,t,...r)}off(e,t){var r;null==(r=this.player)||r.off(e,t)}once(e,t){var r;null==(r=this.player)||r.once(e,t)}emit(e,...t){var r;null==(r=this.player)||r.emit(e,...t)}}class rf{constructor(){this._eventemitter=new Sr}on(e,t,...r){this._eventemitter.on(e,t,...r)}once(e,t,...r){this._eventemitter.once(e,t,...r)}off(e,t,...r){this._eventemitter.off(e,t,...r)}emit(e,t,...r){this._eventemitter.emit(e,t,...r)}offAll(){this._eventemitter.removeAllListeners()}clear(){this._eventemitter.removeAllListeners()}}class nf extends rf{constructor(e){super(),this.playerType=Ut.P.XG}setCustomTracker(e){n.DS.setCustomTracker(e)}setPlayerType(e){this.playerType=e}get device(){return sr.A.device}get version(){return jt.v}}function of(e,t){return e&&e.playerType===t}const sf="[PlayerQueue]";class af{constructor(e){this._maxCount=3,this._queue=[],this._resetDelay=1e4,this.stats={totalCount:0,playCount:0,releaseCount:0,activeCount:0,backupCount:0,unMutedCount:0},this.onInstancePlay=e=>{this.stats.playCount++,(0,Ut.l)(sf,"onInstancePlay",this.stats.playCount)},this.onInstancePause=e=>{this.stats.playCount--,(0,Ut.l)(sf,"onInstancePause",this.stats.playCount)},this.onInstanceVolumeChange=e=>{if(!e||!e.target)return;const t=e.target;t.muted?this.stats.unMutedCount--:this.stats.unMutedCount++,(0,Ut.l)(sf,"onInstanceVolumeChange",t.muted,t.volume,this.stats.unMutedCount)},null!=e&&e.maxCount&&(this._maxCount=e.maxCount)}set maxCount(e){e>=0&&(this._maxCount=e)}set resetDelay(e){this._resetDelay=e}add(e){this._queue.push(e),this.bindEvents(e);const t=this._queue.length;if(this._queue.length>this._maxCount){let e=-1,r=-1;for(let n=0;n<t;n++){const t=this._queue[n];if(t.state===Ut.R.RELEASE){e=n;break}t.state===Ut.R.RETAIN&&(r=n)}const n=e>-1?e:r,i=this.removeByIndex(n);(0,Ut.l)(sf,"removePlayer",null==i?void 0:i.uuid),null==i||i.destroy()}}bindEvents(e){if(!e||!e.element)return;const{muted:t,paused:r}=e.element;t||this.stats.unMutedCount++,(0,Ut.l)(sf,"bindEvents",`state: ${e.state} muted:${t} paused:${r}`,this.stats),e.element.addEventListener("play",this.onInstancePlay),e.element.addEventListener("pause",this.onInstancePause),e.element.addEventListener("volumechange",this.onInstanceVolumeChange)}unbindEvents(e){if(!e||!e.element)return;const{muted:t,paused:r}=e.element;(0,Ut.l)(sf,"unbindEvents",`state: ${e.state} muted:${t} paused:${r}`,this.stats),t||this.stats.unMutedCount--,r&&this.stats.playCount--,e.element.removeEventListener("play",this.onInstancePlay),e.element.removeEventListener("pause",this.onInstancePause),e.element.removeEventListener("volumechange",this.onInstanceVolumeChange)}remove(e){const t=this.getIndex(e);return this.removeByIndex(t)}removeByIndex(e){if(e>=0&&e<this._queue.length){const t=this._queue.splice(e,1);if(t.length>0)return this.unbindEvents(t[0]),t[0]}return null}get length(){return this._queue.length}get(e,t,r){const n=this._queue.length;let i=null;(0,Ut.l)(sf,"get",e,t,r,this.length,this.getAllIdWithState());for(let o=n-1;o>=0;o--){const n=this._queue[o];if(n.state===Ut.R.RELEASE&&of(n,e)&&(!n.mediaType||n.mediaType===t)){if(i=n,!r)break;if(n.vid===r){i=this._queue[o];break}}}return i}getByState(e,t){for(let r=this._queue.length-1;r>=0;r--)if(of(this._queue[r],e)&&this._queue[r].state===t)return this._queue[r];return null}getIndex(e){if(!e)return-1;for(let t=0;t<this._queue.length;t++)if(this._queue[t].uuid===e.uuid)return t;return-1}getByIndex(e){return e>0&&e<this._queue.length?this._queue[e]:null}getById(e){for(let t=0;t<this._queue.length;t++)if(this._queue[t].uuid===e)return t;return-1}getAll(e){return e?this._queue.filter(t=>of(t,e)&&t.state!==Ut.R.RELEASE&&t.state!==Ut.R.DESTROY):this._queue.filter(e=>e.state!==Ut.R.RELEASE&&e.state!==Ut.R.DESTROY)}getAllWithState(e,t){return this._queue.filter(r=>of(r,e)&&r.state===t)}getAllId(){return this._queue.map(e=>e.uuid)}getAllIdWithState(){return this._queue.map(e=>`${e.uuid}_${e.state}_${e.mediaType}`)}getStats(){let e=0,t=0,r=0;return this._queue.forEach(n=>{n.state===Ut.R.RELEASE?t++:n.state===Ut.R.BACKUP||n.state===Ut.R.RETAIN?e++:n.state===Ut.R.ACTIVE&&r++}),{...this.stats,totalCount:this.length,releaseCount:t,activeCount:r,backupCount:e,unMutedCount:0}}removeAll(){this._queue.forEach(e=>{this.unbindEvents(e),null==e||e.destroy()}),this._queue=[]}removeByState(e,t){const r=[];this._queue.forEach((n,i)=>{n.state===e&&(!t||of(n,t))&&r.push(i)}),r.forEach(e=>{const t=this.removeByIndex(e);t&&t.destroy()}),(0,Ut.l)(sf,"removeByState",t,r.join("|"))}setResetTimer(e){(0,Ut.l)(sf,"setResetTimer",e,this.length,this._resetDelay),this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0),!(this._resetDelay<=0)&&(this.timerId=window.setTimeout(()=>{const e=[];this._queue.forEach(t=>{t.state===Ut.R.RELEASE&&(e.push(t.uuid),t.reset())}),window.clearTimeout(this.timerId),this.timerId=void 0,(0,Ut.l)(sf,"resetInstance",e.join("|"))},this._resetDelay))}}let lf=null;function cf(e){return lf||(lf=new af),null!=e&&e.maxCount&&(lf.maxCount=null==e?void 0:e.maxCount),null!=e&&e.resetDelay&&(lf.resetDelay=null==e?void 0:e.resetDelay),lf}const uf="[MultiplePlayerPool1]";class df extends nf{constructor(e){super(e),this.playerType=Ut.P.NEW_TT,this.queue=cf(),this.currentMuted=!1,this.currentVolume=1,this.onDataDownLoad=e=>{const{len:t=0,time:r=0}=e;Sh.M.setSpeed({size:8*t,speed:r?Math.round(8*t/r*1e3/1024):0,duration:r})},this.onHevcDetect=e=>{if(e){const{open:e}=Sh.M.checkHevcResult();e&&this.updatePreloadCodec(Ut.c.H265)}},this._onAutoplayPrevent=()=>{var e;(0,Ut.l)(uf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onAutoplayPrevent"),this.autoplayPrevent=!0},this._onAutoplayStart=()=>{var e,t,r,n,i;(0,Ut.l)(uf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onAutoplayStart",null==(t=this.currentPlayer)?void 0:t.muted,null==(n=null==(r=this.currentPlayer)?void 0:r.element)?void 0:n.paused,null==(i=this.currentPlayer)?void 0:i.currentTime,(new Date).getTime()),this.autoplayPrevent=!1},this._onActiveLoadedData=()=>{const{currentPlayer:e,currentProps:t}=this;!e||!jp(this.currentPlayer)||(t.muted=e.muted,t.volume=e.volume,this.checkLoadBackUpInstance("onActiveLoadedData"))},this._onActiveProgress=()=>{this.checkLoadBackUpInstance("onActiveProgress")},this._onVolumechange=()=>{var e;if(!this.currentPlayer||!jp(this.currentPlayer))return;const{currentPlayer:t,currentProps:r}=this;(0,Ut.l)(uf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onVolumechange",t.muted,t.volume),r.muted=t.muted,r.volume=t.volume},this._onRatechange=()=>{var e;if((0,Ut.l)(uf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onRatechange"),!this.currentPlayer)return;const{currentPlayer:t,currentProps:r}=this;r.playbackRate=t.playbackRate},this._onPlayCatch=(e,t)=>{var r;if((0,Ut.l)(uf,null==(r=this.currentPlayer)?void 0:r.uuid,"_onPlayCatch",e,t),!t)return;const{message:n="",errorCode:i,errorMessage:o=""}=t;(n||o).includes("is unsupported")&&Sh.a.focusDisableHevc({hevcCode:i||1,hevcMsg:n})},this._onceCanplay=()=>{var e,t;const r=null==(e=this.currentPlayer)?void 0:e.buffered;(0,Ut.l)(uf,null==(t=this.currentPlayer)?void 0:t.uuid,"_onceCanplay",Ip(r));const{isTTP:n}=Sh.M.getInstance();null!==n&&Sh.b.asyncMark(n||!1)},this.currentPlayer=null,this.currentProps={playbackRate:1,muted:!1,volume:1},this.autoplayPrevent=!1,this.config={enableReuse:!1,needReset:!0,maxCount:3,enableMultiple:!1,defaultMSE:!1,minBuffer:100,...e},this.queue.maxCount=this.config.maxCount,Sh.a.setDetectCallback(this.onHevcDetect),$p.on("downloaded",this.onDataDownLoad,this.playerType),n.DS.setPlayerPool(this.playerType,this.queue)}setPlayerType(e){this.playerType=e}setCustomTracker(e){n.DS.setCustomTracker(e)}get device(){return sr.A.device}get version(){return jt.v}checkLoadBackUpInstance(e){var t;(function(e,t){const{minBuffer:r}=t;if(!e||!r)return!0;if(e&&e.length>0){const t=e.end(e.length-1);if((0,Ut.f)(t)>=r)return!0}return!1})(null==(t=this.currentPlayer)?void 0:t.buffered,{minBuffer:this.config.minBuffer})&&this.queue.getByState(this.playerType,Ut.R.BACKUP)}_bindEvents(e){(0,Ut.l)(uf,"_bindEvents",e.uuid),e.on("real_time_speed",this.onDataDownLoad)}_unbindEvents(e){(0,Ut.l)(uf,"_unbindEvents",e.uuid),e.off("real_time_speed",this.onDataDownLoad)}_bindActiveEvents(e){e.on(Lh,this._onActiveLoadedData),e.on(Dh,this._onActiveProgress),e.on(Mh,this._onRatechange),e.on(xh,this._onVolumechange),e.once(Rh,this._onceCanplay),e.on(Uh,this._onAutoplayPrevent),e.on(jh,this._onAutoplayStart),e.on("playCatch",this._onPlayCatch)}_unbindActiveEvents(e){e.off(Lh,this._onActiveLoadedData),e.off(Dh,this._onActiveProgress),e.off(Mh,this._onRatechange),e.off(xh,this._onVolumechange),e.off(Rh,this._onceCanplay),e.off(Uh,this._onAutoplayPrevent),e.off(jh,this._onAutoplayStart),e.off("playCatch",this._onPlayCatch)}_activePlayer(e){var t;const{state:r}=e;r!==Ut.R.ACTIVE&&this._bindActiveEvents(e),this.currentPlayer=e;const{currentProps:n}=this,i=Bp(e);(0,Ut.l)(uf,e.uuid,"_activePlayer",e.uuid,`hasStart:${e.hasStart} preState:${r}`,i,n),e.muted=n.muted,e.volume=n.volume,e.forceAutoplay=!0,null==(t=e.metrics)||t.setStartInitInfo(i),e.changeState(Ut.R.ACTIVE),e.hasStart?e.play():e.startPlay()}_retainPlayer(e){(0,Ut.l)(uf,e.uuid,"_retainPlayer");const{state:t}=e;t===Ut.R.ACTIVE&&this._unbindActiveEvents(e),e.changeState(Ut.R.RETAIN),e.forceAutoplay=!1,e.pause(),e.seek(0),e.muted=!0}getInstance(e,t){var r;const n=e.videoInfo.vid;let i=this.queue.get(this.playerType,Ut.M.VIDEO,n);i&&(0,Ut.l)(uf,"getInstance reuse",null==i?void 0:i.uuid,`sameVid: ${n===i.vid}`,t,e);let o=e;if(t!==Ut.R.ACTIVE&&(o=function(e,t){const{playerConfig:r,strategyConfig:n}=e;return r.autoplay=!1,t.defaultMSE&&(n.videoPlayMode=Ut.h.MSE),e}(e,this.config,null==(r=this.currentPlayer)||r.buffered)),i){const{needReset:e}=this.config;i.changeVideo(o,t,e)}else i=new tf(o,t),this.queue.add(i);this._bindEvents(i);const s=new Ah,a=i.config,l=new or(s,{bitrate:a.defaultBitrate,definition:a.defaultDefinition,codecType:a.codecType});return t!==Ut.R.ACTIVE&&(i.muted=!0),i.metrics=l,i.event=s,s.player=i,l.player=i,(0,Ut.l)(uf,"getInstance new","preloadPlayingIds",$p.getPlayingVid(this.playerType)),i}setConfig(e){const t=this.config.enableReuse;Object.keys(e).forEach(t=>{this.config[t]=e[t]}),t!==this.config.enableReuse&&this.queue.removeByState(Ut.R.RELEASE,this.playerType),this.queue.maxCount=this.config.maxCount}mountDom(e,t){if(e&&t)try{if(!e.el)return;t.appendChild(e.el)}catch(e){console.error(e)}}unMountDom(e){var t;if(e)try{const{el:r}=e;if(!r)return;null==(t=null==r?void 0:r.parentElement)||t.removeChild(r)}catch(e){console.error(e)}}usePlayer(e,t){var r,n;const i=this.getInstance(e,t);return(0,Ut.l)(uf,i.uuid,"usePlayer",i.state,t,e),t===Ut.R.ACTIVE&&(null==(r=i.metrics)||r.setStartInitInfo(Bp(i)),this._bindActiveEvents(i),this.currentPlayer=i),(0,Ut.l)(uf,i.uuid,"usePlayer",i.state,t,null==(n=e.playerConfig)?void 0:n.autoplay),i}releasePlayer(e,t=!1){if(!e)return;this.unMountDom(e);const{enableReuse:r}=this.config,{state:n}=e;(0,Ut.l)(uf,null==e?void 0:e.uuid,"releasePlayer",n,t||!r),this._unbindActiveEvents(e),e.changeState(Ut.R.RELEASE);const{metrics:i,event:o}=e;i&&(i.release(),i.removeEvent(),i.player=null),o&&(o.release(),o.player=null),this._unbindEvents(e),t||!r?(this.queue.remove(e),e.destroy()):(e.release(),this.queue.setResetTimer(this.playerType)),this.queue.removeByState(Ut.R.RELEASE,Ut.P.XG)}updatePlayer(e,t){const{state:r}=e,{enableReuse:n,enableMultiple:i}=this.config;if((0,Ut.l)(uf,e.uuid,"updatePlayer",r,t),r!==t&&i)switch(t){case Ut.R.RELEASE:this.releasePlayer(e,!n);break;case Ut.R.ACTIVE:this._activePlayer(e);break;case Ut.R.RETAIN:this._retainPlayer(e)}}callPlay(){(0,Ut.l)(uf,"callPlay",`autoplayPrevent:${this.autoplayPrevent}`),this.autoplayPrevent&&this.queue.getAllWithState(this.playerType,Ut.R.BACKUP).forEach(e=>{const t=e;if(t.state===Ut.R.BACKUP){(0,Ut.l)(uf,"callPlay",t.uuid,`isPlaying:${Dp(t)} hasStart:${Mp(t)}`);const e=()=>{var r;(0,Ut.l)(uf,t.uuid,"onAutoplayStart",t.muted,null==(r=t.element)?void 0:r.paused,t.currentTime,(new Date).getTime()),t.state===Ut.R.BACKUP&&t.pause(),t.off(jh,e)},r=()=>{var e;(0,Ut.l)(uf,t.uuid,"onTimeupdate",t.muted,null==(e=t.element)?void 0:e.paused,t.currentTime,(new Date).getTime()),t.off(Ph,r)};t.on(jh,e),t.on(Ph,r),t.play()}})}changeResolution(e,t){e&&(e.changeResolution(t),this.queue.getAll(this.playerType).forEach(r=>{r!==e&&r.changeResolution(t)}))}getResolutionInfo(e){return e?e.resolutionInfo:null}getPreloadMeta(e){return $p.getPreloadMeta(e)}preloadResources(e){if($p){$p.clearTask(this.playerType);const t=$p.addPreloadList(e,this.playerType);(0,Ut.l)(uf,"preloadResources",t)}}updatePreloadConfig(e){$p.update(e,this.playerType)}updatePreloadCodec(e){$p.changeCodec(e,this.playerType)}set muted(e){this.currentMuted=e,this.currentProps.muted=e,this.currentPlayer&&(this.currentPlayer.muted=e)}set volume(e){this.currentProps.volume=e,this.currentPlayer&&(this.currentPlayer.volume=e)}}const hf="[MultiplePlayerPool1111]";class pf extends nf{constructor(e){super(e),this.playerType=Ut.P.XG,this.queue=cf(),this.currentMuted=!1,this.currentVolume=1,this.onDataDownLoad=e=>{const{len:t=0,time:r=0}=e;Sh.M.setSpeed({size:8*t,speed:r?Math.round(8*t/r*1e3/1024):0,duration:r})},this.onHevcDetect=e=>{if(e){const{open:e}=Sh.M.checkHevcResult();e&&this.updatePreloadCodec(Ut.c.H265)}},this._onAutoplayPrevent=()=>{var e;(0,Ut.l)(hf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onAutoplayPrevent"),this.autoplayPrevent=!0},this._onAutoplayStart=()=>{var e,t,r,n,i;(0,Ut.l)(hf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onAutoplayStart",null==(t=this.currentPlayer)?void 0:t.muted,null==(n=null==(r=this.currentPlayer)?void 0:r.element)?void 0:n.paused,null==(i=this.currentPlayer)?void 0:i.currentTime,(new Date).getTime()),this.autoplayPrevent=!1},this._onActiveLoadedData=()=>{const{currentPlayer:e,currentProps:t}=this;!e||!jp(e)||(t.muted=e.muted,t.volume=e.volume,this.checkLoadBackUpInstance("onActiveLoadedData"))},this._onActiveProgress=()=>{this.checkLoadBackUpInstance("onActiveProgress")},this._onActiveDegrade=e=>{(0,Ut.l)(hf,"_onActiveDegrade",e),e.isSoftWareDecodeError&&this.queue.getAllWithState(this.playerType,Ut.R.BACKUP).forEach(t=>{t.state!==Ut.R.ACTIVE&&t.startSoftHevcDegrade(e,!0)})},this._onVolumechange=()=>{var e,t;if((0,Ut.l)(hf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onVolumechange"),!this.currentPlayer||!jp(this.currentPlayer))return;const{currentPlayer:r,currentProps:n}=this;(0,Ut.l)(hf,null==(t=this.currentPlayer)?void 0:t.uuid,"_onVolumechange",r.muted,r.volume),n.muted=r.muted,n.volume=r.volume},this._onRatechange=()=>{var e;if((0,Ut.l)(hf,null==(e=this.currentPlayer)?void 0:e.uuid,"_onRatechange"),!this.currentPlayer)return;const{currentPlayer:t,currentProps:r}=this;r.playbackRate=t.playbackRate},this._onPlayCatch=(e,t)=>{var r;if((0,Ut.l)(hf,null==(r=this.currentPlayer)?void 0:r.uuid,"_onPlayCatch",e,t),!t)return;const{message:n="",errorCode:i,errorMessage:o=""}=t;(n||o).includes("is unsupported")&&Sh.a.focusDisableHevc({hevcCode:i||1,hevcMsg:n})},this._onceCanplay=()=>{var e,t;const r=null==(e=this.currentPlayer)?void 0:e.buffered;(0,Ut.l)(hf,null==(t=this.currentPlayer)?void 0:t.uuid,"_onceCanplay",Ip(r));const{isTTP:n}=Sh.M.getInstance();null!==n&&Sh.b.asyncMark(n||!1)},this.currentPlayer=null,this.currentProps={playbackRate:1,muted:!1,volume:1},this.autoplayPrevent=!1,this.config={enableReuse:!1,needReset:!1,maxCount:3,enableMultiple:!1,defaultMSE:!1,minBuffer:100,...e},this.queue.maxCount=this.config.maxCount,Sh.a.setDetectCallback(this.onHevcDetect),$p.on("prf_data_size",this.onDataDownLoad),n.DS.setPlayerPool(this.playerType,this.queue)}setCustomTracker(e){n.DS.setCustomTracker(e)}get device(){return sr.A.device}get version(){return jt.v}checkLoadBackUpInstance(e){var t,r,n;const i=null==(t=this.currentPlayer)?void 0:t.buffered,o=Hp(i,{minBuffer:this.config.minBuffer});if(o){const t=this.queue.getByState(this.playerType,Ut.R.BACKUP);if(t){const s=Gp(t);(0,Ut.l)(hf,null==(r=this.currentPlayer)?void 0:r.uuid,"checkLoadBackUpInstance",`${e} ifLoadInit:${o} hasStart:${s} end:${Ip(i)}`),s<1&&(null==(n=t.player)||n.start())}}}_bindEvents(e){(0,Ut.l)(hf,"_bindEvents",e.uuid),e.on("real_time_speed",this.onDataDownLoad)}_unbindEvents(e){(0,Ut.l)(hf,"_unbindEvents",e.uuid),e.off("real_time_speed",this.onDataDownLoad)}_bindActiveEvents(e){e.on(Lh,this._onActiveLoadedData),e.on(Dh,this._onActiveProgress),e.on(Mh,this._onRatechange),e.on(xh,this._onVolumechange),e.once(Rh,this._onceCanplay),e.on(Uh,this._onAutoplayPrevent),e.on(jh,this._onAutoplayStart),e.on("playCatch",this._onPlayCatch),e.on(yh,this._onActiveDegrade)}_unbindActiveEvents(e){e.off(Lh,this._onActiveLoadedData),e.off(Dh,this._onActiveProgress),e.off(Mh,this._onRatechange),e.off(xh,this._onVolumechange),e.off(Rh,this._onceCanplay),e.off(Uh,this._onAutoplayPrevent),e.off(jh,this._onAutoplayStart),e.off("playCatch",this._onPlayCatch),e.off(yh,this._onActiveDegrade)}_activePlayer(e){var t;const{state:r}=e;r!==Ut.R.ACTIVE&&this._bindActiveEvents(e),this.currentPlayer=e;const{currentProps:n}=this,i=qp(e);(0,Ut.l)(hf,e.uuid,"_activePlayer",e.uuid,`preState:${r}`,i,n),e.muted=n.muted,e.volume=n.volume,e.forceAutoplay=!0,null==(t=e.metrics)||t.setStartInitInfo(i);const o=e.player;o&&(o.config.autoplay=!0),e.changeState(Ut.R.ACTIVE),e.play()}_retainPlayer(e){(0,Ut.l)(hf,e.uuid,"_retainPlayer");const{state:t}=e;t===Ut.R.ACTIVE&&this._unbindActiveEvents(e),e.changeState(Ut.R.RETAIN),e.forceAutoplay=!1,e.pause(),e.seek(0),e.muted=!0}canUseSoftHevc(e){var t;if(!Zp(e))return!1;const{extra:r,video:n,bitrateAdapter:i}=e,o=(null==n?void 0:n.codecType)||Ut.c.H264,s=Yp(e.bitrateList||[],(null==r?void 0:r.vid)||"",o,i);return((null==(t=null==s?void 0:s.curBitrate)?void 0:t.codecType)||o)===Ut.c.H265}getInstance(e,t){var r,n,i,o,s;const a=null==(r=e.extra)?void 0:r.vid,l=this.canUseSoftHevc(e);let c=this.queue.get(this.playerType,l?Ut.M.TT_VIDEO:Ut.M.VIDEO,a);const{needReset:u}=this.config;c&&(0,Ut.l)(hf,"getInstance reuse",c.uuid,a,t,`useSoftHevc:${l}`,e);let d=e;t!==Ut.R.ACTIVE&&(d=function(e,t,r){e.autoplay=!1,e.video&&(e.video.autoplay=!1);const n=Hp(r,{minBuffer:t.minBuffer});return e.extra&&(e.extra.videoInit=n),t.defaultMSE&&e.mp4EncryptPlayer&&(e.mp4EncryptPlayer.needPreloadCheck=!1,e.extra&&(e.extra.closeMSE=!1)),e}(e,this.config,null==(n=this.currentPlayer)?void 0:n.buffered)),c?c.changeVideo(d,t,u):(c=new Qp(d,t),this.queue.add(c)),this._bindEvents(c);const h=new Ah,p=c.config,f=new or(h,{bitrate:p.defaultBitrate,definition:p.defaultDefinition,codecType:p.codecType});return t!==Ut.R.ACTIVE&&(c.muted=!0),c.metrics=f,c.event=h,h.player=c,f.player=c,(0,Ut.l)(hf,"getInstance",c.uuid,t,`videoInit:${null==(i=d.extra)?void 0:i.videoInit}, closeMSE:${null==(o=d.extra)?void 0:o.closeMSE} autoplay:${null==(s=d.video)?void 0:s.autoplay} codecType:${p.codecType}  defaultBitrate:${p.defaultBitrate} defaultDefinition:${p.defaultDefinition} useSoftHevc:${l}`),(0,Ut.l)(hf,"getInstance","preloadPlayingIds",$p.getPlayingVid()),c}setConfig(e){const t=this.config.enableReuse;Object.keys(e).forEach(t=>{this.config[t]=e[t]}),t!==this.config.enableReuse&&this.queue.removeByState(Ut.R.RELEASE,this.playerType),this.queue.maxCount=this.config.maxCount}mountDom(e,t){if(e&&t)try{if(!e.element)return;t.appendChild(e.element)}catch(e){console.error(e)}}unMountDom(e){var t;if(e)try{const{element:r}=e;if(!r)return;null==(t=null==r?void 0:r.parentElement)||t.removeChild(r)}catch(e){console.error(e)}}usePlayer(e,t){var r,n;const i=this.getInstance(e,t);return t===Ut.R.ACTIVE&&(null==(r=i.metrics)||r.setStartInitInfo(qp(i)),this._bindActiveEvents(i),this.currentPlayer=i),(0,Ut.l)(hf,i.uuid,"usePlayer",i.state,t,null==(n=e.video)?void 0:n.autoplay),i}releasePlayer(e,t=!1){if(!e)return;this.unMountDom(e);const{enableReuse:r}=this.config,{state:n}=e;(0,Ut.l)(hf,null==e?void 0:e.uuid,"releasePlayer",n,`enableReuse:${r} needDestroy:${t}`),this._unbindActiveEvents(e),e.changeState(Ut.R.RELEASE);const{metrics:i,event:o}=e;i&&(i.release(),i.removeEvent(),i.player=null),o&&(o.release(),o.player=null),this._unbindEvents(e),t||!r?(this.queue.remove(e),e.destroy()):(e.release(),this.queue.setResetTimer(this.playerType)),this.queue.removeByState(Ut.R.RELEASE,Ut.P.NEW_TT)}updatePlayer(e,t){const{state:r}=e,{enableReuse:n,enableMultiple:i}=this.config;if((0,Ut.l)(hf,e.uuid,"updatePlayer",r,t),r!==t&&i)switch(t){case Ut.R.RELEASE:this.releasePlayer(e,!n);break;case Ut.R.ACTIVE:this._activePlayer(e);break;case Ut.R.RETAIN:this._retainPlayer(e)}}callPlay(){(0,Ut.l)(hf,"callPlay",`autoplayPrevent:${this.autoplayPrevent}`),this.autoplayPrevent&&this.queue.getAllWithState(this.playerType,Ut.R.BACKUP).forEach(e=>{if(e.state===Ut.R.BACKUP){(0,Ut.l)(hf,"callPlay",e.uuid,`isPlaying:${Wp(e)} hasStart:${Gp(e)}`);const t=()=>{var r;(0,Ut.l)(hf,e.uuid,"onAutoplayStart",e.muted,null==(r=e.element)?void 0:r.paused,e.currentTime,(new Date).getTime()),e.state===Ut.R.BACKUP&&e.pause(),e.off(jh,t)},r=()=>{var t;(0,Ut.l)(hf,e.uuid,"onTimeupdate",e.muted,null==(t=e.element)?void 0:t.paused,e.currentTime,(new Date).getTime()),e.off(Ph,r)};e.on(jh,t),e.on(Ph,r),e.play()}})}changeResolution(e,t){e&&(e.changeResolution(t),this.queue.getAll(this.playerType).forEach(r=>{r!==e&&r.changeResolution(t)}))}getResolutionInfo(e){return e?e.resolutionInfo:null}getPreloadMeta(e){return $p.getPreloadMeta(e)}preloadResources(e){if($p){$p.clearTask();const t=$p.addPreloadList(e);(0,Ut.l)(hf,"preloadResources",t)}}updatePreloadConfig(e){$p.update(e)}updatePreloadCodec(e){$p.changeCodec(e)}set muted(e){this.currentMuted=e,this.currentProps.muted=e,this.currentPlayer&&(this.currentPlayer.muted=e)}set volume(e){this.currentProps.volume=e,this.currentPlayer&&(this.currentPlayer.volume=e)}}const ff="change",_f="update",yf="reset",gf="error";class mf{constructor(e){this.handlerEvent=e=>{e.type,this.emit("subtitle_event",e)},this.list=[],e.subTitlesList&&e.subTitlesList.forEach(e=>{this.list.push(e)}),this.player=null,this.xgSubtitle=new eo({subTitles:this.list,domRender:!1,defaultOpen:e.defaultOpen,updateMode:e.updateMode||"vod",debugger:!!e.debugger,renderMode:"normal"}),this.bindEvent()}bindEvent(){this.on(ff,this.handlerEvent),this.on("on",this.handlerEvent),this.on(_f,this.handlerEvent),this.on(yf,this.handlerEvent),this.on(gf,this.handlerEvent)}unBindEvents(){this.off(ff,this.handlerEvent),this.off(_f,this.handlerEvent),this.off(yf,this.handlerEvent),this.off(gf,this.handlerEvent),this.off("on",this.handlerEvent)}attach(e){var t,r;null==(t=this.xgSubtitle)||t.detachPlayer(),null==(r=this.xgSubtitle)||r.attachPlayer(e)}detach(){var e;null==(e=this.xgSubtitle)||e.detachPlayer()}destroy(){var e;this.unBindEvents(),null==(e=this.xgSubtitle)||e.destroy(),this.xgSubtitle=null}switch(e){var t,r;if(e)return null==(r=this.xgSubtitle)?void 0:r.switch(e).catch(e=>{console.error("switch error",e)});null==(t=this.xgSubtitle)||t.switchOff()}switchOff(){var e;return null==(e=this.xgSubtitle)?void 0:e.switchOff()}setSubTitles(e,t=!1){var r;const n=e.map(e=>({...e}));null==(r=this.xgSubtitle)||r.setSubTitles(n,t)}emit(e,t,...r){var n;null==(n=this.xgSubtitle)||n.emit(e,t,...r)}on(e,t,...r){var n;null==(n=this.xgSubtitle)||n.on(e,t,...r)}once(e,t,...r){var n;null==(n=this.xgSubtitle)||n.on(e,t,...r)}off(e,t,...r){var n;null==(n=this.xgSubtitle)||n.off(e,t,...r)}offAll(){var e;this.unBindEvents(),null==(e=this.xgSubtitle)||e.offAll()}}},67616:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.0002 3C17.9251 3 13.0002 7.92487 13.0002 14C13.0002 20.0751 17.9251 25 24.0002 25C30.0754 25 35.0002 20.0751 35.0002 14C35.0002 7.92487 30.0754 3 24.0002 3ZM10.4885 44C8.69328 44 7.28076 42.4175 7.8388 40.7112C10.0625 33.9118 16.4577 29 24 29C31.5424 29 37.9375 33.9118 40.1612 40.7112C40.7193 42.4175 39.3067 44 37.5115 44H10.4885Z"}))}},67768:(e,t,r)=>{"use strict";r.d(t,{ck:()=>pe,hp:()=>K});var n=r(40099),i=r(7874),o=r.n(i);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function _(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var i=p(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,r)}}function g(e,t,r){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}},g(e,t,r||e)}function m(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var b,w,C,E,k,T,S,O,A,$,P,R,x,L,I=function(e){h(r,e);var t=y(r);function r(){return s(this,r),t.apply(this,arguments)}return l(r,[{key:"getChildJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"";var r=e.type,n=e.props,i=(n.children,n.id),o=n.type,s=n.parentID,a=_(n,["children","id","type","parentID"]);return s&&(a={"@id":s}),a=Object.assign(i?{"@id":i}:{},o?{"@type":o}:{},a),new r(e.props).getJSON(t,a)}},{key:"parseChildren",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.props.children;return r?r.length>0?r.map(function(r){return e.getChildJSON(r,t)}):[this.getChildJSON(r,t)]:[]}},{key:"render",value:function(){return null}}]),r}(n.Component);c(I,"propTypes",{schema:o().object,id:o().string});var M={schemaType:"Generic",requiredProps:{genericType:o().string.isRequired,genericKey:o().string.isRequired,schema:o().object.isRequired}},D={schemaType:"VideoObject",schemaKey:"video",requiredProps:{name:o().string.isRequired,description:o().string.isRequired,thumbnailUrl:o().arrayOf(o().string).isRequired,uploadDate:o().string.isRequired,expires:o().string,caption:o().string,commentCount:o().string,contentUrl:o().string,embedUrl:o().string,interactionCount:o().string,keywords:o().string,musicBy:o().shape({name:o().string.isRequired,alternateName:o().string,mainEntityOfPage:o().shape((b={},c(b,"@type",o().string.isRequired),c(b,"@id",o().string.isRequired),b))})}},B={schemaType:"BroadcastEvent",schemaKey:"publication",requiredProps:{name:o().string.isRequired,isLiveBroadcast:o().bool.isRequired,startDate:o().string.isRequired,endDate:o().string.isRequired,publishedBy:o().string,publishedOn:o().string}},N={schemaType:"MusicRecording",schemaKey:"MusicRecording",requiredProps:{name:o().string.isRequired,url:o().string.isRequired,description:o().string,image:o().string,duration:o().string,byArtist:o().shape((w={},c(w,"@type",o().string.isRequired),c(w,"name",o().arrayOf(o().string)),w)),inAlbum:o().shape((C={},c(C,"@type",o().string.isRequired),c(C,"name",o().string),C))}},j={schemaType:"Organization",schemaKey:"publisher",requiredProps:{id:o().string,url:o().string.isRequired,logo:o().shape((E={},c(E,"@type",o().string.isRequired),c(E,"url",o().string.isRequired),E)),name:o().string.isRequired,sameAs:o().arrayOf(o().string)}},U={schemaType:"ContactPoint",schemaKey:"contactPoint",requiredProps:{telephone:o().string.isRequired,contactType:o().string.isRequired}},V={schemaType:"Person",schemaKey:"author",requiredProps:{name:o().string.isRequired,alternateName:o().string,description:o().string,mainEntityOfPage:o().shape((k={},c(k,"@type",o().string.isRequired),c(k,"@id",o().string.isRequired),k))}},F={schemaType:"ProfilePage",schemaKey:"mainEntityOfPage",requiredProps:{type:o().string,id:o().string}},H={schemaType:"Comment",schemaKey:"comment",requiredProps:{comment:o().arrayOf(o().shape((O={},c(O,"@type",o().string.isRequired),c(O,"text",o().string.isRequired),c(O,"author",o().shape((S={},c(S,"@type",o().string.isRequired),c(S,"name",o().string.isRequired),c(S,"alternateName",o().string),c(S,"mainEntityOfPage",o().shape((T={},c(T,"@type",o().string.isRequired),c(T,"@id",o().string.isRequired),T))),S))),O)))}},G={schemaType:"ItemList",schemaKey:"itemListElement",requiredProps:{itemListElement:o().arrayOf(o().shape((A={},c(A,"@type",o().string.isRequired),c(A,"position",o().number.isRequired),c(A,"url",o().string.isRequired),A))).isRequired}},W={schemaType:"BreadcrumbList",schemaKey:"BreadcrumbList",requiredProps:{itemListElement:o().arrayOf(o().shape((P={},c(P,"@type",o().string.isRequired),c(P,"position",o().number.isRequired),c(P,"item",o().shape(($={},c($,"@type",o().string.isRequired),c($,"@id",o().string.isRequired),c($,"name",o().string.isRequired),$)).isRequired),P))).isRequired}},q={GenericSchema:M,VideoSchema:D,BroadcastEventSchema:B,MusicRecordingSchema:N,OrganizationSchema:j,ContactSchema:U,PersonSchema:V,PageSchema:F,CommentsSchema:H,ItemListSchema:G,EventSchema:{schemaType:"Event",schemaKey:"Event",requiredProps:{name:o().string.isRequired,description:o().string.isRequired,startDate:o().string.isRequired,endDate:o().string.isRequired,image:o().arrayOf(o().string),location:o().object,offers:o().object,performer:o().object}},LocationSchema:{schemaType:"Place",schemaKey:"location",isParent:!0,requiredProps:{name:o().string.isRequired,address:o().object}},AddressSchema:{schemaType:"PostalAddress",schemaKey:"address",requiredProps:{streetAddress:o().string.isRequired,addressLocality:o().string.isRequired,postalCode:o().string.isRequired,addressRegion:o().string.isRequired,addressCountry:o().string.isRequired}},OffersSchema:{schemaType:"Offer",schemaKey:"offers",requiredProps:{url:o().string.isRequired,price:o().string.isRequired,priceCurrency:o().string.isRequired,availability:o().string.isRequired,validFrom:o().string.isRequired}},PerformerSchema:{schemaType:"PerformingGroup",schemaKey:"performer",requiredProps:{name:o().string.isRequired}},WebSiteSchema:{schemaType:"WebSite",schemaKey:"WebSite",requiredProps:{id:o().string,url:o().string.isRequired,name:o().string.isRequired,description:o().string.isRequired}},BreadcrumbSchema:W,ArticleSchema:{schemaType:"NewsArticle",schemaKey:"article",requiredProps:{headline:o().string.isRequired,image:o().arrayOf(o().string),datePublished:o().string.isRequired,dateModified:o().string.isRequired}},QAPageSchema:{schemaType:"QAPage",schemaKey:"qaPage",requiredProps:{mainEntity:o().shape({"@type":o().string.isRequired,name:o().string.isRequired,answerCount:o().number.isRequired,text:o().string,upvoteCount:o().string,dateCreated:o().string,author:o().shape((R={},c(R,"@type",o().string.isRequired),c(R,"name",o().string.isRequired),R)),acceptedAnswer:o().shape({"@type":o().string.isRequired,text:o().string.isRequired,dateCreated:o().string,upvoteCount:o().string,url:o().string,author:o().shape((x={},c(x,"@type",o().string.isRequired),c(x,"name",o().string.isRequired),x))}),suggestedAnswer:o().arrayOf(o().shape({"@type":o().string.isRequired,text:o().string.isRequired,dateCreated:o().string,upvoteCount:o().string,url:o().string,author:o().shape((L={},c(L,"@type",o().string.isRequired),c(L,"name",o().string.isRequired),L))}))}).isRequired}}},K=function(e){var t="",r=e.id,i=e.dangerouslyExposeHtml,o=e.children;try{if(o){var s=o.type,a=o.props,l=(a.children,a.id),c=a.type,u=_(a,["children","id","type"]),d=new s(a).getJSON(!0,u);t=Object.assign(l?{"@id":l}:{},c?{"@type":c}:{},{"@context":"https://schema.org/"},d)}}catch(e){console.error("[JSONLD] Sciprt ".concat(r," ").concat(e,", only allow one top child."))}return i?n.createElement("script",{type:"application/ld+json",id:r,dangerouslySetInnerHTML:{__html:JSON.stringify(t)}}):n.createElement("script",{type:"application/ld+json",id:r},JSON.stringify(t))};K.propTypes={dangerouslyExposeHtml:o().bool},K.defaultProps={dangerouslyExposeHtml:!1};var z=q.VideoSchema,Z=q.BroadcastEventSchema,Y=q.MusicRecordingSchema,X=q.OrganizationSchema,Q=q.ContactSchema,J=q.PersonSchema,ee=q.PageSchema,te=q.ItemListSchema,re=q.EventSchema,ne=q.LocationSchema,ie=q.AddressSchema,oe=q.OffersSchema,se=q.PerformerSchema,ae=q.WebSiteSchema,le=q.CommentsSchema,ce=q.BreadcrumbSchema,ue=q.ArticleSchema,de=q.QAPageSchema,he=function(e){var t=e.schemaType,r=e.schemaKey,n=e.requiredProps,i=void 0===n?{}:n,a=e.isParent,u=void 0!==a&&a;return function(e){h(a,e);var n=y(a);function a(){return s(this,a),n.apply(this,arguments)}return l(a,[{key:"getJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{o().checkPropTypes(i,n,r,t)}catch(e){console.error("[JSONLD] Sciprt ".concat(t," ").concat(e))}var s={},l=g(p(a.prototype),"parseChildren",this).call(this,!1);if("Generic"===t){var h=this.props,f=h.genericType,_=h.genericKey,y=d({"@type":f},h.schema);s=e?Object.assign.apply(Object,[y].concat(m(l))):Object.assign.apply(Object,[c({},_,y)].concat(m(l)))}else{var v=d({"@type":t},n);s=e?Object.assign.apply(Object,[v].concat(m(l))):u?c({},r,Object.assign.apply(Object,[v].concat(m(l)))):Object.assign.apply(Object,[c({},r,v)].concat(m(l)))}return s}}]),a}(I)},pe=he(q.GenericSchema);he(z),he(Z),he(Q),he(X),he(J),he(ee),he(te),he(re),he(ne),he(ie),he(oe),he(se),he(ae),he(le),he(ce),he(Y),he(ue),he(de)},68652:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M43.4142 22.5858L27.1213 6.29289C26.7308 5.90237 26.0976 5.90237 25.7071 6.29289L24.2929 7.70711C23.9024 8.09763 23.9024 8.7308 24.2929 9.12132L39.1716 24L24.2929 38.8787C23.9024 39.2692 23.9024 39.9024 24.2929 40.2929L25.7071 41.7071C26.0976 42.0976 26.7308 42.0976 27.1213 41.7071L43.4142 25.4142C44.1953 24.6332 44.1953 23.3668 43.4142 22.5858Z"}))}},70363:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 47C36.7025 47 47 36.7025 47 24C47 11.2975 36.7025 1 24 1C11.2975 1 1 11.2975 1 24C1 36.7025 11.2975 47 24 47Z",fill:"#25D366"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M30.9028 25.6129C30.5802 25.4515 28.9944 24.6713 28.6988 24.5635C28.4031 24.4559 28.1881 24.4021 27.9731 24.7249C27.758 25.0478 27.1399 25.7744 26.9517 25.9897C26.7636 26.2049 26.5754 26.2319 26.2529 26.0704C25.9303 25.909 24.891 25.5684 23.659 24.4694C22.7002 23.6141 22.0528 22.5579 21.8647 22.235C21.6765 21.9121 21.8446 21.7375 22.0061 21.5767C22.1512 21.4321 22.3287 21.2 22.4899 21.0116C22.6512 20.8233 22.705 20.6887 22.8125 20.4735C22.92 20.2582 22.8663 20.0699 22.7855 19.9085C22.7049 19.747 22.0599 18.1593 21.7911 17.5134C21.5293 16.8845 21.2634 16.9697 21.0654 16.9598C20.8774 16.9504 20.6622 16.9484 20.4472 16.9484C20.2322 16.9484 19.8827 17.0291 19.587 17.352C19.2914 17.6749 18.4581 18.4553 18.4581 20.0428C18.4581 21.6306 19.6139 23.1643 19.7752 23.3795C19.9365 23.5949 22.0496 26.8528 25.2853 28.2499C26.0548 28.5823 26.6557 28.7807 27.1241 28.9293C27.8968 29.1749 28.5999 29.1402 29.1557 29.0572C29.7754 28.9646 31.064 28.277 31.3328 27.5235C31.6016 26.7699 31.6016 26.1242 31.521 25.9897C31.4404 25.8551 31.2253 25.7744 30.9028 25.6129ZM25.0178 33.6472H25.0134C23.0881 33.6465 21.1998 33.1292 19.5524 32.1517L19.1606 31.9191L15.0998 32.9844L16.1837 29.0251L15.9286 28.6191C14.8546 26.9109 14.2873 24.9365 14.2881 22.9091C14.2905 16.9934 19.1037 12.1805 25.022 12.1805C27.8879 12.1815 30.5817 13.299 32.6076 15.3271C34.6333 17.3551 35.7482 20.0509 35.7471 22.9178C35.7447 28.8339 30.9315 33.6472 25.0178 33.6472ZM34.1489 13.7858C31.7117 11.3458 28.4706 10.0014 25.0173 10C17.902 10 12.111 15.7906 12.1082 22.908C12.1073 25.1832 12.7017 27.4039 13.8313 29.3617L12 36.0509L18.8432 34.2559C20.7287 35.2843 22.8516 35.8264 25.0121 35.827H25.0174H25.0174C32.132 35.827 37.9234 30.0359 37.9263 22.9184C37.9276 19.4691 36.5861 16.2258 34.1489 13.7858Z",fill:"white"}))}},71199:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M33.4646 67.4739C34.2202 68.0266 35.1126 68.3055 36 68.3055C36.8874 68.3055 37.7798 68.0266 38.5404 67.4688C46.2328 61.8504 71.3127 42.0795 70.9679 23.769C70.9679 12.3649 61.6884 3.08545 50.2843 3.08545C44.96 3.08545 39.8386 5.16446 36 8.84075C32.1564 5.16953 27.04 3.09052 21.7157 3.09052C10.3116 3.09052 1.03209 12.37 1.03209 23.7437C0.687274 42.0795 25.7672 61.8504 33.4646 67.4739ZM4.07477 23.769C4.07477 14.0433 11.9902 6.12782 21.7159 6.12782C26.7208 6.12782 31.5126 8.28289 34.8593 12.0403C35.1483 12.3648 35.5641 12.5474 35.9952 12.5474C36.4312 12.5474 36.842 12.3648 37.131 12.0403C40.4878 8.28289 45.2797 6.12782 50.2795 6.12782C60.0052 6.12782 67.9206 14.0433 67.9206 23.7994C68.2502 41.1059 42.004 61.1708 36.7406 65.0145C36.2943 65.339 35.701 65.339 35.2548 65.0145C29.9914 61.1658 3.74517 41.1059 4.07477 23.769Z"}))}},71334:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 36 36",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M27.8819 31.1058C28.1034 31.3236 28.4586 31.3196 28.6753 31.0969L29.9789 29.757C30.1955 29.5344 30.1916 29.1773 29.97 28.9596L5.48908 4.89442C5.26754 4.67664 4.91232 4.6806 4.69569 4.90326L3.39206 6.24315C3.17542 6.46581 3.1794 6.82286 3.40094 7.04064L6.98415 10.563C4.59164 12.4262 3.13477 14.8955 3.13477 17.6043C3.13477 23.407 9.82025 28.111 18.0672 28.111C20.1632 28.111 22.1582 27.8072 23.9683 27.2587L27.8819 31.1058ZM12.9687 16.4459L9.14562 12.6878C7.04739 14.1904 6.12126 15.9708 6.12126 17.6043C6.12126 19.2572 7.06956 21.0606 9.22102 22.5744C11.3631 24.0816 14.4813 25.1091 18.0672 25.1091C19.2549 25.1091 20.3913 24.9964 21.4579 24.7909L19.3334 22.7025C18.9281 22.8039 18.5041 22.8576 18.0675 22.8576C15.1811 22.8576 12.8412 20.5056 12.8412 17.6043C12.8412 17.2063 12.8852 16.8186 12.9687 16.4459Z",fillOpacity:"1"}),n.createElement("path",{d:"M11.9103 8.02949C13.7875 7.43091 15.8721 7.09763 18.0672 7.09763C26.3142 7.09763 32.9997 11.8016 32.9997 17.6043C32.9997 20.3839 31.4656 22.9114 28.9608 24.7905L26.792 22.6586C26.8328 22.6307 26.8733 22.6027 26.9134 22.5744C29.0649 21.0606 30.0132 19.2572 30.0132 17.6043C30.0132 15.9514 29.0649 14.148 26.9134 12.6342C24.7714 11.1271 21.6531 10.0995 18.0672 10.0995C16.7752 10.0995 15.5439 10.2329 14.3971 10.4741L11.9103 8.02949Z",fillOpacity:"1"}),n.createElement("path",{d:"M18.0675 12.351C17.5358 12.351 17.0226 12.4308 16.5391 12.5792L23.0996 19.0282C23.2262 18.5754 23.2939 18.0978 23.2939 17.6043C23.2939 14.703 20.954 12.351 18.0675 12.351Z",fillOpacity:"1"}))}},71404:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 3.59978C18.106 3.59978 3.6 18.1058 3.6 35.9998C3.6 53.8938 18.106 68.3998 36 68.3998C44.2229 68.3998 51.727 65.3386 57.4407 60.2913C58.0794 59.7272 59.0544 59.7876 59.6185 60.4262C60.1826 61.0649 60.1222 62.0399 59.4836 62.604C53.2277 68.1302 45.0038 71.4855 36 71.4855C16.4018 71.4855 0.514282 55.598 0.514282 35.9998C0.514282 16.4016 16.4018 0.514069 36 0.514069C55.5982 0.514069 71.4857 16.4016 71.4857 35.9998C71.4857 42.8834 66.1416 48.5875 59.4 48.5875C54.9024 48.5875 51.0268 46.0488 48.9451 42.3148C46.6052 47.1023 41.6877 50.3998 36 50.3998C28.0471 50.3998 21.6 43.9527 21.6 35.9998C21.6 28.0469 28.0471 21.5998 36 21.5998C43.9529 21.5998 50.4 28.0469 50.4 35.9998C50.4 41.316 54.4963 45.5018 59.4 45.5018C64.3037 45.5018 68.4 41.316 68.4 35.9998C68.4 18.1058 53.894 3.59978 36 3.59978ZM47.3143 35.9998C47.3143 29.7511 42.2487 24.6855 36 24.6855C29.7513 24.6855 24.6857 29.7511 24.6857 35.9998C24.6857 42.2485 29.7513 47.3141 36 47.3141C42.2487 47.3141 47.3143 42.2485 47.3143 35.9998Z"}))}},73256:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.8788 33.1213L7.58586 18.8284C7.19534 18.4379 7.19534 17.8047 7.58586 17.4142L10.4143 14.5858C10.8048 14.1953 11.438 14.1953 11.8285 14.5858L24.0001 26.7574L36.1716 14.5858C36.5622 14.1953 37.1953 14.1953 37.5859 14.5858L40.4143 17.4142C40.8048 17.8047 40.8048 18.4379 40.4143 18.8284L26.1214 33.1213C24.9498 34.2929 23.0503 34.2929 21.8788 33.1213Z"}))}},73282:(e,t,r)=>{"use strict";var n,i;r.d(t,{s$:()=>v,Ac:()=>b,FR:()=>m,wx:()=>_,Vu:()=>p}),(i=n||(n={})).START="jump_start",i.SCHEME_START="jump_schema_start",i.CHECK="jump_check",i.FAIL="jump_fail",i.APP_LINK="jump_app_link";var o=r(35895),s=r(52598),a=r(47483),l=function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})};let c;const u=!1,d="/download-link/ol",h=["onelink.me",d],p=(e,t)=>{const r=h.some(t=>-1!==e.indexOf(t))&&["tiktok_app","tiktok_lite_app","tiktok_pro"].includes(t);if(!r)return[void 0,!1];const n=(0,o.mX)(e);return[n,r&&Boolean(n)]},f=({url:e,autofillSchemeUrl:t,autoFillParamList:r=o.Bw,needAppendSchemeUrl:n=!1})=>{if(!t)return e;try{const i=new URL(e),o=i.pathname.includes(d);let s=!1;for(const e of r)i.searchParams.has(e)&&(i.searchParams.set(e,""),s=!0);return n&&s&&o&&i.searchParams.set("scheme_url",t),i.toString()}catch(e){}return e};function _({processedSchemes:e,processedFallbackURL:t,region:r,useNewRedirectPath:n,launchType:i="tiktok_app",useShortDl:s=!1,autoFillWhiteList:a=o.Bw}){var l;const c=e[0],u=`${(r?(0,o.dX)(r):e.some(e=>e.startsWith("snssdk1180")))?o.Yp:o.NC}/${n?o.hQ.now_app:null!==(l=o.hQ[i])&&void 0!==l?l:o.hQ.tiktok_app}`,d=s?"short_dl":"dl",h=s?f({url:t,autofillSchemeUrl:c,autoFillParamList:a}):t;return`${u}?redirect_url=${encodeURIComponent(c)}&${d}=${encodeURIComponent(h)}&decode_once=1`}function y(e,t){u?console.log(`[matrix.......jump] location ${e}`):t?t(e):function(e){new URL(e).protocol.includes("javascript")?console.error("invalid link found in _safeJump"):location.href=e}(e)}function g(){const e=new URLSearchParams(window.location.search).get("ug_source");if(e)return{ug_source:e};const{userAgent:t}=navigator;for(const[e,r]of Object.entries(o.E4))if(r.test(t))return{ug_source:e};return{}}function m({strategy:e,buildInSchemeParams:t={},buildInFallbackURLParams:r={},customs:n={}}){const{links:i,providerContext:s}=e;let{schemeParams:a={},fallbackURLParams:l={},experimentalFallbackTemplateURLParams:c={}}=e;const{disableAfdp:u=!1,addParamsUrl:d=!1,removeParamsUrlForAfdp:h=!1}=n;let{schemeParams:p={},fallbackURLParams:f={}}=s,{experimentalFallbackTemplateURLParams:_={}}=s;const{url_schemes:y,url_fallback:g}=i,m=null!=y?y:[];if(!m[0])throw new Error("Schemes empty");const v=(0,o.TS)({links:i}),{appType:b}=v;a=(0,o.qo)(a,v),l=(0,o.qo)(l,v),c=(0,o.qo)(c,v),p=(0,o.qo)(p,v),f=(0,o.qo)(f,v),_=(0,o.qo)(_,v);const w=(null!=y?y:[]).map(e=>(0,o.qE)(e,Object.assign(Object.assign(Object.assign(Object.assign({needlaunchlog:1,ug_medium:"fe_component"},s.uniqueId?{wid:s.uniqueId}:{}),t),p),a)));let C=null!=g?g:"",E=w[0];const k=new URLSearchParams(m[0]).get("params_url");if(u?C=C.replace("&af_dp={{schema}}",""):h&&(E=(0,o.bB)(E,"params_url")),d&&k){const e=new URL(k),t=e.origin+e.pathname;C=`${C}&params_url=${encodeURIComponent(t)}`}C=C.replace("{{schema}}",encodeURIComponent(E)),c=(0,o.PW)(Object.entries(c).map(([e,t])=>[e,(0,o.Kg)(t)?t.replace("{{schema}}",encodeURIComponent(w[0])):t])),_&&(_=(0,o.PW)(Object.entries(_).map(([e,t])=>[e,(0,o.Kg)(t)?t.replace("{{schema}}",encodeURIComponent(w[0])):t])));const T=(0,o.qE)(C,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({pid:"website"},s.uniqueId?{wid:s.uniqueId}:{}),r),_),c),f),l));return{appType:b,parsedExtra:v,processedSchemes:w,processedFallbackURL:T}}function v(e){var t;return l(this,void 0,void 0,function*(){const{links:r,launchType:i="tiktok_app",jumpLinkType:l=o.wl.DEFAULT,jumpStartHandler:u,jumpFailHandler:h,jumpCheckHandler:p,jumpEventHandler:v,jumpHook:b,strategyContext:w,providerContext:C}=e,{schemeParams:E={},fallbackURLParams:k={}}=e,{checkOpenTime:T,useNewRedirectPath:S,experimentalSkipSchemes:O=!1,installedApps:A,enableApiOptimization:$=!1,experimentalEnableCoinApiOptimization:P=!0,experimentalUseAppLink:R,experimentalUseBetterAppLink:x,disableAfdp:L,experimentalUseShortDl:I=!1,autoFillWhiteList:M}=C;c=Date.now();const D=(0,o.KJ)(),B=(0,s.a)(),N=null!=L?L:D&&"facebook"===B;try{const{parsedExtra:e,processedSchemes:s,processedFallbackURL:L}=m({strategy:{links:r,providerContext:C,schemeParams:E,fallbackURLParams:k},buildInSchemeParams:Object.assign({jump_time:c},g()),buildInFallbackURLParams:Object.assign({jump_time:c},g()),customs:{disableAfdp:N}}),B=Object.assign(Object.assign({},e),{jumpTime:c,getInstalledAppResult:null!==(t=null==A?void 0:A.length)&&void 0!==t?t:-1,getInstalledAppData:A,jumpTriggerType:"manual"});null==u||u(Object.assign({jumpTime:c},e)),null==v||v(Object.assign({eventType:n.START},B));const j=$&&(0,a.gb)({installedApps:A,launchType:i,experimentalEnableCoinApiOptimization:P}),U=R&&j&&x;if((0,o.SC)()){const[e,t]=s[0].split("://");return void y(`intent://${t}#Intent;scheme=${e};end`,b)}if(!D||l===o.wl.APP_LINK||R&&!U||D&&/FBAN|FBAV/gi.test(navigator.userAgent)&&!O){const e=_({processedSchemes:s,processedFallbackURL:L,useNewRedirectPath:S,region:null==w?void 0:w.region,launchType:i,useShortDl:I,autoFillWhiteList:M});return null==v||v(Object.assign({eventType:n.APP_LINK,appLinkUrl:e},B)),void y(e,b)}if(!O&&!j)for(const[t,r]of s.entries()){const i=Date.now();let s;if(null==v||v(Object.assign({eventType:n.SCHEME_START,schemeIndex:t,scheme:r},B)),y(r,b),"function"==typeof T)try{s=T(r,t)}catch(e){}else s=T;if(0===s)continue;const a=yield(0,o.hh)(s),l=Date.now()-i;if(null==p||p(Object.assign({jumpTime:c,linkType:(0,o.Aq)(r),checkTime:l,checkStatus:a},e)),null==v||v(Object.assign({eventType:n.CHECK,schemeIndex:t,scheme:r,checkTime:l,checkStatus:a},B)),a)return}let V=L;if(I){const{pathname:e}=new URL(V);e.includes(d)&&(V=f({url:V,autofillSchemeUrl:s[0],autoFillParamList:M,needAppendSchemeUrl:!0}))}null==h||h(Object.assign({jumpTime:c,fallbackUrl:V},e)),null==v||v(Object.assign({eventType:n.FAIL,fallbackUrl:V},B)),y(V,b)}catch(e){return void console.warn(e)}})}function b(e){const{experimentalUseShortDl:t=!1,autoFillWhiteList:r}=e.providerContext;try{const{processedSchemes:n,processedFallbackURL:i}=m({strategy:e});return _({processedSchemes:n,processedFallbackURL:i,launchType:e.launchType,useShortDl:t,autoFillWhiteList:r})}catch(e){return console.warn(e),""}}},73635:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.1718 23.9999L10.2931 13.1212C9.90261 12.7307 9.90261 12.0975 10.2931 11.707L11.7074 10.2928C12.0979 9.90228 12.731 9.90228 13.1216 10.2928L24.0002 21.1715L34.8789 10.2928C35.2694 9.90228 35.9026 9.90228 36.2931 10.2928L37.7073 11.707C38.0979 12.0975 38.0979 12.7307 37.7073 13.1212L26.8287 23.9999L37.7073 34.8786C38.0979 35.2691 38.0979 35.9023 37.7073 36.2928L36.2931 37.707C35.9026 38.0975 35.2694 38.0975 34.8789 37.707L24.0002 26.8283L13.1216 37.707C12.731 38.0975 12.0979 38.0975 11.7074 37.707L10.2931 36.2928C9.90261 35.9023 9.90261 35.2691 10.2931 34.8786L21.1718 23.9999Z"}))}},75778:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46ZM15.1466 30.7323L21.8788 24.0001L15.1466 17.2679C14.756 16.8774 14.756 16.2442 15.1466 15.8537L15.8537 15.1466C16.2442 14.756 16.8774 14.756 17.2679 15.1466L24.0001 21.8788L30.7323 15.1466C31.1229 14.756 31.756 14.756 32.1466 15.1466L32.8537 15.8537C33.2442 16.2442 33.2442 16.8774 32.8537 17.2679L26.1214 24.0001L32.8537 30.7323C33.2442 31.1229 33.2442 31.756 32.8537 32.1466L32.1466 32.8537C31.756 33.2442 31.1229 33.2442 30.7323 32.8537L24.0001 26.1214L17.2679 32.8537C16.8774 33.2442 16.2442 33.2442 15.8537 32.8537L15.1466 32.1466C14.756 31.756 14.756 31.1229 15.1466 30.7323Z"}))}},76943:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.9505 7.84001C24.3975 7.38666 23.6014 7.38666 23.0485 7.84003L6.94846 21.04C6.45839 21.4418 6.2737 22.1083 6.48706 22.705C6.70041 23.3017 7.26576 23.7 7.89949 23.7H10.2311L11.4232 36.7278C11.5409 38.0149 12.6203 39 13.9128 39H21.5C22.0523 39 22.5 38.5523 22.5 38V28.3153C22.5 27.763 22.9477 27.3153 23.5 27.3153H24.5C25.0523 27.3153 25.5 27.763 25.5 28.3153V38C25.5 38.5523 25.9477 39 26.5 39H34.0874C35.3798 39 36.4592 38.0149 36.577 36.7278L37.7691 23.7H40.1001C40.7338 23.7 41.2992 23.3017 41.5125 22.705C41.7259 22.1082 41.5412 21.4418 41.0511 21.04L24.9505 7.84001Z"}))}},78116:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 24C18.6274 24 24 18.6274 24 12C24 5.37258 18.6274 0 12 0C5.37258 0 0 5.37258 0 12C0 18.6274 5.37258 24 12 24Z",fill:"#FE2C55"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.7913 7.1875C18.6796 6.99413 18.4733 6.875 18.25 6.875H5.75001C5.50258 6.875 5.27845 7.02097 5.17839 7.24727C5.07834 7.47356 5.1212 7.73758 5.28771 7.9206L8.55021 11.5065C8.72305 11.6965 8.9945 11.7614 9.23456 11.6702L13.7656 9.94799C13.8184 9.92795 13.8423 9.93624 13.8527 9.94039C13.871 9.94765 13.8971 9.96649 13.9177 10.0013C13.9382 10.0361 13.9421 10.0681 13.9396 10.0876C13.9382 10.0987 13.9339 10.1237 13.8909 10.1602L10.1707 13.3155C9.97902 13.4782 9.90339 13.7398 9.97878 13.9796L11.4038 18.5124C11.4781 18.749 11.6853 18.9192 11.9317 18.9463C12.1781 18.9734 12.4173 18.8522 12.5413 18.6375L18.7913 7.81251C18.9029 7.61913 18.9029 7.38088 18.7913 7.1875Z",fill:"white"}))}},79279:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23 8V28.7803L12.0371 19.0823C11.8302 18.8993 11.5143 18.9187 11.3313 19.1255L10.6687 19.8745C10.4858 20.0813 10.5051 20.3973 10.7119 20.5803L23.3374 31.749C23.7158 32.0837 24.2843 32.0837 24.6626 31.749L37.2881 20.5803C37.4949 20.3973 37.5143 20.0813 37.3313 19.8745L36.6687 19.1255C36.4858 18.9187 36.1698 18.8993 35.9629 19.0823L25 28.7803V8C25 7.72386 24.7761 7.5 24.5 7.5H23.5C23.2239 7.5 23 7.72386 23 8ZM12.5 37C12.2239 37 12 37.2239 12 37.5V38.5C12 38.7761 12.2239 39 12.5 39H35.5C35.7761 39 36 38.7761 36 38.5V37.5C36 37.2239 35.7761 37 35.5 37H12.5Z"}))}},79398:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M69.07 1.39049C69.4326 1.6902 69.6425 2.13608 69.6425 2.60649V55.4412C69.6618 55.5966 69.6718 55.755 69.6718 55.9158V58.8542C69.6718 62.9423 66.3577 66.2564 62.2696 66.2564H53.9206C50.0147 66.2564 46.8484 63.09 46.8484 59.1841C46.8484 55.2782 50.0147 52.1119 53.9206 52.1119H65.8679C66.0788 52.1119 66.2856 52.129 66.4872 52.162V4.51509L24.8515 12.4916V60.1579C24.8707 60.3128 24.8806 60.4706 24.8806 60.6307V63.5691C24.8806 67.6572 21.5665 70.9713 17.4784 70.9713H9.12941C5.22351 70.9713 2.05716 67.805 2.05716 63.8991C2.05716 59.9932 5.22352 56.8268 9.12942 56.8268H21.0767C21.2877 56.8268 21.4946 56.844 21.6962 56.877V11.1875C21.6962 10.4306 22.2337 9.78043 22.977 9.63802L67.768 1.05702C68.23 0.968504 68.7074 1.09078 69.07 1.39049ZM21.6962 60.438C21.6141 60.1739 21.3678 59.9821 21.0767 59.9821H9.12942C6.96615 59.9821 5.21248 61.7358 5.21248 63.8991C5.21248 66.0623 6.96615 67.816 9.12941 67.816H17.4784C19.6699 67.816 21.4737 66.1561 21.7011 64.0249C21.6979 63.9835 21.6962 63.9417 21.6962 63.8994V60.438ZM66.4872 58.996V55.7224C66.4049 55.4586 66.1588 55.2672 65.8679 55.2672H53.9206C51.7573 55.2672 50.0037 57.0208 50.0037 59.1841C50.0037 61.3474 51.7573 63.1011 53.9206 63.1011H62.2696C64.4949 63.1011 66.3205 61.3895 66.5017 59.211C66.4921 59.1407 66.4872 59.0689 66.4872 58.996Z"}))}},80752:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 33 32",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M8.5417 16.9942L13.4398 4.39003C13.5312 4.15501 13.7588 4 14.0126 4H22.2303C22.6768 4 22.9739 4.45799 22.7892 4.86138L19.7413 11.516C19.5565 11.9194 19.8537 12.3774 20.3002 12.3774H23.885C24.3889 12.3774 24.6782 12.9467 24.3787 13.3488L13.653 27.7504C13.2651 28.2712 12.4348 27.9113 12.5561 27.2749L14.221 18.5453C14.2926 18.1701 14.0026 17.8227 13.6178 17.8227H9.11448C8.68341 17.8227 8.38658 17.3934 8.5417 16.9942Z"}))}},81887:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M50.7571 1.16743C51.2866 1.22458 51.6695 1.70014 51.6124 2.22962L49.2242 24.3565H65.3287C65.8612 24.3565 66.293 24.7882 66.293 25.3208V26.5552C66.293 27.0877 65.8612 27.5194 65.3287 27.5194H48.8829L47.0243 44.7401H65.3287C65.8612 44.7401 66.293 45.1718 66.293 45.7044V46.9388C66.293 47.4713 65.8612 47.903 65.3287 47.903H46.6829L44.2855 70.1162C44.2283 70.6457 43.7528 71.0286 43.2233 70.9714L41.9961 70.839C41.4666 70.7818 41.0837 70.3063 41.1408 69.7768L43.5016 47.903H26.461L24.0636 70.1162C24.0065 70.6457 23.5309 71.0286 23.0014 70.9714L21.7742 70.839C21.2447 70.7818 20.8618 70.3063 20.9189 69.7768L23.2797 47.903H6.10714C5.57458 47.903 5.14285 47.4713 5.14285 46.9388V45.7044C5.14285 45.1718 5.57458 44.7401 6.10714 44.7401H23.6211L25.4797 27.5194H6.10714C5.57458 27.5194 5.14285 27.0877 5.14285 26.5552V25.3208C5.14285 24.7882 5.57458 24.3565 6.10714 24.3565H25.8211L28.2458 1.89022C28.303 1.36073 28.7785 0.97783 29.308 1.03498L30.5352 1.16743C31.0647 1.22458 31.4476 1.70014 31.3905 2.22962L29.0024 24.3565H46.0429L48.4677 1.89022C48.5248 1.36073 49.0004 0.97783 49.5299 1.03498L50.7571 1.16743ZM28.661 27.5194L26.8024 44.7401H43.843L45.7016 27.5194H28.661Z"}))}},82436:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 24C6 14.0589 14.0589 6 24 6C33.9411 6 42 14.0589 42 24C42 33.9411 33.9411 42 24 42C14.0589 42 6 33.9411 6 24ZM24 2C11.8497 2 2 11.8497 2 24C2 36.1503 11.8497 46 24 46C36.1503 46 46 36.1503 46 24C46 11.8497 36.1503 2 24 2ZM22 15V24C22 25.1046 22.8954 26 24 26H33C33.5523 26 34 25.5523 34 25V23C34 22.4477 33.5523 22 33 22H26V15C26 14.4477 25.5523 14 25 14H23C22.4477 14 22 14.4477 22 15Z"}))}},82454:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M49.55 2.05728H38.1855V48.2983C38.1855 53.8078 33.8145 58.3336 28.375 58.3336C22.9355 58.3336 18.5646 53.8078 18.5646 48.2983C18.5646 42.8871 22.8384 38.4598 28.0836 38.263V26.6536C16.5248 26.8503 7.19997 36.3937 7.19997 48.2983C7.19997 60.3013 16.719 69.943 28.4721 69.943C40.2253 69.943 49.7443 60.2029 49.7443 48.2983V24.5875C54.0182 27.7358 59.2634 29.6051 64.8 29.7035V18.0941C56.2522 17.7989 49.55 10.7152 49.55 2.05728Z"}))}},83566:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 56 56",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M28.136 18.741C27.086 18.741 26.106 19.4202 25.4659 20.9074C25.3385 21.2034 25.011 21.3705 24.7054 21.2686L21.385 20.1618C21.0794 20.06 20.9127 19.729 21.031 19.4293C22.0833 16.7637 24.3746 14.0744 28.136 14.0744C32.0199 14.0744 35.1684 17.2229 35.1684 21.1068C35.1684 23.37 33.7882 25.2384 32.3604 26.4219C31.0527 27.5058 29.3169 28.3493 27.5438 28.5051C27.2228 28.5333 26.9612 28.2698 26.9612 27.9476V24.4476C26.9612 24.1254 27.2249 23.8635 27.538 23.7878C28.1002 23.6517 28.7735 23.3336 29.3824 22.829C30.2427 22.1159 30.5018 21.439 30.5018 21.1068C30.5018 19.8002 29.4426 18.741 28.136 18.741Z"}),n.createElement("path",{d:"M30.3333 32.741C30.3333 34.0297 29.2886 35.0744 28 35.0744C26.7113 35.0744 25.6666 34.0297 25.6666 32.741C25.6666 31.4524 26.7113 30.4077 28 30.4077C29.2886 30.4077 30.3333 31.4524 30.3333 32.741Z"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.62496 5.8335C6.88655 5.8335 4.66663 8.05341 4.66663 10.7918V50.1668C4.66663 51.1106 5.23512 51.9614 6.10703 52.3226C6.97894 52.6837 7.98255 52.4841 8.64987 51.8167L17.154 43.3127H46.375C49.1134 43.3127 51.3333 41.0927 51.3333 38.3543V10.7918C51.3333 8.05344 49.1134 5.8335 46.375 5.8335H9.62496ZM14.5375 39.3294L9.33329 44.5337V10.7918C9.33329 10.6307 9.46388 10.5002 9.62496 10.5002H46.375C46.536 10.5002 46.6666 10.6307 46.6666 10.7918V38.3543C46.6666 38.5154 46.536 38.646 46.375 38.646H16.1875C15.5686 38.646 14.9751 38.8918 14.5375 39.3294Z"}))}},84783:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 16 16",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 2.5C7.58579 2.5 7.25 2.83579 7.25 3.25V7.25H3.25C2.83579 7.25 2.5 7.58579 2.5 8C2.5 8.41421 2.83579 8.75 3.25 8.75H7.25V12.75C7.25 13.1642 7.58579 13.5 8 13.5C8.41421 13.5 8.75 13.1642 8.75 12.75V8.75H12.75C13.1642 8.75 13.5 8.41421 13.5 8C13.5 7.58579 13.1642 7.25 12.75 7.25H8.75V3.25C8.75 2.83579 8.41421 2.5 8 2.5Z"}))}},84879:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 48C37.2548 48 48 37.2548 48 24C48 10.7452 37.2548 0 24 0C10.7452 0 0 10.7452 0 24C0 37.2548 10.7452 48 24 48Z",fill:"#0DBEF3"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.6327 14.8957C12.4779 14.8957 11.5417 15.8318 11.5417 16.9866V31.0131C11.5417 32.1679 12.4779 33.104 13.6327 33.104H34.3675C35.5223 33.104 36.4584 32.1679 36.4584 31.0131V16.9866C36.4584 15.8318 35.5223 14.8957 34.3675 14.8957H13.6327ZM33.7214 17.3809L24.0001 24.1142L14.2788 17.3809C13.9321 17.1407 13.4584 17.3889 13.4584 17.8106V19.0944L24.0001 26.396L34.5418 19.0944V17.8106C34.5418 17.3889 34.0681 17.1407 33.7214 17.3809Z",fill:"white"}))}},85576:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 20 20",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.496 1.25L4.49737 1.25L15.4466 1.25C15.8518 1.25074 16.2496 1.3722 16.5849 1.60147L16.5886 1.60401C16.9378 1.8459 17.2023 2.19274 17.3372 2.59729L18.5939 5.87674C18.7775 6.34467 18.7999 6.85844 18.657 7.3405C18.5201 7.80257 18.2398 8.20704 17.8609 8.50268V17C17.8609 17.9665 17.0774 18.75 16.1109 18.75H3.88867C2.92218 18.75 2.13867 17.9665 2.13867 17V8.49262C1.75629 8.19412 1.47438 7.78473 1.33896 7.31707C1.19689 6.82643 1.2258 6.30462 1.41987 5.8327L2.60345 2.60315C2.73771 2.19609 3.0031 1.84708 3.35401 1.60402L3.35771 1.60146C3.69298 1.37219 4.09076 1.25074 4.496 1.25ZM15.9434 8.94402C16.0821 8.96327 16.2216 8.97264 16.3609 8.97221V17C16.3609 17.1381 16.249 17.25 16.1109 17.25H12.5277V12.7778C12.5277 11.8113 11.7442 11.0278 10.7777 11.0278H9.22213C8.25563 11.0278 7.47213 11.8113 7.47213 12.7778V17.25H3.88867C3.7506 17.25 3.63867 17.1381 3.63867 17V8.97213C3.78254 8.97324 3.92669 8.9639 4.0699 8.94402L4.07813 8.94288L4.08634 8.94156C4.56528 8.86421 5.01217 8.64712 5.36512 8.31466C5.47088 8.21534 5.61921 8.15477 5.77963 8.15477C5.94018 8.15477 6.08862 8.21544 6.1944 8.3149L6.20021 8.32037L6.20613 8.3257C6.66652 8.74051 7.26858 8.96696 7.88873 8.96696C8.50887 8.96696 9.11093 8.74051 9.57132 8.3257L9.57622 8.32129L9.58105 8.31678C9.69006 8.21503 9.84231 8.15323 10.0067 8.15323C10.171 8.15323 10.3233 8.21503 10.4323 8.31678L10.4371 8.32129L10.442 8.3257C10.9024 8.74051 11.5045 8.96696 12.1246 8.96696C12.7448 8.96696 13.3468 8.74051 13.8072 8.3257L13.8131 8.32037L13.8189 8.3149C13.9247 8.21544 14.0732 8.15477 14.2337 8.15477C14.3941 8.15477 14.5425 8.21534 14.6482 8.31466C15.0012 8.64712 15.4481 8.86421 15.927 8.94156L15.9352 8.94288L15.9434 8.94402ZM5.36512 8.31466L5.36486 8.3149L4.85118 7.7686L5.36544 8.31436L5.36512 8.31466ZM8.97213 17.25H11.0277V12.7778C11.0277 12.6397 10.9158 12.5278 10.7777 12.5278H9.22213C9.08406 12.5278 8.97213 12.6397 8.97213 12.7778V17.25ZM4.49819 2.75C4.39077 2.7503 4.2888 2.78251 4.20626 2.8384C4.11633 2.90128 4.05566 2.98632 4.02675 3.07674L4.02197 3.09167L2.81662 6.38061L2.80971 6.39701C2.74188 6.55803 2.73176 6.73407 2.77977 6.89985C2.82664 7.06173 2.92822 7.21064 3.07584 7.32105C3.12563 7.35304 3.17767 7.38205 3.23168 7.40785C3.43209 7.46944 3.64533 7.48729 3.85508 7.45943C4.04086 7.42787 4.2083 7.3437 4.33675 7.22266L4.33733 7.22212C4.72746 6.85528 5.24576 6.65477 5.77963 6.65477C6.31017 6.65477 6.82533 6.85279 7.21462 7.21528C7.39326 7.37421 7.63367 7.46696 7.88873 7.46696C8.14414 7.46696 8.38487 7.37395 8.56359 7.21461C8.95574 6.85148 9.47352 6.65323 10.0067 6.65323C10.5398 6.65323 11.0576 6.85148 11.4497 7.21461C11.6285 7.37395 11.8692 7.46696 12.1246 7.46696C12.3797 7.46696 12.6201 7.37421 12.7987 7.21527C13.188 6.85279 13.7032 6.65477 14.2337 6.65477C14.7676 6.65477 15.2859 6.85528 15.676 7.22212L15.6766 7.22266C15.805 7.3437 15.9725 7.42786 16.1583 7.45943C16.368 7.48729 16.5812 7.46943 16.7817 7.40785C16.8344 7.38263 16.8854 7.35434 16.9341 7.32321C17.075 7.21465 17.1725 7.0706 17.2189 6.91419C17.2667 6.75279 17.2594 6.58136 17.1971 6.42333L17.1957 6.41998L15.9223 3.09691L15.9158 3.07674C15.8869 2.98631 15.8263 2.90127 15.7363 2.83839C15.6538 2.7825 15.5518 2.7503 15.4444 2.75H4.49819Z"}))}},85767:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M34.4961 70.3557C34.7809 70.7422 35.2335 70.971 35.7166 70.971C36.1997 70.971 36.6522 70.7422 36.937 70.3557L45.7854 58.5121H65.6332C67.6978 58.5121 69.376 56.834 69.376 54.7693V4.77091C69.376 2.70629 67.6978 1.02815 65.6332 1.02815H5.79989C3.73527 1.02815 2.05713 2.70629 2.05713 4.77091V54.7693C2.05713 56.834 3.73527 58.5121 5.79989 58.5121H25.6477L34.4961 70.3557ZM5.10829 4.77135C5.10829 4.38996 5.4185 4.07976 5.79989 4.07976H65.6281C66.0095 4.07976 66.3197 4.38996 66.3197 4.77135V54.7749C66.3197 55.1562 66.0095 55.4665 65.6281 55.4665H45.0175C44.5395 55.4665 44.0869 55.6902 43.7971 56.0767L35.7166 66.8981L27.6361 56.0767C27.3513 55.6902 26.8987 55.4614 26.4156 55.4614H5.79989C5.4185 55.4614 5.10829 55.1512 5.10829 54.7698V4.77135Z"}),n.createElement("path",{d:"M49.6956 31.2955H21.7368C20.8926 31.2955 20.2112 30.6141 20.2112 29.7699C20.2112 28.9258 20.8926 28.2443 21.7368 28.2443H49.6956C50.5398 28.2443 51.2212 28.9258 51.2212 29.7699C51.2212 30.6141 50.5398 31.2955 49.6956 31.2955Z"}))}},85885:function(e,t,r){!function(e){"use strict";function t(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}l((n=n.apply(e,t||[])).next())})}let n="";function i(e=""){return`02${Date.now()}`+(n||(n=function(e){const t=/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/.test(e),r=/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/.test(e);return t?function(e){const t=e.split(/\./).map(e=>{return t=e,(Array(8).join("0")+parseInt(t,10).toString(2)).slice(-8);var t}),r=[];return r[0]=s(t[0]+t[1]),r[1]=s(t[2]+t[3]),["0000","0000","0000","0000","0000","ffff",r[0],r[1]].join("")}(e):r?function(e){let t="";const r=[];let n=0,i=0,o=!0;const s="0000";if(e.indexOf("::")>-1){const a=e.split("::");for(let e=0;e<a.length;e++){const t=a[e];if(t.indexOf(":")>0){const e=t.split(":");o&&(n=e.length),i+=e.length;for(let t=0;t<e.length;t++)if(4!==e[t].length){const n=s.substring(0,4-e[t].length).concat(e[t]);r.push(n)}else r.push(e[t]);o=!1}else{if(4!==t.length){const e=s.substring(0,4-t.length).concat(t);r.push(e)}else r.push(t);o&&(n+=1),i+=1,o=!1}}let l="";for(let e=0;e<8-i;e++)l=l.concat(s);for(let e=0;e<r.length;e++)e===n?(t=t.concat(l),t=t.concat(r[e])):t=t.concat(r[e]);return t}{const r=e.split(":");for(let e=0;e<r.length;e++){const n=r[e];if(4!==r[e].length){const i=s.substring(0,4-r[e].length).concat(n);t=t.concat(i)}else t=t.concat(n)}return t}}(e):"00000000000000000000000000000000"}(e)))+Math.random().toString(16).slice(-6)}function o(){return 1e4*Date.now()+Math.floor(1e4*Math.random())}function s(e){return(Array(4).join("0")+parseInt(e,2).toString(16)).slice(-4)}function a(e,t){const r=e.key;void 0!==r&&(A(t,10),E(t,r));const n=e.value;void 0!==n&&(A(t,18),E(t,n))}function l(e){const t={};e:for(;!m(e);){const r=O(e);switch(r>>>3){case 0:break e;case 1:t.key=C(e,O(e));break;case 2:t.value=C(e,O(e));break;default:h(e,7&r)}}if(void 0===t.key)throw new Error("Missing required field: key");if(void 0===t.value)throw new Error("Missing required field: value");return t}function c(e){const t=_();return function(e,t){const r=e.SeqID;void 0!==r&&(A(t,8),P(t,r));const n=e.LogID;void 0!==n&&(A(t,16),P(t,n));const i=e.service;void 0!==i&&(A(t,24),P(t,p(i)));const o=e.method;void 0!==o&&(A(t,32),P(t,p(o)));const s=e.headers;if(void 0!==s)for(const e of s){A(t,42);const r=_();a(e,r),A(t,r.limit),k(t,r),y(r)}const l=e.payloadEncoding;void 0!==l&&(A(t,50),E(t,l));const c=e.payloadType;void 0!==c&&(A(t,58),E(t,c));const u=e.payload;void 0!==u&&(A(t,66),A(t,u.length),function(e,t){const r=v(e,t.length);e.bytes.set(t,r)}(t,u));const d=e.LogIDNew;void 0!==d&&(A(t,74),E(t,d))}(e,t),function(e){const t=e.bytes,r=e.limit;return t.length===r?t:t.subarray(0,r)}(t)}function u(e){return function(e){const t={};e:for(;!m(e);){const r=O(e);switch(r>>>3){case 0:break e;case 1:t.SeqID=$(e,!0);break;case 2:t.LogID=$(e,!0);break;case 3:t.service=O(e);break;case 4:t.method=O(e);break;case 5:{const r=d(e);(t.headers||(t.headers=[])).push(l(e)),e.limit=r;break}case 6:t.payloadEncoding=C(e,O(e));break;case 7:t.payloadType=C(e,O(e));break;case 8:t.payload=w(e,O(e));break;case 9:t.LogIDNew=C(e,O(e));break;default:h(e,7&r)}}if(void 0===t.SeqID)throw new Error("Missing required field: SeqID");if(void 0===t.LogID)throw new Error("Missing required field: LogID");if(void 0===t.service)throw new Error("Missing required field: service");if(void 0===t.method)throw new Error("Missing required field: method");return t}({bytes:t=e,offset:0,limit:t.length});var t}function d(e){const t=O(e),r=e.limit;return e.limit=e.offset+t,r}function h(e,t){switch(t){case 0:for(;128&T(e););break;case 2:g(e,O(e));break;case 5:g(e,4);break;case 1:g(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function p(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}const f=[];function _(){const e=f.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function y(e){f.push(e)}function g(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function m(e){return e.offset>=e.limit}function v(e,t){const r=e.bytes,n=e.offset,i=e.limit,o=n+t;if(o>r.length){const t=new Uint8Array(2*o);t.set(r),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),n}function b(e,t){const r=e.offset;if(r+t>e.limit)throw new Error("Read past limit");return e.offset+=t,r}function w(e,t){const r=b(e,t);return e.bytes.subarray(r,r+t)}function C(e,t){const r=b(e,t),n=String.fromCharCode,i=e.bytes,o="�";let s="";for(let e=0;e<t;e++){const a=i[e+r];let l,c,u,d;128&a?192==(224&a)?e+1>=t?s+=o:(l=i[e+r+1],128!=(192&l)?s+=o:(d=(31&a)<<6|63&l,d<128?s+=o:(s+=n(d),e++))):224==(240&a)?e+2>=t?s+=o:(l=i[e+r+1],c=i[e+r+2],32896!=(49344&(l|c<<8))?s+=o:(d=(15&a)<<12|(63&l)<<6|63&c,d<2048||d>=55296&&d<=57343?s+=o:(s+=n(d),e+=2))):240==(248&a)?e+3>=t?s+=o:(l=i[e+r+1],c=i[e+r+2],u=i[e+r+3],8421504!=(12632256&(l|c<<8|u<<16))?s+=o:(d=(7&a)<<18|(63&l)<<12|(63&c)<<6|63&u,d<65536||d>1114111?s+=o:(d-=65536,s+=n(55296+(d>>10),56320+(1023&d)),e+=3))):s+=o:s+=n(a)}return s}function E(e,t){const r=t.length;let n=0;for(let e=0;e<r;e++){let i=t.charCodeAt(e);i>=55296&&i<=56319&&e+1<r&&(i=(i<<10)+t.charCodeAt(++e)-56613888),n+=i<128?1:i<2048?2:i<65536?3:4}A(e,n);let i=v(e,n);const o=e.bytes;for(let e=0;e<r;e++){let n=t.charCodeAt(e);n>=55296&&n<=56319&&e+1<r&&(n=(n<<10)+t.charCodeAt(++e)-56613888),n<128?o[i++]=n:(n<2048?o[i++]=n>>6&31|192:(n<65536?o[i++]=n>>12&15|224:(o[i++]=n>>18&7|240,o[i++]=n>>12&63|128),o[i++]=n>>6&63|128),o[i++]=63&n|128)}}function k(e,t){const r=v(e,t.limit),n=e.bytes,i=t.bytes;for(let e=0,o=t.limit;e<o;e++)n[e+r]=i[e]}function T(e){return e.bytes[b(e,1)]}function S(e,t){const r=v(e,1);e.bytes[r]=t}function O(e){let t,r=0,n=0;do{t=T(e),r<32&&(n|=(127&t)<<r),r+=7}while(128&t);return n}function A(e,t){for(t>>>=0;t>=128;)S(e,127&t|128),t>>>=7;S(e,t)}function $(e,t){let r,n=0,i=0,o=0;return r=T(e),n=127&r,128&r&&(r=T(e),n|=(127&r)<<7,128&r&&(r=T(e),n|=(127&r)<<14,128&r&&(r=T(e),n|=(127&r)<<21,128&r&&(r=T(e),i=127&r,128&r&&(r=T(e),i|=(127&r)<<7,128&r&&(r=T(e),i|=(127&r)<<14,128&r&&(r=T(e),i|=(127&r)<<21,128&r&&(r=T(e),o=127&r,128&r&&(r=T(e),o|=(127&r)<<7))))))))),{low:n|i<<28,high:i>>>4|o<<24,unsigned:t}}function P(e,t){const r=t.low>>>0,n=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===n?r<16384?r<128?1:2:r<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:i<128?9:10,s=v(e,o),a=e.bytes;switch(o){case 10:a[s+9]=i>>>7&1;case 9:a[s+8]=9!==o?128|i:127&i;case 8:a[s+7]=8!==o?n>>>21|128:n>>>21&127;case 7:a[s+6]=7!==o?n>>>14|128:n>>>14&127;case 6:a[s+5]=6!==o?n>>>7|128:n>>>7&127;case 5:a[s+4]=5!==o?128|n:127&n;case 4:a[s+3]=4!==o?r>>>21|128:r>>>21&127;case 3:a[s+2]=3!==o?r>>>14|128:r>>>14&127;case 2:a[s+1]=2!==o?r>>>7|128:r>>>7&127;case 1:a[s]=1!==o?128|r:127&r}}function R(e){return u(e)}function x(e){return c(e)}const L=4294967296,I=0x10000000000000000,M=I/2,D=String.prototype.charCodeAt;class B{constructor(e,t,r){this.isLong=!0,this.low=0|e,this.high=0|t,this.unsigned=!!r}static isLong(e){return e&&!0===e.isLong}static fromBits(e,t,r){return new B(e,t,r)}static fromBytes(e,t,r){return r?B.fromBytesLE(e,t):B.fromBytesBE(e,t)}static fromBytesLE(e,t){return new B(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)}static fromBytesBE(e,t){return new B(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}static fromHash(e){return"\0\0\0\0\0\0\0\0"===e?N:new B((D.call(e,0)|D.call(e,1)<<8|D.call(e,2)<<16|D.call(e,3)<<24)>>>0,(D.call(e,4)|D.call(e,5)<<8|D.call(e,6)<<16|D.call(e,7)<<24)>>>0,!0)}toHash(){return String.fromCharCode(255&this.low,this.low>>>8&255,this.low>>>16&255,this.low>>>24,255&this.high,this.high>>>8&255,this.high>>>16&255,this.high>>>24)}static fromNumber(e,t=!0){if(isNaN(e))return t?j:N;if(t){if(e>=I)return V}else{if(e<=-M)return F;if(e+1>=M)return U}return B.fromBits(e%L|0,e/L|0,t)}toNumber(){return this.unsigned?(this.high>>>0)*L+(this.low>>>0):this.high*L+(this.low>>>0)}isZero(){return 0===this.high&&0===this.low}add(e){B.isLong(e)||(e=B.fromNumber(e));const t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16;let l=0,c=0,u=0,d=0;return d+=i+(65535&e.low),u+=d>>>16,d&=65535,u+=n+a,c+=u>>>16,u&=65535,c+=r+s,l+=c>>>16,c&=65535,l+=t+o,l&=65535,B.fromBits(u<<16|d,l<<16|c,this.unsigned)}equals(e){return B.isLong(e)||(e=B.fromNumber(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low}addOne(){return-1===this.low&&-1===this.high?B.fromBits(0,0,this.unsigned):-1===this.low?B.fromBits(0,this.high+1,this.unsigned):B.fromBits(this.low+1,this.high,this.unsigned)}toBytes(e){return e?this.toBytesLE():this.toBytesBE()}toBytesLE(){const e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]}toBytesBE(){const e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]}}const N=new B(0,0,!1),j=new B(0,0,!0),U=B.fromBits(-1,2147483647,!1),V=B.fromBits(-1,-1,!0),F=B.fromBits(0,-2147483648,!1);var H;e.ErrorCode=void 0,(H=e.ErrorCode||(e.ErrorCode={}))[H.NATIVE_ERROR=5001]="NATIVE_ERROR",H[H.CONNECTING_ERROR=5002]="CONNECTING_ERROR",H[H.MAX_RETRIES_ERROR=5003]="MAX_RETRIES_ERROR",H[H.MESSAGE_ERROR=5004]="MESSAGE_ERROR",H[H.OPEN_ERROR=5005]="OPEN_ERROR";class G{constructor(e){this.type=e,this.target=null}}class W extends G{constructor(e,t){super(e),this.message=t&&t.message||null}}class q extends G{constructor(t,r){super(t),this.error=r&&r.error||null,this.colno=r&&r.colno||0,this.filename=r&&r.filename||"",this.lineno=r&&r.lineno||0,this.message=r&&r.message||"",this.code=r&&r.code||e.ErrorCode.NATIVE_ERROR}}class K extends G{constructor(e,t){super(e),this.code=t&&t.code||0,this.reason=t&&t.reason||"",this.wasClean=t&&t.wasClean||!1}}class z extends G{constructor(e,t){super(e),this.data=t&&t.data||null}}class Z extends z{constructor(e,t){super(e),this.data=t&&t.data||null,this.message=t&&t.message||null}}class Y extends G{constructor(e,t){super(e),this.data=t&&t.data||null}}function X(e,{message:t,code:r}){return new q(e,{message:t,code:r})}function Q(e,{code:t,reason:r,wasClean:n}){return"undefined"!=typeof CloseEvent?new CloseEvent(e,{code:t,reason:r,wasClean:n}):new K(e,{code:t,reason:r,wasClean:n})}class J{constructor(e,t){this.endpoints=e,this.maxRetries=t,this.currentIndex=0,this.currentEndpointTriesCount=0}resetEndpointConfig(){this.currentIndex=0,this.currentEndpointTriesCount=0}resetTries(){this.currentEndpointTriesCount=0}getCurrentEndpoint(){return this.endpoints[this.currentIndex]}getCurrentEndpointTriesCount(){return this.currentEndpointTriesCount}checkReachMaxTries(){return this.currentIndex>=this.endpoints.length||this.currentIndex===this.endpoints.length-1&&this.currentEndpointTriesCount===this.maxRetries}checkCurrentEndpointReachedMaxRetries(){return this.currentIndex==this.endpoints.length||this.currentEndpointTriesCount>this.maxRetries}replaceBackupEndpointAndUpdateCount(){return this.currentEndpointTriesCount=1,this.currentIndex++,this.endpoints[this.currentIndex]}getCurrentEndpointAndUpdateCount(){return this.currentEndpointTriesCount++,this.getCurrentEndpoint()}}const ee=("undefined"!=typeof globalThis&&"Window"===globalThis.constructor.name||"undefined"!=typeof window&&"Window"===window.constructor.name)&&"undefined"!=typeof document,te="undefined"!=typeof globalThis&&("Object"===globalThis.constructor.name||"DedicatedWorkerGlobalScope"===globalThis.constructor.name)&&"undefined"!=typeof tt,re=("undefined"!=typeof globalThis&&"Object"===globalThis.constructor.name||"undefined"==typeof globalThis||"undefined"!=typeof globalThis&&!!globalThis.WeixinJSBridge)&&"undefined"!=typeof wx,ne="undefined"!=typeof globalThis&&("DedicatedWorkerGlobalScope"===globalThis.constructor.name||"SharedWorkerGlobalScope"===globalThis.constructor.name||"ServiceWorkerGlobalScope"===globalThis.constructor.name)&&"undefined"!=typeof self,ie="undefined"!=typeof globalThis&&"Object"===globalThis.constructor.name&&"Object"===r.g.constructor.name&&"undefined"!=typeof process&&process.version;class oe{constructor(){this._listeners={}}emit(e,...t){const r=this._listeners[e];if(r)r.slice().forEach(e=>e.fn.apply(e.ctx,t));else if("error"===e&&!this.onerror){const e=t.length&&t[0];if(e instanceof Error)throw e;throw new Error("Unhandled error."+(e?" ("+e.message+")":"")).context=e,e}return this}off(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=null;else{const r=this._listeners[e];for(let e=0;e<r.length;)r[e].fn===t?r.splice(e,1):++e}return this}on(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this}}class se extends oe{constructor(e,t,r){super(),this._socket=null,re&&wx.connectSocket&&(this._socket=wx.connectSocket({url:e,protocols:t,header:r,fail:e=>{const t=X("error",{message:e.errMsg||e.errNo?`message: ${e.errMsg}`||`code: ${e.errNo}`||"":JSON.stringify(e)});this.emit("error",t)}})),te&&tt.connectSocket&&(this._socket=tt.connectSocket({url:e,protocols:t,header:r,fail:(e=>{const t=X("error",{message:e.errMsg||e.errNo?`message: ${e.errMsg}`||`code: ${e.errNo}`||"":JSON.stringify(e)});this.emit("error",t)}).bind(this)})),this._addWsListeners()}_addWsListeners(){this._socket.onOpen(e=>{this.emit("open",new Y("open",e))}),this._socket.onClose(e=>{this.emit("close",new K("close",e))}),this._socket.onMessage(e=>{this.emit("message",new Z("message",e))}),this._socket.onError(e=>{this.emit("error",new q("error",e))})}send(e){if(e instanceof Uint8Array){const t=e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset);this._socket&&this._socket.send({data:t,fail:e=>{this.emit("error",X("error",{message:e.errMsg||e.errNo?`message: ${e.errMsg}`||`code: ${e.errNo}`||"":JSON.stringify(e)}))}})}else this._socket&&this._socket.send({data:e,fail:e=>{this.emit("error",X("error",{message:e.errMsg||e.errNo?`message: ${e.errMsg}`||`code: ${e.errNo}`||"":JSON.stringify(e)}))}})}close(e,t){this._socket&&this._socket.close({code:e,reason:t})}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}get readyState(){return this._socket.readyState}get binaryType(){return this._socket.binaryType}set binaryType(e){}get url(){return this._socket.url}get protocol(){return this._socket.protocol}get extensions(){return this._socket.extensions}get bufferedAmount(){return 0}}function ae(e,t,r){return!!(null==e?void 0:e.find(e=>e.key===t&&e.value===r))}function le(e,t){var r;return null===(r=null==e?void 0:e.find(e=>e.key===t))||void 0===r?void 0:r.value}function ce(e){return t(this,void 0,void 0,function*(){const{enableAutoAck:t}=this._options,r=ae(e.message.headers,"need_ack","1"),n=ae(e.message.headers,"is_ack","1"),i=ae(e.message.headers,"x_frontier_qos_ack","1");if(t&&r){const{SeqID:t,LogID:r,service:n,LogIDNew:i,method:o}=e.message;this._sendAck({SeqID:t,LogID:r,LogIDNew:i,service:n,method:o,headers:[{key:"is_ack",value:"1"},{key:"ack_id",value:i||""},{key:"ack_code",value:"0"}]})}n&&!i&&this._dispatchAckMessageEvent(e)})}function ue(e){return t(this,void 0,void 0,function*(){if("string"==typeof e){const t=new Uint8Array(function(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t}(e));return function(e,t,r){const n=r;let i,o;for(let n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296==(64512&i)&&56320==(64512&(o=e.charCodeAt(n+1)))?(i=65536+((1023&i)<<10)+(1023&o),++n,t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}(e,t,0),t}return e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)})}function de(e){return t(this,void 0,void 0,function*(){const t=R(yield ue(e.data));try{if(t.payload instanceof Uint8Array){const e=this._options.payloadEncoding instanceof Object?{force:!!this._options.payloadEncoding.force,encoding:this._options.payloadEncoding.encoding?this._options.payloadEncoding.encoding.replace(/\s/g,"").toLowerCase():""}:{force:!1,encoding:this._options.payloadEncoding?this._options.payloadEncoding.replace(/\s/g,"").toLowerCase():""},r=t.payloadEncoding?t.payloadEncoding.replace(/\s/g,"").toLowerCase():"",n=this._options.payloadType instanceof Object?{force:!!this._options.payloadType.force,type:this._options.payloadType.type?this._options.payloadType.type.replace(/\s/g,"").toLowerCase():""}:{force:!1,type:this._options.payloadType?this._options.payloadType.replace(/\s/g,"").toLowerCase():""},i=t.payloadType?t.payloadType.replace(/\s/g,"").toLowerCase():"",o=n.force?n.type:i||n.type,s=e.force?e.encoding:r||e.encoding,a=["text/plain;charset=utf-8","application/json","application/json;charset=utf-8","string"],l=["none_none","binary"];this._options.enableTransformTextPayload&&a.includes(o)&&(!s||l.includes(s))?t.textPayload=function(e,t,r){if(r-t<1)return"";let n="";for(let i=t;i<r;){const t=e[i++];if(t<=127)n+=String.fromCharCode(t);else if(t>=192&&t<224)n+=String.fromCharCode((31&t)<<6|63&e[i++]);else if(t>=224&&t<240)n+=String.fromCharCode((15&t)<<12|(63&e[i++])<<6|63&e[i++]);else if(t>=240){const r=((7&t)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++])-65536;n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+(1023&r))}}return n}(t.payload,0,t.payload.byteLength):t.textPayload=""}else t.textPayload=""}catch(e){t.textPayload="",console.log(e)}e.message=t})}function he(e,t,r){let n=-1;return function t(i){return n++,n<r.length?r[n].bind(e)(i).then(()=>t(i)):Promise.resolve()}(t)}let pe,fe;const _e=new WeakMap,ye=new WeakMap,ge=new WeakMap,me=new WeakMap,ve=new WeakMap;let be={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return ye.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ge.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ee(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function we(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(fe||(fe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ke(this),t),Ee(_e.get(this))}:function(...t){return Ee(e.apply(ke(this),t))}:function(t,...r){const n=e.call(ke(this),t,...r);return ge.set(n,t.sort?t.sort():[t]),Ee(n)}}function Ce(e){return"function"==typeof e?we(e):(e instanceof IDBTransaction&&function(e){if(ye.has(e))return;const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),n()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});ye.set(e,t)}(e),t=e,(pe||(pe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,be):e);var t}function Ee(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Ee(e.result)),n()},o=()=>{r(e.error),n()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&_e.set(t,e)}).catch(()=>{}),ve.set(t,e),t}(e);if(me.has(e))return me.get(e);const t=Ce(e);return t!==e&&(me.set(e,t),ve.set(t,e)),t}const ke=e=>ve.get(e);const Te=["get","getKey","getAll","getAllKeys","count"],Se=["put","add","delete","clear"],Oe=new Map;function Ae(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Oe.get(t))return Oe.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,i=Se.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Te.includes(r))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(t.shift())),(await Promise.all([s[r](...t),i&&o.done]))[0]};return Oe.set(t,o),o}be=(e=>({...e,get:(t,r,n)=>Ae(t,r)||e.get(t,r,n),has:(t,r)=>!!Ae(t,r)||e.has(t,r)}))(be);class $e extends oe{constructor(){super(),this._qosDB=void 0,this._intervalTimeoutId=null,this._interval=36e5,this._init()}openDB(){return t(this,void 0,void 0,function*(){yield this._init()})}_init(){return t(this,void 0,void 0,function*(){return new Promise(e=>{this._qosDB?e(this):(function(e,t,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Ee(s);return n&&s.addEventListener("upgradeneeded",e=>{n(Ee(s.result),e.oldVersion,e.newVersion,Ee(s.transaction))}),r&&s.addEventListener("blocked",()=>r()),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}("frontier",1,{upgrade(e,t,r,n){e.createObjectStore("qos",{keyPath:"message_id"})}}).then(e=>{this._qosDB=e,this._intervalFlush(),this.emit("ready")}),this.on("ready",()=>{e(this),this.off()}))})})}_intervalFlush(){return t(this,void 0,void 0,function*(){clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=setInterval(()=>{this.flushExpired()},this._interval)})}get(e){var r;return t(this,void 0,void 0,function*(){return yield null===(r=this._qosDB)||void 0===r?void 0:r.get("qos",e)})}set(e,r){var n;return t(this,void 0,void 0,function*(){return yield null===(n=this._qosDB)||void 0===n?void 0:n.put("qos",{message_id:e,timestamp:r})})}del(e){var r;return t(this,void 0,void 0,function*(){return yield null===(r=this._qosDB)||void 0===r?void 0:r.delete("qos",e)})}clear(){var e;return t(this,void 0,void 0,function*(){return yield null===(e=this._qosDB)||void 0===e?void 0:e.clear("qos")})}keys(){var e;return t(this,void 0,void 0,function*(){return yield null===(e=this._qosDB)||void 0===e?void 0:e.getAllKeys("qos")})}getAll(){var e;return t(this,void 0,void 0,function*(){return yield null===(e=this._qosDB)||void 0===e?void 0:e.getAll("qos")})}flushExpired(){var e;return t(this,void 0,void 0,function*(){((yield null===(e=this._qosDB)||void 0===e?void 0:e.getAll("qos"))||[]).filter(({timestamp:e})=>e<Date.now()).forEach(e=>{var t;null===(t=this._qosDB)||void 0===t||t.delete("qos",e.message_id)})})}closeDB(){var e;return t(this,void 0,void 0,function*(){clearInterval(this._intervalTimeoutId),null===(e=this._qosDB)||void 0===e||e.close(),this._qosDB=void 0})}get isReady(){return this._qosDB}}class Pe{constructor(){this._qosDB=localStorage,this._intervalTimeoutId=null,this._interval=36e5,this._intervalFlush()}openDB(){return t(this,void 0,void 0,function*(){if(!this._intervalTimeoutId)return this._intervalFlush(),this})}_intervalFlush(){return t(this,void 0,void 0,function*(){clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=setInterval(()=>{this.flushExpired()},this._interval)})}_add_prefix(e){return`${this._prefix}${e}`}get _prefix(){return"frontier_qos_msg_id_"}get(e){return t(this,void 0,void 0,function*(){const t=this._qosDB.getItem(this._add_prefix(e));return JSON.parse(t||"{}")})}set(e,r){return t(this,void 0,void 0,function*(){return this._qosDB.setItem(this._add_prefix(e),JSON.stringify({message_id:e,timestamp:r}))})}del(e){return t(this,void 0,void 0,function*(){return this._qosDB.removeItem(this._add_prefix(e))})}clear(){return t(this,void 0,void 0,function*(){return this._qosDB.clear()})}keys(){return t(this,void 0,void 0,function*(){const e=[];for(let t=0;t<this._qosDB.length;t++)e.push(this._qosDB.key(t));return e.filter(e=>null==e?void 0:e.startsWith(this._prefix))})}getAll(){return t(this,void 0,void 0,function*(){const e=[],t=yield this.keys();for(const r in t){const t=this._qosDB.getItem(r);e.push(JSON.parse(t||"{}"))}return e})}flushExpired(){return t(this,void 0,void 0,function*(){((yield this.getAll())||[]).filter(({timestamp:e})=>e<Date.now()).forEach(e=>{this.del(e.message_id)})})}closeDB(){clearInterval(this._intervalTimeoutId)}get isReady(){return this._qosDB}}class Re{constructor(){this._qosDB=te?tt:re?wx:null,this._intervalTimeoutId=null,this._interval=36e5,this._intervalFlush()}openDB(){return t(this,void 0,void 0,function*(){if(!this._intervalTimeoutId)return this._intervalFlush(),this})}_intervalFlush(){return t(this,void 0,void 0,function*(){clearInterval(this._intervalTimeoutId),this._intervalTimeoutId=setInterval(()=>{this.flushExpired()},this._interval)})}_add_prefix(e){return`${this._prefix}${e}`}get _prefix(){return"frontier_qos_msg_id_"}get(e){return t(this,void 0,void 0,function*(){const t=this._qosDB.getStorageSync(this._add_prefix(e));return JSON.parse(t||"{}")})}set(e,r){return t(this,void 0,void 0,function*(){return this._qosDB.setStorageSync(this._add_prefix(e),JSON.stringify({message_id:e,timestamp:r}))})}del(e){return t(this,void 0,void 0,function*(){return this._qosDB.removeStorageSync(this._add_prefix(e))})}clear(){return t(this,void 0,void 0,function*(){return this._qosDB.clearStorageSync()})}keys(){return t(this,void 0,void 0,function*(){const{keys:e}=this._qosDB.getStorageInfoSync();return e.filter(e=>null==e?void 0:e.startsWith(this._prefix))})}getAll(){return t(this,void 0,void 0,function*(){const e=[],t=yield this.keys();for(const r of t){const t=yield this.get(r);e.push(t)}return e})}flushExpired(){return t(this,void 0,void 0,function*(){((yield this.getAll())||[]).filter(({timestamp:e})=>e<Date.now()).forEach(e=>{this.del(e.message_id)})})}closeDB(){clearInterval(this._intervalTimeoutId)}get isReady(){return this._qosDB}}function xe(){return te||te?new Re:(ee||ne)&&void 0!==typeof indexedDB?new $e:(ee||ne)&&void 0!==typeof localStorage?new Pe:null}function Le(e){var r,n,i,o;return t(this,void 0,void 0,function*(){const t=ae(e.message.headers,"code","-1"),s=ae(e.message.headers,"is_ack","1"),a=le(e.message.headers,"x_frontier_msgid"),l=Number(le(e.message.headers,"x_frontier_ttl"))||0,c=ae(e.message.headers,"x_frontier_qos","2");if(!ae(e.message.headers,"x_frontier_qos_ack","1")||!c)if(c&&!this._qosDB&&(this._qosDB=xe(),this._qosDB&&(yield this._qosDB.openDB())),c&&!this._qosDB.isReady&&(yield this._qosDB.openDB()),e.message.service>0&&s&&!t){if(a&&c)return void(!!(yield null===(r=this._qosDB)||void 0===r?void 0:r.get(a))||(this._dispatchMessageEvent(e),yield null===(n=this._qosDB)||void 0===n?void 0:n.set(a,Date.now()+l)));this._dispatchMessageEvent(e)}else if(e.message.service>0){if(a&&c)return void(!!(yield null===(i=this._qosDB)||void 0===i?void 0:i.get(a))||(this._dispatchMessageEvent(e),yield null===(o=this._qosDB)||void 0===o?void 0:o.set(a,Date.now()+l)));this._dispatchMessageEvent(e)}})}function Ie(e){return t(this,void 0,void 0,function*(){this._uptimeTimeoutId=setTimeout((()=>Me.bind(this)(e)).bind(this),this._options.uptimeInterval)})}function Me(e){var r,n;return t(this,void 0,void 0,function*(){if(!this._ws||this._ws.readyState!==this.OPEN)return;const{pingInterval:t}=this._options;null===(r=this._endpointManager)||void 0===r||r.resetEndpointConfig();for(let e=0;e<this._messageQueue.length;e++){const t=this._messageQueue[e];if(this._ws.readyState!==this.OPEN||null===t)break;this._ws&&this._ws.send(t),this._messageQueue[e]=null}this._messageQueue=this._messageQueue.filter(e=>Boolean(e)),this._pingPongTimeoutId=setTimeout(()=>this._ping(),t),this._dispatchOpenEvent(e),this._isBrowser&&this._ws&&(this._ws.binaryType=this._binaryType);const i=null===(n=this._endpointManager)||void 0===n?void 0:n.getCurrentEndpoint();this._debug(`open ${i} success`)})}function De(){return t(this,void 0,void 0,function*(){this._isInit=!1,clearTimeout(this._connectionTimeoutId)})}function Be(e){var r,n;return t(this,void 0,void 0,function*(){const t=ae(e.message.headers,"x_frontier_qos","2"),i=ae(e.message.headers,"x_frontier_is_ack","1"),o=null===(r=le(e.message.headers,"x_frontier_ack_msgid"))||void 0===r?void 0:r.split(",");if(t&&!this._qosDB&&(this._qosDB=xe(),this._qosDB&&(yield this._qosDB.openDB())),t&&!this._qosDB.isReady&&(yield this._qosDB.openDB()),t&&i&&o&&o.length)for(const e of o)yield null===(n=this._qosDB)||void 0===n?void 0:n.del(e)})}e.CustomCloseEvent=K,e.CustomErrorEvent=q,e.Event=G,e.FWS=class extends oe{constructor(r){super(),this._miniNavigatorOnline=!0,this._isBrowser=ee,this._isNode=ie,this._isMiniTT=te,this._isMiniWX=re,this._isWorker=ne,this._messageQueue=[],this._endpointManager=null,this._readyClosed=!1,this._binaryType="arraybuffer",this._connectLock=!1,this._connectionTimeoutId=null,this._uptimeTimeoutId=null,this._reconnectTimeoutId=null,this._pingPongTimeoutId=null,this._seqId=0,this._isInit=!1,this._url="",this._qosDB=null,this._protocols="pbbp2",this.CLOSED=3,this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this._onOpen=t=>{he(this,t,[De,Ie]).then(()=>{var e;const t=null===(e=this._endpointManager)||void 0===e?void 0:e.getCurrentEndpoint();this._debug(`open ${t}`)}).catch(t=>{const r=X("error",{message:t.message,code:e.ErrorCode.OPEN_ERROR});this._dispatchErrorEvent(r)})},this._onMessage=r=>t(this,void 0,void 0,function*(){const{pingInterval:t,pingFrequency:n}=this._options;clearTimeout(this._reconnectTimeoutId),"hi"!==r.data&&"auto"!==n||(clearTimeout(this._pingPongTimeoutId),this._pingPongTimeoutId=setTimeout(()=>this._ping(),t)),"hi"!==r.data&&he(this,r,[de,ce,Be,Le]).then(()=>{this._debug("received",r.message)}).catch(t=>{const r=X("error",{message:t.message,code:e.ErrorCode.MESSAGE_ERROR});this._dispatchErrorEvent(r)})}),this._onError=t=>{var r,n;const i=null===(r=this._endpointManager)||void 0===r?void 0:r.checkReachMaxTries(),o=null===(n=this._endpointManager)||void 0===n?void 0:n.getCurrentEndpoint();if(i&&!t.message){const t=`connect ${o} fail, max retries reached`;return void this._dispatchErrorEvent(X("error",{message:t,code:e.ErrorCode.MAX_RETRIES_ERROR}))}this._ws&&this._ws.readyState===this.OPEN&&this._disconnect(),this._dispatchErrorEvent(X("error",{message:t.message,code:e.ErrorCode.NATIVE_ERROR}))},this._onClose=e=>t(this,void 0,void 0,function*(){var t,r,n,i,o,s,a,l;this._clearTimer(),this._clearPingTimer(),this._removeWsListeners(),this._connectLock=!1;const c=null===(t=this._endpointManager)||void 0===t?void 0:t.checkReachMaxTries();if(!c&&this._navigatorOnline()&&!this._readyClosed){const t=null===(r=this._endpointManager)||void 0===r?void 0:r.getCurrentEndpoint();return this._dispatchCloseEvent(Q("close",{code:1006,reason:e.reason||`connecting failed, unknown reason, hostname: ${t}`})),void(this._options.reconnectInterceptor(e.code,e.reason)&&this._connect())}if(1e3!==e.code&&this._readyClosed)return this._dispatchCloseEvent(Q("close",{code:1e3,reason:"bye"})),void(null===(n=this._endpointManager)||void 0===n||n.resetEndpointConfig());if(1e3!==e.code&&c){const t=null===(i=this._endpointManager)||void 0===i?void 0:i.getCurrentEndpoint();let r=e.reason;return r=r?`connecting failed, ${r}, hostname: ${t}, max retries reached`:`connecting failed, unknown reason, hostname: ${t}, max retries reached`,this._dispatchCloseEvent(Q("close",{code:e.code,reason:r})),void(null===(o=this._endpointManager)||void 0===o||o.resetEndpointConfig())}if(1e3!==e.code&&!e.reason){const t=null===(s=this._endpointManager)||void 0===s?void 0:s.getCurrentEndpoint();return this._dispatchCloseEvent(Q("close",{code:e.code,reason:`connecting failed, unknown reason, hostname: ${t}`})),void(null===(a=this._endpointManager)||void 0===a||a.resetEndpointConfig())}this._dispatchCloseEvent(e),null===(l=this._endpointManager)||void 0===l||l.resetEndpointConfig()}),this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.onStartReconnect=null,this.onReceiveAck=null,this.onStopImmediatelyReconnect=null,this._options={url:"",automaticOpen:!0,initReconnectInterval:1e3,maxReconnectInterval:1e4,reconnectIntervalGrowFactor:2,timeoutInterval:5e3,uptimeInterval:1e3,maxRetries:5,debug:!1,maxMessageQueueLength:1/0,service:0,logIDGenerator:o,headers:void 0,payloadEncoding:"",payloadType:"",fpID:"",deviceID:"",accessKey:"",ttwID:"",bddID:"",aID:"",disableAutoReconnect:!1,customParams:{},pingInterval:3e4,pingTimeoutInterval:5e3,pingFrequency:"auto",enableTransformTextPayload:!1,logIDNewConfig:{enableAutoGenerateLogIDNew:!1,userIp:""},miniProgramParams:{customHttpHeader:{}},enableAutoAck:!1,reconnectInterceptor:()=>!0,enableQoS:!1};const{url:n,ws:i}=r,s=Array.isArray(n)?n:"string"==typeof n?[n]:[];if(!s||0===s.length)throw new Error("please provide valid url, 'options.env' param is deprecated, you can use 'options.url' param instead");if(!function(e){return!!(e||(ee||ne)&&"undefined"!=typeof WebSocket&&WebSocket||re&&wx.connectSocket||te&&tt.connectSocket)}(i))throw new Error("please provide ws params, WebSocket constructor is undefined");Object.assign(this._options,r),this._endpointManager=new J(s,this._options.maxRetries),this._options.automaticOpen&&(this._isInit=!0,this._connect()),this._isMiniTT||this._isMiniWX?this._onPageNetWorkChange():this._isBrowser&&this._initGlobalEventListener()}_handleOnLine(){this._options.disableAutoReconnect||this._readyClosed||this._handleReconnect()}_handleOffLine(){this._destroyWebSocket();const e=new W("reconnect",{message:"stop immediately reconnect"});this.onStopImmediatelyReconnect&&this.onStopImmediatelyReconnect(e)}_initGlobalEventListener(){this._isBrowser&&window.addEventListener("online",this._handleOnLine.bind(this)),this._isBrowser&&window.addEventListener("offline",this._handleOffLine.bind(this)),this._isBrowser&&window.addEventListener("pagehide",this._handlePageHide.bind(this)),this._isBrowser&&document.addEventListener("resume",this._handlePageShow.bind(this))}_handlePageHide(e){e.persisted||(this._isBrowser&&window.removeEventListener("pagehide",this._handlePageHide),this._isBrowser&&document.removeEventListener("resume",this._handlePageShow),this.close()),this._isBrowser&&window.removeEventListener("online",this._handleOnLine),this._isBrowser&&window.removeEventListener("offline",this._handleOffLine)}_handlePageShow(){!this._navigatorOnline()||this._ws&&this._ws.readyState===this.OPEN&&this._ws.readyState===this.CONNECTING||this._handleOnLine(),this._isBrowser&&window.addEventListener("online",this._handleOnLine.bind(this)),this._isBrowser&&window.addEventListener("offline",this._handleOffLine.bind(this))}_generateUrl(e){return t(this,void 0,void 0,function*(){const{fpID:t,deviceID:r,bddID:n,ttwID:i,accessKey:o,aID:s,customParams:a={},enableAutoAck:l,enableQoS:c}=this._options;let u,d,h;this._isBrowser||this._isMiniWX||this._isMiniTT?(u=location&&"https:"==location.protocol?"wss://":"ws://",d=e.replace(/((^ws)|(^http))((?:[s]*:\/\/))/,""),h=/^wss(.*:\/\/)/.test(e)?e:`${u}${d}`):(u="wss://",d=e.replace(/(^http)((?:[s]*:\/\/))/,""),h=/(^ws)((?:[s]*:\/\/))/.test(d)?d:`${u}${d}`);const p=n?"bd_did":i?"ttwid":"device_id",f=n||i||r;if(!f||!p)throw new Error("please provide bddID, deviceID or ttwID");const _="function"==typeof a?yield a():a,y=Object.assign({device_platform:"web",version_code:"fws_1.0.0",access_key:o,fpid:t,aid:s,[p]:f,xsack:l?1:0,xaack:l?1:0,xsqos:c?1:0},_);return`${h}/ws/v2${Object.keys(y).reduce((e,t)=>`${e}${e?"&":"?"}${t}=${y[t]}`,"")}`})}_connect(){var r,n,i,o,s,a,l;return t(this,void 0,void 0,function*(){if(!this._connectLock&&!this._readyClosed){this._connectLock=!0;try{const u=null===(r=this._endpointManager)||void 0===r?void 0:r.checkCurrentEndpointReachedMaxRetries(),{timeoutInterval:d}=this._options;if(u){const t=null===(n=this._endpointManager)||void 0===n?void 0:n.getCurrentEndpoint(),r=null===(i=this._endpointManager)||void 0===i?void 0:i.replaceBackupEndpointAndUpdateCount(),s=null===(o=this._endpointManager)||void 0===o?void 0:o.getCurrentEndpointTriesCount();if(!r){const r=`connect ${t} timeout, max retries reached`;return this._debug(r),void this._dispatchErrorEvent(X("error",{message:r,code:e.ErrorCode.MAX_RETRIES_ERROR}))}{const n=`connect ${t} timeout, max retries reached, will use backup endpoint ${r} to retry`,i=X("error",{message:n,code:e.ErrorCode.MAX_RETRIES_ERROR});this._debug(n),this._dispatchErrorEvent(i),this._url=yield this._generateUrl(r),this._debug(`connect ${r} ${s} times`),this._removeWsListeners()}}else{const e=null===(s=this._endpointManager)||void 0===s?void 0:s.getCurrentEndpointAndUpdateCount(),t=null===(a=this._endpointManager)||void 0===a?void 0:a.getCurrentEndpointTriesCount();this._url=yield this._generateUrl(e||""),this._debug(`connect ${e} ${t} times`),this._removeWsListeners()}if(this._isInit)this._isInit=!1;else{const e=new W("reconnect",{message:"start"});this.onStartReconnect&&this.onStartReconnect(e)}const h=(null===(l=this._endpointManager)||void 0===l?void 0:l.getCurrentEndpointTriesCount())||0;h>1&&(yield this._wait(h-1)),this._debug(`connecting url: ${this._url} protocols: ${this._protocols}`),this._ws=(t={url:this._url,protocols:[this._protocols],headers:this._options.miniProgramParams.customHttpHeader},(c=this._options.ws)?new c(t.url,t.protocol):(ee||ne)&&"undefined"!=typeof WebSocket&&WebSocket?new WebSocket(t.url,t.protocols):re||te?new se(t.url,t.protocol,t.headers):void 0),(this._isBrowser||this._isWorker)&&this._ws&&(this._ws.binaryType=this._binaryType),this._addWsListeners(),this._connectionTimeoutId=setTimeout(()=>this._onTimeout(),d)}catch(e){throw this._connectLock=!1,e}}var t,c})}_clearTimer(){clearTimeout(this._connectionTimeoutId),clearTimeout(this._uptimeTimeoutId),this._connectionTimeoutId=null,this._uptimeTimeoutId=null}_clearPingTimer(){clearTimeout(this._pingPongTimeoutId),clearTimeout(this._reconnectTimeoutId),this._pingPongTimeoutId=null,this._reconnectTimeoutId=null}_debug(...e){this._options.debug&&console.log.apply(console,["FRONTIER>",...e])}_getIntervalValue(e){const{initReconnectInterval:t,maxReconnectInterval:r,reconnectIntervalGrowFactor:n}=this._options,i=t*Math.pow(n,e-1);return i>r?r:i}_ping(){this._ws&&this._ws.readyState===this.CONNECTING?this._pingPongTimeoutId=setTimeout(()=>this._ping(),this._options.pingInterval):this._ws&&this._ws.readyState===this.OPEN?(this._ws&&this._ws.send("hi"),this._reconnectTimeoutId=setTimeout(()=>this._handleReconnect(),this._options.pingTimeoutInterval)):this._handleReconnect()}_navigatorOnline(){return this._isMiniTT||this._isMiniWX?this._miniNavigatorOnline:!this._isBrowser&&!this._isWorker||navigator.onLine}_handleReconnect(){var e;this._navigatorOnline()&&!this._readyClosed&&(null===(e=this._endpointManager)||void 0===e||e.resetEndpointConfig(),this._ws?this._disconnect(1001,"going away, try reconnecting server",!0):this._connect())}_onPageNetWorkChange(){this._isMiniTT?tt.onNetworkStatusChange(({isConnected:e})=>{this._miniNavigatorOnline=e,e?this._handleOnLine():this._handleOffLine()}):this._isMiniWX&&wx.onNetworkStatusChange(({isConnected:e})=>{this._miniNavigatorOnline=e,e?this._handleOnLine():this._handleOffLine()})}_wait(e){return new Promise(t=>{setTimeout(t,this._getIntervalValue(e))})}_disconnect(e=1e3,t="",r=!1){this._ws&&this._destroyWebSocket(e,t,r)}_onTimeout(){var e;const t=null===(e=this._endpointManager)||void 0===e?void 0:e.getCurrentEndpoint();this._debug(`connect ${t} timeout`),this._disconnect(1001,"timeout, try reconnecting",!0)}_sendAck(e){const t=x(e);this._ws&&this._ws.readyState===this.OPEN&&(this._ws&&this._ws.send(t),this._debug("send_ack",e))}_removeWsListeners(){this._ws&&(this._ws.removeEventListener("open",this._onOpen),this._ws.removeEventListener("close",this._onClose),this._ws.removeEventListener("message",this._onMessage),this._ws.removeEventListener("error",this._onError))}_addWsListeners(){this._ws&&(this._ws.addEventListener("open",this._onOpen),this._ws.addEventListener("close",this._onClose),this._ws.addEventListener("message",this._onMessage),this._ws.addEventListener("error",this._onError))}_wsInstanceClose(e=1e3,t=""){try{this._ws&&this._ws.close(e,t)}catch(e){}}_destroyWebSocket(e=1e3,t="",r=!1){var n,i,o;if(this._clearPingTimer(),this._clearTimer(),this._removeWsListeners(),this._wsInstanceClose(1e3,t),this._connectLock=!1,r&&this._navigatorOnline()&&!this._readyClosed)if(null===(n=this._endpointManager)||void 0===n?void 0:n.checkReachMaxTries()){const e=null===(i=this._endpointManager)||void 0===i?void 0:i.getCurrentEndpoint();this._dispatchCloseEvent(Q("close",{code:1006,reason:`connect ${e} timeout, max retries reached`,wasClean:!0}))}else this._options.reconnectInterceptor(e,t)&&this._connect(),this._dispatchCloseEvent(Q("close",{code:e,reason:t,wasClean:!0}));else this._navigatorOnline()||this._readyClosed?this._dispatchCloseEvent(Q("close",{code:e,reason:"bye"})):this._dispatchCloseEvent(Q("close",{code:1006,reason:"going away, network offline"})),this._ws=null,null===(o=this._endpointManager)||void 0===o||o.resetEndpointConfig()}_dispatchOpenEvent(e){this.emit("open",e),this.onopen&&this.onopen(e)}_dispatchMessageEvent(e){this.emit("message",e),this.onmessage&&this.onmessage(e)}_dispatchAckMessageEvent(e){this.emit("ack",e),this.onReceiveAck&&this.onReceiveAck(e)}_dispatchErrorEvent(e){this.emit("error",e),this.onerror&&this.onerror(e)}_dispatchCloseEvent(e){this.emit("close",e),this.onclose&&this.onclose(e)}get binaryType(){return this._ws?this._ws.binaryType:this._binaryType}set binaryType(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)}get retryCount(){var e;return(null===(e=this._endpointManager)||void 0===e?void 0:e.getCurrentEndpointTriesCount())||0}get bufferedAmount(){return this._messageQueue.reduce((e,t)=>e+(t&&t.byteLength||0),0)+(this._ws?this._ws.bufferedAmount:0)}get extensions(){return this._ws?this._ws.extensions:""}get protocol(){return this._ws?this._ws.protocol:""}get readyState(){return this._ws?this._ws.readyState:this._options.automaticOpen?this.CONNECTING:this.CLOSED}get url(){return this._ws?this._ws.url:""}close(e=1e3,t){var r;if(this._readyClosed=!0,this._clearTimer(),this._clearPingTimer(),null===(r=this._qosDB)||void 0===r||r.closeDB(),!this._ws){this._debug("close, ws instance not initialized");const e=Q("close",{code:1e3,reason:"ws instance not initialized",wasClean:!0});return void this._dispatchCloseEvent(e)}if(this._ws.readyState===this.CLOSED||this._ws.readyState===this.CLOSING){this._debug("close, ws already closed");const e=Q("close",{code:1e3,reason:"ws already closed",wasClean:!0});return void this._dispatchCloseEvent(e)}this._destroyWebSocket(e,t)}send(e,r){return t(this,void 0,void 0,function*(){if(null==e)throw new Error("please provide a valid data, data must be a string or an arraybuffer");"number"==typeof e&&(e=JSON.stringify(e)),"string"==typeof e||e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer||(e=JSON.stringify(e));const t=yield ue(e),n=function(e){try{return"string"!=typeof e&&(e instanceof ArrayBuffer||e.buffer&&e.buffer instanceof ArrayBuffer)?"":"string"==typeof e?(JSON.parse(e),"application/json"):""}catch(t){return"string"==typeof e?"text/plain;charset=utf-8":""}}(e),{method:o=0,service:s=this._options.service,logID:a=this._options.logIDGenerator(),headers:l=this._options.headers,payloadEncoding:c=this._options.payloadEncoding,payloadType:u=this._options.payloadType,logIDNew:d=(this._options.logIDNewConfig.enableAutoGenerateLogIDNew?i(this._options.logIDNewConfig.userIp):"")}=r||{};if(!s)throw new Error("please provide a valid service");const h={SeqID:B.fromNumber(this._seqId++),LogID:B.fromNumber(a),service:s,method:o,headers:l,payloadEncoding:c instanceof Object?c.encoding?c.encoding:"":c,payloadType:u instanceof Object?u.type?u.type:n:u||n,payload:t,LogIDNew:d},p=x(h);return this._ws&&this._ws.readyState===this.OPEN?(this._ws&&this._ws.send(p),this._debug("sent",h)):this._messageQueue.length<this._options.maxMessageQueueLength?(this._messageQueue.push(p),this._debug("enqueue",h)):(this._messageQueue.shift(),this._messageQueue.push(p)),this._seqId})}reconnect(e){var r;return t(this,void 0,void 0,function*(){const{url:t}=e||{},n=Array.isArray(t)?t:"string"==typeof t?[t]:[];e&&Object.assign(this._options,e),n&&n.length?this._endpointManager=new J(n,this._options.maxRetries):null===(r=this._endpointManager)||void 0===r||r.resetEndpointConfig(),this._readyClosed=!1,this._ws&&this._ws.readyState!==this.CLOSED?this._disconnect(1e3,"manual reconnecting",!0):(this._isInit=!0,this._connect())})}connect(){var e;return t(this,void 0,void 0,function*(){this._connectLock||(null===(e=this._endpointManager)||void 0===e||e.resetEndpointConfig(),this._readyClosed=!1,this._isInit=!0,this._connect())})}addEventListener(e,t){this.on(e,t)}dispatchEvent(e){const{type:t}=e;this.emit(t,e)}removeEventListener(e,t){this.off(e,t)}},e.FrontierMessageEvent=Z,e.MessageEvent=z,e.OpenEvent=Y,e.ReconnectEvent=W,e.createCloseEvent=Q,e.createErrorEvent=X,e.decodedFrame=R,e.encodeFrame=x,Object.defineProperty(e,"__esModule",{value:!0})}(t)},86553:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M38.1716 24L24.7929 10.6213C24.4024 10.2308 24.4024 9.59763 24.7929 9.20711L26.2071 7.79289C26.5976 7.40237 27.2308 7.40237 27.6213 7.79289L42.4142 22.5858C43.1953 23.3668 43.1953 24.6332 42.4142 25.4142L27.6213 40.2071C27.2308 40.5976 26.5976 40.5976 26.2071 40.2071L24.7929 38.7929C24.4024 38.4024 24.4024 37.7692 24.7929 37.3787L38.1716 24Z"}))}},88344:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 9C15.7157 9 9 15.7157 9 24C9 32.2843 15.7157 39 24 39C26.4159 39 28.6903 38.4311 30.7045 37.4227L31.5987 36.975C32.5864 36.4805 33.7879 36.8803 34.2824 37.868L35.1778 39.6564C35.6723 40.6441 35.2724 41.8457 34.2847 42.3402L33.3906 42.7878C30.5614 44.2043 27.3693 45 24 45C12.402 45 3 35.598 3 24C3 12.402 12.402 3 24 3C35.598 3 45 12.402 45 24V25.8C45 30.5382 40.9978 34.2 36.4594 34.2C34.1689 34.2 32.0924 33.2832 30.5771 31.7965C28.8019 33.2961 26.5073 34.2 24 34.2C18.3667 34.2 13.8 29.6333 13.8 24C13.8 18.3667 18.3667 13.8 24 13.8C29.6333 13.8 34.2 18.3667 34.2 24C34.2 24.5688 34.1531 25.1288 34.0625 25.6759C34.0605 25.7168 34.0594 25.7581 34.0594 25.8C34.0594 27.1255 35.1339 28.2 36.4594 28.2C37.8857 28.2 39 27.0265 39 25.8V24C39 15.7157 32.2843 9 24 9ZM24 19.8C21.6804 19.8 19.8 21.6804 19.8 24C19.8 26.3196 21.6804 28.2 24 28.2C26.056 28.2 27.7725 26.7197 28.1308 24.7661C28.176 24.5198 28.2 24.264 28.2 24C28.2 21.6804 26.3196 19.8 24 19.8Z"}))}},88479:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 32 32",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.0362 21.3333H18.5243L15.9983 24.4208L13.4721 21.3333H7.96047L7.99557 8H24.0009L24.0362 21.3333ZM24.3705 23.3333H19.4721L17.2883 26.0026C16.6215 26.8176 15.3753 26.8176 14.7084 26.0026L12.5243 23.3333H7.62626C6.70407 23.3333 5.95717 22.5845 5.9596 21.6623L5.99646 7.66228C5.99887 6.74352 6.74435 6 7.66312 6H24.3333C25.2521 6 25.9975 6.7435 26 7.66224L26.0371 21.6622C26.0396 22.5844 25.2927 23.3333 24.3705 23.3333ZM12.6647 14C12.2965 14 11.998 14.2985 11.998 14.6667V15.3333C11.998 15.7015 12.2965 16 12.6647 16H19.3313C19.6995 16 19.998 15.7015 19.998 15.3333V14.6667C19.998 14.2985 19.6995 14 19.3313 14H12.6647Z"}))}},89274:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 32 32",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.78511 10.3334C6.95518 10.3334 6.33301 10.9792 6.33301 11.7143V20.2858C6.33301 21.0209 6.95518 21.6667 7.78511 21.6667H18.5744C19.4043 21.6667 20.0265 21.0209 20.0265 20.2858V17.5602C20.0265 17.1826 20.2392 16.8372 20.5763 16.6672C20.9135 16.4973 21.3177 16.5317 21.6212 16.7563L25.6663 19.7488V12.2513L21.6212 15.2439C21.3177 15.4684 20.9135 15.5029 20.5763 15.3329C20.2392 15.1629 20.0265 14.8175 20.0265 14.4399V11.7143C20.0265 10.9792 19.4043 10.3334 18.5744 10.3334H7.78511ZM25.6855 12.2371C25.6831 12.2388 25.6839 12.2383 25.6839 12.2383L25.6855 12.2371ZM25.6716 12.2177C25.673 12.2212 25.6746 12.2243 25.6763 12.2269C25.6798 12.2324 25.6834 12.2355 25.6855 12.2371L25.6874 12.2383C25.6874 12.2383 25.6865 12.238 25.6839 12.2383M4.33301 11.7143C4.33301 9.81952 5.90653 8.33337 7.78511 8.33337H18.5744C20.453 8.33337 22.0265 9.81953 22.0265 11.7143V12.4562L24.4963 10.629C25.0929 10.1877 25.8879 10.1155 26.5542 10.4359C27.224 10.758 27.6663 11.4325 27.6663 12.1905V19.8096C27.6663 20.5676 27.224 21.2421 26.5542 21.5642C25.888 21.8846 25.0929 21.8124 24.4963 21.371L22.0265 19.5439V20.2858C22.0265 22.1806 20.453 23.6667 18.5744 23.6667H7.78511C5.90653 23.6667 4.33301 22.1806 4.33301 20.2858V11.7143Z"}),n.createElement("path",{d:"M15 15.134C15.6667 15.5189 15.6667 16.4811 15 16.866L12 18.5981C11.3333 18.983 10.5 18.5019 10.5 17.7321L10.5 14.2679C10.5 13.4981 11.3333 13.017 12 13.4019L15 15.134Z"}))}},90040:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.3149 23.1174C22.2013 23.1174 25.3517 19.9571 25.3517 16.0587C25.3517 12.1603 22.2013 9 18.3149 9C14.4286 9 11.2781 12.1603 11.2781 16.0587C11.2781 19.9571 14.4286 23.1174 18.3149 23.1174ZM30.6289 37.2347C30.6289 30.4125 25.1155 24.882 18.3145 24.882C11.5134 24.882 6 30.4125 6 37.2347V37.2353C6 38.2099 6.78762 39 7.75921 39C7.77558 39 7.7919 38.9998 7.80817 38.9993H28.8205C28.8367 38.9998 28.853 39 28.8694 39C29.841 39 30.6286 38.2099 30.6286 37.2353V37.2347H30.6289ZM32.9979 37.2347C32.9979 34.2847 32.1257 31.5298 30.6216 29.2211C30.9879 28.7879 31.685 28.5483 32.8836 28.5483C37.9184 28.5483 42 32.6426 42 37.6931L41.9998 37.6931V37.6936C41.9998 38.4151 41.4167 39 40.6974 39C40.68 39 40.6627 38.9997 40.6454 38.999H32.9979V37.2347ZM38.0933 22.0166C38.0933 24.9026 35.761 27.2422 32.8839 27.2422C30.0068 27.2422 27.6745 24.9026 27.6745 22.0166C27.6745 19.1306 30.0068 16.791 32.8839 16.791C35.761 16.791 38.0933 19.1306 38.0933 22.0166Z"}))}},90046:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 8.5C6.067 8.5 4.5 10.067 4.5 12V36C4.5 37.933 6.067 39.5 8 39.5H39C40.933 39.5 42.5 37.933 42.5 36V12C42.5 10.067 40.933 8.5 39 8.5H8ZM7.5 12C7.5 11.7239 7.72386 11.5 8 11.5H39C39.2761 11.5 39.5 11.7239 39.5 12V26L31.9 20.3C31.346 19.8845 30.5796 19.9023 30.0454 20.3429L10.4611 36.5H8C7.72386 36.5 7.5 36.2761 7.5 36V12ZM31.0442 23.4081L39.5 29.75V36C39.5 36.2761 39.2761 36.5 39 36.5H15.1753L31.0442 23.4081ZM17 22C18.6569 22 20 20.6569 20 19C20 17.3431 18.6569 16 17 16C15.3431 16 14 17.3431 14 19C14 20.6569 15.3431 22 17 22Z"}))}},91128:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 72 72",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36.8479 69.734C37.4283 70.1479 38.0945 70.3649 38.7759 70.3649C39.1191 70.3649 39.4674 70.3094 39.8106 70.1983C58.7271 63.9601 70.9613 49.1216 70.9714 32.4409V32.3803C70.9714 15.6593 55.28 2.0573 36 2.0573C16.72 2.0573 1.02856 15.6593 1.02856 32.3803C1.02856 48.9399 16.4223 62.446 35.4549 62.6983V67.0136C35.4549 68.0886 35.9748 69.1031 36.8479 69.734ZM38.0239 60.0833C37.7412 59.8108 37.3627 59.6543 36.969 59.6543C36.9589 59.6543 36.9438 59.6543 36.9337 59.6493L36.6511 59.6594C36.434 59.6695 36.217 59.6745 36 59.6745C18.3856 59.6745 4.05683 47.4302 4.05683 32.3797C4.05683 17.3293 18.3856 5.08498 36 5.08498C53.6043 5.08498 67.9331 17.3192 67.9432 32.3697V32.405C67.9331 47.7936 56.5165 61.5016 38.8617 67.3259C38.781 67.3512 38.7002 67.336 38.6245 67.2805C38.5791 67.2502 38.4832 67.1644 38.4832 67.013V61.1685C38.4832 60.7597 38.3166 60.366 38.0239 60.0833Z"}),n.createElement("path",{d:"M35.9998 30.4867C34.0769 30.4867 32.5173 32.0513 32.5173 33.9692C32.5173 35.8871 34.0819 37.4517 35.9998 37.4517C37.9177 37.4517 39.4823 35.8871 39.4823 33.9692C39.4823 32.0513 37.9228 30.4867 35.9998 30.4867Z"}),n.createElement("path",{d:"M19.7988 30.6541C17.8758 30.6541 16.3163 32.2187 16.3163 34.1366C16.3163 36.0545 17.8809 37.6191 19.7988 37.6191C21.7167 37.6191 23.2813 36.0545 23.2813 34.1366C23.2813 32.2187 21.7217 30.6541 19.7988 30.6541Z"}),n.createElement("path",{d:"M52.0752 30.4867C50.1522 30.4867 48.5927 32.0513 48.5927 33.9692C48.5927 35.8871 50.1573 37.4517 52.0752 37.4517C53.9931 37.4517 55.5577 35.8871 55.5577 33.9692C55.5577 32.0513 53.9931 30.4867 52.0752 30.4867Z"}))}},91272:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M43 24.4313C43 23.084 42.8767 21.7885 42.6475 20.5449H24.3877V27.8945H34.8219C34.3724 30.2695 33.0065 32.2818 30.9532 33.6291V38.3964H37.2189C40.885 35.0886 43 30.2177 43 24.4313Z",fill:"#4285F4"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.3872 43.001C29.6219 43.001 34.0107 41.2996 37.2184 38.3978L30.9527 33.6305C29.2165 34.7705 26.9958 35.4441 24.3872 35.4441C19.3375 35.4441 15.0633 32.1018 13.5388 27.6108H7.06152V32.5337C10.2517 38.7433 16.8082 43.001 24.3872 43.001Z",fill:"#34A853"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5395 27.6094C13.1516 26.4695 12.9313 25.2517 12.9313 23.9994C12.9313 22.7472 13.1516 21.5295 13.5395 20.3894V15.4668H7.06217C5.74911 18.0318 5 20.9336 5 23.9994C5 27.0654 5.74911 29.9673 7.06217 32.5323L13.5395 27.6094Z",fill:"#FBBC04"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.3872 12.5568C27.2336 12.5568 29.7894 13.5155 31.7987 15.3982L37.3595 9.94866C34.0018 6.88281 29.6131 5 24.3872 5C16.8082 5 10.2517 9.25777 7.06152 15.4674L13.5388 20.39C15.0633 15.8991 19.3375 12.5568 24.3872 12.5568Z",fill:"#EA4335"}))}},91532:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("g",{opacity:"0.9",filter:"url(#CommentShadowColor_filter0_d)"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M38.4943 35.3128C42.6 31.2 45 26.9162 45 21.928C45 11.8056 35.733 3.60001 24.2999 3.60001C12.8671 3.60001 3.6 11.8056 3.6 21.9283C3.6 32.051 13.1669 39 24.6 39V42.3569C24.6 43.4205 25.7028 44.105 26.638 43.5983C29.5598 42.015 34.9741 38.8392 38.4943 35.3128ZM14.2446 19.4564C15.8786 19.4564 17.2031 20.7714 17.2031 22.3912C17.2031 24.0142 15.8786 25.3291 14.2446 25.3291C12.6134 25.3291 11.2888 24.0142 11.2888 22.3912C11.2888 20.7714 12.6134 19.4564 14.2446 19.4564ZM27.2572 22.3912C27.2572 20.7714 25.9332 19.4564 24.3 19.4564C22.667 19.4564 21.3429 20.7714 21.3429 22.3912C21.343 24.0142 22.6671 25.3291 24.3 25.3291C25.9332 25.3291 27.2572 24.0142 27.2572 22.3912ZM34.355 19.4564C35.9887 19.4564 37.3113 20.7714 37.3113 22.3912C37.3113 24.0142 35.9888 25.3291 34.355 25.3291C32.7213 25.3291 31.3969 24.0142 31.397 22.3912C31.397 20.7714 32.7214 19.4564 34.355 19.4564Z",fill:"white"})),n.createElement("path",{opacity:"0.1",fillRule:"evenodd",clipRule:"evenodd",d:"M24.6001 38.9999C24.6001 38.9999 36.0669 38.1138 40.8601 31.9764C36.0669 38.7276 31.2737 42.4101 27.0796 43.6376C22.8855 44.8651 24.6001 38.9999 24.6001 38.9999Z",fill:"url(#CommentShadowColor_paint0_linear)"}),n.createElement("defs",null,n.createElement("filter",{id:"CommentShadowColor_filter0_d",x:"1.2001",y:"2.40001",width:"46.2",height:"44.9688",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},n.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),n.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),n.createElement("feOffset",{dy:"1.2"}),n.createElement("feGaussianBlur",{stdDeviation:"1.2"}),n.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),n.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow"}),n.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})),n.createElement("linearGradient",{id:"CommentShadowColor_paint0_linear",x1:"20.4103",y1:"37.6698",x2:"22.3081",y2:"43.6335",gradientUnits:"userSpaceOnUse"},n.createElement("stop",null),n.createElement("stop",{offset:"1",stopOpacity:"0.01"}))))}},91842:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 10.554V37.4459L38.1463 24L16 10.554ZM12 8.77702C12 6.43812 14.5577 4.99881 16.5569 6.21266L41.6301 21.4356C43.5542 22.6038 43.5542 25.3962 41.6301 26.5644L16.5569 41.7873C14.5577 43.0012 12 41.5619 12 39.223V8.77702Z"}))}},92067:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25 10.8685C25 8.47242 22.3296 7.04325 20.3359 8.37236L10.3944 15H6C4.34315 15 3 16.3431 3 18V30C3 31.6568 4.34314 33 6 33H10.3944L20.3359 39.6276C22.3296 40.9567 25 39.5276 25 37.1315V10.8685ZM29.2929 18.1213L35.1716 24L29.2929 29.8787C28.9024 30.2692 28.9024 30.9024 29.2929 31.2929L30.7071 32.7071C31.0976 33.0976 31.7308 33.0976 32.1213 32.7071L38 26.8284L43.8787 32.7071C44.2692 33.0976 44.9024 33.0976 45.2929 32.7071L46.7071 31.2929C47.0976 30.9024 47.0976 30.2692 46.7071 29.8787L40.8284 24L46.7071 18.1213C47.0976 17.7308 47.0976 17.0976 46.7071 16.7071L45.2929 15.2929C44.9024 14.9024 44.2692 14.9024 43.8787 15.2929L38 21.1716L32.1213 15.2929C31.7308 14.9024 31.0976 14.9024 30.7071 15.2929L29.2929 16.7071C28.9024 17.0976 28.9024 17.7308 29.2929 18.1213Z"}))}},92249:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24.0003 7C20.1343 7 17.0003 10.134 17.0003 14C17.0003 17.866 20.1343 21 24.0003 21C27.8663 21 31.0003 17.866 31.0003 14C31.0003 10.134 27.8663 7 24.0003 7ZM13.0003 14C13.0003 7.92487 17.9252 3 24.0003 3C30.0755 3 35.0003 7.92487 35.0003 14C35.0003 20.0751 30.0755 25 24.0003 25C17.9252 25 13.0003 20.0751 13.0003 14ZM24.0003 33C18.0615 33 13.0493 36.9841 11.4972 42.4262C11.3457 42.9573 10.8217 43.3088 10.2804 43.1989L8.32038 42.8011C7.77914 42.6912 7.4266 42.1618 7.5683 41.628C9.49821 34.358 16.1215 29 24.0003 29C31.8792 29 38.5025 34.358 40.4324 41.628C40.5741 42.1618 40.2215 42.6912 39.6803 42.8011L37.7203 43.1989C37.179 43.3088 36.6549 42.9573 36.5035 42.4262C34.9514 36.9841 29.9391 33 24.0003 33Z"}))}},92467:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 8.77702C12 6.43812 14.5577 4.99881 16.5569 6.21266L41.6301 21.4356C43.5542 22.6038 43.5542 25.3962 41.6301 26.5644L16.5569 41.7873C14.5577 43.0012 12 41.5619 12 39.223V8.77702Z"}))}},92662:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 47.001C36.7026 47.001 47 36.7035 47 24.001C47 11.2984 36.7026 1.00098 24 1.00098C11.2975 1.00098 1 11.2984 1 24.001C1 36.7035 11.2975 47.001 24 47.001Z",fill:"#FBE300"}),n.createElement("path",{d:"M24.0825 10C15.6421 10 8.7998 15.3949 8.7998 22.0498C8.7998 26.3524 11.6603 30.1276 15.9633 32.2594C15.7292 33.0668 14.459 37.4532 14.4084 37.7978C14.4084 37.7978 14.378 38.0567 14.5457 38.1555C14.7133 38.2542 14.9105 38.1775 14.9105 38.1775C15.3914 38.1104 20.4862 34.5316 21.3681 33.9101C22.249 34.0349 23.1562 34.0997 24.0825 34.0997C32.523 34.0997 39.3652 28.7049 39.3652 22.0498C39.3652 15.3949 32.523 10 24.0825 10Z",fill:"black"}),n.createElement("path",{d:"M15.6327 26.2563C15.1464 26.2563 14.751 25.8786 14.751 25.4143V20.1763H13.3752C12.8981 20.1763 12.51 19.7889 12.51 19.3129C12.51 18.837 12.8982 18.4496 13.3752 18.4496H17.8901C18.3673 18.4496 18.7554 18.837 18.7554 19.3129C18.7554 19.7889 18.3671 20.1763 17.8901 20.1763H16.5144V25.4143C16.5144 25.8786 16.1189 26.2563 15.6327 26.2563ZM23.364 26.2448C22.9963 26.2448 22.715 26.0955 22.6303 25.8554L22.1937 24.7124L19.5051 24.7123L19.0682 25.856C18.9837 26.0957 18.7026 26.2448 18.3349 26.2448C18.1415 26.245 17.9504 26.2035 17.7745 26.1232C17.5314 26.011 17.2978 25.7027 17.5655 24.8711L19.6745 19.32C19.8231 18.8978 20.2744 18.4628 20.8486 18.4498C21.4245 18.4627 21.8758 18.8978 22.0247 19.3209L24.1328 24.8695C24.4011 25.703 24.1675 26.0115 23.9244 26.1233C23.7485 26.2035 23.5573 26.245 23.364 26.2448C23.364 26.2448 23.3638 26.2448 23.364 26.2448ZM21.73 23.1507L20.8494 20.6489L19.9687 23.1507H21.73ZM25.5518 26.1277C25.0858 26.1277 24.7068 25.765 24.7068 25.3195V19.3313C24.7068 18.8451 25.1106 18.4496 25.6069 18.4496C26.1031 18.4496 26.5069 18.8451 26.5069 19.3313V24.5113H28.3805C28.8465 24.5113 29.2255 24.8739 29.2255 25.3195C29.2255 25.765 28.8465 26.1277 28.3805 26.1277H25.5518ZM30.4502 26.2448C29.9639 26.2448 29.5685 25.8494 29.5685 25.3631V19.3313C29.5685 18.8451 29.9639 18.4496 30.4502 18.4496C30.9364 18.4496 31.3319 18.8451 31.3319 19.3313V21.2264L33.7918 18.7664C33.9183 18.6399 34.0921 18.5703 34.2808 18.5703C34.501 18.5703 34.722 18.6652 34.8876 18.8307C35.042 18.985 35.1342 19.1835 35.1468 19.3896C35.1596 19.5976 35.0904 19.7882 34.9522 19.9265L32.943 21.9354L35.1133 24.8106C35.1834 24.9028 35.2344 25.0081 35.2635 25.1202C35.2925 25.2323 35.299 25.3491 35.2826 25.4638C35.2669 25.5785 35.2285 25.689 35.1698 25.7888C35.1111 25.8886 35.0331 25.9758 34.9405 26.0453C34.788 26.1612 34.6017 26.2237 34.4101 26.2232C34.2735 26.2239 34.1387 26.1925 34.0164 26.1316C33.894 26.0708 33.7877 25.9821 33.7058 25.8728L31.6381 23.133L31.3321 23.439V25.3627C31.3319 25.5965 31.2389 25.8207 31.0735 25.9861C30.9082 26.1515 30.684 26.2445 30.4502 26.2448Z",fill:"#FFE812"}))}},92681:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.5187 35.2284C24.7205 36.1596 23.2798 36.1596 22.4816 35.2284L8.83008 19.3016C7.71807 18.0042 8.63988 16 10.3486 16H37.6517C39.3604 16 40.2822 18.0042 39.1702 19.3016L25.5187 35.2284Z"}))}},95748:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=(e.fill,e.style),a=e.className,l=e.e2eTag,c=void 0===l?"":l;return n.createElement("svg",{className:a,style:s,width:r,"data-e2e":c,height:o,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z",fill:"#4D76A1"}),n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.4221 22.9074H16.7111C16.7111 22.9074 17.1005 22.8663 17.2993 22.6603C17.4823 22.4712 17.4764 22.1161 17.4764 22.1161C17.4764 22.1161 17.4512 20.4534 18.254 20.2086C19.0453 19.9674 20.0615 21.8155 21.1386 22.5261C21.9531 23.0639 22.572 22.946 22.572 22.946L25.4519 22.9074C25.4519 22.9074 26.9584 22.8182 26.2441 21.6796C26.1855 21.5864 25.8281 20.8373 24.1028 19.2979C22.2971 17.6868 22.5389 17.9474 24.7141 15.1604C26.0389 13.4632 26.5685 12.427 26.4031 11.9832C26.2453 11.5605 25.2709 11.6722 25.2709 11.6722L22.0283 11.6916C22.0283 11.6916 21.7879 11.6601 21.6096 11.7625C21.4355 11.863 21.3233 12.0971 21.3233 12.0971C21.3233 12.0971 20.8101 13.4105 20.1256 14.5275C18.6817 16.8844 18.1044 17.0088 17.8684 16.8625C17.3195 16.5214 17.4565 15.4922 17.4565 14.7611C17.4565 12.4771 17.8169 11.5247 16.7548 11.2782C16.4023 11.1963 16.1429 11.1423 15.2415 11.1335C14.0845 11.122 13.1052 11.1369 12.5507 11.3981C12.1818 11.5717 11.8972 11.9587 12.0706 11.9809C12.2849 12.0085 12.7703 12.1067 13.0276 12.4436C13.3599 12.8781 13.3482 13.8541 13.3482 13.8541C13.3482 13.8541 13.5391 16.5428 12.9023 16.8768C12.4652 17.1059 11.8656 16.6382 10.5783 14.4999C9.91875 13.4046 9.42076 12.1939 9.42076 12.1939C9.42076 12.1939 9.32474 11.9677 9.15347 11.8467C8.94561 11.7001 8.65519 11.6533 8.65519 11.6533L5.57386 11.6728C5.57386 11.6728 5.1113 11.6851 4.94149 11.8785C4.79043 12.0504 4.92949 12.4061 4.92949 12.4061C4.92949 12.4061 7.34186 17.8314 10.0733 20.5654C12.5779 23.0721 15.4221 22.9074 15.4221 22.9074Z",fill:"white"}))}},96973:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M42.6925 12.7217C43.0748 13.1203 43.0616 13.7533 42.663 14.1356L18.8847 36.9434C18.0993 37.6967 16.8556 37.6838 16.086 36.9142L5.29314 26.1213C4.90261 25.7308 4.90261 25.0976 5.29314 24.7071L6.70735 23.2929C7.09788 22.9024 7.73104 22.9024 8.12156 23.2929L17.5294 32.7007L39.8941 11.2489C40.2927 10.8666 40.9257 10.8798 41.308 11.2783L42.6925 12.7217Z"}))}},97413:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 6C6.89543 6 6 6.89543 6 8V21C6 22.1046 6.89543 23 8 23H21C22.1046 23 23 22.1046 23 21V8C23 6.89543 22.1046 6 21 6H8ZM10 19V10H19V19H10ZM28 6C26.8954 6 26 6.89543 26 8V21C26 22.1046 26.8954 23 28 23H41C42.1046 23 43 22.1046 43 21V8C43 6.89543 42.1046 6 41 6H28ZM30 19V10H39V19H30ZM8 26C6.89543 26 6 26.8954 6 28V41C6 42.1046 6.89543 43 8 43H21C22.1046 43 23 42.1046 23 41V28C23 26.8954 22.1046 26 21 26H8ZM10 39V30H19V39H10ZM26 42C26 42.5523 26.4477 43 27 43H29C29.5523 43 30 42.5523 30 42V27C30 26.4477 29.5523 26 29 26H27C26.4477 26 26 26.4477 26 27V42ZM32.5 42C32.5 42.5523 32.9477 43 33.5 43H35.5C36.0523 43 36.5 42.5523 36.5 42V27C36.5 26.4477 36.0523 26 35.5 26H33.5C32.9477 26 32.5 26.4477 32.5 27V42ZM40 43C39.4477 43 39 42.5523 39 42V27C39 26.4477 39.4477 26 40 26H42C42.5523 26 43 26.4477 43 27V42C43 42.5523 42.5523 43 42 43H40Z"}))}},98332:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 42V5C4 4.44772 4.44772 4 5 4H7C7.55228 4 8 4.44772 8 5V40H43C43.5523 40 44 40.4477 44 41V43C44 43.5523 43.5523 44 43 44H6C4.89543 44 4 43.1046 4 42ZM42.8396 11.5433C43.3033 11.8433 43.4359 12.4624 43.1359 12.9261L32.6791 29.0865C32.3807 29.5477 31.9057 29.8659 31.3656 29.9663C30.8255 30.0667 30.2679 29.9406 29.8237 29.6175L20.5908 22.9027L13.2295 35.1715C12.9453 35.6451 12.3311 35.7986 11.8575 35.5145L10.1425 34.4855C9.66893 34.2014 9.51536 33.5871 9.79951 33.1135L18.285 18.971C18.5737 18.4898 19.0513 18.1521 19.6011 18.0402C20.151 17.9283 20.7225 18.0525 21.1763 18.3825L30.4682 25.1403L39.7776 10.7531C40.0776 10.2894 40.6967 10.1567 41.1604 10.4567L42.8396 11.5433Z"}))}},98605:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(40099);function i(e){var t=e.width,r=void 0===t?"1em":t,i=e.height,o=void 0===i?"1em":i,s=e.fill,a=void 0===s?"currentColor":s,l=e.style,c=e.className,u=e.e2eTag,d=void 0===u?"":u;return n.createElement("svg",{className:c,style:l,width:r,"data-e2e":d,height:o,viewBox:"0 0 48 48",fill:a,xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 8.5C20.9624 8.5 18.5 10.9624 18.5 14V18.5H29.5V14C29.5 10.9624 27.0376 8.5 24 8.5ZM32.5 18.5V14C32.5 9.30558 28.6944 5.5 24 5.5C19.3056 5.5 15.5 9.30558 15.5 14V18.5H11C9.61929 18.5 8.5 19.6193 8.5 21V40C8.5 41.3807 9.61929 42.5 11 42.5H37C38.3807 42.5 39.5 41.3807 39.5 40V21C39.5 19.6193 38.3807 18.5 37 18.5H32.5ZM11.5 21.5V39.5H36.5V21.5H11.5Z"}))}}}]);