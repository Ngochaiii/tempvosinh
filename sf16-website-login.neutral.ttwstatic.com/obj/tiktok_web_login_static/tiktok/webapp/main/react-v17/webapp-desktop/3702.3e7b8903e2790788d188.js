"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3702],{3702:(t,e,i)=>{i.d(e,{$4:()=>L,M_:()=>j,R0:()=>I,dF:()=>m,zW:()=>n});var n,o=i(81893),s=i(69857),l=i(73041),c=i(89768),a=i(10453),r=i(37123),u=i(6726),d=i(53455),v=i(16356),g=i(66767),f=i(18499),p=i(78695),y=i(64388),b=i(87314),O=i(1183);!function(t){t.Initial="initial",t.CreatePlaylist="create_playlist",t.CreatePlaylistReady="create_playlist_ready"}(n||(n={}));const h=(0,p._)((0,O.p)("userPageAtom@tiktok/webapp-desktop",{uniqueId:void 0,statusCode:void 0,secUid:void 0,profileState:n.Initial,selectedTab:"user-post"}),{rehydrationKey:"webapp.userPage"});h.debugLabel="userPageAtom";const{useAtomService:m,useServiceDispatchers:j,useServiceState:I,getStaticApi:L}=(0,y.i)(h,(t,e)=>({setUniqueId(t){e(h,e=>Object.assign(Object.assign({},e),{uniqueId:t}))},setSecUid(t){e(h,e=>Object.assign(Object.assign({},e),{secUid:t}))},setProfileState(t){e(h,e=>Object.assign(Object.assign({},e),{profileState:t}))},resetUserPage(t=!1){(0,f.unstable_batchedUpdates)(()=>{e(h,t=>Object.assign(Object.assign({},t),{uniqueId:void 0,secUid:void 0,statusCode:0,profileState:n.Initial})),(0,a.Ds)().resetAllLists(t),(0,r.UO)().setUniqueId(void 0),(0,u.cF)().resetUserFollowInfo(),(0,d.MA)().resetData(),(0,o.rS)().resetCollectionInfoList()})},getUserInfo(i){var n,o,a,u,p,y,O,m,j;return y=this,O=void 0,j=function*(){const y=(0,r.UO)(),O=(0,v.Gp)(),{uniqueId:m,locateItemID:j}=i,{user:I}=(0,c.x)(),{uniqueId:L,secUid:P}=(0,s.L$)(I);let C=t(v.p9).users[null!=m?m:""];const S=t(v.p9).stats[null!=m?m:""],{isInWebappPerfPageSwitchExperiment:w}=(0,b.xW)();try{let c;if("number"!=typeof(null===(n=null==C?void 0:C.extraInfo)||void 0===n?void 0:n.statusCode)||w&&(!S||S.needFix||void 0===(null==C?void 0:C.uniqueIdModifyTime))){const e=yield O.getUserDetail(i);C=t(v.p9).users[null!==(u=null===(a=null===(o=e.userInfo)||void 0===o?void 0:o.user)||void 0===a?void 0:a.uniqueId)&&void 0!==u?u:""],c=e.statusCode}(0,f.unstable_batchedUpdates)(()=>{e(h,t=>Object.assign(Object.assign({},t),{statusCode:null!=c?c:t.statusCode,uniqueId:null==C?void 0:C.uniqueId,secUid:null==C?void 0:C.secUid})),y.setUniqueId(null==C?void 0:C.uniqueId)});const r=[];(null==C?void 0:C.id)&&(0===c||10222===c)&&(0,l.fU)()&&r.push((0,g.s5)().getItemList(Object.assign({secUid:null!==(p=C.secUid)&&void 0!==p?p:"",userId:C.id},j&&{locateItemID:j})));const b=Boolean(I)&&(Boolean(L&&L===(null==C?void 0:C.uniqueId))||Boolean(P&&P===(null==C?void 0:C.secUid))),{id:m="",secUid:U=""}=(0,s.L$)(C);!b&&(null==C?void 0:C.privateAccount)||r.push((0,d.MA)().getVideoPlaylistData({uid:m,secUid:U,isReset:!0})),yield Promise.allSettled(r)}catch(t){console.error(t),e(h,t=>Object.assign(Object.assign({},t),{statusCode:-1}))}},new((m=void 0)||(m=Promise))(function(t,e){function i(t){try{o(j.next(t))}catch(t){e(t)}}function n(t){try{o(j.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof m?o:new m(function(t){t(o)})).then(i,n)}o((j=j.apply(y,O||[])).next())})},setSelectedTab(t){e(h,e=>Object.assign(Object.assign({},e),{selectedTab:t}))}}))},8503:(t,e,i)=>{i.d(e,{A4:()=>c,Se:()=>r,_J:()=>u});var n=i(78695),o=i(64388),s=i(1183);const l=(0,n._)((0,s.p)("playlistDetailAtom@tiktok/webapp-atoms",{}),{rehydrationKey:"webapp.videoPlaylistDetails"}),{useAtomService:c,useServiceDispatchers:a,useServiceState:r,getStaticApi:u}=(0,o.i)(l,(t,e)=>({multiSetPlaylistDetail(i){const n=t(l),o={};i.forEach(t=>{var e;const{id:i=""}=t,s=null!==(e=n[i])&&void 0!==e?e:{};o[i]=Object.assign(Object.assign({},s),t)}),e(l,Object.assign(Object.assign({},n),o))},setPlaylistDetail(t){const{id:i=""}=t;e(l,e=>Object.assign(Object.assign({},e),{[i]:Object.assign(Object.assign({},e[i]),t)}))}}))},21459:(t,e,i)=>{i.d(e,{m:()=>n});const n=(0,i(71273).l)("/api/collection/modify_items/",{statusCode:0})},53455:(t,e,i)=>{i.d(e,{MA:()=>S,kn:()=>L,aD:()=>C,c8:()=>I});var n=i(34914),o=i(87215),s=i(69857),l=i(78695),c=i(64388),a=i(1183),r=i(8503),u=i(54133),d=i(50439),v=i(48941),g=i(35762),f=i(17384),p=i(40746),y=i(73456),b=function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function l(t){try{a(n.next(t))}catch(t){s(t)}}function c(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,c)}a((n=n.apply(t,e||[])).next())})};const O=(0,p.M)({csr:function(t){return b(this,void 0,void 0,function*(){const{uid:e}=t,i=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(i[n[o]]=t[n[o]])}return i}(t,["uid"]),n=(0,d.t)("userPlayList");if(n)return n;const o=(0,v.DV)("userPlayList");return o?(y.P.emit("consume_prefetch_data",performance.now(),"unknown","userPlayList"),o.catch(()=>(y.P.emit("consume_prefetch_data",performance.now(),"fail","userPlayList"),g.h.get("/api/user/playlist/",{query:i,baseUrlType:f.Z4.FixedWww})))):g.h.get("/api/user/playlist/",{query:i,baseUrlType:f.Z4.FixedWww})})}});var h=function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function l(t){try{a(n.next(t))}catch(t){s(t)}}function c(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,c)}a((n=n.apply(t,e||[])).next())})};const m="0",j={loading:!1,changeOrderLoading:!1,hasMore:!0,statusCode:o.s.Ok,playList:[],cursor:m},I=(0,l._)((0,a.p)("videoPlaylistSharedAtom@tiktok/webapp-atoms",j),{rehydrationKey:"webapp.videoPlaylist"}),{useAtomService:L,useServiceDispatchers:P,useServiceState:C,getStaticApi:S}=(0,c.i)(I,(t,e)=>({resetData(){e(I,j)},setPlaylist(t){const{statusCode:i,playList:n=[],hasMore:o,cursor:l,loading:c,changeOrderLoading:a,isMerge:r=!1}=(0,s.L$)(t);e(I,t=>{var e;return Object.assign(Object.assign({},t),{statusCode:null!=i?i:t.statusCode,hasMore:null!=o?o:t.hasMore,cursor:null!=l?l:t.cursor,playList:r?[...null!==(e=t.playList)&&void 0!==e?e:[],...n]:n,loading:null!=c?c:t.loading,changeOrderLoading:null!=a?a:t.changeOrderLoading})})},changePlaylistOrder(i){return h(this,void 0,void 0,function*(){const{playlist:s=[],endIndex:l=-1,successCallback:c}=i,{playList:a=[]}=t(I),r=s.slice(0,l+1);if(!r.length)return o.s.Ok;let d;e(I,t=>Object.assign(Object.assign({},t),{changeOrderLoading:!0}));try{({statusCode:d}=yield function(t){var e;return b(this,void 0,void 0,function*(){return g.h.post("/api/playlist/modify_order/",{baseUrlType:f.Z4.FixedWww,body:u.stringify({commitMixIds:null!==(e=t.commitMixIds)&&void 0!==e?e:""})})})}({commitMixIds:r.join(",")}))}catch(t){d=o.s.UnknownError}try{if(n.c.handleSaveChangePlaylistOrder({status:d===o.s.Ok?"1":"0"}),d!==o.s.Ok)return e(I,t=>Object.assign(Object.assign({},t),{changeOrderLoading:!1})),d;const t=[...r,...a.slice(l+1)];return null==c||c(),this.setPlaylist({playList:t,changeOrderLoading:!1}),d}catch(t){return console.error(t),e(I,t=>Object.assign(Object.assign({},t),{changeOrderLoading:!1})),o.s.UnknownError}})},getVideoPlaylistData(i){return h(this,void 0,void 0,function*(){const{uid:n,secUid:s,isReset:l}=i,{cursor:c=m,hasMore:a}=t(I);if(!a)return;const u=l?m:c;let d,v;e(I,t=>Object.assign(Object.assign({},t),{loading:!0}));try{v=O({uid:n,secUid:s,cursor:u,count:20}),e(I,t=>Object.assign(Object.assign({},t),{prevPromise:v})),d=yield v}catch(t){d={statusCode:o.s.UnknownError,playList:[],hasMore:a}}try{const{playList:e=[]}=d,i=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(i[n[o]]=t[n[o]])}return i}(d,["playList"]),n=e.filter(({id:t})=>t),o=n.map(({id:t})=>t);if((0,r._J)().multiSetPlaylistDetail(n),v&&t(I).prevPromise!==v)return;this.setPlaylist(Object.assign(Object.assign({},i),{playList:o,isMerge:!l,loading:!1}))}catch(t){console.error(t),e(I,t=>Object.assign(Object.assign({},t),{loading:!1}))}})}}))},71273:(t,e,i)=>{i.d(e,{l:()=>r});var n=i(35762),o=i(17384),s=i(89768),l=i(25094),c=i(52957),a=function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function l(t){try{a(n.next(t))}catch(t){s(t)}}function c(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,c)}a((n=n.apply(t,e||[])).next())})};function r(t,e){return(0,c.z)({initState:e,fetchAction:(i,c,r)=>a(this,void 0,void 0,function*(){try{const{user:e,language:i}=(0,s.x)(),a=yield n.h.post(t,{query:Object.assign(Object.assign({},c),{aid:l.xE,region:null==e?void 0:e.region,language:i}),baseUrlType:2,headers:{[o.nk]:n.h.csrfToken}});return null==r||r(a),a}catch(t){const i=Object.assign(Object.assign({},e),{statusCode:-1});return null==r||r(i),i}})})}},81893:(t,e,i)=>{i.d(e,{rS:()=>m,sK:()=>O,HQ:()=>b,x6:()=>h});var n=i(89768),o=i(4852),s=i(11421),l=i(37783),c=i(35762),a=i(17384),r=i(78695),u=i(71111),d=i(64388),v=i(21459);const g=(0,i(71273).l)("/api/collection/move_items/",{statusCode:0});var f=function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function l(t){try{a(n.next(t))}catch(t){s(t)}}function c(t){try{a(n.throw(t))}catch(t){s(t)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(l,c)}a((n=n.apply(t,e||[])).next())})};const p={statusCode:0,loading:!1,hasMore:!0,collectionList:[],total:"0"},y=(0,r._)((0,u.atom)(p),{rehydrationKey:"desktop.userPage.userCollectionList"});y.debugLabel="collectionInfoListAtom";const{useAtomService:b,useServiceDispatchers:O,useServiceState:h,getStaticApi:m}=(0,d.i)(y,(t,e)=>({getCollectionInfoList(i){return f(this,void 0,void 0,function*(){const{uniqueId:l,secUid:r,isReset:u=!1}=i;try{e(y,t=>{var e;return Object.assign(Object.assign({},t),{collectionList:null===(e=t.collectionList)||void 0===e?void 0:e.filter(t=>t.userName===l),loading:!0})});const{user:i}=(0,n.x)(),d=Object.assign(Object.assign({},(0,s.bv)(t,y,{secUid:r})),{appId:o.xE,publicOnly:(null==i?void 0:i.secUid)!==r});u&&(d.cursor="0");const v=function(t){return f(this,void 0,void 0,function*(){return c.h.get("/api/user/collection_list/",{query:t,baseUrlType:2,headers:{[a.nk]:c.h.csrfToken}})})}(d);e(y,t=>Object.assign(Object.assign({},t),{prevPromise:v}));const g=yield v;e(y,t=>{var e,i;if(t.prevPromise!==v)return t;if(u)return Object.assign(Object.assign(Object.assign({},t),g),{loading:!1});const n=[...null!==(e=t.collectionList)&&void 0!==e?e:[]],o=new Set(n.map(t=>t.collectionId));for(const t of null!==(i=g.collectionList)&&void 0!==i?i:[])o.has(t.collectionId)||(o.add(t.collectionId),n.push(t));return Object.assign(Object.assign(Object.assign({},t),g),{collectionList:n,loading:!1})})}catch(t){e(y,t=>Object.assign(Object.assign({},t),{loading:!1,statusCode:-1}))}})},resetCollectionInfoList(){e(y,Object.assign({},p))},moveItems({itemIds:i,fromCollectionId:n,targetCollectionId:o,onMove:s}){var c,a,r,u,d,p,b;return f(this,void 0,void 0,function*(){if(0===i.length)return;const f=t(y),O=null===(c=f.collectionList)||void 0===c?void 0:c.find(t=>t.collectionId===n),h=null===(a=f.collectionList)||void 0===a?void 0:a.find(t=>t.collectionId===o),m=null!==(r=null==O?void 0:O.total)&&void 0!==r?r:"0",j=(BigInt(m)-BigInt(i.length)).toString(),I=null!==(u=null==h?void 0:h.total)&&void 0!==u?u:"0",L=(BigInt(I)+BigInt(i.length)).toString(),P=null===(b=null===(p=null===(d=t(l.Pu)[i[0]])||void 0===d?void 0:d.video)||void 0===p?void 0:p.zoomCover)||void 0===b?void 0:b[240],C="0"===j||null==O?void 0:O.cover,S=!(null==h?void 0:h.cover)&&P?{urlList:[P]}:null==h?void 0:h.cover;let w;if(n)o?(this.modifyCollectionInfo(n,{total:j,cover:C}),this.modifyCollectionInfo(o,{total:L,cover:S}),w=e(g,{itemIDs:i.join(","),fromCollectionID:n,targetCollectionID:o})):(this.modifyCollectionInfo(n,{total:j,cover:C}),w=e(v.m,{collectionId:n,deleteIds:i.join(",")}));else{if(!o)return;this.modifyCollectionInfo(o,{total:L,cover:S}),w=e(v.m,{collectionId:o,commitIds:i.join(",")})}const{statusCode:U}=yield w;0!==U&&(n&&this.modifyCollectionInfo(n,{total:m,cover:null==O?void 0:O.cover}),o&&this.modifyCollectionInfo(o,{total:I,cover:null==h?void 0:h.cover})),null==s||s({statusCode:U,fromCollection:O,targetCollection:h})})},prependCollectionInfo(i){var n;(null===(n=t(y).collectionList)||void 0===n?void 0:n.some(t=>t.collectionId===i.collectionId))||e(y,t=>{var e;return Object.assign(Object.assign({},t),{collectionList:[i,...null!==(e=t.collectionList)&&void 0!==e?e:[]]})})},modifyCollectionInfo(i,n){const o=t(y);if(!o.collectionList)return;const s=o.collectionList.findIndex(t=>t.collectionId===i);if(s<0)return;const l=[...o.collectionList];l[s]=Object.assign(Object.assign({},l[s]),n),e(y,t=>Object.assign(Object.assign({},t),{collectionList:l}))}}))}}]);